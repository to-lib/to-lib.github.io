---
sidebar_position: 22
title: å›½é™…åŒ– (i18n)
---

# React å›½é™…åŒ– (i18n)

> [!TIP]
> å›½é™…åŒ–è®©åº”ç”¨æ”¯æŒå¤šè¯­è¨€ï¼Œä¸ºå…¨çƒç”¨æˆ·æä¾›æœ¬åœ°åŒ–ä½“éªŒã€‚æœ¬æ–‡ä»‹ç» React åº”ç”¨ä¸­å¸¸ç”¨çš„ i18n æ–¹æ¡ˆã€‚

## ğŸ¯ æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ              | ç‰¹ç‚¹                   | é€‚ç”¨åœºæ™¯       |
| ----------------- | ---------------------- | -------------- |
| **react-i18next** | åŠŸèƒ½å…¨é¢ã€ç”Ÿæ€ä¸°å¯Œ     | å¤§å¤šæ•°é¡¹ç›®æ¨è |
| **next-intl**     | Next.js ä¼˜åŒ–ã€ç±»å‹å®‰å…¨ | Next.js é¡¹ç›®   |
| **FormatJS**      | æ ‡å‡†åŒ–ã€ICU æ¶ˆæ¯æ ¼å¼   | ä¼ä¸šçº§åº”ç”¨     |
| **æ‰‹åŠ¨å®ç°**      | ç®€å•ã€æ— ä¾èµ–           | å°å‹é¡¹ç›®       |

## ğŸ“¦ react-i18next

### å®‰è£…

```bash
npm install react-i18next i18next i18next-browser-languagedetector
```

### åŸºç¡€é…ç½®

```js
// i18n.js
import i18n from "i18next";
import { initReactI18next } from "react-i18next";
import LanguageDetector from "i18next-browser-languagedetector";

const resources = {
  en: {
    translation: {
      welcome: "Welcome",
      greeting: "Hello, {{name}}!",
      items: {
        one: "{{count}} item",
        other: "{{count}} items",
      },
    },
  },
  zh: {
    translation: {
      welcome: "æ¬¢è¿",
      greeting: "ä½ å¥½ï¼Œ{{name}}ï¼",
      items: "{{count}} ä¸ªé¡¹ç›®",
    },
  },
};

i18n
  .use(LanguageDetector) // è‡ªåŠ¨æ£€æµ‹è¯­è¨€
  .use(initReactI18next)
  .init({
    resources,
    fallbackLng: "en",
    interpolation: {
      escapeValue: false, // React å·²ç»å®‰å…¨è½¬ä¹‰
    },
  });

export default i18n;
```

### å…¥å£å¼•å…¥

```jsx
// main.jsx
import "./i18n";
import App from "./App";

createRoot(document.getElementById("root")).render(<App />);
```

### ä½¿ç”¨ç¿»è¯‘

```jsx
import { useTranslation } from "react-i18next";

function Welcome() {
  const { t } = useTranslation();

  return (
    <div>
      <h1>{t("welcome")}</h1>
      <p>{t("greeting", { name: "React" })}</p>
    </div>
  );
}
```

### è¯­è¨€åˆ‡æ¢

```jsx
function LanguageSwitcher() {
  const { i18n } = useTranslation();

  const changeLanguage = (lng) => {
    i18n.changeLanguage(lng);
  };

  return (
    <div>
      <button onClick={() => changeLanguage("en")}>English</button>
      <button onClick={() => changeLanguage("zh")}>ä¸­æ–‡</button>
    </div>
  );
}
```

### å¤æ•°å¤„ç†

```jsx
function ItemCount({ count }) {
  const { t } = useTranslation();

  return <span>{t("items", { count })}</span>;
  // count=1: "1 item"
  // count=5: "5 items"
}
```

### å‘½åç©ºé—´

```js
// å¤§å‹é¡¹ç›®æŒ‰æ¨¡å—åˆ†å‰²ç¿»è¯‘
const resources = {
  en: {
    common: { save: "Save", cancel: "Cancel" },
    auth: { login: "Login", logout: "Logout" },
    dashboard: { title: "Dashboard" },
  },
};
```

```jsx
function AuthPage() {
  const { t } = useTranslation("auth");

  return <button>{t("login")}</button>;
}

function Header() {
  const { t: tCommon } = useTranslation("common");
  const { t: tAuth } = useTranslation("auth");

  return (
    <nav>
      <button>{tCommon("save")}</button>
      <button>{tAuth("logout")}</button>
    </nav>
  );
}
```

## ğŸš€ Next.js + next-intl

### å®‰è£…

```bash
npm install next-intl
```

### é…ç½®

```js
// next.config.js
const withNextIntl = require("next-intl/plugin")();

module.exports = withNextIntl({
  // å…¶ä»–é…ç½®
});
```

### æ¶ˆæ¯æ–‡ä»¶

```json
// messages/en.json
{
  "HomePage": {
    "title": "Welcome",
    "description": "This is the homepage"
  }
}
```

```json
// messages/zh.json
{
  "HomePage": {
    "title": "æ¬¢è¿",
    "description": "è¿™æ˜¯é¦–é¡µ"
  }
}
```

### ä¸­é—´ä»¶

```ts
// middleware.ts
import createMiddleware from "next-intl/middleware";

export default createMiddleware({
  locales: ["en", "zh"],
  defaultLocale: "en",
});

export const config = {
  matcher: ["/((?!api|_next|.*\\..*).*)"],
};
```

### ä½¿ç”¨ç¿»è¯‘

```tsx
// app/[locale]/page.tsx
import { useTranslations } from "next-intl";

export default function HomePage() {
  const t = useTranslations("HomePage");

  return (
    <div>
      <h1>{t("title")}</h1>
      <p>{t("description")}</p>
    </div>
  );
}
```

### Server Component ä¸­ä½¿ç”¨

```tsx
import { getTranslations } from "next-intl/server";

export default async function Page() {
  const t = await getTranslations("HomePage");

  return <h1>{t("title")}</h1>;
}
```

## ğŸ› ï¸ æ‰‹åŠ¨å®ç°ï¼ˆç®€å•æ–¹æ¡ˆï¼‰

é€‚ç”¨äºå°å‹é¡¹ç›®ï¼š

```jsx
// translations.js
const translations = {
  en: {
    welcome: "Welcome",
    greeting: (name) => `Hello, ${name}!`,
  },
  zh: {
    welcome: "æ¬¢è¿",
    greeting: (name) => `ä½ å¥½ï¼Œ${name}ï¼`,
  },
};

// I18nContext.jsx
const I18nContext = createContext();

export function I18nProvider({ children }) {
  const [locale, setLocale] = useState("en");
  const t = (key, ...args) => {
    const value = translations[locale][key];
    return typeof value === "function" ? value(...args) : value;
  };

  return (
    <I18nContext.Provider value={{ locale, setLocale, t }}>
      {children}
    </I18nContext.Provider>
  );
}

export function useI18n() {
  return useContext(I18nContext);
}

// ä½¿ç”¨
function App() {
  const { t, setLocale } = useI18n();

  return (
    <div>
      <h1>{t("welcome")}</h1>
      <p>{t("greeting", "React")}</p>
      <button onClick={() => setLocale("zh")}>ä¸­æ–‡</button>
    </div>
  );
}
```

## ğŸŒ æ—¥æœŸå’Œæ•°å­—æ ¼å¼åŒ–

```jsx
function FormattedContent() {
  const { i18n } = useTranslation();
  const locale = i18n.language;

  const date = new Date();
  const number = 1234567.89;

  return (
    <div>
      <p>æ—¥æœŸï¼š{new Intl.DateTimeFormat(locale).format(date)}</p>
      <p>æ•°å­—ï¼š{new Intl.NumberFormat(locale).format(number)}</p>
      <p>
        è´§å¸ï¼š
        {new Intl.NumberFormat(locale, {
          style: "currency",
          currency: locale === "zh" ? "CNY" : "USD",
        }).format(number)}
      </p>
    </div>
  );
}
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ç¿»è¯‘æ–‡ä»¶ç»“æ„åŒ–

```
locales/
â”œâ”€â”€ en/
â”‚   â”œâ”€â”€ common.json
â”‚   â”œâ”€â”€ auth.json
â”‚   â””â”€â”€ dashboard.json
â””â”€â”€ zh/
    â”œâ”€â”€ common.json
    â”œâ”€â”€ auth.json
    â””â”€â”€ dashboard.json
```

### 2. ä½¿ç”¨ TypeScript ç±»å‹

```ts
// types/i18n.d.ts
import "react-i18next";
import en from "../locales/en/common.json";

declare module "react-i18next" {
  interface CustomTypeOptions {
    resources: {
      translation: typeof en;
    };
  }
}
```

### 3. è¯­è¨€æŒä¹…åŒ–

```jsx
useEffect(() => {
  const savedLocale = localStorage.getItem("locale");
  if (savedLocale) {
    i18n.changeLanguage(savedLocale);
  }
}, []);

const changeLanguage = (lng) => {
  i18n.changeLanguage(lng);
  localStorage.setItem("locale", lng);
};
```

### 4. RTL æ”¯æŒ

```jsx
function App() {
  const { i18n } = useTranslation();
  const isRTL = i18n.language === "ar" || i18n.language === "he";

  return <div dir={isRTL ? "rtl" : "ltr"}>...</div>;
}
```

## ğŸ”— ç›¸å…³èµ„æº

- [react-i18next æ–‡æ¡£](https://react.i18next.com/)
- [next-intl æ–‡æ¡£](https://next-intl-docs.vercel.app/)
- [å¯è®¿é—®æ€§](/docs/react/accessibility)
- [SSR ä¸ Next.js](/docs/react/ssr-nextjs)

---

**ä¸‹ä¸€æ­¥**ï¼šäº†è§£ [SSR ä¸ Next.js](/docs/react/ssr-nextjs) å®ç°æœåŠ¡ç«¯æ¸²æŸ“çš„å›½é™…åŒ–ã€‚
