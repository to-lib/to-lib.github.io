"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[53727],{40705:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>m,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"kubernetes/quick-reference","title":"\u5feb\u901f\u53c2\u8003","description":"Kubernetes \u547d\u4ee4\u4e0e\u914d\u7f6e\u901f\u67e5\u8868","source":"@site/docs/kubernetes/quick-reference.md","sourceDirName":"kubernetes","slug":"/kubernetes/quick-reference","permalink":"/docs/kubernetes/quick-reference","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/kubernetes/quick-reference.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"sidebar_position":11,"title":"\u5feb\u901f\u53c2\u8003","description":"Kubernetes \u547d\u4ee4\u4e0e\u914d\u7f6e\u901f\u67e5\u8868"},"sidebar":"kubernetes","previous":{"title":"\u6700\u4f73\u5b9e\u8df5","permalink":"/docs/kubernetes/best-practices"},"next":{"title":"\u5e38\u89c1\u95ee\u9898","permalink":"/docs/kubernetes/faq"}}');var l=s(22714),i=s(48885);const r={sidebar_position:11,title:"\u5feb\u901f\u53c2\u8003",description:"Kubernetes \u547d\u4ee4\u4e0e\u914d\u7f6e\u901f\u67e5\u8868"},a="Kubernetes \u5feb\u901f\u53c2\u8003",d={},c=[{value:"kubectl \u5e38\u7528\u547d\u4ee4",id:"kubectl-\u5e38\u7528\u547d\u4ee4",level:2},{value:"\u96c6\u7fa4\u4fe1\u606f",id:"\u96c6\u7fa4\u4fe1\u606f",level:3},{value:"\u8d44\u6e90\u64cd\u4f5c",id:"\u8d44\u6e90\u64cd\u4f5c",level:3},{value:"\u8c03\u8bd5",id:"\u8c03\u8bd5",level:3},{value:"\u8d44\u6e90\u7f29\u5199",id:"\u8d44\u6e90\u7f29\u5199",level:2},{value:"Pod \u914d\u7f6e\u6a21\u677f",id:"pod-\u914d\u7f6e\u6a21\u677f",level:2},{value:"Deployment \u6a21\u677f",id:"deployment-\u6a21\u677f",level:2},{value:"Service \u6a21\u677f",id:"service-\u6a21\u677f",level:2},{value:"Helm \u547d\u4ee4",id:"helm-\u547d\u4ee4",level:2},{value:"StatefulSet \u6a21\u677f",id:"statefulset-\u6a21\u677f",level:2},{value:"Job \u6a21\u677f",id:"job-\u6a21\u677f",level:2},{value:"CronJob \u6a21\u677f",id:"cronjob-\u6a21\u677f",level:2},{value:"DaemonSet \u6a21\u677f",id:"daemonset-\u6a21\u677f",level:2},{value:"Ingress \u6a21\u677f",id:"ingress-\u6a21\u677f",level:2},{value:"\u8d44\u6e90\u9650\u5236\u63a8\u8350\u503c",id:"\u8d44\u6e90\u9650\u5236\u63a8\u8350\u503c",level:2},{value:"\u5e38\u7528\u6807\u7b7e",id:"\u5e38\u7528\u6807\u7b7e",level:2},{value:"\u8c03\u8bd5\u955c\u50cf",id:"\u8c03\u8bd5\u955c\u50cf",level:2},{value:"\u9ad8\u9891\u8c03\u8bd5\u547d\u4ee4",id:"\u9ad8\u9891\u8c03\u8bd5\u547d\u4ee4",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"kubernetes-\u5feb\u901f\u53c2\u8003",children:"Kubernetes \u5feb\u901f\u53c2\u8003"})}),"\n",(0,l.jsx)(n.h2,{id:"kubectl-\u5e38\u7528\u547d\u4ee4",children:"kubectl \u5e38\u7528\u547d\u4ee4"}),"\n",(0,l.jsx)(n.h3,{id:"\u96c6\u7fa4\u4fe1\u606f",children:"\u96c6\u7fa4\u4fe1\u606f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl cluster-info                 # \u96c6\u7fa4\u4fe1\u606f\nkubectl get nodes -o wide           # \u67e5\u770b\u8282\u70b9\nkubectl top nodes                   # \u8282\u70b9\u8d44\u6e90\u4f7f\u7528\nkubectl api-resources               # API \u8d44\u6e90\u5217\u8868\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u8d44\u6e90\u64cd\u4f5c",children:"\u8d44\u6e90\u64cd\u4f5c"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\nkubectl get pods -A                  # \u6240\u6709\u547d\u540d\u7a7a\u95f4\nkubectl get pods -l app=nginx        # \u6309\u6807\u7b7e\u7b5b\u9009\nkubectl describe pod <name>\nkubectl get pod <name> -o yaml\n\n# \u521b\u5efa/\u66f4\u65b0\nkubectl apply -f manifest.yaml\nkubectl create deployment nginx --image=nginx\nkubectl set image deployment/nginx nginx=nginx:1.25\nkubectl scale deployment nginx --replicas=5\n\n# \u5220\u9664\nkubectl delete pod <name>\nkubectl delete -f manifest.yaml\nkubectl delete pod <name> --force --grace-period=0\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u8c03\u8bd5",children:"\u8c03\u8bd5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl logs <pod> -f                # \u5b9e\u65f6\u65e5\u5fd7\nkubectl exec -it <pod> -- /bin/bash  # \u8fdb\u5165\u5bb9\u5668\nkubectl port-forward pod/<pod> 8080:80\nkubectl cp local-file <pod>:/path\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u8d44\u6e90\u7f29\u5199",children:"\u8d44\u6e90\u7f29\u5199"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u8d44\u6e90"}),(0,l.jsx)(n.th,{children:"\u7f29\u5199"}),(0,l.jsx)(n.th,{children:"\u8d44\u6e90"}),(0,l.jsx)(n.th,{children:"\u7f29\u5199"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"pods"}),(0,l.jsx)(n.td,{children:"po"}),(0,l.jsx)(n.td,{children:"services"}),(0,l.jsx)(n.td,{children:"svc"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"deployments"}),(0,l.jsx)(n.td,{children:"deploy"}),(0,l.jsx)(n.td,{children:"configmaps"}),(0,l.jsx)(n.td,{children:"cm"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"statefulsets"}),(0,l.jsx)(n.td,{children:"sts"}),(0,l.jsx)(n.td,{children:"persistentvolumeclaims"}),(0,l.jsx)(n.td,{children:"pvc"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"namespaces"}),(0,l.jsx)(n.td,{children:"ns"}),(0,l.jsx)(n.td,{children:"serviceaccounts"}),(0,l.jsx)(n.td,{children:"sa"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"pod-\u914d\u7f6e\u6a21\u677f",children:"Pod \u914d\u7f6e\u6a21\u677f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Pod\nmetadata:\n  name: my-pod\n  labels:\n    app: my-app\nspec:\n  containers:\n    - name: app\n      image: nginx:1.24\n      ports:\n        - containerPort: 80\n      resources:\n        requests:\n          memory: "64Mi"\n          cpu: "250m"\n        limits:\n          memory: "128Mi"\n          cpu: "500m"\n      livenessProbe:\n        httpGet:\n          path: /healthz\n          port: 80\n        initialDelaySeconds: 30\n      readinessProbe:\n        httpGet:\n          path: /ready\n          port: 80\n'})}),"\n",(0,l.jsx)(n.h2,{id:"deployment-\u6a21\u677f",children:"Deployment \u6a21\u677f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: my-deployment\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: my-app\n  template:\n    metadata:\n      labels:\n        app: my-app\n    spec:\n      containers:\n        - name: app\n          image: my-app:1.0\n"})}),"\n",(0,l.jsx)(n.h2,{id:"service-\u6a21\u677f",children:"Service \u6a21\u677f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Service\nmetadata:\n  name: my-service\nspec:\n  type: ClusterIP # NodePort / LoadBalancer\n  selector:\n    app: my-app\n  ports:\n    - port: 80\n      targetPort: 8080\n"})}),"\n",(0,l.jsx)(n.h2,{id:"helm-\u547d\u4ee4",children:"Helm \u547d\u4ee4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"helm repo add bitnami https://charts.bitnami.com/bitnami\nhelm install my-release bitnami/nginx -f values.yaml\nhelm upgrade my-release bitnami/nginx\nhelm rollback my-release 1\nhelm uninstall my-release\n"})}),"\n",(0,l.jsx)(n.h2,{id:"statefulset-\u6a21\u677f",children:"StatefulSet \u6a21\u677f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: StatefulSet\nmetadata:\n  name: mysql\nspec:\n  serviceName: mysql\n  replicas: 3\n  selector:\n    matchLabels:\n      app: mysql\n  template:\n    metadata:\n      labels:\n        app: mysql\n    spec:\n      containers:\n        - name: mysql\n          image: mysql:8.0\n          ports:\n            - containerPort: 3306\n          volumeMounts:\n            - name: data\n              mountPath: /var/lib/mysql\n  volumeClaimTemplates:\n    - metadata:\n        name: data\n      spec:\n        accessModes: ["ReadWriteOnce"]\n        resources:\n          requests:\n            storage: 10Gi\n'})}),"\n",(0,l.jsx)(n.h2,{id:"job-\u6a21\u677f",children:"Job \u6a21\u677f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'apiVersion: batch/v1\nkind: Job\nmetadata:\n  name: my-job\nspec:\n  completions: 1\n  parallelism: 1\n  backoffLimit: 3\n  activeDeadlineSeconds: 600\n  template:\n    spec:\n      restartPolicy: Never\n      containers:\n        - name: job\n          image: busybox\n          command: ["echo", "Hello, World!"]\n'})}),"\n",(0,l.jsx)(n.h2,{id:"cronjob-\u6a21\u677f",children:"CronJob \u6a21\u677f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'apiVersion: batch/v1\nkind: CronJob\nmetadata:\n  name: my-cronjob\nspec:\n  schedule: "0 2 * * *" # \u6bcf\u5929\u51cc\u6668 2 \u70b9\n  successfulJobsHistoryLimit: 3\n  failedJobsHistoryLimit: 1\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          restartPolicy: OnFailure\n          containers:\n            - name: job\n              image: busybox\n              command: ["echo", "Scheduled task"]\n'})}),"\n",(0,l.jsx)(n.h2,{id:"daemonset-\u6a21\u677f",children:"DaemonSet \u6a21\u677f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: my-daemonset\nspec:\n  selector:\n    matchLabels:\n      app: my-daemon\n  template:\n    metadata:\n      labels:\n        app: my-daemon\n    spec:\n      containers:\n        - name: daemon\n          image: my-agent:1.0\n          resources:\n            limits:\n              memory: 200Mi\n              cpu: 100m\n"})}),"\n",(0,l.jsx)(n.h2,{id:"ingress-\u6a21\u677f",children:"Ingress \u6a21\u677f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"apiVersion: networking.k8s.io/v1\nkind: Ingress\nmetadata:\n  name: my-ingress\n  annotations:\n    nginx.ingress.kubernetes.io/rewrite-target: /\nspec:\n  ingressClassName: nginx\n  tls:\n    - hosts:\n        - example.com\n      secretName: tls-secret\n  rules:\n    - host: example.com\n      http:\n        paths:\n          - path: /api\n            pathType: Prefix\n            backend:\n              service:\n                name: api-service\n                port:\n                  number: 80\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u8d44\u6e90\u9650\u5236\u63a8\u8350\u503c",children:"\u8d44\u6e90\u9650\u5236\u63a8\u8350\u503c"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u5e94\u7528\u7c7b\u578b"}),(0,l.jsx)(n.th,{children:"CPU requests"}),(0,l.jsx)(n.th,{children:"CPU limits"}),(0,l.jsx)(n.th,{children:"\u5185\u5b58 requests"}),(0,l.jsx)(n.th,{children:"\u5185\u5b58 limits"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5fae\u670d\u52a1"}),(0,l.jsx)(n.td,{children:"100m-250m"}),(0,l.jsx)(n.td,{children:"500m-1000m"}),(0,l.jsx)(n.td,{children:"128Mi-256Mi"}),(0,l.jsx)(n.td,{children:"256Mi-512Mi"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u6570\u636e\u5e93"}),(0,l.jsx)(n.td,{children:"500m-1000m"}),(0,l.jsx)(n.td,{children:"2000m-4000m"}),(0,l.jsx)(n.td,{children:"1Gi-2Gi"}),(0,l.jsx)(n.td,{children:"2Gi-4Gi"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u7f13\u5b58"}),(0,l.jsx)(n.td,{children:"250m-500m"}),(0,l.jsx)(n.td,{children:"1000m-2000m"}),(0,l.jsx)(n.td,{children:"512Mi-1Gi"}),(0,l.jsx)(n.td,{children:"1Gi-2Gi"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u6279\u5904\u7406"}),(0,l.jsx)(n.td,{children:"500m-1000m"}),(0,l.jsx)(n.td,{children:"2000m-4000m"}),(0,l.jsx)(n.td,{children:"512Mi-1Gi"}),(0,l.jsx)(n.td,{children:"2Gi-4Gi"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"\u5e38\u7528\u6807\u7b7e",children:"\u5e38\u7528\u6807\u7b7e"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'metadata:\n  labels:\n    app.kubernetes.io/name: my-app\n    app.kubernetes.io/instance: my-app-prod\n    app.kubernetes.io/version: "1.0.0"\n    app.kubernetes.io/component: frontend\n    app.kubernetes.io/part-of: my-platform\n    app.kubernetes.io/managed-by: helm\n    environment: production\n    team: platform\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u8c03\u8bd5\u955c\u50cf",children:"\u8c03\u8bd5\u955c\u50cf"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u955c\u50cf"}),(0,l.jsx)(n.th,{children:"\u7528\u9014"}),(0,l.jsx)(n.th,{children:"\u793a\u4f8b\u547d\u4ee4"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"busybox"}),(0,l.jsx)(n.td,{children:"\u57fa\u7840\u8c03\u8bd5"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"kubectl run debug --image=busybox -it --rm -- sh"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"nicolaka/netshoot"}),(0,l.jsx)(n.td,{children:"\u7f51\u7edc\u8c03\u8bd5"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"kubectl run netshoot --image=nicolaka/netshoot -it --rm"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"curlimages/curl"}),(0,l.jsx)(n.td,{children:"HTTP \u6d4b\u8bd5"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"kubectl run curl --image=curlimages/curl -it --rm -- curl http://svc"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"registry.k8s.io/e2e-test-images/jessie-dnsutils"}),(0,l.jsx)(n.td,{children:"DNS \u8c03\u8bd5"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"kubectl run dns --image=registry.k8s.io/e2e-test-images/jessie-dnsutils:1.3 -it --rm -- nslookup kubernetes"})})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"\u9ad8\u9891\u8c03\u8bd5\u547d\u4ee4",children:"\u9ad8\u9891\u8c03\u8bd5\u547d\u4ee4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u6240\u6709\u95ee\u9898 Pod\nkubectl get pods -A | grep -v Running | grep -v Completed\n\n# \u67e5\u770b\u6700\u8fd1\u4e8b\u4ef6\nkubectl get events -A --sort-by='.lastTimestamp' | tail -20\n\n# \u6309\u8d44\u6e90\u4f7f\u7528\u6392\u5e8f\nkubectl top pods -A --sort-by=memory | head -20\nkubectl top pods -A --sort-by=cpu | head -20\n\n# \u5bfc\u51fa\u8d44\u6e90\u5b9a\u4e49\nkubectl get deployment my-app -o yaml > deployment.yaml\n\n# \u4e34\u65f6\u8fd0\u884c\u8c03\u8bd5 Pod\nkubectl run debug --image=busybox -it --rm -- sh\n\n# \u7aef\u53e3\u8f6c\u53d1\nkubectl port-forward svc/my-service 8080:80\n\n# \u67e5\u770b\u5bb9\u5668\u8fdb\u7a0b\nkubectl exec -it <pod> -- ps aux\n\n# \u68c0\u67e5\u7f51\u7edc\u8fde\u901a\u6027\nkubectl exec -it <pod> -- curl -v http://service:port\n"})})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},48885:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>a});var t=s(99378);const l={},i=t.createContext(l);function r(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);