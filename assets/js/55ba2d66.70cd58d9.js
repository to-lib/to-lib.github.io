"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[5512],{48885:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>r});var l=s(99378);const t={},a=l.createContext(t);function i(n){const e=l.useContext(a);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:i(n.components),l.createElement(a.Provider,{value:e},n.children)}},84470:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>d});const l=JSON.parse('{"id":"linux/system-admin","title":"\u7cfb\u7edf\u7ba1\u7406","description":"\u7cfb\u7edf\u7ba1\u7406\u662f Linux \u8fd0\u7ef4\u7684\u6838\u5fc3\u5185\u5bb9\uff0c\u5305\u62ec\u7cfb\u7edf\u670d\u52a1\u3001\u542f\u52a8\u7ba1\u7406\u3001\u7cfb\u7edf\u4fe1\u606f\u67e5\u770b\u7b49\u3002","source":"@site/docs/linux/system-admin.md","sourceDirName":"linux","slug":"/linux/system-admin","permalink":"/docs/linux/system-admin","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/linux/system-admin.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"sidebar_position":11,"title":"\u7cfb\u7edf\u7ba1\u7406"},"sidebar":"linux","previous":{"title":"\u8fdb\u7a0b\u7ba1\u7406","permalink":"/docs/linux/process-management"},"next":{"title":"\u670d\u52a1\u7ba1\u7406","permalink":"/docs/linux/service-management"}}');var t=s(22714),a=s(48885);const i={sidebar_position:11,title:"\u7cfb\u7edf\u7ba1\u7406"},r="Linux \u7cfb\u7edf\u7ba1\u7406",c={},d=[{value:"Systemd \u7ba1\u7406",id:"systemd-\u7ba1\u7406",level:2},{value:"Systemd \u6982\u8ff0",id:"systemd-\u6982\u8ff0",level:3},{value:"\u670d\u52a1\u7ba1\u7406",id:"\u670d\u52a1\u7ba1\u7406",level:3},{value:"\u670d\u52a1\u67e5\u8be2",id:"\u670d\u52a1\u67e5\u8be2",level:3},{value:"\u521b\u5efa\u670d\u52a1\u5355\u5143",id:"\u521b\u5efa\u670d\u52a1\u5355\u5143",level:3},{value:"Service \u914d\u7f6e\u8bf4\u660e",id:"service-\u914d\u7f6e\u8bf4\u660e",level:3},{value:"Timer \u5b9a\u65f6\u4efb\u52a1",id:"timer-\u5b9a\u65f6\u4efb\u52a1",level:3},{value:"\u7cfb\u7edf\u542f\u52a8",id:"\u7cfb\u7edf\u542f\u52a8",level:2},{value:"\u542f\u52a8\u8fc7\u7a0b",id:"\u542f\u52a8\u8fc7\u7a0b",level:3},{value:"GRUB \u914d\u7f6e",id:"grub-\u914d\u7f6e",level:3},{value:"Runlevel \u548c Target",id:"runlevel-\u548c-target",level:3},{value:"\u542f\u52a8\u6545\u969c\u6392\u67e5",id:"\u542f\u52a8\u6545\u969c\u6392\u67e5",level:3},{value:"\u7cfb\u7edf\u4fe1\u606f",id:"\u7cfb\u7edf\u4fe1\u606f",level:2},{value:"\u57fa\u672c\u4fe1\u606f",id:"\u57fa\u672c\u4fe1\u606f",level:3},{value:"\u786c\u4ef6\u4fe1\u606f",id:"\u786c\u4ef6\u4fe1\u606f",level:3},{value:"\u7cfb\u7edf\u8d44\u6e90",id:"\u7cfb\u7edf\u8d44\u6e90",level:3},{value:"\u65f6\u95f4\u548c\u65f6\u533a",id:"\u65f6\u95f4\u548c\u65f6\u533a",level:2},{value:"\u65f6\u95f4\u7ba1\u7406",id:"\u65f6\u95f4\u7ba1\u7406",level:3},{value:"NTP \u914d\u7f6e",id:"ntp-\u914d\u7f6e",level:3},{value:"\u7cfb\u7edf\u5173\u673a\u548c\u91cd\u542f",id:"\u7cfb\u7edf\u5173\u673a\u548c\u91cd\u542f",level:2},{value:"\u6a21\u5757\u7ba1\u7406",id:"\u6a21\u5757\u7ba1\u7406",level:2},{value:"\u5185\u6838\u6a21\u5757",id:"\u5185\u6838\u6a21\u5757",level:3},{value:"\u7cfb\u7edf\u65e5\u5fd7",id:"\u7cfb\u7edf\u65e5\u5fd7",level:2},{value:"\u65e5\u5fd7\u6587\u4ef6\u4f4d\u7f6e",id:"\u65e5\u5fd7\u6587\u4ef6\u4f4d\u7f6e",level:3},{value:"journalctl \u4f7f\u7528",id:"journalctl-\u4f7f\u7528",level:3},{value:"\u6027\u80fd\u76d1\u63a7",id:"\u6027\u80fd\u76d1\u63a7",level:2},{value:"\u57fa\u672c\u76d1\u63a7",id:"\u57fa\u672c\u76d1\u63a7",level:3},{value:"\u7cfb\u7edf\u7edf\u8ba1",id:"\u7cfb\u7edf\u7edf\u8ba1",level:3},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2},{value:"1. \u670d\u52a1\u7ba1\u7406",id:"1-\u670d\u52a1\u7ba1\u7406",level:3},{value:"2. \u81ea\u52a8\u5316\u7ef4\u62a4",id:"2-\u81ea\u52a8\u5316\u7ef4\u62a4",level:3},{value:"3. \u76d1\u63a7\u544a\u8b66",id:"3-\u76d1\u63a7\u544a\u8b66",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function o(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"linux-\u7cfb\u7edf\u7ba1\u7406",children:"Linux \u7cfb\u7edf\u7ba1\u7406"})}),"\n",(0,t.jsx)(e.p,{children:"\u7cfb\u7edf\u7ba1\u7406\u662f Linux \u8fd0\u7ef4\u7684\u6838\u5fc3\u5185\u5bb9\uff0c\u5305\u62ec\u7cfb\u7edf\u670d\u52a1\u3001\u542f\u52a8\u7ba1\u7406\u3001\u7cfb\u7edf\u4fe1\u606f\u67e5\u770b\u7b49\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"systemd-\u7ba1\u7406",children:"Systemd \u7ba1\u7406"}),"\n",(0,t.jsx)(e.h3,{id:"systemd-\u6982\u8ff0",children:"Systemd \u6982\u8ff0"}),"\n",(0,t.jsx)(e.p,{children:"Systemd \u662f\u73b0\u4ee3 Linux \u53d1\u884c\u7248\u7684\u521d\u59cb\u5316\u7cfb\u7edf\u548c\u670d\u52a1\u7ba1\u7406\u5668\u3002"}),"\n",(0,t.jsx)(e.mermaid,{value:"graph LR\n    A[systemd] --\x3e B[\u670d\u52a1\u7ba1\u7406]\n    A --\x3e C[\u542f\u52a8\u7ba1\u7406]\n    A --\x3e D[\u65e5\u5fd7\u7ba1\u7406]\n    A --\x3e E[\u8bbe\u5907\u7ba1\u7406]\n    A --\x3e F[\u7f51\u7edc\u7ba1\u7406]"}),"\n",(0,t.jsx)(e.h3,{id:"\u670d\u52a1\u7ba1\u7406",children:"\u670d\u52a1\u7ba1\u7406"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u542f\u52a8\u670d\u52a1\nsudo systemctl start service_name\n\n# \u505c\u6b62\u670d\u52a1\nsudo systemctl stop service_name\n\n# \u91cd\u542f\u670d\u52a1\nsudo systemctl restart service_name\n\n# \u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\nsudo systemctl reload service_name\n\n# \u67e5\u770b\u670d\u52a1\u72b6\u6001\nsystemctl status service_name\n\n# \u542f\u7528\u5f00\u673a\u81ea\u542f\nsudo systemctl enable service_name\n\n# \u7981\u7528\u5f00\u673a\u81ea\u542f\nsudo systemctl disable service_name\n\n#\u542f\u7528\u5e76\u7acb\u5373\u542f\u52a8\nsudo systemctl enable --now service_name\n\n# \u7981\u7528\u5e76\u7acb\u5373\u505c\u6b62\nsudo systemctl disable --now service_name\n\n# \u68c0\u67e5\u662f\u5426\u542f\u7528\nsystemctl is-enabled service_name\n\n# \u68c0\u67e5\u662f\u5426\u8fd0\u884c\nsystemctl is-active service_name\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u670d\u52a1\u67e5\u8be2",children:"\u670d\u52a1\u67e5\u8be2"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u5217\u51fa\u6240\u6709\u670d\u52a1\nsystemctl list-units --type=service\nsystemctl list-units --type=service --all\n\n# \u5217\u51fa\u8fd0\u884c\u4e2d\u7684\u670d\u52a1\nsystemctl list-units --type=service --state=running\n\n# \u5217\u51fa\u5931\u8d25\u7684\u670d\u52a1\nsystemctl list-units --type=service --state=failed\nsystemctl --failed\n\n# \u5217\u51fa\u6240\u6709\u5df2\u5b89\u88c5\u7684\u670d\u52a1\nsystemctl list-unit-files --type=service\n\n# \u663e\u793a\u670d\u52a1\u4f9d\u8d56\nsystemctl list-dependencies service_name\n\n# \u663e\u793a\u670d\u52a1\u914d\u7f6e\nsystemctl cat service_name\n\n# \u67e5\u770b\u670d\u52a1\u65e5\u5fd7\njournalctl -u service_name\njournalctl -u service_name -f    # \u5b9e\u65f6\u67e5\u770b\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u521b\u5efa\u670d\u52a1\u5355\u5143",children:"\u521b\u5efa\u670d\u52a1\u5355\u5143"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u670d\u52a1\u5355\u5143\u6587\u4ef6\u4f4d\u7f6e\n/etc/systemd/system/         # \u7ba1\u7406\u5458\u521b\u5efa\u7684\u670d\u52a1\n/lib/systemd/system/         # \u7cfb\u7edf\u5b89\u88c5\u7684\u670d\u52a1\n/usr/lib/systemd/system/     # \u8f6f\u4ef6\u5305\u5b89\u88c5\u7684\u670d\u52a1\n\n# \u521b\u5efa\u670d\u52a1\u6587\u4ef6\nsudo vim /etc/systemd/system/myapp.service\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u670d\u52a1\u5355\u5143\u6587\u4ef6\u793a\u4f8b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ini",children:'[Unit]\nDescription=My Application\nDocumentation=https://example.com/docs\nAfter=network.target\nRequires=mysql.service\n\n[Service]\nType=simple\nUser=myapp\nGroup=myapp\nWorkingDirectory=/opt/myapp\nExecStart=/opt/myapp/bin/myapp --config /etc/myapp/config.yaml\nExecReload=/bin/kill -HUP $MAINPID\nRestart=on-failure\nRestartSec=5s\nStandardOutput=journal\nStandardError=journal\n\n# \u73af\u5883\u53d8\u91cf\nEnvironment="NODE_ENV=production"\nEnvironmentFile=/etc/myapp/environment\n\n# \u8d44\u6e90\u9650\u5236\nLimitNOFILE=65536\nLimitNPROC=4096\n\n[Install]\nWantedBy=multi-user.target\n'})}),"\n",(0,t.jsx)(e.h3,{id:"service-\u914d\u7f6e\u8bf4\u660e",children:"Service \u914d\u7f6e\u8bf4\u660e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# [Unit] \u90e8\u5206\nDescription=        # \u670d\u52a1\u63cf\u8ff0\nDocumentation=      # \u6587\u6863 URL\nAfter=             # \u5728\u54ea\u4e9b\u670d\u52a1\u4e4b\u540e\u542f\u52a8\nBefore=            # \u5728\u54ea\u4e9b\u670d\u52a1\u4e4b\u524d\u542f\u52a8\nRequires=          # \u5f3a\u4f9d\u8d56\uff08\u65e0\u6cd5\u542f\u52a8\u5219\u5931\u8d25\uff09\nWants=             # \u5f31\u4f9d\u8d56\uff08\u65e0\u6cd5\u542f\u52a8\u4ecd\u7ee7\u7eed\uff09\n\n# [Service] \u90e8\u5206\nType=              # \u670d\u52a1\u7c7b\u578b\n  # simple: \u9ed8\u8ba4\uff0cExecStart \u5c31\u662f\u4e3b\u8fdb\u7a0b\n  # forking: fork \u51fa\u5b50\u8fdb\u7a0b\u4f5c\u4e3a\u4e3b\u8fdb\u7a0b\n  # oneshot: \u4e00\u6b21\u6027\u4efb\u52a1\n  # notify: \u670d\u52a1\u542f\u52a8\u5b8c\u6210\u540e\u901a\u77e5 systemd\n  # dbus: \u901a\u8fc7 D-Bus \u542f\u52a8\n\nExecStart=         # \u542f\u52a8\u547d\u4ee4\nExecStop=          # \u505c\u6b62\u547d\u4ee4\nExecReload=        # \u91cd\u8f7d\u547d\u4ee4\nRestart=           # \u91cd\u542f\u7b56\u7565\n  # no: \u4e0d\u91cd\u542f\n  # on-failure: \u5931\u8d25\u65f6\u91cd\u542f\n  # on-abnormal: \u5f02\u5e38\u65f6\u91cd\u542f\n  # always: \u603b\u662f\u91cd\u542f\n\nRestartSec=        # \u91cd\u542f\u95f4\u9694\nUser=              # \u8fd0\u884c\u7528\u6237\nGroup=             # \u8fd0\u884c\u7ec4\nWorkingDirectory=  # \u5de5\u4f5c\u76ee\u5f55\n\n# [Install] \u90e8\u5206\nWantedBy=          # \u88ab\u54ea\u4e2a target \u9700\u8981\nRequiredBy=        # \u88ab\u54ea\u4e2a target \u5f3a\u4f9d\u8d56\n"})}),"\n",(0,t.jsx)(e.h3,{id:"timer-\u5b9a\u65f6\u4efb\u52a1",children:"Timer \u5b9a\u65f6\u4efb\u52a1"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u521b\u5efa timer \u6587\u4ef6\nsudo vim /etc/systemd/system/backup.timer\n"})}),"\n",(0,t.jsx)(e.p,{children:"Timer \u793a\u4f8b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ini",children:"[Unit]\nDescription=Daily Backup Timer\n\n[Timer]\nOnCalendar=daily\nOnCalendar=*-*-* 02:00:00\nPersistent=true\n\n[Install]\nWantedBy=timers.target\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5bf9\u5e94\u7684 service \u6587\u4ef6\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ini",children:"[Unit]\nDescription=Backup Service\n\n[Service]\nType=oneshot\nExecStart=/usr/local/bin/backup.sh\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u542f\u7528 timer\nsudo systemctl daemon-reload\nsudo systemctl enable backup.timer\nsudo systemctl start backup.timer\n\n# \u67e5\u770b timer\nsystemctl list-timers\nsystemctl list-timers --all\n\n# \u67e5\u770b timer \u72b6\u6001\nsystemctl status backup.timer\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u7cfb\u7edf\u542f\u52a8",children:"\u7cfb\u7edf\u542f\u52a8"}),"\n",(0,t.jsx)(e.h3,{id:"\u542f\u52a8\u8fc7\u7a0b",children:"\u542f\u52a8\u8fc7\u7a0b"}),"\n",(0,t.jsx)(e.mermaid,{value:"graph TD\n    A[BIOS/UEFI] --\x3e B[\u5f15\u5bfc\u52a0\u8f7d\u5668 GRUB]\n    B --\x3e C[Linux \u5185\u6838]\n    C --\x3e D[initramfs]\n    D --\x3e E[systemd init]\n    E --\x3e F[\u7cfb\u7edf\u670d\u52a1]\n    F --\x3e G[\u767b\u5f55\u63d0\u793a]"}),"\n",(0,t.jsx)(e.h3,{id:"grub-\u914d\u7f6e",children:"GRUB \u914d\u7f6e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# GRUB \u914d\u7f6e\u6587\u4ef6\n/etc/default/grub           # \u4e3b\u914d\u7f6e\n/boot/grub/grub.cfg         # \u751f\u6210\u7684\u914d\u7f6e\uff08\u4e0d\u8981\u76f4\u63a5\u7f16\u8f91\uff09\n\n# \u7f16\u8f91 GRUB \u914d\u7f6e\nsudo vim /etc/default/grub\n\n# \u5e38\u7528\u53c2\u6570\nGRUB_TIMEOUT=5                      # \u542f\u52a8\u83dc\u5355\u8d85\u65f6\nGRUB_DEFAULT=0                      # \u9ed8\u8ba4\u542f\u52a8\u9879\nGRUB_CMDLINE_LINUX=""              # \u5185\u6838\u53c2\u6570\nGRUB_CMDLINE_LINUX_DEFAULT="quiet splash"\n\n# \u66f4\u65b0 GRUB \u914d\u7f6e\nsudo update-grub                    # Debian/Ubuntu\nsudo grub2-mkconfig -o /boot/grub2/grub.cfg    # RHEL/CentOS\n'})}),"\n",(0,t.jsx)(e.h3,{id:"runlevel-\u548c-target",children:"Runlevel \u548c Target"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b\u5f53\u524d runlevel/target\nrunlevel\nsystemctl get-default\n\n# \u5207\u6362 target\nsudo systemctl isolate multi-user.target    # \u591a\u7528\u6237\u6587\u672c\u6a21\u5f0f\nsudo systemctl isolate graphical.target     # \u56fe\u5f62\u754c\u9762\n\n# \u8bbe\u7f6e\u9ed8\u8ba4 target\nsudo systemctl set-default multi-user.target\nsudo systemctl set-default graphical.target\n\n# Target \u5bf9\u5e94\u5173\u7cfb\n# poweroff.target     \u2192 runlevel0 (\u5173\u673a)\n# rescue.target       \u2192 runlevel1 (\u5355\u7528\u6237\u6a21\u5f0f)\n# multi-user.target   \u2192 runlevel3 (\u591a\u7528\u6237\u6587\u672c)\n# graphical.target    \u2192 runlevel5 (\u56fe\u5f62\u754c\u9762)\n# reboot.target       \u2192 runlevel6 (\u91cd\u542f)\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u542f\u52a8\u6545\u969c\u6392\u67e5",children:"\u542f\u52a8\u6545\u969c\u6392\u67e5"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u8fdb\u5165\u5355\u7528\u6237\u6a21\u5f0f\uff08GRUB\uff09\n# 1. \u5728 GRUB \u83dc\u5355\u6309 'e' \u7f16\u8f91\n# 2. \u627e\u5230 linux \u5f00\u5934\u7684\u884c\uff0c\u5728\u672b\u5c3e\u6dfb\u52a0\uff1a\nsingle\n# \u6216\nsystemd.unit=rescue.target\n\n# 3. \u6309 Ctrl+X \u6216 F10 \u542f\u52a8\n\n# \u67e5\u770b\u542f\u52a8\u65e5\u5fd7\njournalctl -b              # \u672c\u6b21\u542f\u52a8\njournalctl -b -1           # \u4e0a\u6b21\u542f\u52a8\njournalctl --list-boots    # \u6240\u6709\u542f\u52a8\u8bb0\u5f55\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u7cfb\u7edf\u4fe1\u606f",children:"\u7cfb\u7edf\u4fe1\u606f"}),"\n",(0,t.jsx)(e.h3,{id:"\u57fa\u672c\u4fe1\u606f",children:"\u57fa\u672c\u4fe1\u606f"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u7cfb\u7edf\u4fe1\u606f\nuname -a               # \u6240\u6709\u4fe1\u606f\nuname -r               # \u5185\u6838\u7248\u672c\nuname -m               # \u67b6\u6784\n\n# \u53d1\u884c\u7248\u4fe1\u606f\ncat /etc/os-release\nlsb_release -a\nhostnamectl\n\n# \u4e3b\u673a\u540d\nhostname\nhostnamectl set-hostname newhostname\n\n# \u8fd0\u884c\u65f6\u95f4\nuptime\n\n# \u5f53\u524d\u65e5\u671f\u65f6\u95f4\ndate\ntimedatectl\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u786c\u4ef6\u4fe1\u606f",children:"\u786c\u4ef6\u4fe1\u606f"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# CPU \u4fe1\u606f\nlscpu\ncat /proc/cpuinfo\nnproc                  # CPU \u6838\u5fc3\u6570\n\n# \u5185\u5b58\u4fe1\u606f\nfree -h\ncat /proc/meminfo\n\n# \u78c1\u76d8\u4fe1\u606f\nlsblk\nfdisk -l\ndf -h\ndu -sh /path\n\n# PCI \u8bbe\u5907\nlspci\nlspci -v\n\n# USB \u8bbe\u5907\nlsusb\nlsusb -v\n\n# \u786c\u4ef6\u6982\u89c8\nsudo dmidecode\nsudo lshw -short\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u7cfb\u7edf\u8d44\u6e90",children:"\u7cfb\u7edf\u8d44\u6e90"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# CPU \u4f7f\u7528\ntop\nhtop\nmpstat 1\n\n# \u5185\u5b58\u4f7f\u7528\nfree -h\nvmstat 1\n\n# \u78c1\u76d8 IO\niostat\niotop\n\n# \u7f51\u7edc\niftop\nnethogs\nss -tuln\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u65f6\u95f4\u548c\u65f6\u533a",children:"\u65f6\u95f4\u548c\u65f6\u533a"}),"\n",(0,t.jsx)(e.h3,{id:"\u65f6\u95f4\u7ba1\u7406",children:"\u65f6\u95f4\u7ba1\u7406"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# \u67e5\u770b\u5f53\u524d\u65f6\u95f4\ndate\ntimedatectl\n\n# \u8bbe\u7f6e\u65f6\u95f4\nsudo timedatectl set-time "2024-12-10 19:30:00"\n\n# \u8bbe\u7f6e\u65f6\u533a\nsudo timedatectl set-timezone Asia/Shanghai\nsudo timedatectl list-timezones    # \u5217\u51fa\u6240\u6709\u65f6\u533a\n\n# \u542f\u7528 NTP \u540c\u6b65\nsudo timedatectl set-ntp true\n\n# \u624b\u52a8\u540c\u6b65\u65f6\u95f4\nsudo ntpdate ntp.ubuntu.com\nsudo chronyc makestep\n'})}),"\n",(0,t.jsx)(e.h3,{id:"ntp-\u914d\u7f6e",children:"NTP \u914d\u7f6e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u5b89\u88c5 NTP\nsudo apt install ntp    # \u4f7f\u7528 ntpd\nsudo apt install chrony # \u4f7f\u7528 chrony\uff08\u63a8\u8350\uff09\n\n# Chrony \u914d\u7f6e\nsudo vim /etc/chrony/chrony.conf\n\n# \u6dfb\u52a0 NTP \u670d\u52a1\u5668\nserver ntp1.aliyun.com iburst\nserver ntp2.aliyun.com iburst\n\n# \u91cd\u542f\u670d\u52a1\nsudo systemctl restart chronyd\n\n# \u67e5\u770b\u72b6\u6001\nchronyc tracking\nchronyc sources\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u7cfb\u7edf\u5173\u673a\u548c\u91cd\u542f",children:"\u7cfb\u7edf\u5173\u673a\u548c\u91cd\u542f"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u7acb\u5373\u5173\u673a\nsudo shutdown -h now\nsudo poweroff\nsudo halt\nsudo systemctl poweroff\n\n# \u5b9a\u65f6\u5173\u673a\nsudo shutdown -h +10        # 10\u5206\u949f\u540e\u5173\u673a\nsudo shutdown -h 22:00      # 22:00\u5173\u673a\n\n# \u53d6\u6d88\u5173\u673a\nsudo shutdown -c\n\n# \u7acb\u5373\u91cd\u542f\nsudo reboot\nsudo shutdown -r now\nsudo systemctl reboot\n\n# \u5b9a\u65f6\u91cd\u542f\nsudo shutdown -r +10\n\n# \u6ce8\u9500\u5f53\u524d\u7528\u6237\nexit\nlogout\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u6a21\u5757\u7ba1\u7406",children:"\u6a21\u5757\u7ba1\u7406"}),"\n",(0,t.jsx)(e.h3,{id:"\u5185\u6838\u6a21\u5757",children:"\u5185\u6838\u6a21\u5757"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# \u67e5\u770b\u5df2\u52a0\u8f7d\u7684\u6a21\u5757\nlsmod\n\n# \u67e5\u770b\u6a21\u5757\u4fe1\u606f\nmodinfo module_name\n\n# \u52a0\u8f7d\u6a21\u5757\nsudo modprobe module_name\n\n# \u5378\u8f7d\u6a21\u5757\nsudo modprobe -r module_name\nsudo rmmod module_name\n\n# \u5f00\u673a\u81ea\u52a8\u52a0\u8f7d\u6a21\u5757\necho "module_name" | sudo tee -a /etc/modules\n\n# \u7981\u6b62\u52a0\u8f7d\u6a21\u5757\necho "blacklist module_name" | sudo tee -a /etc/modprobe.d/blacklist.conf\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u7cfb\u7edf\u65e5\u5fd7",children:"\u7cfb\u7edf\u65e5\u5fd7"}),"\n",(0,t.jsx)(e.h3,{id:"\u65e5\u5fd7\u6587\u4ef6\u4f4d\u7f6e",children:"\u65e5\u5fd7\u6587\u4ef6\u4f4d\u7f6e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"/var/log/syslog          # \u7cfb\u7edf\u65e5\u5fd7\uff08Debian/Ubuntu\uff09\n/var/log/messages        # \u7cfb\u7edf\u65e5\u5fd7\uff08RHEL/CentOS\uff09\n/var/log/auth.log        # \u8ba4\u8bc1\u65e5\u5fd7\n/var/log/kern.log        # \u5185\u6838\u65e5\u5fd7\n/var/log/dmesg           # \u542f\u52a8\u65e5\u5fd7\n/var/log/boot.log        # \u5f15\u5bfc\u65e5\u5fd7\n/var/log/cron            # \u8ba1\u5212\u4efb\u52a1\u65e5\u5fd7\n"})}),"\n",(0,t.jsx)(e.h3,{id:"journalctl-\u4f7f\u7528",children:"journalctl \u4f7f\u7528"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:'# \u67e5\u770b\u6240\u6709\u65e5\u5fd7\njournalctl\n\n# \u67e5\u770b\u6700\u65b0\u65e5\u5fd7\njournalctl -n 50\njournalctl -f              # \u5b9e\u65f6\u67e5\u770b\n\n# \u6309\u65f6\u95f4\u67e5\u8be2\njournalctl --since "2024-12-10 09:00:00"\njournalctl --since today\njournalctl --since yesterday\njournalctl --until "2024-12-10 18:00:00"\n\n# \u6309\u670d\u52a1\u67e5\u8be2\njournalctl -u nginx\njournalctl -u nginx -f\n\n# \u6309\u4f18\u5148\u7ea7\u67e5\u8be2\njournalctl -p err          # \u9519\u8bef\u7ea7\u522b\njournalctl -p warning      # \u8b66\u544a\u7ea7\u522b\n\n# \u6309\u8fdb\u7a0b\u67e5\u8be2\njournalctl _PID=1234\n\n# \u5185\u6838\u6d88\u606f\njournalctl -k\njournalctl --dmesg\n\n# \u6e05\u7406\u65e5\u5fd7\nsudo journalctl --vacuum-time=7d    # \u4fdd\u75597\u5929\nsudo journalctl --vacuum-size=1G    # \u4fdd\u75591GB\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u6027\u80fd\u76d1\u63a7",children:"\u6027\u80fd\u76d1\u63a7"}),"\n",(0,t.jsx)(e.h3,{id:"\u57fa\u672c\u76d1\u63a7",children:"\u57fa\u672c\u76d1\u63a7"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u7cfb\u7edf\u8d1f\u8f7d\nuptime\nw\ntop\n\n# \u8fdb\u7a0b\u76d1\u63a7\nps aux\nhtop\n\n# \u5185\u5b58\u76d1\u63a7\nfree -h\nvmstat 1\n\n# \u78c1\u76d8\u76d1\u63a7\ndf -h\ndu -sh /*\niotop\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u7cfb\u7edf\u7edf\u8ba1",children:"\u7cfb\u7edf\u7edf\u8ba1"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u5b89\u88c5 sysstat\nsudo apt install sysstat\n\n# CPU \u7edf\u8ba1\nsar -u 1 5              # \u6bcf\u79d2\u4e00\u6b21\uff0c\u51715\u6b21\nmpstat -P ALL 1\n\n# \u5185\u5b58\u7edf\u8ba1\nsar -r 1 5\n\n# IO \u7edf\u8ba1\nsar -b 1 5\niostat -x 1\n\n# \u7f51\u7edc\u7edf\u8ba1\nsar -n DEV 1 5\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,t.jsx)(e.h3,{id:"1-\u670d\u52a1\u7ba1\u7406",children:"1. \u670d\u52a1\u7ba1\u7406"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u4f7f\u7528 systemd \u7ba1\u7406\u670d\u52a1\n# \u2705 \u521b\u5efa\u4e13\u7528\u7528\u6237\u8fd0\u884c\u670d\u52a1\n# \u2705 \u914d\u7f6e\u8d44\u6e90\u9650\u5236\n# \u2705 \u5b9e\u65bd\u65e5\u5fd7\u7ba1\u7406\n# \u2705 \u5b9a\u671f\u68c0\u67e5\u5931\u8d25\u7684\u670d\u52a1\nsystemctl --failed\n"})}),"\n",(0,t.jsx)(e.h3,{id:"2-\u81ea\u52a8\u5316\u7ef4\u62a4",children:"2. \u81ea\u52a8\u5316\u7ef4\u62a4"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u521b\u5efa\u7ef4\u62a4\u811a\u672c\nsudo vim /usr/local/bin/system-maintenance.sh\n\n#!/bin/bash\n# \u7cfb\u7edf\u7ef4\u62a4\u811a\u672c\n\n# \u66f4\u65b0\u8f6f\u4ef6\u5305\napt update && apt upgrade -y\n\n# \u6e05\u7406\u65e7\u5185\u6838\napt autoremove -y\n\n# \u6e05\u7406\u65e5\u5fd7\njournalctl --vacuum-time=30d\n\n# \u68c0\u67e5\u78c1\u76d8\u7a7a\u95f4\ndf -h\n\n# \u68c0\u67e5\u5931\u8d25\u7684\u670d\u52a1\nsystemctl --failed\n\n# \u521b\u5efa\u5b9a\u65f6\u4efb\u52a1\nsudo systemctl edit --force --full maintenance.timer\n"})}),"\n",(0,t.jsx)(e.h3,{id:"3-\u76d1\u63a7\u544a\u8b66",children:"3. \u76d1\u63a7\u544a\u8b66"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u5b9a\u671f\u68c0\u67e5\n- \u78c1\u76d8\u7a7a\u95f4\n- \u670d\u52a1\u72b6\u6001\n- \u7cfb\u7edf\u8d1f\u8f7d\n- \u5185\u5b58\u4f7f\u7528\n\n# \u8bbe\u7f6e\u544a\u8b66\u9608\u503c\n# \u4f7f\u7528\u76d1\u63a7\u5de5\u5177\uff08\u5982 Prometheus\u3001Zabbix\uff09\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,t.jsx)(e.p,{children:"\u672c\u6587\u4ecb\u7ecd\u4e86 Linux \u7cfb\u7edf\u7ba1\u7406\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u2705 Systemd \u670d\u52a1\u7ba1\u7406"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \u7cfb\u7edf\u542f\u52a8\u548c GRUB"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \u7cfb\u7edf\u4fe1\u606f\u67e5\u770b"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \u65f6\u95f4\u548c\u65f6\u533a\u7ba1\u7406"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \u5185\u6838\u6a21\u5757\u7ba1\u7406"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \u6027\u80fd\u76d1\u63a7"}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u7ee7\u7eed\u5b66\u4e60 ",(0,t.jsx)(e.a,{href:"/docs/linux/log-management",children:"\u65e5\u5fd7\u7ba1\u7406"})," \u548c ",(0,t.jsx)(e.a,{href:"/docs/linux/disk-management",children:"\u78c1\u76d8\u7ba1\u7406"}),"\u3002"]})]})}function u(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(o,{...n})}):o(n)}}}]);