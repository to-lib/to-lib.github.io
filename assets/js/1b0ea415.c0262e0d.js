"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[97986],{48885:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>c});var s=t(99378);const r={},i=s.createContext(r);function l(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(i.Provider,{value:n},e.children)}},55356:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"cpp/move-semantics","title":"\u79fb\u52a8\u8bed\u4e49","description":"\u79fb\u52a8\u8bed\u4e49\u901a\u8fc7\u8f6c\u79fb\u8d44\u6e90\u6240\u6709\u6743\u6765\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u62f7\u8d1d\uff0c\u63d0\u5347\u6027\u80fd\u3002","source":"@site/docs/cpp/move-semantics.md","sourceDirName":"cpp","slug":"/cpp/move-semantics","permalink":"/docs/cpp/move-semantics","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/cpp/move-semantics.md","tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"sidebar_position":16,"title":"\u79fb\u52a8\u8bed\u4e49"},"sidebar":"cpp","previous":{"title":"\u667a\u80fd\u6307\u9488","permalink":"/docs/cpp/smart-pointers"},"next":{"title":"Lambda \u8868\u8fbe\u5f0f","permalink":"/docs/cpp/lambda"}}');var r=t(22714),i=t(48885);const l={sidebar_position:16,title:"\u79fb\u52a8\u8bed\u4e49"},c="C++ \u79fb\u52a8\u8bed\u4e49",o={},d=[{value:"\ud83c\udfaf \u5de6\u503c\u4e0e\u53f3\u503c",id:"-\u5de6\u503c\u4e0e\u53f3\u503c",level:2},{value:"\ud83d\udce6 std::move",id:"-stdmove",level:2},{value:"\ud83d\udd27 \u79fb\u52a8\u6784\u9020\u51fd\u6570\u548c\u79fb\u52a8\u8d4b\u503c",id:"-\u79fb\u52a8\u6784\u9020\u51fd\u6570\u548c\u79fb\u52a8\u8d4b\u503c",level:2},{value:"\ud83d\udd04 \u5b8c\u7f8e\u8f6c\u53d1",id:"-\u5b8c\u7f8e\u8f6c\u53d1",level:2},{value:"\ud83d\udccb \u8fd4\u56de\u503c\u4f18\u5316",id:"-\u8fd4\u56de\u503c\u4f18\u5316",level:2},{value:"\u26a1 \u6700\u4f73\u5b9e\u8df5",id:"-\u6700\u4f73\u5b9e\u8df5",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"c-\u79fb\u52a8\u8bed\u4e49",children:"C++ \u79fb\u52a8\u8bed\u4e49"})}),"\n",(0,r.jsx)(n.p,{children:"\u79fb\u52a8\u8bed\u4e49\u901a\u8fc7\u8f6c\u79fb\u8d44\u6e90\u6240\u6709\u6743\u6765\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u62f7\u8d1d\uff0c\u63d0\u5347\u6027\u80fd\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"-\u5de6\u503c\u4e0e\u53f3\u503c",children:"\ud83c\udfaf \u5de6\u503c\u4e0e\u53f3\u503c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"int x = 10;         // x \u662f\u5de6\u503c\nint y = x + 5;      // x + 5 \u662f\u53f3\u503c\nint& lref = x;      // \u5de6\u503c\u5f15\u7528\nint&& rref = 10;    // \u53f3\u503c\u5f15\u7528\nint&& rref2 = x + 5;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"-stdmove",children:"\ud83d\udce6 std::move"}),"\n",(0,r.jsx)(n.mermaid,{value:"graph LR\n    Src[Source Object] --\x3e|Transfer Ptr| Dest[Dest Object]\n    Dest --\x3e|Owns| Res[Resource]\n    Src -.->|Null/Empty| Res\n\n    style Src fill:#ff9999\n    style Dest fill:#90EE90\n    style Res fill:#99ccff"}),"\n",(0,r.jsx)(n.p,{children:"\u5c06\u5de6\u503c\u8f6c\u6362\u4e3a\u53f3\u503c\u5f15\u7528\uff1a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#include <utility>\n#include <string>\n\nstd::string s1 = "Hello";\nstd::string s2 = std::move(s1);  // s1 \u7684\u8d44\u6e90\u8f6c\u79fb\u5230 s2\n// s1 \u73b0\u5728\u662f\u7a7a\u7684\u6216\u672a\u5b9a\u4e49\u72b6\u6001\n'})}),"\n",(0,r.jsx)(n.h2,{id:"-\u79fb\u52a8\u6784\u9020\u51fd\u6570\u548c\u79fb\u52a8\u8d4b\u503c",children:"\ud83d\udd27 \u79fb\u52a8\u6784\u9020\u51fd\u6570\u548c\u79fb\u52a8\u8d4b\u503c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"class Buffer {\nprivate:\n    int* data;\n    size_t size;\n\npublic:\n    // \u6784\u9020\u51fd\u6570\n    Buffer(size_t s) : size(s), data(new int[s]) {}\n\n    // \u62f7\u8d1d\u6784\u9020\u51fd\u6570\n    Buffer(const Buffer& other) : size(other.size) {\n        data = new int[size];\n        std::copy(other.data, other.data + size, data);\n    }\n\n    // \u79fb\u52a8\u6784\u9020\u51fd\u6570\n    Buffer(Buffer&& other) noexcept\n        : data(other.data), size(other.size) {\n        other.data = nullptr;\n        other.size = 0;\n    }\n\n    // \u79fb\u52a8\u8d4b\u503c\u8fd0\u7b97\u7b26\n    Buffer& operator=(Buffer&& other) noexcept {\n        if (this != &other) {\n            delete[] data;\n            data = other.data;\n            size = other.size;\n            other.data = nullptr;\n            other.size = 0;\n        }\n        return *this;\n    }\n\n    ~Buffer() { delete[] data; }\n};\n"})}),"\n",(0,r.jsx)(n.h2,{id:"-\u5b8c\u7f8e\u8f6c\u53d1",children:"\ud83d\udd04 \u5b8c\u7f8e\u8f6c\u53d1"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"#include <utility>\n\ntemplate<typename T, typename... Args>\nstd::unique_ptr<T> makeUnique(Args&&... args) {\n    return std::unique_ptr<T>(new T(std::forward<Args>(args)...));\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"-\u8fd4\u56de\u503c\u4f18\u5316",children:"\ud83d\udccb \u8fd4\u56de\u503c\u4f18\u5316"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"std::vector<int> createVector() {\n    std::vector<int> v = {1, 2, 3, 4, 5};\n    return v;  // RVO \u6216 NRVO \u4f18\u5316\uff0c\u907f\u514d\u62f7\u8d1d\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"-\u6700\u4f73\u5b9e\u8df5",children:"\u26a1 \u6700\u4f73\u5b9e\u8df5"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"\u79fb\u52a8\u540e\u5bf9\u8c61\u5904\u4e8e\u6709\u6548\u4f46\u672a\u5b9a\u4e49\u72b6\u6001"})}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u79fb\u52a8\u64cd\u4f5c\u6807\u8bb0\u4e3a noexcept"})," - \u5141\u8bb8\u6807\u51c6\u5e93\u4f18\u5316"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4f7f\u7528 std::move"})," - \u660e\u786e\u8868\u793a\u8d44\u6e90\u8f6c\u79fb"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4f7f\u7528 std::forward"})," - \u5b8c\u7f8e\u8f6c\u53d1"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4f9d\u8d56 RVO"})," - \u7f16\u8bd1\u5668\u81ea\u52a8\u4f18\u5316"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);