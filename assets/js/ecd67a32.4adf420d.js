"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[85838],{48829:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"kubernetes/monitoring","title":"\u76d1\u63a7\u4e0e\u544a\u8b66","description":"Kubernetes \u96c6\u7fa4\u76d1\u63a7\u4e0e\u53ef\u89c2\u6d4b\u6027","source":"@site/docs/kubernetes/monitoring.md","sourceDirName":"kubernetes","slug":"/kubernetes/monitoring","permalink":"/docs/kubernetes/monitoring","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/kubernetes/monitoring.md","tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"sidebar_position":13,"title":"\u76d1\u63a7\u4e0e\u544a\u8b66","description":"Kubernetes \u96c6\u7fa4\u76d1\u63a7\u4e0e\u53ef\u89c2\u6d4b\u6027"},"sidebar":"kubernetes","previous":{"title":"RBAC \u6743\u9650\u63a7\u5236","permalink":"/docs/kubernetes/rbac"},"next":{"title":"\u5feb\u901f\u53c2\u8003","permalink":"/docs/kubernetes/quick-reference"}}');var r=a(22714),s=a(48885);const o={sidebar_position:13,title:"\u76d1\u63a7\u4e0e\u544a\u8b66",description:"Kubernetes \u96c6\u7fa4\u76d1\u63a7\u4e0e\u53ef\u89c2\u6d4b\u6027"},i="\u76d1\u63a7\u4e0e\u544a\u8b66",l={},c=[{value:"\u53ef\u89c2\u6d4b\u6027\u6982\u8ff0",id:"\u53ef\u89c2\u6d4b\u6027\u6982\u8ff0",level:2},{value:"Metrics Server",id:"metrics-server",level:2},{value:"\u5b89\u88c5 Metrics Server",id:"\u5b89\u88c5-metrics-server",level:3},{value:"\u8d44\u6e90\u67e5\u770b",id:"\u8d44\u6e90\u67e5\u770b",level:3},{value:"Prometheus \u76d1\u63a7",id:"prometheus-\u76d1\u63a7",level:2},{value:"\u4f7f\u7528 Helm \u5b89\u88c5 kube-prometheus-stack",id:"\u4f7f\u7528-helm-\u5b89\u88c5-kube-prometheus-stack",level:3},{value:"\u8bbf\u95ee Prometheus UI",id:"\u8bbf\u95ee-prometheus-ui",level:3},{value:"\u5e38\u7528 PromQL \u67e5\u8be2",id:"\u5e38\u7528-promql-\u67e5\u8be2",level:3},{value:"\u81ea\u5b9a\u4e49 ServiceMonitor",id:"\u81ea\u5b9a\u4e49-servicemonitor",level:3},{value:"Grafana \u53ef\u89c6\u5316",id:"grafana-\u53ef\u89c6\u5316",level:2},{value:"\u8bbf\u95ee Grafana",id:"\u8bbf\u95ee-grafana",level:3},{value:"\u63a8\u8350 Dashboard",id:"\u63a8\u8350-dashboard",level:3},{value:"\u5bfc\u5165 Dashboard",id:"\u5bfc\u5165-dashboard",level:3},{value:"Alertmanager \u544a\u8b66",id:"alertmanager-\u544a\u8b66",level:2},{value:"\u544a\u8b66\u89c4\u5219\u793a\u4f8b",id:"\u544a\u8b66\u89c4\u5219\u793a\u4f8b",level:3},{value:"\u914d\u7f6e\u544a\u8b66\u901a\u77e5",id:"\u914d\u7f6e\u544a\u8b66\u901a\u77e5",level:3},{value:"HPA \u81ea\u52a8\u6269\u7f29\u5bb9",id:"hpa-\u81ea\u52a8\u6269\u7f29\u5bb9",level:2},{value:"\u57fa\u4e8e CPU \u7684 HPA",id:"\u57fa\u4e8e-cpu-\u7684-hpa",level:3},{value:"\u57fa\u4e8e\u81ea\u5b9a\u4e49\u6307\u6807\u7684 HPA",id:"\u57fa\u4e8e\u81ea\u5b9a\u4e49\u6307\u6807\u7684-hpa",level:3},{value:"HPA \u64cd\u4f5c",id:"hpa-\u64cd\u4f5c",level:3},{value:"\u65e5\u5fd7\u6536\u96c6",id:"\u65e5\u5fd7\u6536\u96c6",level:2},{value:"\u4f7f\u7528 Fluent Bit",id:"\u4f7f\u7528-fluent-bit",level:3},{value:"\u65e5\u5fd7\u67e5\u770b\u547d\u4ee4",id:"\u65e5\u5fd7\u67e5\u770b\u547d\u4ee4",level:3},{value:"\u5e38\u7528\u64cd\u4f5c",id:"\u5e38\u7528\u64cd\u4f5c",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"\u76d1\u63a7\u4e0e\u544a\u8b66",children:"\u76d1\u63a7\u4e0e\u544a\u8b66"})}),"\n",(0,r.jsx)(n.h2,{id:"\u53ef\u89c2\u6d4b\u6027\u6982\u8ff0",children:"\u53ef\u89c2\u6d4b\u6027\u6982\u8ff0"}),"\n",(0,r.jsx)(n.p,{children:"Kubernetes \u53ef\u89c2\u6d4b\u6027\u5305\u542b\u4e09\u4e2a\u6838\u5fc3\u652f\u67f1\uff1a"}),"\n",(0,r.jsx)(n.mermaid,{value:'graph TB\n    subgraph "\u53ef\u89c2\u6d4b\u6027"\n        M[\ud83d\udcca Metrics<br/>\u6307\u6807]\n        L[\ud83d\udcdd Logs<br/>\u65e5\u5fd7]\n        T[\ud83d\udd0d Traces<br/>\u94fe\u8def\u8ffd\u8e2a]\n    end\n\n    subgraph "\u5de5\u5177\u6808"\n        M --\x3e P[Prometheus]\n        M --\x3e G[Grafana]\n        L --\x3e E[Elasticsearch]\n        L --\x3e F[Fluentd]\n        L --\x3e K[Kibana]\n        T --\x3e J[Jaeger]\n        T --\x3e Z[Zipkin]\n    end'}),"\n",(0,r.jsx)(n.h2,{id:"metrics-server",children:"Metrics Server"}),"\n",(0,r.jsx)(n.p,{children:"Metrics Server \u63d0\u4f9b\u96c6\u7fa4\u8d44\u6e90\u4f7f\u7528\u6570\u636e\uff0c\u662f HPA/VPA \u7684\u57fa\u7840\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"\u5b89\u88c5-metrics-server",children:"\u5b89\u88c5 Metrics Server"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# \u5b89\u88c5\nkubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml\n\n# \u5982\u679c\u662f\u672c\u5730\u96c6\u7fa4\uff08\u81ea\u7b7e\u540d\u8bc1\u4e66\uff09\uff0c\u9700\u6dfb\u52a0\u53c2\u6570\nkubectl patch deployment metrics-server -n kube-system --type=\'json\' -p=\'[\n  {"op": "add", "path": "/spec/template/spec/containers/0/args/-", "value": "--kubelet-insecure-tls"}\n]\'\n\n# \u9a8c\u8bc1\nkubectl top nodes\nkubectl top pods -A\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u8d44\u6e90\u67e5\u770b",children:"\u8d44\u6e90\u67e5\u770b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u8282\u70b9\u8d44\u6e90\nkubectl top nodes\n# NAME     CPU(cores)   CPU%   MEMORY(bytes)   MEMORY%\n# node-1   250m         12%    1024Mi          25%\n\n# \u67e5\u770b Pod \u8d44\u6e90\nkubectl top pods -n default\nkubectl top pods --containers  # \u6309\u5bb9\u5668\u663e\u793a\n\n# \u6309\u8d44\u6e90\u6392\u5e8f\nkubectl top pods --sort-by=cpu\nkubectl top pods --sort-by=memory\n"})}),"\n",(0,r.jsx)(n.h2,{id:"prometheus-\u76d1\u63a7",children:"Prometheus \u76d1\u63a7"}),"\n",(0,r.jsx)(n.h3,{id:"\u4f7f\u7528-helm-\u5b89\u88c5-kube-prometheus-stack",children:"\u4f7f\u7528 Helm \u5b89\u88c5 kube-prometheus-stack"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u6dfb\u52a0 Helm \u4ed3\u5e93\nhelm repo add prometheus-community https://prometheus-community.github.io/helm-charts\nhelm repo update\n\n# \u5b89\u88c5 kube-prometheus-stack\uff08\u5305\u542b Prometheus\u3001Grafana\u3001Alertmanager\uff09\nhelm install prometheus prometheus-community/kube-prometheus-stack \\\n  --namespace monitoring \\\n  --create-namespace \\\n  --set grafana.adminPassword=admin123\n\n# \u67e5\u770b\u5b89\u88c5\u7684\u7ec4\u4ef6\nkubectl get pods -n monitoring\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u8bbf\u95ee-prometheus-ui",children:"\u8bbf\u95ee Prometheus UI"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u7aef\u53e3\u8f6c\u53d1\nkubectl port-forward svc/prometheus-kube-prometheus-prometheus -n monitoring 9090:9090\n\n# \u8bbf\u95ee http://localhost:9090\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u5e38\u7528-promql-\u67e5\u8be2",children:"\u5e38\u7528 PromQL \u67e5\u8be2"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-promql",children:'# CPU \u4f7f\u7528\u7387\uff08\u6309\u8282\u70b9\uff09\n100 - (avg by(instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100)\n\n# \u5185\u5b58\u4f7f\u7528\u7387\uff08\u6309\u8282\u70b9\uff09\n(1 - node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes) * 100\n\n# Pod CPU \u4f7f\u7528\u7387\nsum(rate(container_cpu_usage_seconds_total{container!=""}[5m])) by (namespace, pod)\n\n# Pod \u5185\u5b58\u4f7f\u7528\nsum(container_memory_working_set_bytes{container!=""}) by (namespace, pod)\n\n# Pod \u91cd\u542f\u6b21\u6570\nsum(kube_pod_container_status_restarts_total) by (namespace, pod)\n\n# API Server \u8bf7\u6c42\u5ef6\u8fdf\nhistogram_quantile(0.99, sum(rate(apiserver_request_duration_seconds_bucket[5m])) by (le, verb))\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49-servicemonitor",children:"\u81ea\u5b9a\u4e49 ServiceMonitor"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: monitoring.coreos.com/v1\nkind: ServiceMonitor\nmetadata:\n  name: my-app-monitor\n  namespace: monitoring\n  labels:\n    release: prometheus # \u5339\u914d Prometheus Operator \u7684 selector\nspec:\n  selector:\n    matchLabels:\n      app: my-app\n  namespaceSelector:\n    matchNames:\n      - production\n  endpoints:\n    - port: metrics\n      path: /metrics\n      interval: 30s\n      scrapeTimeout: 10s\n"})}),"\n",(0,r.jsx)(n.h2,{id:"grafana-\u53ef\u89c6\u5316",children:"Grafana \u53ef\u89c6\u5316"}),"\n",(0,r.jsx)(n.h3,{id:"\u8bbf\u95ee-grafana",children:"\u8bbf\u95ee Grafana"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# \u83b7\u53d6 Grafana \u5bc6\u7801\nkubectl get secret prometheus-grafana -n monitoring -o jsonpath="{.data.admin-password}" | base64 -d\n\n# \u7aef\u53e3\u8f6c\u53d1\nkubectl port-forward svc/prometheus-grafana -n monitoring 3000:80\n\n# \u8bbf\u95ee http://localhost:3000\n# \u7528\u6237\u540d: admin\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u63a8\u8350-dashboard",children:"\u63a8\u8350 Dashboard"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Dashboard ID"}),(0,r.jsx)(n.th,{children:"\u540d\u79f0"}),(0,r.jsx)(n.th,{children:"\u7528\u9014"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"315"}),(0,r.jsx)(n.td,{children:"Kubernetes cluster monitoring"}),(0,r.jsx)(n.td,{children:"\u96c6\u7fa4\u6982\u89c8"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"13770"}),(0,r.jsx)(n.td,{children:"Kubernetes All-in-One"}),(0,r.jsx)(n.td,{children:"\u5168\u9762\u76d1\u63a7"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"6417"}),(0,r.jsx)(n.td,{children:"Kubernetes Pod Resources"}),(0,r.jsx)(n.td,{children:"Pod \u8d44\u6e90"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"11074"}),(0,r.jsx)(n.td,{children:"Node Exporter"}),(0,r.jsx)(n.td,{children:"\u8282\u70b9\u76d1\u63a7"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"747"}),(0,r.jsx)(n.td,{children:"Kubernetes Deployments"}),(0,r.jsx)(n.td,{children:"Deployment \u76d1\u63a7"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"\u5bfc\u5165-dashboard",children:"\u5bfc\u5165 Dashboard"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u8bbf\u95ee Grafana UI"}),"\n",(0,r.jsx)(n.li,{children:"\u5de6\u4fa7\u83dc\u5355 \u2192 Dashboards \u2192 Import"}),"\n",(0,r.jsx)(n.li,{children:"\u8f93\u5165 Dashboard ID \u6216\u4e0a\u4f20 JSON"}),"\n",(0,r.jsx)(n.li,{children:"\u9009\u62e9\u6570\u636e\u6e90\uff08Prometheus\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u70b9\u51fb Import"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"alertmanager-\u544a\u8b66",children:"Alertmanager \u544a\u8b66"}),"\n",(0,r.jsx)(n.h3,{id:"\u544a\u8b66\u89c4\u5219\u793a\u4f8b",children:"\u544a\u8b66\u89c4\u5219\u793a\u4f8b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'apiVersion: monitoring.coreos.com/v1\nkind: PrometheusRule\nmetadata:\n  name: custom-alerts\n  namespace: monitoring\n  labels:\n    release: prometheus\nspec:\n  groups:\n    - name: kubernetes-apps\n      rules:\n        # Pod CrashLoopBackOff \u544a\u8b66\n        - alert: PodCrashLoopBackOff\n          expr: |\n            max_over_time(kube_pod_container_status_waiting_reason{reason="CrashLoopBackOff"}[5m]) >= 1\n          for: 5m\n          labels:\n            severity: critical\n          annotations:\n            summary: "Pod {{ $labels.namespace }}/{{ $labels.pod }} CrashLoopBackOff"\n            description: "Pod {{ $labels.pod }} in namespace {{ $labels.namespace }} is in CrashLoopBackOff state."\n\n        # Pod \u5185\u5b58\u4f7f\u7528\u8d85\u8fc7 80%\n        - alert: PodHighMemoryUsage\n          expr: |\n            (container_memory_working_set_bytes / container_spec_memory_limit_bytes) * 100 > 80\n          for: 5m\n          labels:\n            severity: warning\n          annotations:\n            summary: "Pod {{ $labels.namespace }}/{{ $labels.pod }} memory usage > 80%"\n\n        # \u8282\u70b9 NotReady\n        - alert: NodeNotReady\n          expr: kube_node_status_condition{condition="Ready",status="true"} == 0\n          for: 5m\n          labels:\n            severity: critical\n          annotations:\n            summary: "Node {{ $labels.node }} is NotReady"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u914d\u7f6e\u544a\u8b66\u901a\u77e5",children:"\u914d\u7f6e\u544a\u8b66\u901a\u77e5"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# \u521b\u5efa Alertmanager \u914d\u7f6e\u7684 Secret\napiVersion: v1\nkind: Secret\nmetadata:\n  name: alertmanager-prometheus-kube-prometheus-alertmanager\n  namespace: monitoring\ntype: Opaque\nstringData:\n  alertmanager.yaml: |\n    global:\n      resolve_timeout: 5m\n      slack_api_url: 'https://hooks.slack.com/services/xxx'\n\n    route:\n      group_by: ['alertname', 'namespace']\n      group_wait: 30s\n      group_interval: 5m\n      repeat_interval: 4h\n      receiver: 'default'\n      routes:\n        - match:\n            severity: critical\n          receiver: 'slack-critical'\n\n    receivers:\n      - name: 'default'\n        webhook_configs:\n          - url: 'http://alertmanager-webhook:8080/webhook'\n\n      - name: 'slack-critical'\n        slack_configs:\n          - channel: '#alerts-critical'\n            send_resolved: true\n            title: '{{ .Status | toUpper }}: {{ .CommonAnnotations.summary }}'\n            text: '{{ .CommonAnnotations.description }}'\n"})}),"\n",(0,r.jsx)(n.h2,{id:"hpa-\u81ea\u52a8\u6269\u7f29\u5bb9",children:"HPA \u81ea\u52a8\u6269\u7f29\u5bb9"}),"\n",(0,r.jsx)(n.h3,{id:"\u57fa\u4e8e-cpu-\u7684-hpa",children:"\u57fa\u4e8e CPU \u7684 HPA"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: my-app-hpa\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: my-app\n  minReplicas: 2\n  maxReplicas: 10\n  metrics:\n    - type: Resource\n      resource:\n        name: cpu\n        target:\n          type: Utilization\n          averageUtilization: 70\n    - type: Resource\n      resource:\n        name: memory\n        target:\n          type: Utilization\n          averageUtilization: 80\n  behavior:\n    scaleDown:\n      stabilizationWindowSeconds: 300\n      policies:\n        - type: Percent\n          value: 10\n          periodSeconds: 60\n    scaleUp:\n      stabilizationWindowSeconds: 0\n      policies:\n        - type: Percent\n          value: 100\n          periodSeconds: 15\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u57fa\u4e8e\u81ea\u5b9a\u4e49\u6307\u6807\u7684-hpa",children:"\u57fa\u4e8e\u81ea\u5b9a\u4e49\u6307\u6807\u7684 HPA"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: autoscaling/v2\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: my-app-hpa\nspec:\n  scaleTargetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: my-app\n  minReplicas: 2\n  maxReplicas: 20\n  metrics:\n    - type: Pods\n      pods:\n        metric:\n          name: http_requests_per_second\n        target:\n          type: AverageValue\n          averageValue: 1000\n"})}),"\n",(0,r.jsx)(n.h3,{id:"hpa-\u64cd\u4f5c",children:"HPA \u64cd\u4f5c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u521b\u5efa HPA\nkubectl apply -f hpa.yaml\n\n# \u67e5\u770b HPA\nkubectl get hpa\nkubectl describe hpa my-app-hpa\n\n# \u547d\u4ee4\u884c\u521b\u5efa HPA\nkubectl autoscale deployment my-app --cpu-percent=70 --min=2 --max=10\n\n# \u67e5\u770b\u6269\u7f29\u5bb9\u4e8b\u4ef6\nkubectl get events --field-selector reason=SuccessfulRescale\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u65e5\u5fd7\u6536\u96c6",children:"\u65e5\u5fd7\u6536\u96c6"}),"\n",(0,r.jsx)(n.h3,{id:"\u4f7f\u7528-fluent-bit",children:"\u4f7f\u7528 Fluent Bit"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"apiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: fluent-bit-config\ndata:\n  fluent-bit.conf: |\n    [SERVICE]\n        Flush         5\n        Log_Level     info\n        Daemon        off\n\n    [INPUT]\n        Name              tail\n        Tag               kube.*\n        Path              /var/log/containers/*.log\n        Parser            docker\n        DB                /var/log/flb_kube.db\n        Mem_Buf_Limit     50MB\n        Skip_Long_Lines   On\n        Refresh_Interval  10\n\n    [FILTER]\n        Name                kubernetes\n        Match               kube.*\n        Kube_URL            https://kubernetes.default.svc:443\n        Kube_CA_File        /var/run/secrets/kubernetes.io/serviceaccount/ca.crt\n        Kube_Token_File     /var/run/secrets/kubernetes.io/serviceaccount/token\n        Merge_Log           On\n        K8S-Logging.Parser  On\n        K8S-Logging.Exclude On\n\n    [OUTPUT]\n        Name            es\n        Match           *\n        Host            elasticsearch\n        Port            9200\n        Index           kubernetes\n        Type            _doc\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u65e5\u5fd7\u67e5\u770b\u547d\u4ee4",children:"\u65e5\u5fd7\u67e5\u770b\u547d\u4ee4"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b Pod \u65e5\u5fd7\nkubectl logs <pod-name>\nkubectl logs <pod-name> -c <container-name>  # \u591a\u5bb9\u5668\nkubectl logs <pod-name> --previous           # \u4e0a\u4e00\u4e2a\u5bb9\u5668\u5b9e\u4f8b\nkubectl logs <pod-name> -f                   # \u5b9e\u65f6\u65e5\u5fd7\nkubectl logs <pod-name> --tail=100          # \u6700\u540e 100 \u884c\nkubectl logs <pod-name> --since=1h          # \u6700\u8fd1 1 \u5c0f\u65f6\n\n# \u67e5\u770b\u591a\u4e2a Pod \u65e5\u5fd7\nkubectl logs -l app=my-app --all-containers\n\n# \u4f7f\u7528 stern \u5de5\u5177\nstern my-app -n production\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5e38\u7528\u64cd\u4f5c",children:"\u5e38\u7528\u64cd\u4f5c"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u8d44\u6e90\u76d1\u63a7\nkubectl top nodes\nkubectl top pods -A\n\n# \u4e8b\u4ef6\u67e5\u770b\nkubectl get events -A --sort-by='.lastTimestamp'\nkubectl get events -w  # \u5b9e\u65f6\u4e8b\u4ef6\n\n# \u7ec4\u4ef6\u5065\u5eb7\u68c0\u67e5\nkubectl get componentstatuses\nkubectl get --raw /healthz\nkubectl get --raw /readyz\n\n# API Server \u6307\u6807\nkubectl get --raw /metrics | head -100\n"})})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},48885:(e,n,a)=>{a.d(n,{R:()=>o,x:()=>i});var t=a(99378);const r={},s=t.createContext(r);function o(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);