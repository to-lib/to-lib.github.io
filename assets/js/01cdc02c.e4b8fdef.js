"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[49215],{13368:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"ai/graphrag","title":"\ud83d\udd78\ufe0f GraphRAG","description":"GraphRAG \u7ed3\u5408\u77e5\u8bc6\u56fe\u8c31\u548c\u5411\u91cf\u68c0\u7d22\uff0c\u63d0\u4f9b\u66f4\u51c6\u786e\u3001\u66f4\u6709\u4e0a\u4e0b\u6587\u7684\u68c0\u7d22\u7ed3\u679c\u3002\u7279\u522b\u9002\u5408\u9700\u8981\u7406\u89e3\u5b9e\u4f53\u5173\u7cfb\u7684\u590d\u6742\u67e5\u8be2\u3002","source":"@site/docs/ai/graphrag.md","sourceDirName":"ai","slug":"/ai/graphrag","permalink":"/docs/ai/graphrag","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ai/graphrag.md","tags":[],"version":"current","sidebarPosition":29,"frontMatter":{"sidebar_position":29,"title":"\ud83d\udd78\ufe0f GraphRAG"},"sidebar":"ai","previous":{"title":"\ud83d\udcda RAG (\u68c0\u7d22\u589e\u5f3a\u751f\u6210)","permalink":"/docs/ai/rag"},"next":{"title":"\ud83d\udd27 Function Calling","permalink":"/docs/ai/function-calling"}}');var r=t(22714),i=t(48885);const a={sidebar_position:29,title:"\ud83d\udd78\ufe0f GraphRAG"},o="GraphRAG\uff08\u77e5\u8bc6\u56fe\u8c31\u589e\u5f3a\u68c0\u7d22\uff09",l={},d=[{value:"\u4f20\u7edf RAG vs GraphRAG",id:"\u4f20\u7edf-rag-vs-graphrag",level:2},{value:"\u5de5\u4f5c\u539f\u7406",id:"\u5de5\u4f5c\u539f\u7406",level:2},{value:"\u5fae\u8f6f GraphRAG",id:"\u5fae\u8f6f-graphrag",level:2},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:3},{value:"\u521d\u59cb\u5316\u9879\u76ee",id:"\u521d\u59cb\u5316\u9879\u76ee",level:3},{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:3},{value:"\u6784\u5efa\u7d22\u5f15",id:"\u6784\u5efa\u7d22\u5f15",level:3},{value:"\u67e5\u8be2",id:"\u67e5\u8be2",level:3},{value:"\u624b\u52a8\u5b9e\u73b0 GraphRAG",id:"\u624b\u52a8\u5b9e\u73b0-graphrag",level:2},{value:"1. \u5b9e\u4f53\u548c\u5173\u7cfb\u63d0\u53d6",id:"1-\u5b9e\u4f53\u548c\u5173\u7cfb\u63d0\u53d6",level:3},{value:"2. \u6784\u5efa\u77e5\u8bc6\u56fe\u8c31",id:"2-\u6784\u5efa\u77e5\u8bc6\u56fe\u8c31",level:3},{value:"3. GraphRAG \u67e5\u8be2",id:"3-graphrag-\u67e5\u8be2",level:3},{value:"\u6df7\u5408\u68c0\u7d22",id:"\u6df7\u5408\u68c0\u7d22",level:2},{value:"LlamaIndex GraphRAG",id:"llamaindex-graphrag",level:2},{value:"\u793e\u533a\u68c0\u6d4b\u4e0e\u6458\u8981",id:"\u793e\u533a\u68c0\u6d4b\u4e0e\u6458\u8981",level:2},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2},{value:"\u5ef6\u4f38\u9605\u8bfb",id:"\u5ef6\u4f38\u9605\u8bfb",level:2}];function c(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"graphrag\u77e5\u8bc6\u56fe\u8c31\u589e\u5f3a\u68c0\u7d22",children:"GraphRAG\uff08\u77e5\u8bc6\u56fe\u8c31\u589e\u5f3a\u68c0\u7d22\uff09"})}),"\n",(0,r.jsx)(e.p,{children:"GraphRAG \u7ed3\u5408\u77e5\u8bc6\u56fe\u8c31\u548c\u5411\u91cf\u68c0\u7d22\uff0c\u63d0\u4f9b\u66f4\u51c6\u786e\u3001\u66f4\u6709\u4e0a\u4e0b\u6587\u7684\u68c0\u7d22\u7ed3\u679c\u3002\u7279\u522b\u9002\u5408\u9700\u8981\u7406\u89e3\u5b9e\u4f53\u5173\u7cfb\u7684\u590d\u6742\u67e5\u8be2\u3002"}),"\n",(0,r.jsx)(e.h2,{id:"\u4f20\u7edf-rag-vs-graphrag",children:"\u4f20\u7edf RAG vs GraphRAG"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u7279\u6027"}),(0,r.jsx)(e.th,{children:"\u4f20\u7edf RAG"}),(0,r.jsx)(e.th,{children:"GraphRAG"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u68c0\u7d22\u65b9\u5f0f"}),(0,r.jsx)(e.td,{children:"\u5411\u91cf\u76f8\u4f3c\u5ea6"}),(0,r.jsx)(e.td,{children:"\u56fe\u904d\u5386 + \u5411\u91cf"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5173\u7cfb\u7406\u89e3"}),(0,r.jsx)(e.td,{children:"\u5f31"}),(0,r.jsx)(e.td,{children:"\u5f3a"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u591a\u8df3\u63a8\u7406"}),(0,r.jsx)(e.td,{children:"\u56f0\u96be"}),(0,r.jsx)(e.td,{children:"\u81ea\u7136\u652f\u6301"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5168\u5c40\u6458\u8981"}),(0,r.jsx)(e.td,{children:"\u4e0d\u652f\u6301"}),(0,r.jsx)(e.td,{children:"\u652f\u6301"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u6784\u5efa\u6210\u672c"}),(0,r.jsx)(e.td,{children:"\u4f4e"}),(0,r.jsx)(e.td,{children:"\u9ad8"})]})]})]}),"\n",(0,r.jsx)(e.h2,{id:"\u5de5\u4f5c\u539f\u7406",children:"\u5de5\u4f5c\u539f\u7406"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\u6587\u6863 \u2500\u2500> \u5b9e\u4f53\u63d0\u53d6 \u2500\u2500> \u5173\u7cfb\u62bd\u53d6 \u2500\u2500> \u77e5\u8bc6\u56fe\u8c31\n                                    \u2502\n\u67e5\u8be2 \u2500\u2500> \u5b9e\u4f53\u8bc6\u522b \u2500\u2500> \u56fe\u68c0\u7d22 \u2500\u2500> \u5b50\u56fe \u2500\u2500> LLM \u2500\u2500> \u7b54\u6848\n                        \u2502\n                    \u5411\u91cf\u68c0\u7d22 \u2500\u2500> \u76f8\u5173\u6587\u6863\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u5fae\u8f6f-graphrag",children:"\u5fae\u8f6f GraphRAG"}),"\n",(0,r.jsx)(e.h3,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"pip install graphrag\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u521d\u59cb\u5316\u9879\u76ee",children:"\u521d\u59cb\u5316\u9879\u76ee"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u521b\u5efa\u9879\u76ee\u76ee\u5f55\nmkdir my_graphrag\ncd my_graphrag\n\n# \u521d\u59cb\u5316\npython -m graphrag.index --init --root .\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u914d\u7f6e",children:"\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"# settings.yaml\nllm:\n  api_key: ${OPENAI_API_KEY}\n  model: gpt-4o\n  \nembeddings:\n  api_key: ${OPENAI_API_KEY}\n  model: text-embedding-3-small\n\nchunks:\n  size: 1200\n  overlap: 100\n\nentity_extraction:\n  max_gleanings: 1\n\ncommunity_reports:\n  max_length: 2000\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u6784\u5efa\u7d22\u5f15",children:"\u6784\u5efa\u7d22\u5f15"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u5c06\u6587\u6863\u653e\u5165 input \u76ee\u5f55\ncp documents/*.txt ./input/\n\n# \u6784\u5efa\u7d22\u5f15\npython -m graphrag.index --root .\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u67e5\u8be2",children:"\u67e5\u8be2"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'# \u5168\u5c40\u67e5\u8be2\uff08\u9002\u5408\u6458\u8981\u6027\u95ee\u9898\uff09\npython -m graphrag.query --root . --method global "\u6587\u6863\u7684\u4e3b\u8981\u4e3b\u9898\u662f\u4ec0\u4e48\uff1f"\n\n# \u5c40\u90e8\u67e5\u8be2\uff08\u9002\u5408\u5177\u4f53\u95ee\u9898\uff09\npython -m graphrag.query --root . --method local "\u5f20\u4e09\u548c\u674e\u56db\u662f\u4ec0\u4e48\u5173\u7cfb\uff1f"\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u624b\u52a8\u5b9e\u73b0-graphrag",children:"\u624b\u52a8\u5b9e\u73b0 GraphRAG"}),"\n",(0,r.jsx)(e.h3,{id:"1-\u5b9e\u4f53\u548c\u5173\u7cfb\u63d0\u53d6",children:"1. \u5b9e\u4f53\u548c\u5173\u7cfb\u63d0\u53d6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'from openai import OpenAI\nimport json\nfrom dataclasses import dataclass\n\nclient = OpenAI()\n\n@dataclass\nclass Entity:\n    name: str\n    type: str\n    description: str\n\n@dataclass\nclass Relationship:\n    source: str\n    target: str\n    relation: str\n    description: str\n\ndef extract_entities_and_relations(text: str) -> tuple[list[Entity], list[Relationship]]:\n    """\u4ece\u6587\u672c\u4e2d\u63d0\u53d6\u5b9e\u4f53\u548c\u5173\u7cfb"""\n    prompt = f"""\n\u4ece\u4ee5\u4e0b\u6587\u672c\u4e2d\u63d0\u53d6\u5b9e\u4f53\u548c\u5173\u7cfb\u3002\n\n\u6587\u672c\uff1a\n{text}\n\n\u8fd4\u56de JSON \u683c\u5f0f\uff1a\n{{\n    "entities": [\n        {{"name": "\u5b9e\u4f53\u540d", "type": "\u7c7b\u578b(\u4eba\u7269/\u7ec4\u7ec7/\u5730\u70b9/\u6982\u5ff5)", "description": "\u63cf\u8ff0"}}\n    ],\n    "relationships": [\n        {{"source": "\u6e90\u5b9e\u4f53", "target": "\u76ee\u6807\u5b9e\u4f53", "relation": "\u5173\u7cfb\u7c7b\u578b", "description": "\u5173\u7cfb\u63cf\u8ff0"}}\n    ]\n}}\n"""\n    \n    response = client.chat.completions.create(\n        model="gpt-4o",\n        messages=[{"role": "user", "content": prompt}],\n        response_format={"type": "json_object"}\n    )\n    \n    data = json.loads(response.choices[0].message.content)\n    \n    entities = [Entity(**e) for e in data.get("entities", [])]\n    relationships = [Relationship(**r) for r in data.get("relationships", [])]\n    \n    return entities, relationships\n'})}),"\n",(0,r.jsx)(e.h3,{id:"2-\u6784\u5efa\u77e5\u8bc6\u56fe\u8c31",children:"2. \u6784\u5efa\u77e5\u8bc6\u56fe\u8c31"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'import networkx as nx\nfrom langchain_openai import OpenAIEmbeddings\nimport numpy as np\n\nclass KnowledgeGraph:\n    """\u77e5\u8bc6\u56fe\u8c31"""\n    \n    def __init__(self):\n        self.graph = nx.DiGraph()\n        self.embeddings = OpenAIEmbeddings(model="text-embedding-3-small")\n        self.entity_embeddings = {}\n    \n    def add_entity(self, entity: Entity):\n        """\u6dfb\u52a0\u5b9e\u4f53"""\n        self.graph.add_node(\n            entity.name,\n            type=entity.type,\n            description=entity.description\n        )\n        # \u8ba1\u7b97\u5d4c\u5165\n        self.entity_embeddings[entity.name] = self.embeddings.embed_query(\n            f"{entity.name}: {entity.description}"\n        )\n    \n    def add_relationship(self, rel: Relationship):\n        """\u6dfb\u52a0\u5173\u7cfb"""\n        self.graph.add_edge(\n            rel.source,\n            rel.target,\n            relation=rel.relation,\n            description=rel.description\n        )\n    \n    def build_from_documents(self, documents: list[str]):\n        """\u4ece\u6587\u6863\u6784\u5efa\u56fe\u8c31"""\n        for doc in documents:\n            entities, relationships = extract_entities_and_relations(doc)\n            \n            for entity in entities:\n                self.add_entity(entity)\n            \n            for rel in relationships:\n                if rel.source in self.graph and rel.target in self.graph:\n                    self.add_relationship(rel)\n    \n    def find_similar_entities(self, query: str, top_k: int = 5) -> list[str]:\n        """\u627e\u5230\u4e0e\u67e5\u8be2\u76f8\u4f3c\u7684\u5b9e\u4f53"""\n        query_embedding = self.embeddings.embed_query(query)\n        \n        similarities = []\n        for entity, embedding in self.entity_embeddings.items():\n            sim = np.dot(query_embedding, embedding)\n            similarities.append((entity, sim))\n        \n        similarities.sort(key=lambda x: x[1], reverse=True)\n        return [e[0] for e in similarities[:top_k]]\n    \n    def get_subgraph(self, entities: list[str], hops: int = 2) -> nx.DiGraph:\n        """\u83b7\u53d6\u5b9e\u4f53\u5468\u56f4\u7684\u5b50\u56fe"""\n        nodes = set(entities)\n        \n        for _ in range(hops):\n            new_nodes = set()\n            for node in nodes:\n                if node in self.graph:\n                    new_nodes.update(self.graph.predecessors(node))\n                    new_nodes.update(self.graph.successors(node))\n            nodes.update(new_nodes)\n        \n        return self.graph.subgraph(nodes)\n    \n    def subgraph_to_text(self, subgraph: nx.DiGraph) -> str:\n        """\u5c06\u5b50\u56fe\u8f6c\u6362\u4e3a\u6587\u672c\u63cf\u8ff0"""\n        lines = []\n        \n        # \u5b9e\u4f53\u63cf\u8ff0\n        lines.append("\u5b9e\u4f53\uff1a")\n        for node in subgraph.nodes():\n            data = self.graph.nodes[node]\n            lines.append(f"- {node} ({data.get(\'type\', \'\u672a\u77e5\')}): {data.get(\'description\', \'\')}")\n        \n        # \u5173\u7cfb\u63cf\u8ff0\n        lines.append("\\n\u5173\u7cfb\uff1a")\n        for source, target, data in subgraph.edges(data=True):\n            lines.append(f"- {source} --[{data.get(\'relation\', \'\')}]--\x3e {target}")\n        \n        return "\\n".join(lines)\n'})}),"\n",(0,r.jsx)(e.h3,{id:"3-graphrag-\u67e5\u8be2",children:"3. GraphRAG \u67e5\u8be2"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'class GraphRAG:\n    """GraphRAG \u67e5\u8be2\u7cfb\u7edf"""\n    \n    def __init__(self, knowledge_graph: KnowledgeGraph):\n        self.kg = knowledge_graph\n        self.client = OpenAI()\n    \n    def query(self, question: str) -> str:\n        """\u67e5\u8be2"""\n        # 1. \u627e\u5230\u76f8\u5173\u5b9e\u4f53\n        relevant_entities = self.kg.find_similar_entities(question, top_k=5)\n        \n        # 2. \u83b7\u53d6\u5b50\u56fe\n        subgraph = self.kg.get_subgraph(relevant_entities, hops=2)\n        \n        # 3. \u8f6c\u6362\u4e3a\u4e0a\u4e0b\u6587\n        context = self.kg.subgraph_to_text(subgraph)\n        \n        # 4. \u751f\u6210\u7b54\u6848\n        response = self.client.chat.completions.create(\n            model="gpt-4o",\n            messages=[\n                {\n                    "role": "system",\n                    "content": f"\u6839\u636e\u4ee5\u4e0b\u77e5\u8bc6\u56fe\u8c31\u4fe1\u606f\u56de\u7b54\u95ee\u9898\u3002\\n\\n{context}"\n                },\n                {"role": "user", "content": question}\n            ]\n        )\n        \n        return response.choices[0].message.content\n\n# \u4f7f\u7528\nkg = KnowledgeGraph()\nkg.build_from_documents(documents)\n\nrag = GraphRAG(kg)\nanswer = rag.query("\u5f20\u4e09\u548c\u674e\u56db\u662f\u4ec0\u4e48\u5173\u7cfb\uff1f")\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u6df7\u5408\u68c0\u7d22",children:"\u6df7\u5408\u68c0\u7d22"}),"\n",(0,r.jsx)(e.p,{children:"\u7ed3\u5408\u5411\u91cf\u68c0\u7d22\u548c\u56fe\u68c0\u7d22\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'from langchain_community.vectorstores import Chroma\n\nclass HybridGraphRAG:\n    """\u6df7\u5408 GraphRAG"""\n    \n    def __init__(self, documents: list[str]):\n        # \u5411\u91cf\u5b58\u50a8\n        self.vectorstore = Chroma.from_texts(\n            texts=documents,\n            embedding=OpenAIEmbeddings(model="text-embedding-3-small")\n        )\n        \n        # \u77e5\u8bc6\u56fe\u8c31\n        self.kg = KnowledgeGraph()\n        self.kg.build_from_documents(documents)\n        \n        self.client = OpenAI()\n    \n    def query(self, question: str) -> str:\n        # \u5411\u91cf\u68c0\u7d22\n        vector_docs = self.vectorstore.similarity_search(question, k=3)\n        vector_context = "\\n".join([d.page_content for d in vector_docs])\n        \n        # \u56fe\u68c0\u7d22\n        entities = self.kg.find_similar_entities(question, top_k=3)\n        subgraph = self.kg.get_subgraph(entities, hops=1)\n        graph_context = self.kg.subgraph_to_text(subgraph)\n        \n        # \u5408\u5e76\u4e0a\u4e0b\u6587\n        combined_context = f"""\n\u6587\u6863\u7247\u6bb5\uff1a\n{vector_context}\n\n\u77e5\u8bc6\u56fe\u8c31\uff1a\n{graph_context}\n"""\n        \n        response = self.client.chat.completions.create(\n            model="gpt-4o",\n            messages=[\n                {\n                    "role": "system",\n                    "content": f"\u6839\u636e\u4ee5\u4e0b\u4fe1\u606f\u56de\u7b54\u95ee\u9898\u3002\\n\\n{combined_context}"\n                },\n                {"role": "user", "content": question}\n            ]\n        )\n        \n        return response.choices[0].message.content\n'})}),"\n",(0,r.jsx)(e.h2,{id:"llamaindex-graphrag",children:"LlamaIndex GraphRAG"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'from llama_index.core import KnowledgeGraphIndex, SimpleDirectoryReader\nfrom llama_index.core import StorageContext\nfrom llama_index.graph_stores.neo4j import Neo4jGraphStore\n\n# \u914d\u7f6e Neo4j\ngraph_store = Neo4jGraphStore(\n    username="neo4j",\n    password="password",\n    url="bolt://localhost:7687",\n    database="neo4j"\n)\n\nstorage_context = StorageContext.from_defaults(graph_store=graph_store)\n\n# \u52a0\u8f7d\u6587\u6863\ndocuments = SimpleDirectoryReader("./data").load_data()\n\n# \u6784\u5efa\u77e5\u8bc6\u56fe\u8c31\u7d22\u5f15\nindex = KnowledgeGraphIndex.from_documents(\n    documents,\n    storage_context=storage_context,\n    max_triplets_per_chunk=10,\n    include_embeddings=True\n)\n\n# \u67e5\u8be2\nquery_engine = index.as_query_engine(\n    include_text=True,\n    response_mode="tree_summarize"\n)\n\nresponse = query_engine.query("\u4e3b\u8981\u4eba\u7269\u4e4b\u95f4\u7684\u5173\u7cfb\u662f\u4ec0\u4e48\uff1f")\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u793e\u533a\u68c0\u6d4b\u4e0e\u6458\u8981",children:"\u793e\u533a\u68c0\u6d4b\u4e0e\u6458\u8981"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'from networkx.algorithms import community\n\ndef detect_communities(kg: KnowledgeGraph) -> list[set]:\n    """\u68c0\u6d4b\u793e\u533a"""\n    # \u8f6c\u6362\u4e3a\u65e0\u5411\u56fe\u8fdb\u884c\u793e\u533a\u68c0\u6d4b\n    undirected = kg.graph.to_undirected()\n    communities = community.louvain_communities(undirected)\n    return communities\n\ndef summarize_community(kg: KnowledgeGraph, nodes: set) -> str:\n    """\u751f\u6210\u793e\u533a\u6458\u8981"""\n    subgraph = kg.graph.subgraph(nodes)\n    context = kg.subgraph_to_text(subgraph)\n    \n    response = client.chat.completions.create(\n        model="gpt-4o",\n        messages=[\n            {\n                "role": "system",\n                "content": "\u6839\u636e\u4ee5\u4e0b\u77e5\u8bc6\u56fe\u8c31\u7247\u6bb5\uff0c\u751f\u6210\u4e00\u4e2a\u7b80\u6d01\u7684\u6458\u8981\u3002"\n            },\n            {"role": "user", "content": context}\n        ],\n        max_tokens=500\n    )\n    \n    return response.choices[0].message.content\n\n# \u5168\u5c40\u67e5\u8be2\uff1a\u4f7f\u7528\u793e\u533a\u6458\u8981\ndef global_query(kg: KnowledgeGraph, question: str) -> str:\n    communities = detect_communities(kg)\n    summaries = [summarize_community(kg, c) for c in communities[:5]]\n    \n    combined = "\\n\\n".join([f"\u4e3b\u9898 {i+1}\uff1a{s}" for i, s in enumerate(summaries)])\n    \n    response = client.chat.completions.create(\n        model="gpt-4o",\n        messages=[\n            {\n                "role": "system",\n                "content": f"\u6839\u636e\u4ee5\u4e0b\u4e3b\u9898\u6458\u8981\u56de\u7b54\u95ee\u9898\u3002\\n\\n{combined}"\n            },\n            {"role": "user", "content": question}\n        ]\n    )\n    \n    return response.choices[0].message.content\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u9009\u62e9\u5408\u9002\u7684\u573a\u666f"}),"\uff1a\u5173\u7cfb\u5bc6\u96c6\u7684\u6570\u636e\u66f4\u9002\u5408 GraphRAG"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u63a7\u5236\u56fe\u89c4\u6a21"}),"\uff1a\u5927\u56fe\u9700\u8981\u5206\u533a\u6216\u91c7\u6837"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6df7\u5408\u4f7f\u7528"}),"\uff1a\u7ed3\u5408\u5411\u91cf\u68c0\u7d22\u548c\u56fe\u68c0\u7d22"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u589e\u91cf\u66f4\u65b0"}),"\uff1a\u652f\u6301\u56fe\u8c31\u7684\u589e\u91cf\u6784\u5efa"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8d28\u91cf\u63a7\u5236"}),"\uff1a\u9a8c\u8bc1\u63d0\u53d6\u7684\u5b9e\u4f53\u548c\u5173\u7cfb"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u5ef6\u4f38\u9605\u8bfb",children:"\u5ef6\u4f38\u9605\u8bfb"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://github.com/microsoft/graphrag",children:"Microsoft GraphRAG"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://docs.llamaindex.ai/en/stable/examples/index_structs/knowledge_graph/",children:"LlamaIndex Knowledge Graph"})}),"\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://neo4j.com/developer/genai/",children:"Neo4j + LLM"})}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(c,{...n})}):c(n)}},48885:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>o});var s=t(99378);const r={},i=s.createContext(r);function a(n){const e=s.useContext(i);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:a(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);