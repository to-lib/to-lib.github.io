"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[47447],{48885:(n,e,t)=>{t.d(e,{R:()=>d,x:()=>l});var r=t(99378);const s={},i=r.createContext(s);function d(n){const e=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:d(n.components),r.createElement(i.Provider,{value:e},n.children)}},74180:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"ml/model-evaluation","title":"\ud83d\udccf \u6a21\u578b\u8bc4\u4f30","description":"\u6570\u636e\u96c6\u5212\u5206","source":"@site/docs/ml/model-evaluation.md","sourceDirName":"ml","slug":"/ml/model-evaluation","permalink":"/docs/ml/model-evaluation","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/model-evaluation.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9,"title":"\ud83d\udccf \u6a21\u578b\u8bc4\u4f30"},"sidebar":"ml","previous":{"title":"\ud83d\uddbc\ufe0f \u8ba1\u7b97\u673a\u89c6\u89c9","permalink":"/docs/ml/computer-vision"},"next":{"title":"\u2699\ufe0f \u6a21\u578b\u8c03\u4f18","permalink":"/docs/ml/model-tuning"}}');var s=t(22714),i=t(48885);const d={sidebar_position:9,title:"\ud83d\udccf \u6a21\u578b\u8bc4\u4f30"},l="\u6a21\u578b\u8bc4\u4f30",c={},o=[{value:"\u6570\u636e\u96c6\u5212\u5206",id:"\u6570\u636e\u96c6\u5212\u5206",level:2},{value:"\u5206\u7c7b\u6307\u6807",id:"\u5206\u7c7b\u6307\u6807",level:2},{value:"\u6df7\u6dc6\u77e9\u9635\u4e0e\u6838\u5fc3\u6307\u6807",id:"\u6df7\u6dc6\u77e9\u9635\u4e0e\u6838\u5fc3\u6307\u6807",level:3},{value:"\u56de\u5f52\u6307\u6807",id:"\u56de\u5f52\u6307\u6807",level:2},{value:"\u5b66\u4e60\u66f2\u7ebf",id:"\u5b66\u4e60\u66f2\u7ebf",level:2}];function a(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"\u6a21\u578b\u8bc4\u4f30",children:"\u6a21\u578b\u8bc4\u4f30"})}),"\n",(0,s.jsx)(e.h2,{id:"\u6570\u636e\u96c6\u5212\u5206",children:"\u6570\u636e\u96c6\u5212\u5206"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"from sklearn.model_selection import train_test_split, cross_val_score, StratifiedKFold\n\n# \u5212\u5206\u8bad\u7ec3/\u9a8c\u8bc1/\u6d4b\u8bd5\u96c6\nX_temp, X_test, y_temp, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\nX_train, X_val, y_train, y_val = train_test_split(X_temp, y_temp, test_size=0.25)\n\n# \u4ea4\u53c9\u9a8c\u8bc1\nscores = cross_val_score(model, X, y, cv=StratifiedKFold(5), scoring='accuracy')\nprint(f\"CV \u51c6\u786e\u7387: {scores.mean():.2%} \xb1 {scores.std():.2%}\")\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u5206\u7c7b\u6307\u6807",children:"\u5206\u7c7b\u6307\u6807"}),"\n",(0,s.jsx)(e.h3,{id:"\u6df7\u6dc6\u77e9\u9635\u4e0e\u6838\u5fc3\u6307\u6807",children:"\u6df7\u6dc6\u77e9\u9635\u4e0e\u6838\u5fc3\u6307\u6807"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{}),(0,s.jsx)(e.th,{children:"\u9884\u6d4b\u6b63"}),(0,s.jsx)(e.th,{children:"\u9884\u6d4b\u8d1f"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u5b9e\u9645\u6b63"}),(0,s.jsx)(e.td,{children:"TP"}),(0,s.jsx)(e.td,{children:"FN"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u5b9e\u9645\u8d1f"}),(0,s.jsx)(e.td,{children:"FP"}),(0,s.jsx)(e.td,{children:"TN"})]})]})]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"from sklearn.metrics import classification_report, confusion_matrix, roc_auc_score\n\nprint(classification_report(y_test, y_pred))\n\n# AUC\ny_prob = model.predict_proba(X_test)[:, 1]\nauc = roc_auc_score(y_test, y_prob)\n"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u6307\u6807"}),(0,s.jsx)(e.th,{children:"\u516c\u5f0f"}),(0,s.jsx)(e.th,{children:"\u9002\u7528\u573a\u666f"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u51c6\u786e\u7387"}),(0,s.jsx)(e.td,{children:"(TP+TN)/\u603b\u6570"}),(0,s.jsx)(e.td,{children:"\u7c7b\u522b\u5e73\u8861"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u7cbe\u786e\u7387"}),(0,s.jsx)(e.td,{children:"TP/(TP+FP)"}),(0,s.jsx)(e.td,{children:"\u5047\u6b63\u4f8b\u4ee3\u4ef7\u9ad8"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u53ec\u56de\u7387"}),(0,s.jsx)(e.td,{children:"TP/(TP+FN)"}),(0,s.jsx)(e.td,{children:"\u5047\u8d1f\u4f8b\u4ee3\u4ef7\u9ad8"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"F1"}),(0,s.jsx)(e.td,{children:"2\xd7P\xd7R/(P+R)"}),(0,s.jsx)(e.td,{children:"\u7c7b\u522b\u4e0d\u5e73\u8861"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"AUC"}),(0,s.jsx)(e.td,{children:"ROC \u66f2\u7ebf\u4e0b\u9762\u79ef"}),(0,s.jsx)(e.td,{children:"\u6392\u5e8f\u80fd\u529b"})]})]})]}),"\n",(0,s.jsx)(e.h2,{id:"\u56de\u5f52\u6307\u6807",children:"\u56de\u5f52\u6307\u6807"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score\n\nrmse = mean_squared_error(y_test, y_pred, squared=False)\nmae = mean_absolute_error(y_test, y_pred)\nr2 = r2_score(y_test, y_pred)\n"})}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u6307\u6807"}),(0,s.jsx)(e.th,{children:"\u7279\u70b9"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"MSE/RMSE"}),(0,s.jsx)(e.td,{children:"\u5bf9\u5927\u8bef\u5dee\u654f\u611f"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"MAE"}),(0,s.jsx)(e.td,{children:"\u5bf9\u5f02\u5e38\u503c\u9c81\u68d2"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"R\xb2"}),(0,s.jsx)(e.td,{children:"\u89e3\u91ca\u65b9\u5dee\u6bd4\u4f8b"})]})]})]}),"\n",(0,s.jsx)(e.h2,{id:"\u5b66\u4e60\u66f2\u7ebf",children:"\u5b66\u4e60\u66f2\u7ebf"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"from sklearn.model_selection import learning_curve\n\ntrain_sizes, train_scores, val_scores = learning_curve(model, X, y, cv=5)\n# \u9ad8\u504f\u5dee\uff1a\u4e24\u6761\u66f2\u7ebf\u90fd\u4f4e \u2192 \u589e\u52a0\u590d\u6742\u5ea6\n# \u9ad8\u65b9\u5dee\uff1a\u8bad\u7ec3\u9ad8\u9a8c\u8bc1\u4f4e \u2192 \u589e\u52a0\u6570\u636e/\u6b63\u5219\u5316\n"})})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(a,{...n})}):a(n)}}}]);