"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[4207],{12897:(n,e,l)=>{l.r(e),l.d(e,{assets:()=>c,contentTitle:()=>t,default:()=>o,frontMatter:()=>h,metadata:()=>i,toc:()=>r});const i=JSON.parse('{"id":"linux/shell-scripting","title":"Shell \u811a\u672c","description":"Shell \u811a\u672c\u662f Linux \u7cfb\u7edf\u81ea\u52a8\u5316\u7684\u5f3a\u5927\u5de5\u5177\uff0c\u53ef\u4ee5\u5c06\u591a\u4e2a\u547d\u4ee4\u7ec4\u5408\u6210\u53ef\u91cd\u590d\u6267\u884c\u7684\u7a0b\u5e8f\u3002","source":"@site/docs/linux/shell-scripting.md","sourceDirName":"linux","slug":"/linux/shell-scripting","permalink":"/docs/linux/shell-scripting","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/linux/shell-scripting.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"Shell \u811a\u672c"},"sidebar":"linux","previous":{"title":"\u7cfb\u7edf\u5b89\u5168","permalink":"/docs/linux/security"},"next":{"title":"\u6027\u80fd\u4f18\u5316","permalink":"/docs/linux/performance-tuning"}}');var s=l(22714),a=l(48885);const h={sidebar_position:7,title:"Shell \u811a\u672c"},t="Shell \u811a\u672c\u7f16\u7a0b",c={},r=[{value:"Shell \u811a\u672c\u57fa\u7840",id:"shell-\u811a\u672c\u57fa\u7840",level:2},{value:"\u7b2c\u4e00\u4e2a\u811a\u672c",id:"\u7b2c\u4e00\u4e2a\u811a\u672c",level:3},{value:"\u53d8\u91cf",id:"\u53d8\u91cf",level:3},{value:"\u7279\u6b8a\u53d8\u91cf",id:"\u7279\u6b8a\u53d8\u91cf",level:3},{value:"\u6761\u4ef6\u5224\u65ad",id:"\u6761\u4ef6\u5224\u65ad",level:2},{value:"if \u8bed\u53e5",id:"if-\u8bed\u53e5",level:3},{value:"\u6d4b\u8bd5\u8fd0\u7b97\u7b26",id:"\u6d4b\u8bd5\u8fd0\u7b97\u7b26",level:3},{value:"\u5faa\u73af",id:"\u5faa\u73af",level:2},{value:"for \u5faa\u73af",id:"for-\u5faa\u73af",level:3},{value:"while \u5faa\u73af",id:"while-\u5faa\u73af",level:3},{value:"until \u5faa\u73af",id:"until-\u5faa\u73af",level:3},{value:"\u51fd\u6570",id:"\u51fd\u6570",level:2},{value:"\u6570\u7ec4",id:"\u6570\u7ec4",level:2},{value:"\u8f93\u5165\u8f93\u51fa",id:"\u8f93\u5165\u8f93\u51fa",level:2},{value:"\u8bfb\u53d6\u8f93\u5165",id:"\u8bfb\u53d6\u8f93\u5165",level:3},{value:"\u91cd\u5b9a\u5411",id:"\u91cd\u5b9a\u5411",level:3},{value:"\u5b9e\u7528\u811a\u672c\u793a\u4f8b",id:"\u5b9e\u7528\u811a\u672c\u793a\u4f8b",level:2},{value:"\u5907\u4efd\u811a\u672c",id:"\u5907\u4efd\u811a\u672c",level:3},{value:"\u7cfb\u7edf\u76d1\u63a7\u811a\u672c",id:"\u7cfb\u7edf\u76d1\u63a7\u811a\u672c",level:3},{value:"\u6279\u91cf\u91cd\u547d\u540d",id:"\u6279\u91cf\u91cd\u547d\u540d",level:3},{value:"\u8c03\u8bd5\u6280\u5de7",id:"\u8c03\u8bd5\u6280\u5de7",level:2},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2},{value:"1. \u811a\u672c\u6a21\u677f",id:"1-\u811a\u672c\u6a21\u677f",level:3},{value:"2. \u9519\u8bef\u5904\u7406",id:"2-\u9519\u8bef\u5904\u7406",level:3},{value:"3. \u53c2\u6570\u89e3\u6790",id:"3-\u53c2\u6570\u89e3\u6790",level:3},{value:"\u6587\u672c\u5904\u7406\u4e09\u5251\u5ba2",id:"\u6587\u672c\u5904\u7406\u4e09\u5251\u5ba2",level:2},{value:"grep \u9ad8\u7ea7\u7528\u6cd5",id:"grep-\u9ad8\u7ea7\u7528\u6cd5",level:3},{value:"sed \u6d41\u7f16\u8f91\u5668",id:"sed-\u6d41\u7f16\u8f91\u5668",level:3},{value:"awk \u6587\u672c\u5904\u7406",id:"awk-\u6587\u672c\u5904\u7406",level:3},{value:"\u6b63\u5219\u8868\u8fbe\u5f0f",id:"\u6b63\u5219\u8868\u8fbe\u5f0f",level:2},{value:"\u57fa\u672c\u6b63\u5219\u8868\u8fbe\u5f0f",id:"\u57fa\u672c\u6b63\u5219\u8868\u8fbe\u5f0f",level:3},{value:"\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f",id:"\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f",level:3},{value:"\u5b9e\u7528\u6b63\u5219\u8868\u8fbe\u5f0f",id:"\u5b9e\u7528\u6b63\u5219\u8868\u8fbe\u5f0f",level:3},{value:"\u5b9e\u7528\u811a\u672c\u6848\u4f8b",id:"\u5b9e\u7528\u811a\u672c\u6848\u4f8b",level:2},{value:"\u65e5\u5fd7\u5206\u6790\u811a\u672c",id:"\u65e5\u5fd7\u5206\u6790\u811a\u672c",level:3},{value:"\u6279\u91cf\u6587\u4ef6\u5904\u7406",id:"\u6279\u91cf\u6587\u4ef6\u5904\u7406",level:3},{value:"\u7cfb\u7edf\u76d1\u63a7\u811a\u672c",id:"\u7cfb\u7edf\u76d1\u63a7\u811a\u672c-1",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"shell-\u811a\u672c\u7f16\u7a0b",children:"Shell \u811a\u672c\u7f16\u7a0b"})}),"\n",(0,s.jsx)(e.p,{children:"Shell \u811a\u672c\u662f Linux \u7cfb\u7edf\u81ea\u52a8\u5316\u7684\u5f3a\u5927\u5de5\u5177\uff0c\u53ef\u4ee5\u5c06\u591a\u4e2a\u547d\u4ee4\u7ec4\u5408\u6210\u53ef\u91cd\u590d\u6267\u884c\u7684\u7a0b\u5e8f\u3002"}),"\n",(0,s.jsx)(e.h2,{id:"shell-\u811a\u672c\u57fa\u7840",children:"Shell \u811a\u672c\u57fa\u7840"}),"\n",(0,s.jsx)(e.h3,{id:"\u7b2c\u4e00\u4e2a\u811a\u672c",children:"\u7b2c\u4e00\u4e2a\u811a\u672c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n# \u8fd9\u662f\u6ce8\u91ca\n# shebang \u884c\u6307\u5b9a\u89e3\u91ca\u5668\n\necho "Hello, World!"\n'})}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u4fdd\u5b58\u4e3a hello.sh\uff0c\u6dfb\u52a0\u6267\u884c\u6743\u9650\nchmod +x hello.sh\n\n# \u8fd0\u884c\u811a\u672c\n./hello.sh\nbash hello.sh\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u53d8\u91cf",children:"\u53d8\u91cf"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u5b9a\u4e49\u53d8\u91cf\uff08\u7b49\u53f7\u4e24\u8fb9\u4e0d\u80fd\u6709\u7a7a\u683c\uff09\nname="Linux"\ncount=10\n\n# \u4f7f\u7528\u53d8\u91cf\necho "\u540d\u79f0: $name"\necho "\u6570\u91cf: ${count}"\n\n# \u53ea\u8bfb\u53d8\u91cf\nreadonly PI=3.14159\n\n# \u5220\u9664\u53d8\u91cf\nunset name\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u7279\u6b8a\u53d8\u91cf",children:"\u7279\u6b8a\u53d8\u91cf"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\necho "\u811a\u672c\u540d: $0"\necho "\u7b2c\u4e00\u4e2a\u53c2\u6570: $1"\necho "\u7b2c\u4e8c\u4e2a\u53c2\u6570: $2"\necho "\u6240\u6709\u53c2\u6570: $@"\necho "\u53c2\u6570\u4e2a\u6570: $#"\necho "\u4e0a\u4e2a\u547d\u4ee4\u9000\u51fa\u72b6\u6001: $?"\necho "\u5f53\u524d\u8fdb\u7a0bID: $$"\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u6761\u4ef6\u5224\u65ad",children:"\u6761\u4ef6\u5224\u65ad"}),"\n",(0,s.jsx)(e.h3,{id:"if-\u8bed\u53e5",children:"if \u8bed\u53e5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\nif [ "$1" = "hello" ]; then\n    echo "\u4f60\u8bf4\u4e86 hello"\nelif [ "$1" = "bye" ]; then\n    echo "\u4f60\u8bf4\u4e86 bye"\nelse\n    echo "\u672a\u77e5\u547d\u4ee4"\nfi\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u6d4b\u8bd5\u8fd0\u7b97\u7b26",children:"\u6d4b\u8bd5\u8fd0\u7b97\u7b26"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'# \u6570\u503c\u6bd4\u8f83\nif [ $a -eq $b ]; then echo "\u76f8\u7b49"; fi\nif [ $a -ne $b ]; then echo "\u4e0d\u76f8\u7b49"; fi\nif [ $a -gt $b ]; then echo "\u5927\u4e8e"; fi\nif [ $a -lt $b ]; then echo "\u5c0f\u4e8e"; fi\nif [ $a -ge $b ]; then echo "\u5927\u4e8e\u7b49\u4e8e"; fi\nif [ $a -le $b ]; then echo "\u5c0f\u4e8e\u7b49\u4e8e"; fi\n\n# \u5b57\u7b26\u4e32\u6bd4\u8f83\nif [ "$a" = "$b" ]; then echo "\u76f8\u7b49"; fi\nif [ "$a" != "$b" ]; then echo "\u4e0d\u76f8\u7b49"; fi\nif [ -z "$a" ]; then echo "\u957f\u5ea6\u4e3a0"; fi\nif [ -n "$a" ]; then echo "\u957f\u5ea6\u4e0d\u4e3a0"; fi\n\n# \u6587\u4ef6\u6d4b\u8bd5\nif [ -e file.txt ]; then echo "\u6587\u4ef6\u5b58\u5728"; fi\nif [ -f file.txt ]; then echo "\u662f\u666e\u901a\u6587\u4ef6"; fi\nif [ -d directory ]; then echo "\u662f\u76ee\u5f55"; fi\nif [ -r file.txt ]; then echo "\u53ef\u8bfb"; fi\nif [ -w file.txt ]; then echo "\u53ef\u5199"; fi\nif [ -x file.sh ]; then echo "\u53ef\u6267\u884c"; fi\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u5faa\u73af",children:"\u5faa\u73af"}),"\n",(0,s.jsx)(e.h3,{id:"for-\u5faa\u73af",children:"for \u5faa\u73af"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u57fa\u672cfor\u5faa\u73af\nfor i in 1 2 3 4 5; do\n    echo "\u6570\u5b57: $i"\ndone\n\n# \u8303\u56f4\nfor i in {1..10}; do\n    echo $i\ndone\n\n# C\u98ce\u683cfor\u5faa\u73af\nfor ((i=1; i<=10; i++)); do\n    echo $i\ndone\n\n# \u904d\u5386\u6587\u4ef6\nfor file in *.txt; do\n    echo "\u5904\u7406: $file"\ndone\n\n# \u904d\u5386\u6570\u7ec4\nfiles=(file1.txt file2.txt file3.txt)\nfor file in "${files[@]}"; do\n    echo $file\ndone\n'})}),"\n",(0,s.jsx)(e.h3,{id:"while-\u5faa\u73af",children:"while \u5faa\u73af"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\ncount=1\nwhile [ $count -le 5 ]; do\n    echo "\u8ba1\u6570: $count"\n    ((count++))\ndone\n\n# \u8bfb\u53d6\u6587\u4ef6\nwhile IFS= read -r line; do\n    echo "\u884c\u5185\u5bb9: $line"\ndone < file.txt\n'})}),"\n",(0,s.jsx)(e.h3,{id:"until-\u5faa\u73af",children:"until \u5faa\u73af"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\ncount=1\nuntil [ $count -gt 5 ]; do\n    echo "\u8ba1\u6570: $count"\n    ((count++))\ndone\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u51fd\u6570",children:"\u51fd\u6570"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u5b9a\u4e49\u51fd\u6570\nfunction greet() {\n    echo "Hello, $1!"\n}\n\n# \u53e6\u4e00\u79cd\u5b9a\u4e49\u65b9\u5f0f\nsay_bye() {\n    echo "Goodbye, $1!"\n}\n\n# \u8c03\u7528\u51fd\u6570\ngreet "Alice"\nsay_bye "Bob"\n\n# \u8fd4\u56de\u503c\nadd() {\n    local result=$(($1 + $2))\n    echo $result\n}\n\nsum=$(add 5 3)\necho "Sum: $sum"\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u6570\u7ec4",children:"\u6570\u7ec4"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u5b9a\u4e49\u6570\u7ec4\nfruits=("apple" "banana" "orange")\n\n# \u8bbf\u95ee\u5143\u7d20\necho ${fruits[0]}\necho ${fruits[1]}\n\n# \u6240\u6709\u5143\u7d20\necho ${fruits[@]}\n\n# \u6570\u7ec4\u957f\u5ea6\necho ${#fruits[@]}\n\n# \u6dfb\u52a0\u5143\u7d20\nfruits+=("grape")\n\n# \u904d\u5386\u6570\u7ec4\nfor fruit in "${fruits[@]}"; do\n    echo $fruit\ndone\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u8f93\u5165\u8f93\u51fa",children:"\u8f93\u5165\u8f93\u51fa"}),"\n",(0,s.jsx)(e.h3,{id:"\u8bfb\u53d6\u8f93\u5165",children:"\u8bfb\u53d6\u8f93\u5165"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\necho "\u8bf7\u8f93\u5165\u4f60\u7684\u540d\u5b57:"\nread name\necho "\u4f60\u597d, $name!"\n\n# \u4e0d\u663e\u793a\u8f93\u5165\uff08\u5bc6\u7801\uff09\nread -s -p "\u8bf7\u8f93\u5165\u5bc6\u7801: " password\necho\n\n# \u8d85\u65f6\nread -t 5 -p "5\u79d2\u5185\u8f93\u5165: " input\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u91cd\u5b9a\u5411",children:"\u91cd\u5b9a\u5411"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u8f93\u51fa\u91cd\u5b9a\u5411\necho "Hello" > output.txt      # \u8986\u76d6\necho "World" >> output.txt     # \u8ffd\u52a0\n\n# \u8f93\u5165\u91cd\u5b9a\u5411\nwhile read line; do\n    echo $line\ndone < input.txt\n\n# \u9519\u8bef\u91cd\u5b9a\u5411\ncommand 2> error.log\ncommand &> all.log\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u5b9e\u7528\u811a\u672c\u793a\u4f8b",children:"\u5b9e\u7528\u811a\u672c\u793a\u4f8b"}),"\n",(0,s.jsx)(e.h3,{id:"\u5907\u4efd\u811a\u672c",children:"\u5907\u4efd\u811a\u672c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u5907\u4efd\u76ee\u5f55\nSOURCE="/home/user/documents"\nDEST="/backup"\nDATE=$(date +%Y%m%d)\nBACKUP_FILE="backup_$DATE.tar.gz"\n\n# \u521b\u5efa\u5907\u4efd\ntar -czf "$DEST/$BACKUP_FILE" "$SOURCE"\n\n# \u68c0\u67e5\u662f\u5426\u6210\u529f\nif [ $? -eq 0 ]; then\n    echo "\u5907\u4efd\u6210\u529f: $BACKUP_FILE"\nelse\n    echo "\u5907\u4efd\u5931\u8d25" >&2\n    exit 1\nfi\n\n# \u5220\u9664\u65e7\u5907\u4efd\uff08\u4fdd\u75597\u5929\uff09\nfind "$DEST" -name "backup_*.tar.gz" -mtime +7 -delete\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u7cfb\u7edf\u76d1\u63a7\u811a\u672c",children:"\u7cfb\u7edf\u76d1\u63a7\u811a\u672c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\n# CPU\u4f7f\u7528\u7387\nCPU=$(top -bn1 | grep "Cpu(s)" | awk \'{print $2}\' | cut -d\'%\' -f1)\n\n# \u5185\u5b58\u4f7f\u7528\u7387\nMEM=$(free | grep Mem | awk \'{print ($3/$2) * 100.0}\')\n\n# \u78c1\u76d8\u4f7f\u7528\u7387\nDISK=$(df -h / | tail -1 | awk \'{print $5}\' | tr -d \'%\')\n\necho "=== \u7cfb\u7edf\u72b6\u6001 ==="\necho "CPU: $CPU%"\necho "\u5185\u5b58: ${MEM}%"\necho "\u78c1\u76d8: $DISK%"\n\n# \u53d1\u9001\u544a\u8b66\nif [ $(echo "$CPU > 80" | bc) -eq 1 ]; then\n    echo "\u8b66\u544a: CPU\u4f7f\u7528\u7387\u8fc7\u9ad8\uff01"\nfi\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u6279\u91cf\u91cd\u547d\u540d",children:"\u6279\u91cf\u91cd\u547d\u540d"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u6279\u91cf\u6dfb\u52a0\u524d\u7f00\nfor file in *.jpg; do\n    mv "$file" "photo_$file"\ndone\n\n# \u6279\u91cf\u4fee\u6539\u6269\u5c55\u540d\nfor file in *.jpeg; do\n    mv "$file" "${file%.jpeg}.jpg"\ndone\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u8c03\u8bd5\u6280\u5de7",children:"\u8c03\u8bd5\u6280\u5de7"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u663e\u793a\u6267\u884c\u7684\u547d\u4ee4\nbash -x script.sh\n\n# \u5728\u811a\u672c\u4e2d\u542f\u7528\u8c03\u8bd5\n#!/bin/bash\nset -x  # \u5f00\u542f\nset +x  # \u5173\u95ed\n\n# \u9047\u5230\u9519\u8bef\u7acb\u5373\u9000\u51fa\nset -e\n\n# \u53d8\u91cf\u672a\u5b9a\u4e49\u65f6\u62a5\u9519\nset -u\n\n# \u7ba1\u9053\u9519\u8bef\u65f6\u9000\u51fa\nset -o pipefail\n\n# \u7ec4\u5408\u4f7f\u7528\nset -euo pipefail\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,s.jsx)(e.h3,{id:"1-\u811a\u672c\u6a21\u677f",children:"1. \u811a\u672c\u6a21\u677f"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\nset -euo pipefail\n\n# \u811a\u672c\u8bf4\u660e\n# \u7528\u9014\uff1a...\n# \u4f5c\u8005\uff1a...\n# \u65e5\u671f\uff1a...\n\n# \u53d8\u91cf\u5b9a\u4e49\nSCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"\nLOG_FILE="/var/log/myscript.log"\n\n# \u51fd\u6570\u5b9a\u4e49\nlog() {\n    echo "[$(date +\'%Y-%m-%d %H:%M:%S\')] $*" | tee -a "$LOG_FILE"\n}\n\ncleanup() {\n    log "\u6e05\u7406\u4e2d..."\n}\n\ntrap cleanup EXIT\n\n# \u4e3b\u903b\u8f91\nmain() {\n    log "\u811a\u672c\u5f00\u59cb"\n    # ...\n    log "\u811a\u672c\u7ed3\u675f"\n}\n\nmain "$@"\n'})}),"\n",(0,s.jsx)(e.h3,{id:"2-\u9519\u8bef\u5904\u7406",children:"2. \u9519\u8bef\u5904\u7406"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\ncommand || {\n    echo "\u547d\u4ee4\u5931\u8d25" >&2\n    exit 1\n}\n\n# \u68c0\u67e5\u547d\u4ee4\u662f\u5426\u5b58\u5728\nif ! command -v curl &> /dev/null; then\n    echo "curl \u672a\u5b89\u88c5" >&2\n    exit 1\nfi\n'})}),"\n",(0,s.jsx)(e.h3,{id:"3-\u53c2\u6570\u89e3\u6790",children:"3. \u53c2\u6570\u89e3\u6790"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\nusage() {\n    echo "\u7528\u6cd5: $0 [-h] [-f file] [-v]"\n    exit 1\n}\n\nwhile getopts "hf:v" opt; do\n    case $opt in\n        h) usage ;;\n        f) FILE="$OPTARG" ;;\n        v) VERBOSE=1 ;;\n        *) usage ;;\n    esac\ndone\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u6587\u672c\u5904\u7406\u4e09\u5251\u5ba2",children:"\u6587\u672c\u5904\u7406\u4e09\u5251\u5ba2"}),"\n",(0,s.jsx)(e.h3,{id:"grep-\u9ad8\u7ea7\u7528\u6cd5",children:"grep \u9ad8\u7ea7\u7528\u6cd5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n\n# \u57fa\u672c\u641c\u7d22\ngrep "pattern" file.txt\ngrep -i "pattern" file.txt      # \u5ffd\u7565\u5927\u5c0f\u5199\ngrep -r "pattern" /path/        # \u9012\u5f52\u641c\u7d22\ngrep -n "pattern" file.txt      # \u663e\u793a\u884c\u53f7\ngrep -v "pattern" file.txt      # \u53cd\u5411\u5339\u914d\n\n# \u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\ngrep -E "pattern1|pattern2" file.txt    # \u6269\u5c55\u6b63\u5219\ngrep -P "pattern" file.txt               # Perl\u6b63\u5219\n\n# \u5e38\u7528\u793a\u4f8b\ngrep -E "^[0-9]+" file.txt               # \u4ee5\u6570\u5b57\u5f00\u5934\u7684\u884c\ngrep -E "error|warning" /var/log/syslog  # \u641c\u7d22\u9519\u8bef\u6216\u8b66\u544a\ngrep -o "[0-9]\\+\\.[0-9]\\+\\.[0-9]\\+\\.[0-9]\\+" access.log  # \u63d0\u53d6IP\u5730\u5740\n\n# \u4e0a\u4e0b\u6587\u663e\u793a\ngrep -A 3 "error" file.txt    # \u663e\u793a\u5339\u914d\u884c\u540e3\u884c\ngrep -B 3 "error" file.txt    # \u663e\u793a\u5339\u914d\u884c\u524d3\u884c\ngrep -C 3 "error" file.txt    # \u663e\u793a\u5339\u914d\u884c\u524d\u540e\u54043\u884c\n'})}),"\n",(0,s.jsx)(e.h3,{id:"sed-\u6d41\u7f16\u8f91\u5668",children:"sed \u6d41\u7f16\u8f91\u5668"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"#!/bin/bash\n\n# \u57fa\u672c\u66ff\u6362\nsed 's/old/new/' file.txt           # \u66ff\u6362\u7b2c\u4e00\u4e2a\u5339\u914d\nsed 's/old/new/g' file.txt          # \u66ff\u6362\u6240\u6709\u5339\u914d\nsed -i 's/old/new/g' file.txt       # \u76f4\u63a5\u4fee\u6539\u6587\u4ef6\n\n# \u5220\u9664\u64cd\u4f5c\nsed '/pattern/d' file.txt           # \u5220\u9664\u5339\u914d\u884c\nsed '1d' file.txt                   # \u5220\u9664\u7b2c\u4e00\u884c\nsed '$d' file.txt                   # \u5220\u9664\u6700\u540e\u4e00\u884c\nsed '1,5d' file.txt                 # \u5220\u96641-5\u884c\n\n# \u63d2\u5165\u548c\u8ffd\u52a0\nsed '3i\\\u63d2\u5165\u7684\u6587\u672c' file.txt         # \u5728\u7b2c3\u884c\u524d\u63d2\u5165\nsed '3a\\\u8ffd\u52a0\u7684\u6587\u672c' file.txt         # \u5728\u7b2c3\u884c\u540e\u8ffd\u52a0\n\n# \u6253\u5370\u64cd\u4f5c\nsed -n '5p' file.txt                # \u6253\u5370\u7b2c5\u884c\nsed -n '5,10p' file.txt             # \u6253\u53705-10\u884c\nsed -n '/pattern/p' file.txt        # \u6253\u5370\u5339\u914d\u884c\n\n# \u5b9e\u7528\u793a\u4f8b\n# \u5220\u9664\u7a7a\u884c\nsed '/^$/d' file.txt\n\n# \u5220\u9664\u6ce8\u91ca\u884c\nsed '/^#/d' config.conf\n\n# \u5728\u6bcf\u884c\u672b\u5c3e\u6dfb\u52a0\u5185\u5bb9\nsed 's/$/;/' file.txt\n\n# \u66ff\u6362\u591a\u4e2a\u6a21\u5f0f\nsed -e 's/foo/bar/g' -e 's/baz/qux/g' file.txt\n"})}),"\n",(0,s.jsx)(e.h3,{id:"awk-\u6587\u672c\u5904\u7406",children:"awk \u6587\u672c\u5904\u7406"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"#!/bin/bash\n\n# \u57fa\u672c\u8bed\u6cd5\uff1aawk 'pattern { action }' file\n\n# \u6253\u5370\u7279\u5b9a\u5217\nawk '{print $1}' file.txt           # \u7b2c\u4e00\u5217\nawk '{print $1, $3}' file.txt       # \u7b2c\u4e00\u548c\u7b2c\u4e09\u5217\nawk '{print $NF}' file.txt          # \u6700\u540e\u4e00\u5217\n\n# \u5b57\u6bb5\u5206\u9694\u7b26\nawk -F':' '{print $1}' /etc/passwd  # \u7528\u5192\u53f7\u5206\u9694\nawk -F',' '{print $2}' data.csv     # \u7528\u9017\u53f7\u5206\u9694\n\n# \u6761\u4ef6\u8fc7\u6ee4\nawk '$3 > 100' data.txt             # \u7b2c\u4e09\u5217\u5927\u4e8e100\nawk '/pattern/' file.txt            # \u5305\u542bpattern\u7684\u884c\nawk '$1 == \"value\"' file.txt        # \u7b2c\u4e00\u5217\u7b49\u4e8evalue\n\n# \u5185\u7f6e\u53d8\u91cf\nawk '{print NR, $0}' file.txt       # NR: \u884c\u53f7\nawk '{print NF}' file.txt           # NF: \u5b57\u6bb5\u6570\nawk 'END{print NR}' file.txt        # \u603b\u884c\u6570\n\n# \u8ba1\u7b97\u7edf\u8ba1\nawk '{sum+=$1} END{print sum}' numbers.txt              # \u6c42\u548c\nawk '{sum+=$1} END{print sum/NR}' numbers.txt           # \u5e73\u5747\u503c\nawk 'NR==1{max=$1} $1>max{max=$1} END{print max}' file  # \u6700\u5927\u503c\n\n# \u683c\u5f0f\u5316\u8f93\u51fa\nawk '{printf \"%-10s %5d\\n\", $1, $2}' file.txt\n\n# \u5b9e\u7528\u793a\u4f8b\n# \u7edf\u8ba1\u6bcf\u4e2a\u7528\u6237\u7684\u8fdb\u7a0b\u6570\nps aux | awk '{count[$1]++} END{for(user in count) print user, count[user]}'\n\n# \u63d0\u53d6\u65e5\u5fd7\u4e2d\u7684IP\u5730\u5740\u5e76\u7edf\u8ba1\u8bbf\u95ee\u6b21\u6570\nawk '{print $1}' access.log | sort | uniq -c | sort -rn | head -10\n\n# \u8ba1\u7b97\u6587\u4ef6\u5927\u5c0f\u603b\u548c\nls -l | awk '{sum+=$5} END{print sum}'\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u6b63\u5219\u8868\u8fbe\u5f0f",children:"\u6b63\u5219\u8868\u8fbe\u5f0f"}),"\n",(0,s.jsx)(e.h3,{id:"\u57fa\u672c\u6b63\u5219\u8868\u8fbe\u5f0f",children:"\u57fa\u672c\u6b63\u5219\u8868\u8fbe\u5f0f"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u5b57\u7b26\u5339\u914d\n.       # \u4efb\u610f\u5355\u4e2a\u5b57\u7b26\n*       # \u524d\u4e00\u4e2a\u5b57\u7b260\u6b21\u6216\u591a\u6b21\n^       # \u884c\u9996\n$       # \u884c\u5c3e\n[]      # \u5b57\u7b26\u96c6\u5408\n[^]     # \u4e0d\u5728\u96c6\u5408\u4e2d\u7684\u5b57\u7b26\n\n# \u793a\u4f8b\n^hello      # \u4ee5hello\u5f00\u5934\nworld$      # \u4ee5world\u7ed3\u5c3e\nh.llo       # h\u540e\u8ddf\u4efb\u610f\u5b57\u7b26\u518d\u8ddfllo\ncolou*r     # color \u6216 colour\n[aeiou]     # \u4efb\u610f\u5143\u97f3\u5b57\u6bcd\n[0-9]       # \u4efb\u610f\u6570\u5b57\n[^0-9]      # \u975e\u6570\u5b57\u5b57\u7b26\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f",children:"\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u4f7f\u7528 grep -E \u6216 egrep\n\n+       # \u524d\u4e00\u4e2a\u5b57\u7b261\u6b21\u6216\u591a\u6b21\n?       # \u524d\u4e00\u4e2a\u5b57\u7b260\u6b21\u62161\u6b21\n{n}     # \u6070\u597dn\u6b21\n{n,}    # \u81f3\u5c11n\u6b21\n{n,m}   # n\u5230m\u6b21\n|       # \u6216\n()      # \u5206\u7ec4\n\n# \u793a\u4f8b\n[0-9]+          # \u4e00\u4e2a\u6216\u591a\u4e2a\u6570\u5b57\nhttps?          # http \u6216 https\ncolou?r         # color \u6216 colour\n[0-9]{3}        # \u6070\u597d3\u4e2a\u6570\u5b57\n[0-9]{1,3}      # 1\u52303\u4e2a\u6570\u5b57\ncat|dog         # cat \u6216 dog\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u5b9e\u7528\u6b63\u5219\u8868\u8fbe\u5f0f",children:"\u5b9e\u7528\u6b63\u5219\u8868\u8fbe\u5f0f"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# IP\u5730\u5740\n[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\n\n# \u90ae\u7bb1\u5730\u5740\uff08\u7b80\u5316\u7248\uff09\n[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}\n\n# \u624b\u673a\u53f7\uff08\u4e2d\u56fd\uff09\n1[3-9][0-9]{9}\n\n# \u65e5\u671f\u683c\u5f0f YYYY-MM-DD\n[0-9]{4}-[0-9]{2}-[0-9]{2}\n\n# URL\nhttps?://[a-zA-Z0-9.-]+(/[a-zA-Z0-9./?&=_-]*)?\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u5b9e\u7528\u811a\u672c\u6848\u4f8b",children:"\u5b9e\u7528\u811a\u672c\u6848\u4f8b"}),"\n",(0,s.jsx)(e.h3,{id:"\u65e5\u5fd7\u5206\u6790\u811a\u672c",children:"\u65e5\u5fd7\u5206\u6790\u811a\u672c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n# \u5206\u6790 Nginx \u8bbf\u95ee\u65e5\u5fd7\n\nLOG_FILE="/var/log/nginx/access.log"\n\necho "=== \u8bbf\u95ee\u7edf\u8ba1 ==="\n\n# \u603b\u8bf7\u6c42\u6570\necho "\u603b\u8bf7\u6c42\u6570: $(wc -l < "$LOG_FILE")"\n\n# Top 10 IP\necho -e "\\n=== Top 10 \u8bbf\u95eeIP ==="\nawk \'{print $1}\' "$LOG_FILE" | sort | uniq -c | sort -rn | head -10\n\n# HTTP\u72b6\u6001\u7801\u7edf\u8ba1\necho -e "\\n=== HTTP\u72b6\u6001\u7801\u7edf\u8ba1 ==="\nawk \'{print $9}\' "$LOG_FILE" | sort | uniq -c | sort -rn\n\n# \u6700\u5e38\u8bbf\u95ee\u7684URL\necho -e "\\n=== Top 10 \u8bbf\u95eeURL ==="\nawk \'{print $7}\' "$LOG_FILE" | sort | uniq -c | sort -rn | head -10\n\n# \u6bcf\u5c0f\u65f6\u8bf7\u6c42\u6570\necho -e "\\n=== \u6bcf\u5c0f\u65f6\u8bf7\u6c42\u5206\u5e03 ==="\nawk \'{print substr($4,14,2)}\' "$LOG_FILE" | sort | uniq -c\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u6279\u91cf\u6587\u4ef6\u5904\u7406",children:"\u6279\u91cf\u6587\u4ef6\u5904\u7406"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n# \u6279\u91cf\u91cd\u547d\u540d\u548c\u5904\u7406\u6587\u4ef6\n\n# \u6279\u91cf\u6dfb\u52a0\u65e5\u671f\u524d\u7f00\nfor file in *.log; do\n    date_prefix=$(date +%Y%m%d)\n    mv "$file" "${date_prefix}_${file}"\ndone\n\n# \u6279\u91cf\u8f6c\u6362\u6587\u4ef6\u7f16\u7801\nfor file in *.txt; do\n    iconv -f GBK -t UTF-8 "$file" -o "${file%.txt}_utf8.txt"\ndone\n\n# \u6279\u91cf\u538b\u7f29\u65e7\u6587\u4ef6\nfind /var/log -name "*.log" -mtime +7 -exec gzip {} \\;\n\n# \u6279\u91cf\u66ff\u6362\u6587\u4ef6\u5185\u5bb9\nfind . -name "*.conf" -exec sed -i \'s/old_value/new_value/g\' {} \\;\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u7cfb\u7edf\u76d1\u63a7\u811a\u672c-1",children:"\u7cfb\u7edf\u76d1\u63a7\u811a\u672c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n# \u7cfb\u7edf\u8d44\u6e90\u76d1\u63a7\n\nTHRESHOLD_CPU=80\nTHRESHOLD_MEM=80\nTHRESHOLD_DISK=90\nALERT_EMAIL="admin@example.com"\n\ncheck_cpu() {\n    cpu_usage=$(top -bn1 | grep "Cpu(s)" | awk \'{print int($2)}\')\n    if [ "$cpu_usage" -gt "$THRESHOLD_CPU" ]; then\n        echo "\u8b66\u544a: CPU\u4f7f\u7528\u7387\u8fc7\u9ad8 (${cpu_usage}%)"\n    fi\n}\n\ncheck_memory() {\n    mem_usage=$(free | awk \'/Mem/{printf("%.0f", $3/$2*100)}\')\n    if [ "$mem_usage" -gt "$THRESHOLD_MEM" ]; then\n        echo "\u8b66\u544a: \u5185\u5b58\u4f7f\u7528\u7387\u8fc7\u9ad8 (${mem_usage}%)"\n    fi\n}\n\ncheck_disk() {\n    df -h | awk \'NR>1{gsub(/%/,"",$5); if($5>\'"$THRESHOLD_DISK"\') print "\u8b66\u544a: \u78c1\u76d8"$6"\u4f7f\u7528\u7387\u8fc7\u9ad8 ("$5"%)"}\'\n}\n\necho "=== \u7cfb\u7edf\u76d1\u63a7\u62a5\u544a $(date) ==="\ncheck_cpu\ncheck_memory\ncheck_disk\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,s.jsx)(e.p,{children:"\u672c\u6587\u4ecb\u7ecd\u4e86 Shell \u811a\u672c\u7f16\u7a0b\uff1a"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u2705 \u53d8\u91cf\u548c\u53c2\u6570"}),"\n",(0,s.jsx)(e.li,{children:"\u2705 \u6761\u4ef6\u5224\u65ad\u548c\u5faa\u73af"}),"\n",(0,s.jsx)(e.li,{children:"\u2705 \u51fd\u6570\u548c\u6570\u7ec4"}),"\n",(0,s.jsx)(e.li,{children:"\u2705 \u6587\u672c\u5904\u7406\u4e09\u5251\u5ba2\uff08grep/sed/awk\uff09"}),"\n",(0,s.jsx)(e.li,{children:"\u2705 \u6b63\u5219\u8868\u8fbe\u5f0f"}),"\n",(0,s.jsx)(e.li,{children:"\u2705 \u5b9e\u7528\u811a\u672c\u793a\u4f8b"}),"\n",(0,s.jsx)(e.li,{children:"\u2705 \u8c03\u8bd5\u548c\u6700\u4f73\u5b9e\u8df5"}),"\n"]}),"\n",(0,s.jsx)(e.p,{children:"\u8fd9\u4e9b\u662f Linux \u7684\u6838\u5fc3\u77e5\u8bc6\uff0c\u638c\u63e1\u540e\u53ef\u4ee5\u9ad8\u6548\u5730\u4f7f\u7528\u548c\u7ba1\u7406 Linux \u7cfb\u7edf\uff01"}),"\n",(0,s.jsxs)(e.p,{children:["\u7ee7\u7eed\u5b66\u4e60 ",(0,s.jsx)(e.a,{href:"/docs/linux/cron-scheduling",children:"\u5b9a\u65f6\u4efb\u52a1"})," \u548c ",(0,s.jsx)(e.a,{href:"/docs/linux/service-management",children:"\u670d\u52a1\u7ba1\u7406"}),"\u3002"]})]})}function o(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},48885:(n,e,l)=>{l.d(e,{R:()=>h,x:()=>t});var i=l(99378);const s={},a=i.createContext(s);function h(n){const e=i.useContext(a);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:h(n.components),i.createElement(a.Provider,{value:e},n.children)}}}]);