"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[61891],{48885:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>c});var i=r(99378);const s={},d=i.createContext(s);function l(e){const n=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(d.Provider,{value:n},e.children)}},81138:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"flink/flink-cdc","title":"Flink CDC","description":"Flink CDC \u53d8\u66f4\u6570\u636e\u6355\u83b7\u8be6\u89e3","source":"@site/docs/flink/flink-cdc.md","sourceDirName":"flink","slug":"/flink/flink-cdc","permalink":"/docs/flink/flink-cdc","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/flink/flink-cdc.md","tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"sidebar_position":13,"title":"Flink CDC","description":"Flink CDC \u53d8\u66f4\u6570\u636e\u6355\u83b7\u8be6\u89e3"},"sidebar":"flink","previous":{"title":"\u8fde\u63a5\u5668","permalink":"/docs/flink/connectors"},"next":{"title":"\u90e8\u7f72\u4e0e\u8fd0\u7ef4","permalink":"/docs/flink/deployment"}}');var s=r(22714),d=r(48885);const l={sidebar_position:13,title:"Flink CDC",description:"Flink CDC \u53d8\u66f4\u6570\u636e\u6355\u83b7\u8be6\u89e3"},c="Flink CDC",t={},a=[{value:"\u4ec0\u4e48\u662f Flink CDC\uff1f",id:"\u4ec0\u4e48\u662f-flink-cdc",level:2},{value:"\u6838\u5fc3\u4f18\u52bf",id:"\u6838\u5fc3\u4f18\u52bf",level:3},{value:"\u652f\u6301\u7684\u6570\u636e\u6e90",id:"\u652f\u6301\u7684\u6570\u636e\u6e90",level:2},{value:"\u6dfb\u52a0\u4f9d\u8d56",id:"\u6dfb\u52a0\u4f9d\u8d56",level:2},{value:"MySQL CDC \u914d\u7f6e",id:"mysql-cdc-\u914d\u7f6e",level:2},{value:"\u6570\u636e\u5e93\u51c6\u5907",id:"\u6570\u636e\u5e93\u51c6\u5907",level:3},{value:"my.cnf \u914d\u7f6e",id:"mycnf-\u914d\u7f6e",level:3},{value:"SQL \u65b9\u5f0f\u4f7f\u7528",id:"sql-\u65b9\u5f0f\u4f7f\u7528",level:2},{value:"\u521b\u5efa CDC \u6e90\u8868",id:"\u521b\u5efa-cdc-\u6e90\u8868",level:3},{value:"\u591a\u8868\u540c\u6b65",id:"\u591a\u8868\u540c\u6b65",level:3},{value:"\u5b9e\u65f6\u6570\u636e\u540c\u6b65",id:"\u5b9e\u65f6\u6570\u636e\u540c\u6b65",level:3},{value:"DataStream API \u4f7f\u7528",id:"datastream-api-\u4f7f\u7528",level:2},{value:"\u57fa\u7840\u7528\u6cd5",id:"\u57fa\u7840\u7528\u6cd5",level:3},{value:"\u81ea\u5b9a\u4e49\u53cd\u5e8f\u5217\u5316",id:"\u81ea\u5b9a\u4e49\u53cd\u5e8f\u5217\u5316",level:3},{value:"\u9ad8\u7ea7\u914d\u7f6e",id:"\u9ad8\u7ea7\u914d\u7f6e",level:2},{value:"\u542f\u52a8\u6a21\u5f0f",id:"\u542f\u52a8\u6a21\u5f0f",level:3},{value:"\u5206\u7247\u5e76\u884c\u8bfb\u53d6",id:"\u5206\u7247\u5e76\u884c\u8bfb\u53d6",level:3},{value:"\u5fc3\u8df3\u914d\u7f6e",id:"\u5fc3\u8df3\u914d\u7f6e",level:3},{value:"\u5b9e\u6218\u6848\u4f8b",id:"\u5b9e\u6218\u6848\u4f8b",level:2},{value:"\u5b9e\u65f6\u6570\u636e\u540c\u6b65\u5230\u6570\u636e\u4ed3\u5e93",id:"\u5b9e\u65f6\u6570\u636e\u540c\u6b65\u5230\u6570\u636e\u4ed3\u5e93",level:3},{value:"\u5b9e\u65f6\u5bbd\u8868\u6784\u5efa",id:"\u5b9e\u65f6\u5bbd\u8868\u6784\u5efa",level:3},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2},{value:"\u6027\u80fd\u4f18\u5316",id:"\u6027\u80fd\u4f18\u5316",level:3},{value:"\u6ce8\u610f\u4e8b\u9879",id:"\u6ce8\u610f\u4e8b\u9879",level:3},{value:"\u4e0b\u4e00\u6b65",id:"\u4e0b\u4e00\u6b65",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"flink-cdc",children:"Flink CDC"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u9002\u7528\u7248\u672c\uff1aApache Flink v2.2.0"}),"\n"]}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"\u6ce8\u610f\uff1aFlink CDC \u8fde\u63a5\u5668\u4e0e Flink \u4e3b\u7248\u672c\u72ec\u7acb\u53d1\u5e03\uff0c\u4f9d\u8d56\u7248\u672c\u4e0e\u529f\u80fd\u652f\u6301\u8bf7\u4ee5\u5bf9\u5e94\u7ec4\u4ef6\u53d1\u5e03\u8bf4\u660e\u4e3a\u51c6\u3002"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u4ec0\u4e48\u662f-flink-cdc",children:"\u4ec0\u4e48\u662f Flink CDC\uff1f"}),"\n",(0,s.jsx)(n.p,{children:"Flink CDC\uff08Change Data Capture\uff09\u662f\u57fa\u4e8e\u6570\u636e\u5e93\u65e5\u5fd7\u7684\u53d8\u66f4\u6570\u636e\u6355\u83b7\u5de5\u5177\uff0c\u53ef\u4ee5\u5b9e\u65f6\u5c06\u6570\u636e\u5e93\u53d8\u66f4\u540c\u6b65\u5230 Flink \u8fdb\u884c\u5904\u7406\u3002"}),"\n",(0,s.jsx)(n.h3,{id:"\u6838\u5fc3\u4f18\u52bf",children:"\u6838\u5fc3\u4f18\u52bf"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5b9e\u65f6\u6027"}),"\uff1a\u6beb\u79d2\u7ea7\u6570\u636e\u540c\u6b65"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5168\u91cf+\u589e\u91cf"}),"\uff1a\u81ea\u52a8\u5207\u6362\uff0c\u65e0\u9700\u624b\u52a8\u5e72\u9884"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u7cbe\u786e\u4e00\u6b21"}),"\uff1a\u4fdd\u8bc1\u6570\u636e\u4e00\u81f4\u6027"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u65e0\u4fb5\u5165"}),"\uff1a\u4e0d\u5f71\u54cd\u6e90\u6570\u636e\u5e93\u6027\u80fd"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u652f\u6301\u7684\u6570\u636e\u6e90",children:"\u652f\u6301\u7684\u6570\u636e\u6e90"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u6570\u636e\u6e90"}),(0,s.jsx)(n.th,{children:"\u7248\u672c\u652f\u6301"}),(0,s.jsx)(n.th,{children:"\u7279\u6027"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"MySQL"})}),(0,s.jsx)(n.td,{children:"5.6, 5.7, 8.0"}),(0,s.jsx)(n.td,{children:"\u5168\u91cf+\u589e\u91cf\uff0c\u652f\u6301\u6240\u6709\u7c7b\u578b"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"PostgreSQL"})}),(0,s.jsx)(n.td,{children:"9.6+"}),(0,s.jsx)(n.td,{children:"\u903b\u8f91\u590d\u5236"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Oracle"})}),(0,s.jsx)(n.td,{children:"11, 12, 19"}),(0,s.jsx)(n.td,{children:"LogMiner / XStream"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"MongoDB"})}),(0,s.jsx)(n.td,{children:"3.6+"}),(0,s.jsx)(n.td,{children:"Change Streams"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"SQL Server"})}),(0,s.jsx)(n.td,{children:"2012+"}),(0,s.jsx)(n.td,{children:"CDC \u529f\u80fd"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"TiDB"})}),(0,s.jsx)(n.td,{children:"4.0+"}),(0,s.jsx)(n.td,{children:"TiCDC \u517c\u5bb9"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"\u6dfb\u52a0\u4f9d\u8d56",children:"\u6dfb\u52a0\u4f9d\u8d56"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- MySQL CDC --\x3e\n<dependency>\n    <groupId>com.ververica</groupId>\n    <artifactId>flink-connector-mysql-cdc</artifactId>\n    <version>2.4.0</version>\n</dependency>\n\n\x3c!-- PostgreSQL CDC --\x3e\n<dependency>\n    <groupId>com.ververica</groupId>\n    <artifactId>flink-connector-postgres-cdc</artifactId>\n    <version>2.4.0</version>\n</dependency>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"mysql-cdc-\u914d\u7f6e",children:"MySQL CDC \u914d\u7f6e"}),"\n",(0,s.jsx)(n.h3,{id:"\u6570\u636e\u5e93\u51c6\u5907",children:"\u6570\u636e\u5e93\u51c6\u5907"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- \u521b\u5efa CDC \u7528\u6237\nCREATE USER 'flink'@'%' IDENTIFIED BY 'password';\n\n-- \u6388\u6743\nGRANT SELECT, RELOAD, SHOW DATABASES, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO 'flink'@'%';\nFLUSH PRIVILEGES;\n\n-- \u68c0\u67e5 binlog \u914d\u7f6e\nSHOW VARIABLES LIKE 'log_bin';           -- \u5e94\u4e3a ON\nSHOW VARIABLES LIKE 'binlog_format';     -- \u5e94\u4e3a ROW\nSHOW VARIABLES LIKE 'binlog_row_image';  -- \u5e94\u4e3a FULL\n"})}),"\n",(0,s.jsx)(n.h3,{id:"mycnf-\u914d\u7f6e",children:"my.cnf \u914d\u7f6e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"[mysqld]\nserver-id = 1\nlog_bin = mysql-bin\nbinlog_format = ROW\nbinlog_row_image = FULL\nexpire_logs_days = 3\n"})}),"\n",(0,s.jsx)(n.h2,{id:"sql-\u65b9\u5f0f\u4f7f\u7528",children:"SQL \u65b9\u5f0f\u4f7f\u7528"}),"\n",(0,s.jsx)(n.h3,{id:"\u521b\u5efa-cdc-\u6e90\u8868",children:"\u521b\u5efa CDC \u6e90\u8868"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE orders (\n    order_id INT,\n    user_id INT,\n    product_name STRING,\n    price DECIMAL(10, 2),\n    order_status STRING,\n    create_time TIMESTAMP(3),\n    update_time TIMESTAMP(3),\n    PRIMARY KEY (order_id) NOT ENFORCED\n) WITH (\n    'connector' = 'mysql-cdc',\n    'hostname' = 'localhost',\n    'port' = '3306',\n    'username' = 'flink',\n    'password' = 'password',\n    'database-name' = 'mydb',\n    'table-name' = 'orders',\n    'server-time-zone' = 'Asia/Shanghai'\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u591a\u8868\u540c\u6b65",children:"\u591a\u8868\u540c\u6b65"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- \u4f7f\u7528\u6b63\u5219\u5339\u914d\u591a\u8868\nCREATE TABLE all_orders (\n    db_name STRING METADATA FROM 'database_name' VIRTUAL,\n    table_name STRING METADATA FROM 'table_name' VIRTUAL,\n    order_id INT,\n    user_id INT,\n    amount DECIMAL(10, 2),\n    PRIMARY KEY (order_id) NOT ENFORCED\n) WITH (\n    'connector' = 'mysql-cdc',\n    'hostname' = 'localhost',\n    'port' = '3306',\n    'username' = 'flink',\n    'password' = 'password',\n    'database-name' = 'shop_.*',\n    'table-name' = 'orders'\n);\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u5b9e\u65f6\u6570\u636e\u540c\u6b65",children:"\u5b9e\u65f6\u6570\u636e\u540c\u6b65"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- \u540c\u6b65\u5230 Kafka\nINSERT INTO kafka_orders\nSELECT * FROM orders;\n\n-- \u540c\u6b65\u5230 ClickHouse\nINSERT INTO clickhouse_orders\nSELECT order_id, user_id, price, order_status, create_time\nFROM orders;\n\n-- \u540c\u6b65\u5230 Elasticsearch\nINSERT INTO es_orders\nSELECT order_id, user_id, product_name, price\nFROM orders\nWHERE order_status = 'COMPLETED';\n"})}),"\n",(0,s.jsx)(n.h2,{id:"datastream-api-\u4f7f\u7528",children:"DataStream API \u4f7f\u7528"}),"\n",(0,s.jsx)(n.h3,{id:"\u57fa\u7840\u7528\u6cd5",children:"\u57fa\u7840\u7528\u6cd5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'import com.ververica.cdc.connectors.mysql.source.MySqlSource;\nimport com.ververica.cdc.debezium.JsonDebeziumDeserializationSchema;\n\nMySqlSource<String> source = MySqlSource.<String>builder()\n    .hostname("localhost")\n    .port(3306)\n    .databaseList("mydb")\n    .tableList("mydb.orders")\n    .username("flink")\n    .password("password")\n    .deserializer(new JsonDebeziumDeserializationSchema())\n    .build();\n\nDataStreamSource<String> stream = env.fromSource(\n    source,\n    WatermarkStrategy.noWatermarks(),\n    "MySQL CDC Source"\n);\n\nstream.print();\nenv.execute("MySQL CDC Job");\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49\u53cd\u5e8f\u5217\u5316",children:"\u81ea\u5b9a\u4e49\u53cd\u5e8f\u5217\u5316"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public class OrderDeserializer\n        implements DebeziumDeserializationSchema<Order> {\n\n    @Override\n    public void deserialize(SourceRecord record, Collector<Order> out) {\n        Struct value = (Struct) record.value();\n        String op = value.getString("op"); // c=create, u=update, d=delete\n\n        Struct after = value.getStruct("after");\n        if (after != null) {\n            Order order = new Order();\n            order.setOrderId(after.getInt32("order_id"));\n            order.setUserId(after.getInt32("user_id"));\n            order.setAmount(after.getFloat64("amount"));\n            order.setOperation(op);\n            out.collect(order);\n        }\n    }\n\n    @Override\n    public TypeInformation<Order> getProducedType() {\n        return TypeInformation.of(Order.class);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\u9ad8\u7ea7\u914d\u7f6e",children:"\u9ad8\u7ea7\u914d\u7f6e"}),"\n",(0,s.jsx)(n.h3,{id:"\u542f\u52a8\u6a21\u5f0f",children:"\u542f\u52a8\u6a21\u5f0f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'MySqlSource.<String>builder()\n    // \u521d\u59cb\u8bfb\u53d6\uff1a\u5168\u91cf + \u589e\u91cf\n    .startupOptions(StartupOptions.initial())\n\n    // \u4ece\u6700\u65b0\u4f4d\u7f6e\u5f00\u59cb\uff08\u8df3\u8fc7\u5168\u91cf\uff09\n    .startupOptions(StartupOptions.latest())\n\n    // \u4ece\u6307\u5b9a\u65f6\u95f4\u6233\u5f00\u59cb\n    .startupOptions(StartupOptions.timestamp(1678886400000L))\n\n    // \u4ece\u6307\u5b9a binlog \u4f4d\u7f6e\u5f00\u59cb\n    .startupOptions(StartupOptions.specificOffset("mysql-bin.000003", 4L))\n    .build();\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u5206\u7247\u5e76\u884c\u8bfb\u53d6",children:"\u5206\u7247\u5e76\u884c\u8bfb\u53d6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'MySqlSource.<String>builder()\n    .hostname("localhost")\n    .port(3306)\n    .databaseList("mydb")\n    .tableList("mydb.orders")\n    .username("flink")\n    .password("password")\n    // \u5e76\u884c\u5feb\u7167\u8bfb\u53d6\n    .splitSize(8096)            // \u6bcf\u4e2a\u5206\u7247\u7684\u8bb0\u5f55\u6570\n    .fetchSize(1024)            // \u6bcf\u6b21\u62c9\u53d6\u7684\u8bb0\u5f55\u6570\n    .connectTimeout(Duration.ofSeconds(30))\n    .deserializer(new JsonDebeziumDeserializationSchema())\n    .build();\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u5fc3\u8df3\u914d\u7f6e",children:"\u5fc3\u8df3\u914d\u7f6e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE orders (...) WITH (\n    'connector' = 'mysql-cdc',\n    ...\n    'debezium.heartbeat.interval.ms' = '60000',\n    'debezium.snapshot.mode' = 'initial'\n);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5b9e\u6218\u6848\u4f8b",children:"\u5b9e\u6218\u6848\u4f8b"}),"\n",(0,s.jsx)(n.h3,{id:"\u5b9e\u65f6\u6570\u636e\u540c\u6b65\u5230\u6570\u636e\u4ed3\u5e93",children:"\u5b9e\u65f6\u6570\u636e\u540c\u6b65\u5230\u6570\u636e\u4ed3\u5e93"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- \u6e90\u8868\nCREATE TABLE source_orders (\n    id INT,\n    user_id INT,\n    amount DECIMAL(10,2),\n    status STRING,\n    created_at TIMESTAMP(3),\n    updated_at TIMESTAMP(3),\n    PRIMARY KEY (id) NOT ENFORCED\n) WITH (\n    'connector' = 'mysql-cdc',\n    'hostname' = 'mysql-prod',\n    'database-name' = 'ecommerce',\n    'table-name' = 'orders',\n    'username' = 'cdc_user',\n    'password' = 'password'\n);\n\n-- \u76ee\u6807\u8868\uff08ClickHouse\uff09\nCREATE TABLE sink_orders (\n    id INT,\n    user_id INT,\n    amount DECIMAL(10,2),\n    status STRING,\n    created_at TIMESTAMP(3),\n    updated_at TIMESTAMP(3),\n    PRIMARY KEY (id) NOT ENFORCED\n) WITH (\n    'connector' = 'jdbc',\n    'url' = 'jdbc:clickhouse://clickhouse:8123/analytics',\n    'table-name' = 'orders',\n    'driver' = 'com.clickhouse.jdbc.ClickHouseDriver'\n);\n\n-- \u5b9e\u65f6\u540c\u6b65\nINSERT INTO sink_orders SELECT * FROM source_orders;\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u5b9e\u65f6\u5bbd\u8868\u6784\u5efa",children:"\u5b9e\u65f6\u5bbd\u8868\u6784\u5efa"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sql",children:"-- \u8ba2\u5355\u4e3b\u8868\nCREATE TABLE orders (...) WITH ('connector' = 'mysql-cdc', ...);\n\n-- \u7528\u6237\u7ef4\u8868\nCREATE TABLE users (...) WITH ('connector' = 'jdbc', ...);\n\n-- \u5546\u54c1\u7ef4\u8868\nCREATE TABLE products (...) WITH ('connector' = 'jdbc', ...);\n\n-- \u6784\u5efa\u5bbd\u8868\nINSERT INTO order_wide_table\nSELECT\n    o.order_id,\n    o.order_time,\n    o.amount,\n    u.user_name,\n    u.user_level,\n    p.product_name,\n    p.category\nFROM orders o\nLEFT JOIN users FOR SYSTEM_TIME AS OF o.proc_time AS u\n    ON o.user_id = u.user_id\nLEFT JOIN products FOR SYSTEM_TIME AS OF o.proc_time AS p\n    ON o.product_id = p.product_id;\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,s.jsx)(n.h3,{id:"\u6027\u80fd\u4f18\u5316",children:"\u6027\u80fd\u4f18\u5316"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"// 1. \u5408\u7406\u8bbe\u7f6e\u5e76\u884c\u5ea6\nenv.setParallelism(4);\n\n// 2. \u914d\u7f6e RocksDB \u72b6\u6001\u540e\u7aef\nenv.setStateBackend(new EmbeddedRocksDBStateBackend());\n\n// 3. \u589e\u91cf\u68c0\u67e5\u70b9\nenv.getCheckpointConfig().enableUnalignedCheckpoints();\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u6ce8\u610f\u4e8b\u9879",children:"\u6ce8\u610f\u4e8b\u9879"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u95ee\u9898"}),(0,s.jsx)(n.th,{children:"\u89e3\u51b3\u65b9\u6848"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u5168\u91cf\u9636\u6bb5\u6162"}),(0,s.jsx)(n.td,{children:"\u589e\u52a0 splitSize\uff0c\u63d0\u9ad8\u5e76\u884c\u5ea6"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u5185\u5b58\u4e0d\u8db3"}),(0,s.jsx)(n.td,{children:"\u4f7f\u7528 RocksDB \u540e\u7aef"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u6570\u636e\u5ef6\u8fdf"}),(0,s.jsx)(n.td,{children:"\u68c0\u67e5\u6e90\u5e93\u8d1f\u8f7d\uff0c\u4f18\u5316\u7f51\u7edc"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u65ad\u70b9\u7eed\u4f20"}),(0,s.jsx)(n.td,{children:"\u542f\u7528\u68c0\u67e5\u70b9\uff0c\u914d\u7f6e\u72b6\u6001\u540e\u7aef"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"\u4e0b\u4e00\u6b65",children:"\u4e0b\u4e00\u6b65"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\ud83d\udd0c ",(0,s.jsx)(n.a,{href:"/docs/flink/connectors",children:"\u8fde\u63a5\u5668"})," - \u66f4\u591a\u8fde\u63a5\u5668\u914d\u7f6e"]}),"\n",(0,s.jsxs)(n.li,{children:["\ud83d\udcca ",(0,s.jsx)(n.a,{href:"/docs/flink/table-sql",children:"Table API & SQL"})," - SQL \u8be6\u89e3"]}),"\n",(0,s.jsxs)(n.li,{children:["\ud83d\ude80 ",(0,s.jsx)(n.a,{href:"/docs/flink/monitoring",children:"\u76d1\u63a7\u4e0e\u8fd0\u7ef4"})," - \u751f\u4ea7\u76d1\u63a7"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);