"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[3715],{48885:(e,n,p)=>{p.d(n,{R:()=>l,x:()=>c});var i=p(99378);const t={},s=i.createContext(t);function l(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),i.createElement(s.Provider,{value:n},e.children)}},64506:(e,n,p)=>{p.r(n),p.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>r});const i=JSON.parse('{"id":"ffmpeg/video-processing","title":"\u89c6\u9891\u5904\u7406","description":"FFmpeg \u89c6\u9891\u5904\u7406\u9ad8\u7ea7\u64cd\u4f5c","source":"@site/docs/ffmpeg/video-processing.md","sourceDirName":"ffmpeg","slug":"/ffmpeg/video-processing","permalink":"/docs/ffmpeg/video-processing","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ffmpeg/video-processing.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"\u89c6\u9891\u5904\u7406","description":"FFmpeg \u89c6\u9891\u5904\u7406\u9ad8\u7ea7\u64cd\u4f5c"},"sidebar":"ffmpeg","previous":{"title":"\u57fa\u7840\u547d\u4ee4","permalink":"/docs/ffmpeg/basic-commands"},"next":{"title":"\u97f3\u9891\u5904\u7406","permalink":"/docs/ffmpeg/audio-processing"}}');var t=p(22714),s=p(48885);const l={sidebar_position:4,title:"\u89c6\u9891\u5904\u7406",description:"FFmpeg \u89c6\u9891\u5904\u7406\u9ad8\u7ea7\u64cd\u4f5c"},c="FFmpeg \u89c6\u9891\u5904\u7406",o={},r=[{value:"\u89c6\u9891\u7f16\u7801",id:"\u89c6\u9891\u7f16\u7801",level:2},{value:"H.264 \u7f16\u7801",id:"h264-\u7f16\u7801",level:3},{value:"H.265/HEVC \u7f16\u7801",id:"h265hevc-\u7f16\u7801",level:3},{value:"\u786c\u4ef6\u52a0\u901f\u7f16\u7801",id:"\u786c\u4ef6\u52a0\u901f\u7f16\u7801",level:3},{value:"\u89c6\u9891\u753b\u9762\u5904\u7406",id:"\u89c6\u9891\u753b\u9762\u5904\u7406",level:2},{value:"\u88c1\u526a\u753b\u9762\uff08Crop\uff09",id:"\u88c1\u526a\u753b\u9762crop",level:3},{value:"\u586b\u5145\u753b\u9762\uff08Pad\uff09",id:"\u586b\u5145\u753b\u9762pad",level:3},{value:"\u65cb\u8f6c\u548c\u7ffb\u8f6c",id:"\u65cb\u8f6c\u548c\u7ffb\u8f6c",level:3},{value:"\u8c03\u6574\u901f\u5ea6",id:"\u8c03\u6574\u901f\u5ea6",level:3},{value:"\u89c6\u9891\u5408\u6210",id:"\u89c6\u9891\u5408\u6210",level:2},{value:"\u753b\u4e2d\u753b",id:"\u753b\u4e2d\u753b",level:3},{value:"\u591a\u89c6\u9891\u5e76\u6392",id:"\u591a\u89c6\u9891\u5e76\u6392",level:3},{value:"\u6dfb\u52a0\u6c34\u5370",id:"\u6dfb\u52a0\u6c34\u5370",level:3},{value:"\u89c6\u9891\u526a\u8f91",id:"\u89c6\u9891\u526a\u8f91",level:2},{value:"\u7cbe\u786e\u526a\u8f91",id:"\u7cbe\u786e\u526a\u8f91",level:3},{value:"\u591a\u6bb5\u526a\u8f91\u5408\u5e76",id:"\u591a\u6bb5\u526a\u8f91\u5408\u5e76",level:3},{value:"\u683c\u5f0f\u8f6c\u6362\u6700\u4f73\u5b9e\u8df5",id:"\u683c\u5f0f\u8f6c\u6362\u6700\u4f73\u5b9e\u8df5",level:2},{value:"\u8f6c\u6362\u4e3a Web \u53cb\u597d\u683c\u5f0f",id:"\u8f6c\u6362\u4e3a-web-\u53cb\u597d\u683c\u5f0f",level:3},{value:"\u751f\u6210\u9884\u89c8\u56fe",id:"\u751f\u6210\u9884\u89c8\u56fe",level:3}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"ffmpeg-\u89c6\u9891\u5904\u7406",children:"FFmpeg \u89c6\u9891\u5904\u7406"})}),"\n",(0,t.jsx)(n.p,{children:"\u672c\u6587\u4ecb\u7ecd FFmpeg \u7684\u89c6\u9891\u5904\u7406\u9ad8\u7ea7\u64cd\u4f5c\uff0c\u5305\u62ec\u7f16\u7801\u3001\u88c1\u526a\u3001\u5408\u5e76\u7b49\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"\u89c6\u9891\u7f16\u7801",children:"\u89c6\u9891\u7f16\u7801"}),"\n",(0,t.jsx)(n.h3,{id:"h264-\u7f16\u7801",children:"H.264 \u7f16\u7801"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u57fa\u7840 H.264 \u7f16\u7801\nffmpeg -i input.mp4 -c:v libx264 -preset medium -crf 23 output.mp4\n\n# \u9ad8\u8d28\u91cf\u7f16\u7801\nffmpeg -i input.mp4 -c:v libx264 -preset slow -crf 18 output.mp4\n\n# \u5feb\u901f\u7f16\u7801\uff08\u727a\u7272\u8d28\u91cf\u6362\u901f\u5ea6\uff09\nffmpeg -i input.mp4 -c:v libx264 -preset ultrafast -crf 23 output.mp4\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"preset \u9009\u9879"}),"\uff08\u4ece\u5feb\u5230\u6162\uff09\uff1a"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"ultrafast"}),", ",(0,t.jsx)(n.code,{children:"superfast"}),", ",(0,t.jsx)(n.code,{children:"veryfast"}),", ",(0,t.jsx)(n.code,{children:"faster"}),", ",(0,t.jsx)(n.code,{children:"fast"})]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"medium"}),"\uff08\u9ed8\u8ba4\uff09"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"slow"}),", ",(0,t.jsx)(n.code,{children:"slower"}),", ",(0,t.jsx)(n.code,{children:"veryslow"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"CRF \u503c"}),"\uff1a0-51\uff0c\u8d8a\u5c0f\u8d28\u91cf\u8d8a\u9ad8\uff0c\u63a8\u8350 18-28"]}),"\n",(0,t.jsx)(n.h3,{id:"h265hevc-\u7f16\u7801",children:"H.265/HEVC \u7f16\u7801"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u57fa\u7840 H.265 \u7f16\u7801\nffmpeg -i input.mp4 -c:v libx265 -preset medium -crf 28 output.mp4\n\n# 10-bit \u7f16\u7801\nffmpeg -i input.mp4 -c:v libx265 -pix_fmt yuv420p10le output.mp4\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u786c\u4ef6\u52a0\u901f\u7f16\u7801",children:"\u786c\u4ef6\u52a0\u901f\u7f16\u7801"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# NVIDIA NVENC\uff08H.264\uff09\nffmpeg -i input.mp4 -c:v h264_nvenc -preset fast output.mp4\n\n# NVIDIA NVENC\uff08H.265\uff09\nffmpeg -i input.mp4 -c:v hevc_nvenc output.mp4\n\n# macOS VideoToolbox\nffmpeg -i input.mp4 -c:v h264_videotoolbox output.mp4\n\n# Intel QSV\nffmpeg -i input.mp4 -c:v h264_qsv output.mp4\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u89c6\u9891\u753b\u9762\u5904\u7406",children:"\u89c6\u9891\u753b\u9762\u5904\u7406"}),"\n",(0,t.jsx)(n.h3,{id:"\u88c1\u526a\u753b\u9762crop",children:"\u88c1\u526a\u753b\u9762\uff08Crop\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# \u88c1\u526a\u4e2d\u5fc3 640x480 \u533a\u57df\nffmpeg -i input.mp4 -vf "crop=640:480" output.mp4\n\n# \u6307\u5b9a\u8d77\u59cb\u4f4d\u7f6e\u88c1\u526a\nffmpeg -i input.mp4 -vf "crop=640:480:100:50" output.mp4\n# \u683c\u5f0f\uff1acrop=\u5bbd:\u9ad8:x\u504f\u79fb:y\u504f\u79fb\n\n# \u88c1\u526a\u53bb\u9664\u9ed1\u8fb9\nffmpeg -i input.mp4 -vf "cropdetect" -f null - 2>&1 | grep crop\nffmpeg -i input.mp4 -vf "crop=1920:800:0:140" output.mp4\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u586b\u5145\u753b\u9762pad",children:"\u586b\u5145\u753b\u9762\uff08Pad\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# \u6dfb\u52a0\u9ed1\u8fb9\u5230 16:9\nffmpeg -i input.mp4 -vf "pad=1920:1080:(ow-iw)/2:(oh-ih)/2" output.mp4\n\n# \u6dfb\u52a0\u5f69\u8272\u8fb9\u6846\nffmpeg -i input.mp4 -vf "pad=1920:1080:(ow-iw)/2:(oh-ih)/2:red" output.mp4\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u65cb\u8f6c\u548c\u7ffb\u8f6c",children:"\u65cb\u8f6c\u548c\u7ffb\u8f6c"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# \u987a\u65f6\u9488\u65cb\u8f6c 90 \u5ea6\nffmpeg -i input.mp4 -vf "transpose=1" output.mp4\n\n# \u9006\u65f6\u9488\u65cb\u8f6c 90 \u5ea6\nffmpeg -i input.mp4 -vf "transpose=2" output.mp4\n\n# \u65cb\u8f6c 180 \u5ea6\nffmpeg -i input.mp4 -vf "transpose=1,transpose=1" output.mp4\n\n# \u6c34\u5e73\u7ffb\u8f6c\nffmpeg -i input.mp4 -vf "hflip" output.mp4\n\n# \u5782\u76f4\u7ffb\u8f6c\nffmpeg -i input.mp4 -vf "vflip" output.mp4\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u8c03\u6574\u901f\u5ea6",children:"\u8c03\u6574\u901f\u5ea6"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# \u89c6\u9891\u52a0\u901f 2 \u500d\nffmpeg -i input.mp4 -vf "setpts=0.5*PTS" output.mp4\n\n# \u89c6\u9891\u51cf\u901f 2 \u500d\nffmpeg -i input.mp4 -vf "setpts=2.0*PTS" output.mp4\n\n# \u540c\u65f6\u8c03\u6574\u97f3\u9891\u901f\u5ea6\nffmpeg -i input.mp4 -vf "setpts=0.5*PTS" -af "atempo=2.0" output.mp4\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\u89c6\u9891\u5408\u6210",children:"\u89c6\u9891\u5408\u6210"}),"\n",(0,t.jsx)(n.h3,{id:"\u753b\u4e2d\u753b",children:"\u753b\u4e2d\u753b"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# \u53f3\u4e0b\u89d2\u6dfb\u52a0\u5c0f\u89c6\u9891\nffmpeg -i main.mp4 -i overlay.mp4 \\\n    -filter_complex "[0:v][1:v]overlay=W-w-10:H-h-10" \\\n    output.mp4\n\n# \u5de6\u4e0a\u89d2\u6dfb\u52a0 Logo\nffmpeg -i input.mp4 -i logo.png \\\n    -filter_complex "[0:v][1:v]overlay=10:10" \\\n    output.mp4\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u591a\u89c6\u9891\u5e76\u6392",children:"\u591a\u89c6\u9891\u5e76\u6392"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# \u5de6\u53f3\u5e76\u6392\nffmpeg -i left.mp4 -i right.mp4 \\\n    -filter_complex "[0:v]scale=640:480[v0];[1:v]scale=640:480[v1];[v0][v1]hstack" \\\n    output.mp4\n\n# \u4e0a\u4e0b\u5e76\u6392\nffmpeg -i top.mp4 -i bottom.mp4 \\\n    -filter_complex "[0:v]scale=1280:360[v0];[1:v]scale=1280:360[v1];[v0][v1]vstack" \\\n    output.mp4\n\n# 2x2 \u7f51\u683c\nffmpeg -i 1.mp4 -i 2.mp4 -i 3.mp4 -i 4.mp4 \\\n    -filter_complex "[0:v][1:v]hstack[top];[2:v][3:v]hstack[bottom];[top][bottom]vstack" \\\n    output.mp4\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u6dfb\u52a0\u6c34\u5370",children:"\u6dfb\u52a0\u6c34\u5370"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# \u56fe\u7247\u6c34\u5370\nffmpeg -i input.mp4 -i watermark.png \\\n    -filter_complex "[0:v][1:v]overlay=10:10" \\\n    output.mp4\n\n# \u6587\u5b57\u6c34\u5370\nffmpeg -i input.mp4 \\\n    -vf "drawtext=text=\'\u7248\u6743\u6240\u6709\':fontsize=24:fontcolor=white:x=10:y=10" \\\n    output.mp4\n\n# \u52a8\u6001\u6587\u5b57\u6c34\u5370\uff08\u663e\u793a\u65f6\u95f4\uff09\nffmpeg -i input.mp4 \\\n    -vf "drawtext=text=\'%{localtime\\:%Y-%m-%d %H\\\\\\:%M\\\\\\:%S}\':fontsize=20:fontcolor=white:x=10:y=10" \\\n    output.mp4\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\u89c6\u9891\u526a\u8f91",children:"\u89c6\u9891\u526a\u8f91"}),"\n",(0,t.jsx)(n.h3,{id:"\u7cbe\u786e\u526a\u8f91",children:"\u7cbe\u786e\u526a\u8f91"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u4ece\u7b2c 10 \u79d2\u5f00\u59cb\u526a\u8f91 30 \u79d2\nffmpeg -ss 00:00:10 -i input.mp4 -t 00:00:30 -c copy output.mp4\n\n# \u7cbe\u786e\u6a21\u5f0f\uff08\u53ef\u80fd\u9700\u8981\u91cd\u65b0\u7f16\u7801\uff09\nffmpeg -i input.mp4 -ss 00:00:10 -t 00:00:30 -c:v libx264 -c:a aac output.mp4\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u591a\u6bb5\u526a\u8f91\u5408\u5e76",children:"\u591a\u6bb5\u526a\u8f91\u5408\u5e76"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# \u526a\u8f91\u591a\u6bb5\u5e76\u5408\u5e76\nffmpeg -i input.mp4 -filter_complex \\\n    "[0:v]trim=start=10:end=20,setpts=PTS-STARTPTS[v1]; \\\n     [0:v]trim=start=30:end=40,setpts=PTS-STARTPTS[v2]; \\\n     [0:a]atrim=start=10:end=20,asetpts=PTS-STARTPTS[a1]; \\\n     [0:a]atrim=start=30:end=40,asetpts=PTS-STARTPTS[a2]; \\\n     [v1][a1][v2][a2]concat=n=2:v=1:a=1[v][a]" \\\n    -map "[v]" -map "[a]" output.mp4\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\u683c\u5f0f\u8f6c\u6362\u6700\u4f73\u5b9e\u8df5",children:"\u683c\u5f0f\u8f6c\u6362\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,t.jsx)(n.h3,{id:"\u8f6c\u6362\u4e3a-web-\u53cb\u597d\u683c\u5f0f",children:"\u8f6c\u6362\u4e3a Web \u53cb\u597d\u683c\u5f0f"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# \u8f6c\u6362\u4e3a MP4\uff08H.264 + AAC\uff09\nffmpeg -i input.mov \\\n    -c:v libx264 -preset slow -crf 22 \\\n    -c:a aac -b:a 128k \\\n    -movflags +faststart \\\n    output.mp4\n"})}),"\n",(0,t.jsx)(n.h3,{id:"\u751f\u6210\u9884\u89c8\u56fe",children:"\u751f\u6210\u9884\u89c8\u56fe"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# \u751f\u6210\u7f29\u7565\u56fe\u7f51\u683c\nffmpeg -i input.mp4 -vf "fps=1/10,scale=320:-1,tile=4x4" thumbnail.png\n\n# \u751f\u6210\u89c6\u9891\u9884\u89c8 GIF\nffmpeg -i input.mp4 -vf "fps=10,scale=320:-1:flags=lanczos" -t 5 preview.gif\n'})})]})}function m(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}}}]);