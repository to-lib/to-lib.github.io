"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[75151],{48885:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>o});var s=r(99378);const i={},d=s.createContext(i);function l(n){const e=s.useContext(d);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),s.createElement(d.Provider,{value:e},n.children)}},69342:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"docker/windows-containers","title":"Windows Containers","description":"Windows \u5bb9\u5668\u57fa\u7840\u4e0e\u4f7f\u7528\u6307\u5357","source":"@site/docs/docker/windows-containers.md","sourceDirName":"docker","slug":"/docker/windows-containers","permalink":"/docs/docker/windows-containers","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/docker/windows-containers.md","tags":[],"version":"current","sidebarPosition":33,"frontMatter":{"sidebar_position":33,"title":"Windows Containers","description":"Windows \u5bb9\u5668\u57fa\u7840\u4e0e\u4f7f\u7528\u6307\u5357"},"sidebar":"docker","previous":{"title":"Docker API","permalink":"/docs/docker/api"},"next":{"title":"\u6700\u4f73\u5b9e\u8df5","permalink":"/docs/docker/best-practices"}}');var i=r(22714),d=r(48885);const l={sidebar_position:33,title:"Windows Containers",description:"Windows \u5bb9\u5668\u57fa\u7840\u4e0e\u4f7f\u7528\u6307\u5357"},o="Windows Containers",c={},t=[{value:"\u5bb9\u5668\u7c7b\u578b",id:"\u5bb9\u5668\u7c7b\u578b",level:2},{value:"Windows Server Containers",id:"windows-server-containers",level:3},{value:"Hyper-V Containers",id:"hyper-v-containers",level:3},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907",level:2},{value:"\u542f\u7528 Windows \u5bb9\u5668\u529f\u80fd",id:"\u542f\u7528-windows-\u5bb9\u5668\u529f\u80fd",level:3},{value:"Docker Desktop \u914d\u7f6e",id:"docker-desktop-\u914d\u7f6e",level:3},{value:"\u57fa\u7840\u955c\u50cf",id:"\u57fa\u7840\u955c\u50cf",level:2},{value:"\u5b98\u65b9\u57fa\u7840\u955c\u50cf",id:"\u5b98\u65b9\u57fa\u7840\u955c\u50cf",level:3},{value:"\u7248\u672c\u5339\u914d",id:"\u7248\u672c\u5339\u914d",level:3},{value:"Dockerfile \u793a\u4f8b",id:"dockerfile-\u793a\u4f8b",level:2},{value:".NET Framework \u5e94\u7528",id:"net-framework-\u5e94\u7528",level:3},{value:".NET Core/6+ \u5e94\u7528",id:"net-core6-\u5e94\u7528",level:3},{value:"IIS \u5e94\u7528",id:"iis-\u5e94\u7528",level:3},{value:"\u8fd0\u884c\u5bb9\u5668",id:"\u8fd0\u884c\u5bb9\u5668",level:2},{value:"\u7f51\u7edc\u914d\u7f6e",id:"\u7f51\u7edc\u914d\u7f6e",level:2},{value:"\u7f51\u7edc\u6a21\u5f0f",id:"\u7f51\u7edc\u6a21\u5f0f",level:3},{value:"\u5b58\u50a8",id:"\u5b58\u50a8",level:2},{value:"Docker Compose",id:"docker-compose",level:2},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2},{value:"\u7248\u672c\u4e0d\u5339\u914d",id:"\u7248\u672c\u4e0d\u5339\u914d",level:3},{value:"\u955c\u50cf\u592a\u5927",id:"\u955c\u50cf\u592a\u5927",level:3},{value:"\u6027\u80fd\u4f18\u5316",id:"\u6027\u80fd\u4f18\u5316",level:3},{value:"Linux vs Windows \u5bb9\u5668",id:"linux-vs-windows-\u5bb9\u5668",level:2}];function a(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"windows-containers",children:"Windows Containers"})}),"\n",(0,i.jsx)(e.p,{children:"Windows \u5bb9\u5668\u5141\u8bb8\u5728 Windows \u4e0a\u8fd0\u884c\u539f\u751f Windows \u5e94\u7528\u7a0b\u5e8f\uff0c\u4e0e Linux \u5bb9\u5668\u4e0d\u540c\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u5bb9\u5668\u7c7b\u578b",children:"\u5bb9\u5668\u7c7b\u578b"}),"\n",(0,i.jsx)(e.h3,{id:"windows-server-containers",children:"Windows Server Containers"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4e0e\u4e3b\u673a\u5171\u4eab\u5185\u6838"}),"\n",(0,i.jsx)(e.li,{children:"\u8f7b\u91cf\u7ea7\uff0c\u542f\u52a8\u5feb"}),"\n",(0,i.jsx)(e.li,{children:"\u9002\u5408\u540c\u7248\u672c Windows"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"hyper-v-containers",children:"Hyper-V Containers"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u6bcf\u4e2a\u5bb9\u5668\u8fd0\u884c\u5728\u8f7b\u91cf\u7ea7 VM \u4e2d"}),"\n",(0,i.jsx)(e.li,{children:"\u66f4\u5f3a\u7684\u9694\u79bb\u6027"}),"\n",(0,i.jsx)(e.li,{children:"\u53ef\u8fd0\u884c\u4e0d\u540c\u7248\u672c Windows"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u73af\u5883\u51c6\u5907",children:"\u73af\u5883\u51c6\u5907"}),"\n",(0,i.jsx)(e.h3,{id:"\u542f\u7528-windows-\u5bb9\u5668\u529f\u80fd",children:"\u542f\u7528 Windows \u5bb9\u5668\u529f\u80fd"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-powershell",children:"# Windows Server\nInstall-WindowsFeature -Name Containers\n\n# Windows 10/11 (\u9700\u8981 Pro/Enterprise)\nEnable-WindowsOptionalFeature -Online -FeatureName Containers -All\nEnable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All\n"})}),"\n",(0,i.jsx)(e.h3,{id:"docker-desktop-\u914d\u7f6e",children:"Docker Desktop \u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"Settings > General > Use the WSL 2 based engine (\u5173\u95ed)\nSettings > General > Switch to Windows containers\n"})}),"\n",(0,i.jsx)(e.p,{children:'\u6216\u53f3\u952e\u6258\u76d8\u56fe\u6807 > "Switch to Windows containers"'}),"\n",(0,i.jsx)(e.h2,{id:"\u57fa\u7840\u955c\u50cf",children:"\u57fa\u7840\u955c\u50cf"}),"\n",(0,i.jsx)(e.h3,{id:"\u5b98\u65b9\u57fa\u7840\u955c\u50cf",children:"\u5b98\u65b9\u57fa\u7840\u955c\u50cf"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u955c\u50cf"}),(0,i.jsx)(e.th,{children:"\u5927\u5c0f"}),(0,i.jsx)(e.th,{children:"\u7528\u9014"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"mcr.microsoft.com/windows/servercore"})}),(0,i.jsx)(e.td,{children:"~5GB"}),(0,i.jsx)(e.td,{children:"\u5b8c\u6574 Windows Server Core"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"mcr.microsoft.com/windows/nanoserver"})}),(0,i.jsx)(e.td,{children:"~100MB"}),(0,i.jsx)(e.td,{children:"\u6700\u5c0f\u5316 Windows"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"mcr.microsoft.com/windows"})}),(0,i.jsx)(e.td,{children:"~10GB"}),(0,i.jsx)(e.td,{children:"\u5b8c\u6574 Windows"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"mcr.microsoft.com/dotnet/aspnet"})}),(0,i.jsx)(e.td,{children:"~300MB"}),(0,i.jsx)(e.td,{children:"ASP.NET \u8fd0\u884c\u65f6"})]})]})]}),"\n",(0,i.jsx)(e.h3,{id:"\u7248\u672c\u5339\u914d",children:"\u7248\u672c\u5339\u914d"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-powershell",children:"# \u67e5\u770b\u4e3b\u673a\u7248\u672c\n[System.Environment]::OSVersion.Version\n\n# \u955c\u50cf\u6807\u7b7e\u9700\u8981\u5339\u914d\u4e3b\u673a\u7248\u672c\n# ltsc2022 - Windows Server 2022\n# ltsc2019 - Windows Server 2019\n# 1809, 1903, 1909, 2004, 20H2 - \u534a\u5e74\u9891\u9053\u7248\u672c\n"})}),"\n",(0,i.jsx)(e.h2,{id:"dockerfile-\u793a\u4f8b",children:"Dockerfile \u793a\u4f8b"}),"\n",(0,i.jsx)(e.h3,{id:"net-framework-\u5e94\u7528",children:".NET Framework \u5e94\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-dockerfile",children:"FROM mcr.microsoft.com/dotnet/framework/aspnet:4.8-windowsservercore-ltsc2022\n\nWORKDIR /inetpub/wwwroot\nCOPY ./publish .\n\nEXPOSE 80\n"})}),"\n",(0,i.jsx)(e.h3,{id:"net-core6-\u5e94\u7528",children:".NET Core/6+ \u5e94\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-dockerfile",children:'FROM mcr.microsoft.com/dotnet/sdk:8.0-nanoserver-ltsc2022 AS build\nWORKDIR /src\nCOPY *.csproj .\nRUN dotnet restore\nCOPY . .\nRUN dotnet publish -c Release -o /app\n\nFROM mcr.microsoft.com/dotnet/aspnet:8.0-nanoserver-ltsc2022\nWORKDIR /app\nCOPY --from=build /app .\nENTRYPOINT ["dotnet", "MyApp.dll"]\n'})}),"\n",(0,i.jsx)(e.h3,{id:"iis-\u5e94\u7528",children:"IIS \u5e94\u7528"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-dockerfile",children:"FROM mcr.microsoft.com/windows/servercore/iis:windowsservercore-ltsc2022\n\nRUN powershell -Command \\\n    Remove-Item -Recurse C:\\inetpub\\wwwroot\\*\n\nCOPY ./website C:/inetpub/wwwroot\n\nEXPOSE 80\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u8fd0\u884c\u5bb9\u5668",children:"\u8fd0\u884c\u5bb9\u5668"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-powershell",children:"# \u8fd0\u884c Windows \u5bb9\u5668\ndocker run -d -p 8080:80 mcr.microsoft.com/windows/servercore/iis\n\n# \u4f7f\u7528 Hyper-V \u9694\u79bb\ndocker run -d --isolation=hyperv -p 8080:80 myapp\n\n# \u8fdb\u5165\u5bb9\u5668\ndocker exec -it container_id powershell\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u7f51\u7edc\u914d\u7f6e",children:"\u7f51\u7edc\u914d\u7f6e"}),"\n",(0,i.jsx)(e.h3,{id:"\u7f51\u7edc\u6a21\u5f0f",children:"\u7f51\u7edc\u6a21\u5f0f"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u6a21\u5f0f"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"nat"}),(0,i.jsx)(e.td,{children:"\u9ed8\u8ba4\uff0cNAT \u7f51\u7edc"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"transparent"}),(0,i.jsx)(e.td,{children:"\u76f4\u63a5\u8fde\u63a5\u7269\u7406\u7f51\u7edc"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"overlay"}),(0,i.jsx)(e.td,{children:"Swarm \u8de8\u4e3b\u673a\u7f51\u7edc"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"l2bridge"}),(0,i.jsx)(e.td,{children:"L2 \u6865\u63a5"})]})]})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-powershell",children:"# \u521b\u5efa NAT \u7f51\u7edc\ndocker network create -d nat mynat\n\n# \u521b\u5efa\u900f\u660e\u7f51\u7edc\ndocker network create -d transparent mytrans\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5b58\u50a8",children:"\u5b58\u50a8"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-powershell",children:"# \u521b\u5efa\u5377\ndocker volume create mydata\n\n# \u6302\u8f7d\u5377\ndocker run -v mydata:C:\\data myapp\n\n# \u7ed1\u5b9a\u6302\u8f7d\ndocker run -v C:\\HostPath:C:\\ContainerPath myapp\n"})}),"\n",(0,i.jsx)(e.h2,{id:"docker-compose",children:"Docker Compose"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  web:\n    image: mcr.microsoft.com/dotnet/aspnet:8.0-nanoserver-ltsc2022\n    build:\n      context: .\n      dockerfile: Dockerfile\n    ports:\n      - "8080:80"\n    volumes:\n      - app-data:C:\\app\\data\n\n  db:\n    image: mcr.microsoft.com/mssql/server:2022-latest\n    environment:\n      SA_PASSWORD: "YourStrong!Passw0rd"\n      ACCEPT_EULA: "Y"\n    ports:\n      - "1433:1433"\n\nvolumes:\n  app-data:\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,i.jsx)(e.h3,{id:"\u7248\u672c\u4e0d\u5339\u914d",children:"\u7248\u672c\u4e0d\u5339\u914d"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"container operating system does not match host operating system\n"})}),"\n",(0,i.jsx)(e.p,{children:"\u89e3\u51b3\uff1a\u4f7f\u7528\u5339\u914d\u4e3b\u673a\u7248\u672c\u7684\u955c\u50cf\u6807\u7b7e\uff0c\u6216\u4f7f\u7528 Hyper-V \u9694\u79bb\u3002"}),"\n",(0,i.jsx)(e.h3,{id:"\u955c\u50cf\u592a\u5927",children:"\u955c\u50cf\u592a\u5927"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\u4f7f\u7528 nanoserver \u66ff\u4ee3 servercore"}),"\n",(0,i.jsx)(e.li,{children:"\u4f7f\u7528\u591a\u9636\u6bb5\u6784\u5efa"}),"\n",(0,i.jsx)(e.li,{children:"\u6e05\u7406\u4e34\u65f6\u6587\u4ef6"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u6027\u80fd\u4f18\u5316",children:"\u6027\u80fd\u4f18\u5316"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-powershell",children:"# \u4f7f\u7528\u8fdb\u7a0b\u9694\u79bb\uff08\u66f4\u5feb\uff09\ndocker run --isolation=process myapp\n\n# \u9884\u62c9\u53d6\u57fa\u7840\u955c\u50cf\ndocker pull mcr.microsoft.com/windows/nanoserver:ltsc2022\n"})}),"\n",(0,i.jsx)(e.h2,{id:"linux-vs-windows-\u5bb9\u5668",children:"Linux vs Windows \u5bb9\u5668"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u7279\u6027"}),(0,i.jsx)(e.th,{children:"Linux"}),(0,i.jsx)(e.th,{children:"Windows"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u955c\u50cf\u5927\u5c0f"}),(0,i.jsx)(e.td,{children:"MB \u7ea7"}),(0,i.jsx)(e.td,{children:"GB \u7ea7"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u542f\u52a8\u901f\u5ea6"}),(0,i.jsx)(e.td,{children:"\u79d2\u7ea7"}),(0,i.jsx)(e.td,{children:"\u8f83\u6162"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u57fa\u7840\u955c\u50cf"}),(0,i.jsx)(e.td,{children:"Alpine, Debian"}),(0,i.jsx)(e.td,{children:"Nano, ServerCore"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u751f\u6001\u7cfb\u7edf"}),(0,i.jsx)(e.td,{children:"\u4e30\u5bcc"}),(0,i.jsx)(e.td,{children:"\u6709\u9650"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u9002\u7528\u573a\u666f"}),(0,i.jsx)(e.td,{children:"\u5927\u591a\u6570\u5e94\u7528"}),(0,i.jsx)(e.td,{children:".NET Framework, IIS"})]})]})]})]})}function h(n={}){const{wrapper:e}={...(0,d.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}}}]);