"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[76155],{48885:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var t=s(99378);const r={},i=t.createContext(r);function l(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(i.Provider,{value:n},e.children)}},88490:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"nginx/ssl-tls","title":"SSL/TLS \u914d\u7f6e","description":"Nginx HTTPS \u914d\u7f6e\u4e0e SSL \u8bc1\u4e66\u7ba1\u7406","source":"@site/docs/nginx/ssl-tls.md","sourceDirName":"nginx","slug":"/nginx/ssl-tls","permalink":"/docs/nginx/ssl-tls","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/nginx/ssl-tls.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"SSL/TLS \u914d\u7f6e","description":"Nginx HTTPS \u914d\u7f6e\u4e0e SSL \u8bc1\u4e66\u7ba1\u7406"},"sidebar":"nginx","previous":{"title":"\u8d1f\u8f7d\u5747\u8861","permalink":"/docs/nginx/load-balancing"},"next":{"title":"\u5b89\u5168\u914d\u7f6e","permalink":"/docs/nginx/security"}}');var r=s(22714),i=s(48885);const l={sidebar_position:7,title:"SSL/TLS \u914d\u7f6e",description:"Nginx HTTPS \u914d\u7f6e\u4e0e SSL \u8bc1\u4e66\u7ba1\u7406"},o="SSL/TLS \u914d\u7f6e",c={},a=[{value:"\u57fa\u672c HTTPS \u914d\u7f6e",id:"\u57fa\u672c-https-\u914d\u7f6e",level:2},{value:"HTTP \u91cd\u5b9a\u5411\u5230 HTTPS",id:"http-\u91cd\u5b9a\u5411\u5230-https",level:2},{value:"SSL \u4f18\u5316\u914d\u7f6e",id:"ssl-\u4f18\u5316\u914d\u7f6e",level:2},{value:"Let&#39;s Encrypt \u8bc1\u4e66",id:"lets-encrypt-\u8bc1\u4e66",level:2},{value:"\u5b89\u5168\u54cd\u5e94\u5934",id:"\u5b89\u5168\u54cd\u5e94\u5934",level:2},{value:"\u5b8c\u6574 HTTPS \u914d\u7f6e",id:"\u5b8c\u6574-https-\u914d\u7f6e",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",pre:"pre",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"ssltls-\u914d\u7f6e",children:"SSL/TLS \u914d\u7f6e"})}),"\n",(0,r.jsx)(n.h2,{id:"\u57fa\u672c-https-\u914d\u7f6e",children:"\u57fa\u672c HTTPS \u914d\u7f6e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 443 ssl http2;\n    server_name example.com;\n\n    ssl_certificate /etc/nginx/ssl/example.com.crt;\n    ssl_certificate_key /etc/nginx/ssl/example.com.key;\n\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_prefer_server_ciphers on;\n\n    root /var/www/html;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"http-\u91cd\u5b9a\u5411\u5230-https",children:"HTTP \u91cd\u5b9a\u5411\u5230 HTTPS"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 80;\n    server_name example.com www.example.com;\n    return 301 https://$host$request_uri;\n}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"ssl-\u4f18\u5316\u914d\u7f6e",children:"SSL \u4f18\u5316\u914d\u7f6e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:"ssl_protocols TLSv1.2 TLSv1.3;\nssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;\nssl_prefer_server_ciphers on;\n\n# Session \u7f13\u5b58\nssl_session_cache shared:SSL:10m;\nssl_session_timeout 1d;\nssl_session_tickets off;\n\n# OCSP Stapling\nssl_stapling on;\nssl_stapling_verify on;\nresolver 8.8.8.8 8.8.4.4 valid=300s;\n"})}),"\n",(0,r.jsx)(n.h2,{id:"lets-encrypt-\u8bc1\u4e66",children:"Let's Encrypt \u8bc1\u4e66"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u5b89\u88c5 Certbot\nsudo apt install certbot python3-certbot-nginx\n\n# \u83b7\u53d6\u8bc1\u4e66\nsudo certbot --nginx -d example.com -d www.example.com\n\n# \u81ea\u52a8\u7eed\u671f\nsudo certbot renew --dry-run\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5b89\u5168\u54cd\u5e94\u5934",children:"\u5b89\u5168\u54cd\u5e94\u5934"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:'add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;\nadd_header X-Content-Type-Options nosniff;\nadd_header X-Frame-Options SAMEORIGIN;\nadd_header X-XSS-Protection "1; mode=block";\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u5b8c\u6574-https-\u914d\u7f6e",children:"\u5b8c\u6574 HTTPS \u914d\u7f6e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-nginx",children:'server {\n    listen 80;\n    server_name example.com;\n    return 301 https://$host$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name example.com;\n\n    ssl_certificate /etc/nginx/ssl/fullchain.pem;\n    ssl_certificate_key /etc/nginx/ssl/privkey.pem;\n\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;\n    ssl_prefer_server_ciphers on;\n\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 1d;\n\n    add_header Strict-Transport-Security "max-age=31536000" always;\n\n    root /var/www/html;\n    index index.html;\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);