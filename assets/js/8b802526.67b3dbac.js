"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[5498],{30288:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>c,default:()=>o,frontMatter:()=>l,metadata:()=>d,toc:()=>t});const d=JSON.parse('{"id":"redis/backup-and-recovery","title":"\u5907\u4efd\u4e0e\u6062\u590d","description":"Redis \u7684\u5907\u4efd\u6062\u590d\u662f\u6570\u636e\u5b89\u5168\u7684\u91cd\u8981\u4fdd\u969c\u3002\u672c\u6587\u8be6\u7ec6\u4ecb\u7ecd RDB \u548c AOF \u4e24\u79cd\u6301\u4e45\u5316\u6587\u4ef6\u7684\u5907\u4efd\u6062\u590d\u7b56\u7565\uff0c\u5305\u62ec\u81ea\u52a8\u5316\u811a\u672c\u3001\u4e91\u5b58\u50a8\u96c6\u6210\u548c\u707e\u96be\u6062\u590d\u65b9\u6848\u3002","source":"@site/docs/redis/backup-and-recovery.md","sourceDirName":"redis","slug":"/redis/backup-and-recovery","permalink":"/docs/redis/backup-and-recovery","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/redis/backup-and-recovery.md","tags":[],"version":"current","sidebarPosition":26,"frontMatter":{"sidebar_position":26,"title":"\u5907\u4efd\u4e0e\u6062\u590d"},"sidebar":"redis","previous":{"title":"\u76d1\u63a7\u4e0e\u6392\u969c","permalink":"/docs/redis/monitoring-and-troubleshooting"},"next":{"title":"\u5feb\u901f\u53c2\u8003","permalink":"/docs/redis/quick-reference"}}');var r=s(22714),i=s(48885);const l={sidebar_position:26,title:"\u5907\u4efd\u4e0e\u6062\u590d"},c="Redis \u5907\u4efd\u4e0e\u6062\u590d",a={},t=[{value:"\u5907\u4efd\u7b56\u7565\u6982\u8ff0",id:"\u5907\u4efd\u7b56\u7565\u6982\u8ff0",level:2},{value:"\u6301\u4e45\u5316\u6587\u4ef6\u7c7b\u578b",id:"\u6301\u4e45\u5316\u6587\u4ef6\u7c7b\u578b",level:3},{value:"\u5907\u4efd\u7b56\u7565\u9009\u62e9",id:"\u5907\u4efd\u7b56\u7565\u9009\u62e9",level:3},{value:"RDB \u5907\u4efd",id:"rdb-\u5907\u4efd",level:2},{value:"\u624b\u52a8\u89e6\u53d1\u5907\u4efd",id:"\u624b\u52a8\u89e6\u53d1\u5907\u4efd",level:3},{value:"\u81ea\u52a8\u5907\u4efd\u811a\u672c",id:"\u81ea\u52a8\u5907\u4efd\u811a\u672c",level:3},{value:"\u5b9a\u65f6\u4efb\u52a1\u914d\u7f6e",id:"\u5b9a\u65f6\u4efb\u52a1\u914d\u7f6e",level:3},{value:"AOF \u5907\u4efd",id:"aof-\u5907\u4efd",level:2},{value:"AOF \u6587\u4ef6\u7ed3\u6784",id:"aof-\u6587\u4ef6\u7ed3\u6784",level:3},{value:"AOF \u5907\u4efd\u811a\u672c",id:"aof-\u5907\u4efd\u811a\u672c",level:3},{value:"AOF \u5907\u4efd\u6700\u4f73\u5b9e\u8df5",id:"aof-\u5907\u4efd\u6700\u4f73\u5b9e\u8df5",level:3},{value:"\u4e91\u5b58\u50a8\u5907\u4efd",id:"\u4e91\u5b58\u50a8\u5907\u4efd",level:2},{value:"AWS S3 \u5907\u4efd",id:"aws-s3-\u5907\u4efd",level:3},{value:"\u963f\u91cc\u4e91 OSS \u5907\u4efd",id:"\u963f\u91cc\u4e91-oss-\u5907\u4efd",level:3},{value:"\u5b89\u88c5\u4e91\u5b58\u50a8\u5de5\u5177",id:"\u5b89\u88c5\u4e91\u5b58\u50a8\u5de5\u5177",level:3},{value:"\u6570\u636e\u6062\u590d",id:"\u6570\u636e\u6062\u590d",level:2},{value:"RDB \u6062\u590d\u6d41\u7a0b",id:"rdb-\u6062\u590d\u6d41\u7a0b",level:3},{value:"AOF \u6062\u590d\u6d41\u7a0b",id:"aof-\u6062\u590d\u6d41\u7a0b",level:3},{value:"\u4fee\u590d\u635f\u574f\u7684\u6301\u4e45\u5316\u6587\u4ef6",id:"\u4fee\u590d\u635f\u574f\u7684\u6301\u4e45\u5316\u6587\u4ef6",level:3},{value:"\u4ece RDB \u6062\u590d\u5230 AOF \u6a21\u5f0f",id:"\u4ece-rdb-\u6062\u590d\u5230-aof-\u6a21\u5f0f",level:3},{value:"\u707e\u96be\u6062\u590d",id:"\u707e\u96be\u6062\u590d",level:2},{value:"\u6062\u590d\u6f14\u7ec3\u6d41\u7a0b",id:"\u6062\u590d\u6f14\u7ec3\u6d41\u7a0b",level:3},{value:"\u6062\u590d\u65f6\u95f4\u76ee\u6807 (RTO) \u8bc4\u4f30",id:"\u6062\u590d\u65f6\u95f4\u76ee\u6807-rto-\u8bc4\u4f30",level:3},{value:"\u6570\u636e\u8fc1\u79fb",id:"\u6570\u636e\u8fc1\u79fb",level:2},{value:"\u5728\u7ebf\u8fc1\u79fb\uff08\u4e3b\u4ece\u590d\u5236\uff09",id:"\u5728\u7ebf\u8fc1\u79fb\u4e3b\u4ece\u590d\u5236",level:3},{value:"\u79bb\u7ebf\u8fc1\u79fb\uff08RDB \u6587\u4ef6\uff09",id:"\u79bb\u7ebf\u8fc1\u79fbrdb-\u6587\u4ef6",level:3},{value:"\u4f7f\u7528 redis-shake \u8fc1\u79fb",id:"\u4f7f\u7528-redis-shake-\u8fc1\u79fb",level:3},{value:"\u96c6\u7fa4\u73af\u5883\u5907\u4efd",id:"\u96c6\u7fa4\u73af\u5883\u5907\u4efd",level:2},{value:"Redis Cluster \u5907\u4efd",id:"redis-cluster-\u5907\u4efd",level:3},{value:"Sentinel \u73af\u5883\u5907\u4efd",id:"sentinel-\u73af\u5883\u5907\u4efd",level:3},{value:"\u76d1\u63a7\u4e0e\u544a\u8b66",id:"\u76d1\u63a7\u4e0e\u544a\u8b66",level:2},{value:"\u5907\u4efd\u76d1\u63a7\u6307\u6807",id:"\u5907\u4efd\u76d1\u63a7\u6307\u6807",level:3},{value:"\u544a\u8b66\u914d\u7f6e\u793a\u4f8b\uff08Prometheus AlertManager\uff09",id:"\u544a\u8b66\u914d\u7f6e\u793a\u4f8bprometheus-alertmanager",level:3},{value:"\u5c0f\u7ed3",id:"\u5c0f\u7ed3",level:2}];function h(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"redis-\u5907\u4efd\u4e0e\u6062\u590d",children:"Redis \u5907\u4efd\u4e0e\u6062\u590d"})}),"\n",(0,r.jsx)(e.p,{children:"Redis \u7684\u5907\u4efd\u6062\u590d\u662f\u6570\u636e\u5b89\u5168\u7684\u91cd\u8981\u4fdd\u969c\u3002\u672c\u6587\u8be6\u7ec6\u4ecb\u7ecd RDB \u548c AOF \u4e24\u79cd\u6301\u4e45\u5316\u6587\u4ef6\u7684\u5907\u4efd\u6062\u590d\u7b56\u7565\uff0c\u5305\u62ec\u81ea\u52a8\u5316\u811a\u672c\u3001\u4e91\u5b58\u50a8\u96c6\u6210\u548c\u707e\u96be\u6062\u590d\u65b9\u6848\u3002"}),"\n",(0,r.jsx)(e.h2,{id:"\u5907\u4efd\u7b56\u7565\u6982\u8ff0",children:"\u5907\u4efd\u7b56\u7565\u6982\u8ff0"}),"\n",(0,r.jsx)(e.h3,{id:"\u6301\u4e45\u5316\u6587\u4ef6\u7c7b\u578b",children:"\u6301\u4e45\u5316\u6587\u4ef6\u7c7b\u578b"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u6587\u4ef6\u7c7b\u578b"}),(0,r.jsx)(e.th,{children:"\u6587\u4ef6\u540d"}),(0,r.jsx)(e.th,{children:"\u7279\u70b9"}),(0,r.jsx)(e.th,{children:"\u9002\u7528\u573a\u666f"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"RDB"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"dump.rdb"})}),(0,r.jsx)(e.td,{children:"\u4e8c\u8fdb\u5236\u5feb\u7167\uff0c\u4f53\u79ef\u5c0f\uff0c\u6062\u590d\u5feb"}),(0,r.jsx)(e.td,{children:"\u5b9a\u671f\u5907\u4efd\uff0c\u51b7\u5907\u4efd"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"AOF"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"appendonly.aof"})}),(0,r.jsx)(e.td,{children:"\u547d\u4ee4\u65e5\u5fd7\uff0c\u6570\u636e\u5b8c\u6574\u6027\u9ad8"}),(0,r.jsx)(e.td,{children:"\u70ed\u5907\u4efd\uff0c\u6570\u636e\u654f\u611f\u573a\u666f"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u6df7\u5408 AOF"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"appendonlydir/"})}),(0,r.jsx)(e.td,{children:"Redis 7.0+\uff0c\u591a\u6587\u4ef6\u7ed3\u6784"}),(0,r.jsx)(e.td,{children:"\u73b0\u4ee3\u90e8\u7f72"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"\u5907\u4efd\u7b56\u7565\u9009\u62e9",children:"\u5907\u4efd\u7b56\u7565\u9009\u62e9"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u573a\u666f"}),(0,r.jsx)(e.th,{children:"\u63a8\u8350\u7b56\u7565"}),(0,r.jsx)(e.th,{children:"\u5907\u4efd\u9891\u7387"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u7f13\u5b58\u670d\u52a1"}),(0,r.jsx)(e.td,{children:"\u4ec5 RDB \u6216\u4e0d\u5907\u4efd"}),(0,r.jsx)(e.td,{children:"\u6bcf\u65e5"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u4f1a\u8bdd\u5b58\u50a8"}),(0,r.jsx)(e.td,{children:"RDB + AOF"}),(0,r.jsx)(e.td,{children:"\u6bcf\u5c0f\u65f6"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5173\u952e\u4e1a\u52a1\u6570\u636e"}),(0,r.jsx)(e.td,{children:"AOF (everysec) + RDB"}),(0,r.jsx)(e.td,{children:"\u5b9e\u65f6 + \u6bcf\u5c0f\u65f6"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u91d1\u878d\u7ea7\u6570\u636e"}),(0,r.jsx)(e.td,{children:"AOF (always) + \u591a\u526f\u672c"}),(0,r.jsx)(e.td,{children:"\u5b9e\u65f6"})]})]})]}),"\n",(0,r.jsx)(e.h2,{id:"rdb-\u5907\u4efd",children:"RDB \u5907\u4efd"}),"\n",(0,r.jsx)(e.h3,{id:"\u624b\u52a8\u89e6\u53d1\u5907\u4efd",children:"\u624b\u52a8\u89e6\u53d1\u5907\u4efd"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u540e\u53f0\u5f02\u6b65\u4fdd\u5b58\uff08\u63a8\u8350\uff0c\u4e0d\u963b\u585e\uff09\nredis-cli BGSAVE\n\n# \u540c\u6b65\u4fdd\u5b58\uff08\u963b\u585e\uff0c\u4ec5\u8c03\u8bd5\u4f7f\u7528\uff09\nredis-cli SAVE\n\n# \u67e5\u770b\u6700\u540e\u4fdd\u5b58\u65f6\u95f4\nredis-cli LASTSAVE\n\n# \u67e5\u770b\u4fdd\u5b58\u72b6\u6001\nredis-cli INFO persistence | grep rdb\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u81ea\u52a8\u5907\u4efd\u811a\u672c",children:"\u81ea\u52a8\u5907\u4efd\u811a\u672c"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u57fa\u7840\u5907\u4efd\u811a\u672c"}),"\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n# /opt/scripts/redis-backup.sh\n# Redis RDB \u5907\u4efd\u811a\u672c\n\n# \u914d\u7f6e\nREDIS_HOST="127.0.0.1"\nREDIS_PORT="6379"\nREDIS_PASSWORD=""\nREDIS_DATA_DIR="/var/lib/redis"\nBACKUP_DIR="/backup/redis"\nRETENTION_DAYS=7\n\n# \u65e5\u671f\nDATE=$(date +%Y%m%d_%H%M%S)\nBACKUP_FILE="$BACKUP_DIR/dump_$DATE.rdb"\n\n# \u521b\u5efa\u5907\u4efd\u76ee\u5f55\nmkdir -p $BACKUP_DIR\n\n# \u5199\u5165\u65e5\u5fd7\nlog() {\n    echo "[$(date \'+%Y-%m-%d %H:%M:%S\')] $1"\n}\n\n# \u89e6\u53d1 BGSAVE\nlog "\u5f00\u59cb\u89e6\u53d1 BGSAVE..."\nif [ -n "$REDIS_PASSWORD" ]; then\n    redis-cli -h $REDIS_HOST -p $REDIS_PORT -a "$REDIS_PASSWORD" BGSAVE\nelse\n    redis-cli -h $REDIS_HOST -p $REDIS_PORT BGSAVE\nfi\n\n# \u7b49\u5f85 BGSAVE \u5b8c\u6210\nlog "\u7b49\u5f85 BGSAVE \u5b8c\u6210..."\nwhile true; do\n    if [ -n "$REDIS_PASSWORD" ]; then\n        LASTSAVE=$(redis-cli -h $REDIS_HOST -p $REDIS_PORT -a "$REDIS_PASSWORD" LASTSAVE 2>/dev/null)\n    else\n        LASTSAVE=$(redis-cli -h $REDIS_HOST -p $REDIS_PORT LASTSAVE 2>/dev/null)\n    fi\n    \n    if [ "$LASTSAVE" != "$PREV_LASTSAVE" ] && [ -n "$PREV_LASTSAVE" ]; then\n        break\n    fi\n    PREV_LASTSAVE=$LASTSAVE\n    sleep 1\ndone\n\n# \u590d\u5236 RDB \u6587\u4ef6\nlog "\u590d\u5236 RDB \u6587\u4ef6\u5230\u5907\u4efd\u76ee\u5f55..."\ncp "$REDIS_DATA_DIR/dump.rdb" "$BACKUP_FILE"\n\n# \u9a8c\u8bc1\u5907\u4efd\u6587\u4ef6\nif [ -f "$BACKUP_FILE" ]; then\n    SIZE=$(ls -lh "$BACKUP_FILE" | awk \'{print $5}\')\n    log "\u5907\u4efd\u6210\u529f: $BACKUP_FILE ($SIZE)"\nelse\n    log "\u5907\u4efd\u5931\u8d25: \u6587\u4ef6\u4e0d\u5b58\u5728"\n    exit 1\nfi\n\n# \u6e05\u7406\u8fc7\u671f\u5907\u4efd\nlog "\u6e05\u7406 $RETENTION_DAYS \u5929\u524d\u7684\u5907\u4efd..."\nfind $BACKUP_DIR -name "dump_*.rdb" -mtime +$RETENTION_DAYS -delete\n\nlog "\u5907\u4efd\u5b8c\u6210"\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u5b9a\u65f6\u4efb\u52a1\u914d\u7f6e",children:"\u5b9a\u65f6\u4efb\u52a1\u914d\u7f6e"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Cron \u65b9\u5f0f"}),"\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u7f16\u8f91 crontab\ncrontab -e\n\n# \u6bcf\u5c0f\u65f6\u5907\u4efd\u4e00\u6b21\n0 * * * * /opt/scripts/redis-backup.sh >> /var/log/redis-backup.log 2>&1\n\n# \u6bcf\u5929\u51cc\u6668 2 \u70b9\u5907\u4efd\n0 2 * * * /opt/scripts/redis-backup.sh >> /var/log/redis-backup.log 2>&1\n\n# \u6bcf 6 \u5c0f\u65f6\u5907\u4efd\u4e00\u6b21\n0 */6 * * * /opt/scripts/redis-backup.sh >> /var/log/redis-backup.log 2>&1\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Systemd Timer \u65b9\u5f0f"}),"\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ini",children:"# /etc/systemd/system/redis-backup.service\n[Unit]\nDescription=Redis Backup Service\nAfter=redis.service\n\n[Service]\nType=oneshot\nExecStart=/opt/scripts/redis-backup.sh\nUser=redis\nGroup=redis\n\n[Install]\nWantedBy=multi-user.target\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ini",children:"# /etc/systemd/system/redis-backup.timer\n[Unit]\nDescription=Run Redis Backup every hour\n\n[Timer]\nOnCalendar=hourly\nPersistent=true\n\n[Install]\nWantedBy=timers.target\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u542f\u7528\u5b9a\u65f6\u5668\nsudo systemctl daemon-reload\nsudo systemctl enable --now redis-backup.timer\n\n# \u67e5\u770b\u5b9a\u65f6\u5668\u72b6\u6001\nsudo systemctl list-timers redis-backup.timer\n"})}),"\n",(0,r.jsx)(e.h2,{id:"aof-\u5907\u4efd",children:"AOF \u5907\u4efd"}),"\n",(0,r.jsx)(e.h3,{id:"aof-\u6587\u4ef6\u7ed3\u6784",children:"AOF \u6587\u4ef6\u7ed3\u6784"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Redis 6.x \u53ca\u4e4b\u524d"}),"\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"/var/lib/redis/\n\u2514\u2500\u2500 appendonly.aof\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"Redis 7.0+ \u591a\u90e8\u5206 AOF"}),"\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"/var/lib/redis/appendonlydir/\n\u251c\u2500\u2500 appendonly.aof.1.base.rdb    # \u57fa\u7840 RDB\n\u251c\u2500\u2500 appendonly.aof.2.incr.aof    # \u589e\u91cf AOF\n\u2514\u2500\u2500 appendonly.aof.manifest      # \u6e05\u5355\u6587\u4ef6\n"})}),"\n",(0,r.jsx)(e.h3,{id:"aof-\u5907\u4efd\u811a\u672c",children:"AOF \u5907\u4efd\u811a\u672c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n# /opt/scripts/redis-aof-backup.sh\n# Redis AOF \u5907\u4efd\u811a\u672c\n\nREDIS_HOST="127.0.0.1"\nREDIS_PORT="6379"\nREDIS_DATA_DIR="/var/lib/redis"\nBACKUP_DIR="/backup/redis/aof"\nDATE=$(date +%Y%m%d_%H%M%S)\n\nmkdir -p $BACKUP_DIR\n\n# \u89e6\u53d1 AOF \u91cd\u5199\uff08\u538b\u7f29\u6587\u4ef6\uff09\nredis-cli -h $REDIS_HOST -p $REDIS_PORT BGREWRITEAOF\n\n# \u7b49\u5f85\u91cd\u5199\u5b8c\u6210\necho "\u7b49\u5f85 AOF \u91cd\u5199\u5b8c\u6210..."\nwhile true; do\n    REWRITING=$(redis-cli -h $REDIS_HOST -p $REDIS_PORT INFO persistence | grep aof_rewrite_in_progress | cut -d: -f2 | tr -d \'\\r\')\n    if [ "$REWRITING" = "0" ]; then\n        break\n    fi\n    sleep 2\ndone\n\n# \u5907\u4efd AOF \u6587\u4ef6\nif [ -d "$REDIS_DATA_DIR/appendonlydir" ]; then\n    # Redis 7.0+ \u591a\u90e8\u5206 AOF\n    tar -czf "$BACKUP_DIR/aof_$DATE.tar.gz" -C "$REDIS_DATA_DIR" appendonlydir\nelse\n    # \u4f20\u7edf\u5355\u6587\u4ef6 AOF\n    cp "$REDIS_DATA_DIR/appendonly.aof" "$BACKUP_DIR/appendonly_$DATE.aof"\nfi\n\necho "AOF \u5907\u4efd\u5b8c\u6210: $BACKUP_DIR"\n\n# \u6e05\u7406 7 \u5929\u524d\u7684\u5907\u4efd\nfind $BACKUP_DIR -name "*.aof" -o -name "*.tar.gz" -mtime +7 -delete\n'})}),"\n",(0,r.jsx)(e.h3,{id:"aof-\u5907\u4efd\u6700\u4f73\u5b9e\u8df5",children:"AOF \u5907\u4efd\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5907\u4efd\u524d\u6267\u884c BGREWRITEAOF"}),"\uff1a\u538b\u7f29 AOF \u6587\u4ef6\u5927\u5c0f"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u907f\u514d\u9ad8\u5cf0\u671f\u5907\u4efd"}),"\uff1aAOF \u91cd\u5199\u4f1a\u6d88\u8017 CPU \u548c\u78c1\u76d8 I/O"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5907\u4efd\u6574\u4e2a appendonlydir \u76ee\u5f55"}),"\uff08Redis 7.0+\uff09"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u9a8c\u8bc1\u5907\u4efd\u6587\u4ef6\u5b8c\u6574\u6027"}),"\uff1a"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5 AOF \u6587\u4ef6\nredis-check-aof --fix appendonly.aof\n\n# Redis 7.0+ \u68c0\u67e5\nredis-check-aof --fix appendonlydir/appendonly.aof.manifest\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u4e91\u5b58\u50a8\u5907\u4efd",children:"\u4e91\u5b58\u50a8\u5907\u4efd"}),"\n",(0,r.jsx)(e.h3,{id:"aws-s3-\u5907\u4efd",children:"AWS S3 \u5907\u4efd"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n# /opt/scripts/redis-backup-s3.sh\n\nBACKUP_DIR="/backup/redis"\nS3_BUCKET="s3://your-bucket/redis-backup"\nDATE=$(date +%Y%m%d_%H%M%S)\n\n# \u6267\u884c\u672c\u5730\u5907\u4efd\n/opt/scripts/redis-backup.sh\n\n# \u4e0a\u4f20\u5230 S3\naws s3 cp "$BACKUP_DIR/dump_$DATE.rdb" "$S3_BUCKET/dump_$DATE.rdb"\n\n# \u540c\u6b65\u6574\u4e2a\u5907\u4efd\u76ee\u5f55\uff08\u53ef\u9009\uff09\naws s3 sync $BACKUP_DIR $S3_BUCKET --delete\n\n# \u8bbe\u7f6e S3 \u751f\u547d\u5468\u671f\uff08\u5728 S3 \u63a7\u5236\u53f0\u914d\u7f6e\uff09\n# - 30 \u5929\u540e\u8f6c\u79fb\u5230 Glacier\n# - 90 \u5929\u540e\u5220\u9664\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u963f\u91cc\u4e91-oss-\u5907\u4efd",children:"\u963f\u91cc\u4e91 OSS \u5907\u4efd"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n# /opt/scripts/redis-backup-oss.sh\n\nBACKUP_DIR="/backup/redis"\nOSS_BUCKET="oss://your-bucket/redis-backup"\nDATE=$(date +%Y%m%d_%H%M%S)\n\n# \u6267\u884c\u672c\u5730\u5907\u4efd\n/opt/scripts/redis-backup.sh\n\n# \u4e0a\u4f20\u5230 OSS\nossutil cp "$BACKUP_DIR/dump_$DATE.rdb" "$OSS_BUCKET/dump_$DATE.rdb"\n\n# \u6216\u4f7f\u7528 ossutil sync \u540c\u6b65\nossutil sync $BACKUP_DIR $OSS_BUCKET\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u5b89\u88c5\u4e91\u5b58\u50a8\u5de5\u5177",children:"\u5b89\u88c5\u4e91\u5b58\u50a8\u5de5\u5177"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# AWS CLI\npip install awscli\naws configure\n\n# \u963f\u91cc\u4e91 ossutil\nwget https://gosspublic.alicdn.com/ossutil/1.7.15/ossutil-v1.7.15-linux-amd64.zip\nunzip ossutil-v1.7.15-linux-amd64.zip\nsudo mv ossutil /usr/local/bin/\nossutil config\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u6570\u636e\u6062\u590d",children:"\u6570\u636e\u6062\u590d"}),"\n",(0,r.jsx)(e.h3,{id:"rdb-\u6062\u590d\u6d41\u7a0b",children:"RDB \u6062\u590d\u6d41\u7a0b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# 1. \u505c\u6b62 Redis\nsudo systemctl stop redis\n\n# 2. \u5907\u4efd\u5f53\u524d\u6570\u636e\uff08\u53ef\u9009\uff09\ncp /var/lib/redis/dump.rdb /var/lib/redis/dump.rdb.bak\n\n# 3. \u590d\u5236\u5907\u4efd\u6587\u4ef6\ncp /backup/redis/dump_20240101_020000.rdb /var/lib/redis/dump.rdb\n\n# 4. \u8bbe\u7f6e\u6587\u4ef6\u6743\u9650\nchown redis:redis /var/lib/redis/dump.rdb\nchmod 660 /var/lib/redis/dump.rdb\n\n# 5. \u542f\u52a8 Redis\nsudo systemctl start redis\n\n# 6. \u9a8c\u8bc1\u6062\u590d\nredis-cli INFO keyspace\nredis-cli DBSIZE\n"})}),"\n",(0,r.jsx)(e.h3,{id:"aof-\u6062\u590d\u6d41\u7a0b",children:"AOF \u6062\u590d\u6d41\u7a0b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# 1. \u505c\u6b62 Redis\nsudo systemctl stop redis\n\n# 2. \u5907\u4efd\u5f53\u524d\u6570\u636e\nmv /var/lib/redis/appendonlydir /var/lib/redis/appendonlydir.bak\n\n# 3. \u6062\u590d AOF \u6587\u4ef6 (Redis 7.0+)\ntar -xzf /backup/redis/aof/aof_20240101_020000.tar.gz -C /var/lib/redis/\n\n# 4. \u8bbe\u7f6e\u6743\u9650\nchown -R redis:redis /var/lib/redis/appendonlydir\n\n# 5. \u542f\u52a8 Redis\nsudo systemctl start redis\n\n# 6. \u9a8c\u8bc1\u6062\u590d\nredis-cli INFO persistence\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u4fee\u590d\u635f\u574f\u7684\u6301\u4e45\u5316\u6587\u4ef6",children:"\u4fee\u590d\u635f\u574f\u7684\u6301\u4e45\u5316\u6587\u4ef6"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"RDB \u6587\u4ef6\u68c0\u67e5"}),"\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5 RDB \u6587\u4ef6\nredis-check-rdb dump.rdb\n\n# \u8f93\u51fa\u793a\u4f8b\n# [offset 0] Checking RDB file dump.rdb\n# [offset 26] AUX FIELD redis-ver = '7.0.0'\n# ...\n# [offset 1234567] Checksum OK\n# [offset 1234567] \\o/ RDB looks OK! \\o/\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"AOF \u6587\u4ef6\u4fee\u590d"}),"\uff1a"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5\u5e76\u4fee\u590d AOF \u6587\u4ef6\nredis-check-aof --fix appendonly.aof\n\n# Redis 7.0+ \u4fee\u590d\nredis-check-aof --fix appendonlydir/appendonly.aof.manifest\n\n# \u4fee\u590d\u540e\u4f1a\u751f\u6210\u5907\u4efd\n# appendonly.aof.bak (\u539f\u6587\u4ef6\u5907\u4efd)\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u4ece-rdb-\u6062\u590d\u5230-aof-\u6a21\u5f0f",children:"\u4ece RDB \u6062\u590d\u5230 AOF \u6a21\u5f0f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# 1. \u4f7f\u7528 RDB \u542f\u52a8 Redis\nredis-server --dbfilename dump.rdb --appendonly no\n\n# 2. \u52a8\u6001\u5f00\u542f AOF\nredis-cli CONFIG SET appendonly yes\n\n# 3. \u7b49\u5f85 AOF \u91cd\u5199\u5b8c\u6210\nredis-cli BGREWRITEAOF\n\n# 4. \u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff0c\u6c38\u4e45\u751f\u6548\n# appendonly yes\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u707e\u96be\u6062\u590d",children:"\u707e\u96be\u6062\u590d"}),"\n",(0,r.jsx)(e.h3,{id:"\u6062\u590d\u6f14\u7ec3\u6d41\u7a0b",children:"\u6062\u590d\u6f14\u7ec3\u6d41\u7a0b"}),"\n",(0,r.jsx)(e.p,{children:"\u5b9a\u671f\uff08\u5efa\u8bae\u6bcf\u5b63\u5ea6\uff09\u6267\u884c\u707e\u96be\u6062\u590d\u6f14\u7ec3\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n# /opt/scripts/redis-dr-drill.sh\n# \u707e\u96be\u6062\u590d\u6f14\u7ec3\u811a\u672c\n\nDR_ENV="dr-redis"\nBACKUP_FILE="/backup/redis/dump_latest.rdb"\nTEST_PORT=6380\n\necho "=== Redis \u707e\u96be\u6062\u590d\u6f14\u7ec3 ==="\necho "\u5f00\u59cb\u65f6\u95f4: $(date)"\n\n# 1. \u542f\u52a8\u6d4b\u8bd5\u5b9e\u4f8b\necho "1. \u542f\u52a8\u6d4b\u8bd5 Redis \u5b9e\u4f8b..."\ndocker run -d --name $DR_ENV \\\n    -p $TEST_PORT:6379 \\\n    -v $BACKUP_FILE:/data/dump.rdb:ro \\\n    redis:7.0 redis-server --dbfilename dump.rdb\n\nsleep 5\n\n# 2. \u9a8c\u8bc1\u6570\u636e\necho "2. \u9a8c\u8bc1\u6570\u636e..."\nDBSIZE=$(redis-cli -p $TEST_PORT DBSIZE)\necho "   - \u952e\u6570\u91cf: $DBSIZE"\n\n# 3. \u62bd\u6837\u68c0\u67e5\necho "3. \u62bd\u6837\u68c0\u67e5..."\nSAMPLE_KEYS=$(redis-cli -p $TEST_PORT SCAN 0 COUNT 5 | tail -n +2)\nfor key in $SAMPLE_KEYS; do\n    TYPE=$(redis-cli -p $TEST_PORT TYPE "$key")\n    echo "   - $key: $TYPE"\ndone\n\n# 4. \u6027\u80fd\u6d4b\u8bd5\necho "4. \u6027\u80fd\u6d4b\u8bd5..."\nredis-benchmark -p $TEST_PORT -t get,set -n 1000 -q\n\n# 5. \u6e05\u7406\necho "5. \u6e05\u7406\u6d4b\u8bd5\u73af\u5883..."\ndocker stop $DR_ENV\ndocker rm $DR_ENV\n\necho "=== \u6f14\u7ec3\u5b8c\u6210 ==="\necho "\u7ed3\u675f\u65f6\u95f4: $(date)"\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u6062\u590d\u65f6\u95f4\u76ee\u6807-rto-\u8bc4\u4f30",children:"\u6062\u590d\u65f6\u95f4\u76ee\u6807 (RTO) \u8bc4\u4f30"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u6062\u590d\u573a\u666f"}),(0,r.jsx)(e.th,{children:"\u9884\u8ba1 RTO"}),(0,r.jsx)(e.th,{children:"\u5f71\u54cd\u56e0\u7d20"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"RDB \u6062\u590d\uff0810GB\uff09"}),(0,r.jsx)(e.td,{children:"2-5 \u5206\u949f"}),(0,r.jsx)(e.td,{children:"\u78c1\u76d8 I/O"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"AOF \u6062\u590d\uff0810GB\uff09"}),(0,r.jsx)(e.td,{children:"5-15 \u5206\u949f"}),(0,r.jsx)(e.td,{children:"\u547d\u4ee4\u91cd\u653e\u901f\u5ea6"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u6df7\u5408\u6301\u4e45\u5316\u6062\u590d"}),(0,r.jsx)(e.td,{children:"2-5 \u5206\u949f"}),(0,r.jsx)(e.td,{children:"RDB \u52a0\u8f7d + \u589e\u91cf AOF"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u4ece\u4e91\u5b58\u50a8\u6062\u590d"}),(0,r.jsx)(e.td,{children:"+5-30 \u5206\u949f"}),(0,r.jsx)(e.td,{children:"\u7f51\u7edc\u4e0b\u8f7d\u65f6\u95f4"})]})]})]}),"\n",(0,r.jsx)(e.h2,{id:"\u6570\u636e\u8fc1\u79fb",children:"\u6570\u636e\u8fc1\u79fb"}),"\n",(0,r.jsx)(e.h3,{id:"\u5728\u7ebf\u8fc1\u79fb\u4e3b\u4ece\u590d\u5236",children:"\u5728\u7ebf\u8fc1\u79fb\uff08\u4e3b\u4ece\u590d\u5236\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# 1. \u65b0\u670d\u52a1\u5668\u914d\u7f6e\u4e3a\u4ece\u8282\u70b9\nredis-cli -h new-server REPLICAOF old-server 6379\n\n# 2. \u7b49\u5f85\u540c\u6b65\u5b8c\u6210\nredis-cli -h new-server INFO replication\n# master_link_status:up\n# master_sync_in_progress:0\n\n# 3. \u63d0\u5347\u4e3a\u4e3b\u8282\u70b9\nredis-cli -h new-server REPLICAOF NO ONE\n\n# 4. \u5207\u6362\u5e94\u7528\u8fde\u63a5\u5230\u65b0\u670d\u52a1\u5668\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u79bb\u7ebf\u8fc1\u79fbrdb-\u6587\u4ef6",children:"\u79bb\u7ebf\u8fc1\u79fb\uff08RDB \u6587\u4ef6\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'# 1. \u5728\u6e90\u670d\u52a1\u5668\u751f\u6210 RDB\nredis-cli -h source-server BGSAVE\n\n# 2. \u590d\u5236 RDB \u6587\u4ef6\u5230\u76ee\u6807\u670d\u52a1\u5668\nscp source-server:/var/lib/redis/dump.rdb target-server:/var/lib/redis/\n\n# 3. \u5728\u76ee\u6807\u670d\u52a1\u5668\u542f\u52a8 Redis\nssh target-server "systemctl start redis"\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u4f7f\u7528-redis-shake-\u8fc1\u79fb",children:"\u4f7f\u7528 redis-shake \u8fc1\u79fb"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'# \u4e0b\u8f7d redis-shake\nwget https://github.com/alibaba/RedisShake/releases/download/v3.1.0/redis-shake-linux-amd64.tar.gz\ntar -xzf redis-shake-linux-amd64.tar.gz\n\n# \u914d\u7f6e shake.toml\ncat > shake.toml << EOF\n[source]\naddress = "127.0.0.1:6379"\npassword = ""\n\n[target]\naddress = "192.168.1.100:6379"\npassword = ""\nEOF\n\n# \u6267\u884c\u8fc1\u79fb\n./redis-shake shake.toml\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u96c6\u7fa4\u73af\u5883\u5907\u4efd",children:"\u96c6\u7fa4\u73af\u5883\u5907\u4efd"}),"\n",(0,r.jsx)(e.h3,{id:"redis-cluster-\u5907\u4efd",children:"Redis Cluster \u5907\u4efd"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\n# \u96c6\u7fa4\u5907\u4efd\u811a\u672c\n\nCLUSTER_NODES="192.168.1.101:7001 192.168.1.102:7002 192.168.1.103:7003"\nBACKUP_DIR="/backup/redis-cluster"\nDATE=$(date +%Y%m%d_%H%M%S)\nBACKUP_PATH="$BACKUP_DIR/$DATE"\n\nmkdir -p $BACKUP_PATH\n\nfor node in $CLUSTER_NODES; do\n    HOST=$(echo $node | cut -d: -f1)\n    PORT=$(echo $node | cut -d: -f2)\n    \n    echo "\u5907\u4efd\u8282\u70b9: $node"\n    \n    # \u89e6\u53d1 BGSAVE\n    redis-cli -h $HOST -p $PORT BGSAVE\n    sleep 5\n    \n    # \u590d\u5236 RDB \u6587\u4ef6\n    scp $HOST:/var/lib/redis/$PORT/dump.rdb "$BACKUP_PATH/dump_${HOST}_${PORT}.rdb"\ndone\n\n# \u4fdd\u5b58\u96c6\u7fa4\u4fe1\u606f\nredis-cli -c -h 192.168.1.101 -p 7001 CLUSTER NODES > "$BACKUP_PATH/cluster_nodes.txt"\nredis-cli -c -h 192.168.1.101 -p 7001 CLUSTER INFO > "$BACKUP_PATH/cluster_info.txt"\n\necho "\u96c6\u7fa4\u5907\u4efd\u5b8c\u6210: $BACKUP_PATH"\n'})}),"\n",(0,r.jsx)(e.h3,{id:"sentinel-\u73af\u5883\u5907\u4efd",children:"Sentinel \u73af\u5883\u5907\u4efd"}),"\n",(0,r.jsx)(e.p,{children:"\u5bf9\u4e8e\u54e8\u5175\u6a21\u5f0f\uff0c\u53ea\u9700\u5907\u4efd\u4e3b\u8282\u70b9\u7684 RDB/AOF \u6587\u4ef6\u3002\u4ece\u8282\u70b9\u4f1a\u81ea\u52a8\u4ece\u4e3b\u8282\u70b9\u540c\u6b65\u6570\u636e\u3002"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u83b7\u53d6\u5f53\u524d\u4e3b\u8282\u70b9\nMASTER=$(redis-cli -h sentinel-host -p 26379 SENTINEL get-master-addr-by-name mymaster)\nMASTER_HOST=$(echo $MASTER | awk '{print $1}')\nMASTER_PORT=$(echo $MASTER | awk '{print $2}')\n\n# \u5907\u4efd\u4e3b\u8282\u70b9\nredis-cli -h $MASTER_HOST -p $MASTER_PORT BGSAVE\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u76d1\u63a7\u4e0e\u544a\u8b66",children:"\u76d1\u63a7\u4e0e\u544a\u8b66"}),"\n",(0,r.jsx)(e.h3,{id:"\u5907\u4efd\u76d1\u63a7\u6307\u6807",children:"\u5907\u4efd\u76d1\u63a7\u6307\u6807"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5\u6700\u540e\u5907\u4efd\u65f6\u95f4\nredis-cli INFO persistence | grep rdb_last_save_time\n\n# \u68c0\u67e5\u5907\u4efd\u6587\u4ef6\nls -la /backup/redis/\n\n# \u68c0\u67e5\u5907\u4efd\u6587\u4ef6\u5927\u5c0f\u53d8\u5316\ndu -sh /backup/redis/*\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u544a\u8b66\u914d\u7f6e\u793a\u4f8bprometheus-alertmanager",children:"\u544a\u8b66\u914d\u7f6e\u793a\u4f8b\uff08Prometheus AlertManager\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:'groups:\n  - name: redis-backup\n    rules:\n      - alert: RedisBackupTooOld\n        expr: time() - redis_rdb_last_save_timestamp_seconds > 86400\n        for: 10m\n        labels:\n          severity: warning\n        annotations:\n          summary: "Redis \u5907\u4efd\u8d85\u8fc7 24 \u5c0f\u65f6\u672a\u66f4\u65b0"\n          \n      - alert: RedisBackupFileMissing\n        expr: redis_rdb_last_cow_size_bytes == 0\n        for: 5m\n        labels:\n          severity: critical\n        annotations:\n          summary: "Redis RDB \u5907\u4efd\u6587\u4ef6\u53ef\u80fd\u4e22\u5931"\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u5c0f\u7ed3",children:"\u5c0f\u7ed3"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u5907\u4efd\u7c7b\u578b"}),(0,r.jsx)(e.th,{children:"\u9002\u7528\u573a\u666f"}),(0,r.jsx)(e.th,{children:"\u6062\u590d\u901f\u5ea6"}),(0,r.jsx)(e.th,{children:"\u6570\u636e\u5b8c\u6574\u6027"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"RDB \u624b\u52a8"}),(0,r.jsx)(e.td,{children:"\u4e34\u65f6\u5907\u4efd"}),(0,r.jsx)(e.td,{children:"\u5feb"}),(0,r.jsx)(e.td,{children:"\u4e2d"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"RDB \u81ea\u52a8"}),(0,r.jsx)(e.td,{children:"\u5b9a\u671f\u5907\u4efd"}),(0,r.jsx)(e.td,{children:"\u5feb"}),(0,r.jsx)(e.td,{children:"\u4e2d"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"AOF"}),(0,r.jsx)(e.td,{children:"\u70ed\u5907\u4efd"}),(0,r.jsx)(e.td,{children:"\u4e2d"}),(0,r.jsx)(e.td,{children:"\u9ad8"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u4e91\u5b58\u50a8"}),(0,r.jsx)(e.td,{children:"\u5f02\u5730\u5bb9\u707e"}),(0,r.jsx)(e.td,{children:"\u6162"}),(0,r.jsx)(e.td,{children:"\u9ad8"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u4e3b\u4ece\u590d\u5236"}),(0,r.jsx)(e.td,{children:"\u5728\u7ebf\u8fc1\u79fb"}),(0,r.jsx)(e.td,{children:"\u5feb"}),(0,r.jsx)(e.td,{children:"\u9ad8"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u6700\u4f73\u5b9e\u8df5"}),"\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u2705 \u540c\u65f6\u542f\u7528 RDB \u548c AOF"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 \u5b9a\u671f\u5907\u4efd\u5230\u5f02\u5730\u5b58\u50a8"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 \u5b9a\u671f\u6267\u884c\u6062\u590d\u6f14\u7ec3"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 \u76d1\u63a7\u5907\u4efd\u72b6\u6001\u548c\u6587\u4ef6\u5927\u5c0f"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 \u4fdd\u7559\u591a\u4e2a\u5907\u4efd\u7248\u672c"}),"\n"]})]})}function o(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(h,{...n})}):h(n)}},48885:(n,e,s)=>{s.d(e,{R:()=>l,x:()=>c});var d=s(99378);const r={},i=d.createContext(r);function l(n){const e=d.useContext(i);return d.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),d.createElement(i.Provider,{value:e},n.children)}}}]);