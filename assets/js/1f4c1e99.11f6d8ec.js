"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[389],{48885:(n,e,l)=>{l.d(e,{R:()=>i,x:()=>a});var t=l(99378);const r={},d=t.createContext(r);function i(n){const e=t.useContext(d);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:i(n.components),t.createElement(d.Provider,{value:e},n.children)}},95877:(n,e,l)=>{l.r(e),l.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>t,toc:()=>s});const t=JSON.parse('{"id":"netty/core-components","title":"\u6838\u5fc3\u7ec4\u4ef6\u8be6\u89e3","description":"Channel","source":"@site/docs/netty/core-components.md","sourceDirName":"netty","slug":"/netty/core-components","permalink":"/docs/netty/core-components","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/netty/core-components.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"netty","previous":{"title":"Netty \u57fa\u7840\u6982\u5ff5","permalink":"/docs/netty/basics"},"next":{"title":"ByteBuf \u8be6\u89e3","permalink":"/docs/netty/bytebuf"}}');var r=l(22714),d=l(48885);const i={sidebar_position:3},a="\u6838\u5fc3\u7ec4\u4ef6\u8be6\u89e3",c={},s=[{value:"Channel",id:"channel",level:2},{value:"Channel \u7684\u751f\u547d\u5468\u671f",id:"channel-\u7684\u751f\u547d\u5468\u671f",level:3},{value:"\u5e38\u7528 Channel \u7c7b\u578b",id:"\u5e38\u7528-channel-\u7c7b\u578b",level:3},{value:"Channel \u64cd\u4f5c\u793a\u4f8b",id:"channel-\u64cd\u4f5c\u793a\u4f8b",level:3},{value:"EventLoop",id:"eventloop",level:2},{value:"EventLoopGroup",id:"eventloopgroup",level:3},{value:"EventLoop \u7684\u804c\u8d23",id:"eventloop-\u7684\u804c\u8d23",level:3},{value:"\u63d0\u4ea4\u4efb\u52a1\u5230 EventLoop",id:"\u63d0\u4ea4\u4efb\u52a1\u5230-eventloop",level:3},{value:"EventLoop \u6700\u4f73\u5b9e\u8df5",id:"eventloop-\u6700\u4f73\u5b9e\u8df5",level:3},{value:"ChannelPipeline",id:"channelpipeline",level:2},{value:"Pipeline \u7ed3\u6784",id:"pipeline-\u7ed3\u6784",level:3},{value:"Handler \u7684\u4e24\u4e2a\u65b9\u5411",id:"handler-\u7684\u4e24\u4e2a\u65b9\u5411",level:3},{value:"\u6dfb\u52a0\u548c\u79fb\u9664 Handler",id:"\u6dfb\u52a0\u548c\u79fb\u9664-handler",level:3},{value:"Pipeline \u521d\u59cb\u5316",id:"pipeline-\u521d\u59cb\u5316",level:3},{value:"ChannelHandlerContext",id:"channelhandlercontext",level:2},{value:"\u83b7\u53d6 Context",id:"\u83b7\u53d6-context",level:3},{value:"\u4e8b\u4ef6\u4f20\u64ad",id:"\u4e8b\u4ef6\u4f20\u64ad",level:3},{value:"\u603b\u7ed3\u8868\u683c",id:"\u603b\u7ed3\u8868\u683c",level:2}];function o(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"\u6838\u5fc3\u7ec4\u4ef6\u8be6\u89e3",children:"\u6838\u5fc3\u7ec4\u4ef6\u8be6\u89e3"})}),"\n",(0,r.jsx)(e.h2,{id:"channel",children:"Channel"}),"\n",(0,r.jsx)(e.p,{children:"Channel \u662f Netty \u7684\u6838\u5fc3\u62bd\u8c61\uff0c\u4ee3\u8868\u5230\u5b9e\u4f53\u7684\u903b\u8f91\u8fde\u63a5\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"channel-\u7684\u751f\u547d\u5468\u671f",children:"Channel \u7684\u751f\u547d\u5468\u671f"}),"\n",(0,r.jsx)(e.mermaid,{value:"stateDiagram-v2\n    [*] --\x3e channelCreated: Channel \u521b\u5efa\n    channelCreated --\x3e channelRegistered: \u6ce8\u518c\u5230 EventLoop\n    channelRegistered --\x3e channelActive: \u8fde\u63a5\u5efa\u7acb/\u6fc0\u6d3b\n    channelActive --\x3e \u8bfb\u5199\u64cd\u4f5c: \u5904\u7406\u6570\u636e\n    \u8bfb\u5199\u64cd\u4f5c --\x3e channelActive: \u7ee7\u7eed\u5904\u7406\n    channelActive --\x3e channelInactive: \u8fde\u63a5\u5173\u95ed\n    channelInactive --\x3e channelUnregistered: \u6ce8\u9500\n    channelUnregistered --\x3e [*]\n    \n    note right of channelActive: \u8fde\u63a5\u6d3b\u8dc3\u72b6\u6001\n    note right of \u8bfb\u5199\u64cd\u4f5c: channelRead\\nchannelWrite"}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsxs)(e.p,{children:["[!NOTE]\n",(0,r.jsx)(e.strong,{children:"\u751f\u547d\u5468\u671f\u8bf4\u660e:"})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"channelRegistered"})," - Channel \u4e0e EventLoop \u7ed1\u5b9a"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"channelActive"})," - \u8fde\u63a5\u5efa\u7acb,\u53ef\u4ee5\u5f00\u59cb\u8bfb\u5199"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"channelInactive"})," - \u8fde\u63a5\u65ad\u5f00,\u4e0d\u518d\u5904\u7406\u6570\u636e"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"channelUnregistered"})," - \u4ece EventLoop \u6ce8\u9500"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u5e38\u7528-channel-\u7c7b\u578b",children:"\u5e38\u7528 Channel \u7c7b\u578b"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Channel \u7c7b\u578b"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"NioServerSocketChannel"})}),(0,r.jsx)(e.td,{children:"\u670d\u52a1\u5668 ServerSocket \u901a\u9053"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"NioSocketChannel"})}),(0,r.jsx)(e.td,{children:"\u5ba2\u6237\u7aef Socket \u901a\u9053"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"NioDatagramChannel"})}),(0,r.jsx)(e.td,{children:"UDP \u6570\u636e\u62a5\u901a\u9053"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"NioSctpServerChannel"})}),(0,r.jsx)(e.td,{children:"SCTP \u670d\u52a1\u5668\u901a\u9053"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"NioSctpChannel"})}),(0,r.jsx)(e.td,{children:"SCTP \u901a\u9053"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"OioServerSocketChannel"})}),(0,r.jsx)(e.td,{children:"\u963b\u585e I/O \u670d\u52a1\u5668\u901a\u9053"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"channel-\u64cd\u4f5c\u793a\u4f8b",children:"Channel \u64cd\u4f5c\u793a\u4f8b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'// \u5199\u5165\u6570\u636e\nChannelFuture future = ctx.writeAndFlush(msg);\nfuture.addListener(f -> {\n    if (f.isSuccess()) {\n        System.out.println("\u6570\u636e\u5199\u5165\u6210\u529f");\n    }\n});\n\n// \u5173\u95ed Channel\nctx.close();\n\n// \u83b7\u53d6 Channel \u5c5e\u6027\nChannel channel = ctx.channel();\nInetSocketAddress remote = (InetSocketAddress) channel.remoteAddress();\nInetSocketAddress local = (InetSocketAddress) channel.localAddress();\nSystem.out.println("Local: " + local + ", Remote: " + remote);\n\n// \u68c0\u67e5 Channel \u72b6\u6001\nif (channel.isActive()) {\n    System.out.println("Channel \u6d3b\u8dc3");\n}\nif (channel.isOpen()) {\n    System.out.println("Channel \u5f00\u653e");\n}\nif (channel.isWritable()) {\n    System.out.println("Channel \u53ef\u5199");\n}\n\n// \u4fdd\u5b58\u81ea\u5b9a\u4e49\u6570\u636e\nchannel.attr(AttributeKey.valueOf("userId")).set(12345);\nInteger userId = (Integer) channel.attr(AttributeKey.valueOf("userId")).get();\n'})}),"\n",(0,r.jsx)(e.h2,{id:"eventloop",children:"EventLoop"}),"\n",(0,r.jsx)(e.p,{children:"EventLoop \u662f\u5355\u7ebf\u7a0b\u5316\u7684 I/O \u5904\u7406\u7ebf\u7a0b\uff0c\u8d1f\u8d23\u5904\u7406\u8fde\u63a5\u7684\u6240\u6709 I/O \u64cd\u4f5c\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"eventloopgroup",children:"EventLoopGroup"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// NIO \u4e8b\u4ef6\u5faa\u73af\u7ec4\nEventLoopGroup bossGroup = new NioEventLoopGroup(1);\nEventLoopGroup workerGroup = new NioEventLoopGroup();\n\n// OIO \u4e8b\u4ef6\u5faa\u73af\u7ec4\uff08\u4e0d\u63a8\u8350\uff09\nEventLoopGroup group = new OioEventLoopGroup();\n\n// \u4f18\u96c5\u5173\u95ed\nbossGroup.shutdownGracefully();\nworkerGroup.shutdownGracefully();\n"})}),"\n",(0,r.jsx)(e.h3,{id:"eventloop-\u7684\u804c\u8d23",children:"EventLoop \u7684\u804c\u8d23"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"EventLoop \u7ebf\u7a0b\u5faa\u73af\u6267\u884c\uff1a\n1. \u8f6e\u8be2\u6ce8\u518c\u7684 Channel\uff08\u4f7f\u7528 Selector\uff09\n2. \u5904\u7406\u9009\u4e2d Channel \u7684 I/O \u4e8b\u4ef6\n3. \u6267\u884c EventLoop \u4e0a\u7684\u4efb\u52a1\u961f\u5217\u4e2d\u7684\u4efb\u52a1\n4. \u5982\u679c\u6ca1\u6709 I/O \u548c\u4efb\u52a1\uff0c\u5219\u7b49\u5f85\u4e0b\u4e00\u4e2a\u8f6e\u8be2\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u63d0\u4ea4\u4efb\u52a1\u5230-eventloop",children:"\u63d0\u4ea4\u4efb\u52a1\u5230 EventLoop"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class MyHandler extends ChannelInboundHandlerAdapter {\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) {\n        // \u65b9\u5f0f1\uff1a\u63d0\u4ea4\u5230 Handler \u5173\u8054\u7684 EventLoop\n        ctx.executor().execute(() -> {\n            System.out.println("\u5728 EventLoop \u4e2d\u6267\u884c");\n        });\n\n        // \u65b9\u5f0f2\uff1a\u63d0\u4ea4\u5e26\u5ef6\u8fdf\u7684\u4efb\u52a1\n        ctx.executor().schedule(() -> {\n            System.out.println("\u5ef6\u8fdf 1 \u79d2\u540e\u6267\u884c");\n        }, 1, TimeUnit.SECONDS);\n\n        // \u65b9\u5f0f3\uff1a\u63d0\u4ea4\u5468\u671f\u4efb\u52a1\n        ctx.executor().scheduleAtFixedRate(() -> {\n            System.out.println("\u6bcf 1 \u79d2\u6267\u884c\u4e00\u6b21");\n        }, 1, 1, TimeUnit.SECONDS);\n\n        // \u65b9\u5f0f4\uff1a\u63d0\u4ea4\u5230 Channel \u7684 EventLoop\uff08\u63a8\u8350\uff09\n        ctx.channel().eventLoop().execute(() -> {\n            System.out.println("\u5728 Channel \u7684 EventLoop \u4e2d\u6267\u884c");\n        });\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"eventloop-\u6700\u4f73\u5b9e\u8df5",children:"EventLoop \u6700\u4f73\u5b9e\u8df5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"// \u2713 \u6b63\u786e\uff1a\u5feb\u901f\u64cd\u4f5c\u5728 EventLoop \u4e2d\u6267\u884c\n@Override\npublic void channelRead(ChannelHandlerContext ctx, Object msg) {\n    // \u8fd9\u662f\u6b63\u786e\u7684 - \u5feb\u901f\u64cd\u4f5c\n    ctx.write(msg);\n}\n\n// \u2717 \u9519\u8bef\uff1a\u963b\u585e\u64cd\u4f5c\u5728 EventLoop \u4e2d\u6267\u884c\n@Override\npublic void channelRead(ChannelHandlerContext ctx, Object msg) {\n    // \u8fd9\u662f\u9519\u8bef\u7684 - \u963b\u585e\u64cd\u4f5c\u4f1a\u5bfc\u81f4 EventLoop \u5361\u4f4f\n    try {\n        Thread.sleep(1000);\n    } catch (InterruptedException e) {\n        e.printStackTrace();\n    }\n    ctx.write(msg);\n}\n\n// \u2713 \u6b63\u786e\uff1a\u963b\u585e\u64cd\u4f5c\u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u6267\u884c\nprivate ExecutorService executor = Executors.newFixedThreadPool(10);\n\n@Override\npublic void channelRead(ChannelHandlerContext ctx, Object msg) {\n    executor.execute(() -> {\n        try {\n            // \u963b\u585e\u64cd\u4f5c\u5728\u72ec\u7acb\u7ebf\u7a0b\u4e2d\u6267\u884c\n            Thread.sleep(1000);\n            ctx.writeAndFlush(msg);\n        } catch (InterruptedException e) {\n            Thread.currentThread().interrupt();\n        }\n    });\n}\n"})}),"\n",(0,r.jsx)(e.h2,{id:"channelpipeline",children:"ChannelPipeline"}),"\n",(0,r.jsx)(e.p,{children:"Pipeline \u662f\u4e00\u4e2a Handler \u7684\u5bb9\u5668\u548c\u5904\u7406\u94fe\uff0c\u8d1f\u8d23\u7ba1\u7406 Handler \u7684\u6267\u884c\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"pipeline-\u7ed3\u6784",children:"Pipeline \u7ed3\u6784"}),"\n",(0,r.jsx)(e.mermaid,{value:'graph LR\n    subgraph "ChannelPipeline"\n    direction LR\n    Head[Head] --\x3e|Inbound| H1[Handler1]\n    H1 --\x3e|Inbound| H2[Handler2]\n    H2 --\x3e|Inbound| H3[Handler3]\n    H3 --\x3e|Inbound| Tail[Tail]\n    \n    Tail -.->|Outbound| H3\n    H3 -.->|Outbound| H2\n    H2 -.->|Outbound| H1\n    H1 -.->|Outbound| Head\n    end\n    \n    IN((\u6570\u636e\u8fdb\u5165)) --\x3e Head\n    Tail --\x3e OUT((\u6570\u636e\u8f93\u51fa))\n    \n    style Head fill:#e1f5ff\n    style Tail fill:#e1f5ff\n    style H1 fill:#c8e6c9\n    style H2 fill:#c8e6c9\n    style H3 fill:#c8e6c9'}),"\n",(0,r.jsxs)(e.blockquote,{children:["\n",(0,r.jsxs)(e.p,{children:["[!TIP]\n",(0,r.jsx)(e.strong,{children:"Pipeline \u6570\u636e\u6d41\u5411:"})]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Inbound"})," (\u5b9e\u7ebf\u7bad\u5934): \u8bfb\u53d6\u6570\u636e,\u4ece Head \u2192 Tail"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"Outbound"})," (\u865a\u7ebf\u7bad\u5934): \u5199\u5165\u6570\u636e,\u4ece Tail \u2192 Head"]}),"\n",(0,r.jsx)(e.li,{children:"Head \u548c Tail \u662fNetty\u81ea\u52a8\u6dfb\u52a0\u7684\u7279\u6b8aHandler"}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"handler-\u7684\u4e24\u4e2a\u65b9\u5411",children:"Handler \u7684\u4e24\u4e2a\u65b9\u5411"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class MyHandler extends ChannelDuplexHandler {\n    // ========== Inbound \u4e8b\u4ef6\uff08\u8bfb\u53d6\u6570\u636e\uff09==========\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) {\n        System.out.println("\u63a5\u6536\u5230\u6570\u636e");\n        // \u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a Handler\n        ctx.fireChannelRead(msg);\n    }\n\n    @Override\n    public void channelReadComplete(ChannelHandlerContext ctx) {\n        System.out.println("\u8bfb\u53d6\u5b8c\u6210");\n        ctx.fireChannelReadComplete();\n    }\n\n    // ========== Outbound \u4e8b\u4ef6\uff08\u5199\u5165\u6570\u636e\uff09==========\n    @Override\n    public void write(ChannelHandlerContext ctx, Object msg, \n                      ChannelPromise promise) {\n        System.out.println("\u5199\u5165\u6570\u636e");\n        // \u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a Handler\n        ctx.write(msg, promise);\n    }\n\n    @Override\n    public void flush(ChannelHandlerContext ctx) {\n        System.out.println("\u5237\u65b0\u7f13\u51b2\u533a");\n        ctx.flush();\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, \n                                Throwable cause) {\n        cause.printStackTrace();\n        ctx.close();\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u6dfb\u52a0\u548c\u79fb\u9664-handler",children:"\u6dfb\u52a0\u548c\u79fb\u9664 Handler"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class DynamicHandlerExample extends ChannelInboundHandlerAdapter {\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) {\n        // \u6dfb\u52a0 Handler\n        ctx.pipeline().addLast("myHandler", new MyHandler());\n\n        // \u79fb\u9664 Handler\n        ctx.pipeline().remove("oldHandler");\n\n        // \u66ff\u6362 Handler\n        ctx.pipeline().replace("oldHandler", "newHandler", new NewHandler());\n\n        // \u83b7\u53d6 Handler\n        MyHandler handler = ctx.pipeline().get(MyHandler.class);\n\n        // \u6309\u540d\u79f0\u83b7\u53d6\n        ChannelHandler handler2 = ctx.pipeline().get("myHandler");\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"pipeline-\u521d\u59cb\u5316",children:"Pipeline \u521d\u59cb\u5316"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'ServerBootstrap bootstrap = new ServerBootstrap();\nbootstrap.childHandler(new ChannelInitializer<SocketChannel>() {\n    @Override\n    protected void initChannel(SocketChannel ch) {\n        ChannelPipeline pipeline = ch.pipeline();\n        \n        // \u6dfb\u52a0\u591a\u4e2a Handler\uff0c\u6309\u987a\u5e8f\u5904\u7406\n        pipeline.addLast("frameDecoder", new FrameDecoder());\n        pipeline.addLast("stringDecoder", new StringDecoder(CharsetUtil.UTF_8));\n        pipeline.addLast("logHandler", new LoggingHandler(LogLevel.DEBUG));\n        pipeline.addLast("businessHandler", new MyBusinessHandler());\n    }\n});\n'})}),"\n",(0,r.jsx)(e.h2,{id:"channelhandlercontext",children:"ChannelHandlerContext"}),"\n",(0,r.jsx)(e.p,{children:"Context \u662f Handler \u4e0e\u5176\u4ed6 Handler \u4e4b\u95f4\u7684\u901a\u4fe1\u5de5\u5177\u3002"}),"\n",(0,r.jsx)(e.h3,{id:"\u83b7\u53d6-context",children:"\u83b7\u53d6 Context"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class MyHandler extends ChannelInboundHandlerAdapter {\n    @Override\n    public void channelActive(ChannelHandlerContext ctx) {\n        // \u83b7\u53d6\u5173\u8054\u7684 Channel\n        Channel channel = ctx.channel();\n\n        // \u83b7\u53d6\u5173\u8054\u7684 EventLoop\n        EventLoop eventLoop = ctx.eventLoop();\n\n        // \u83b7\u53d6 Handler \u540d\u79f0\n        String name = ctx.name();\n\n        // \u83b7\u53d6 Pipeline\n        ChannelPipeline pipeline = ctx.pipeline();\n\n        // \u83b7\u53d6\u5c5e\u6027 Attributes\n        Attribute<String> attr = ctx.attr(AttributeKey.valueOf("key"));\n        attr.set("value");\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u4e8b\u4ef6\u4f20\u64ad",children:"\u4e8b\u4ef6\u4f20\u64ad"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'public class Handler1 extends ChannelInboundHandlerAdapter {\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) {\n        System.out.println("Handler1 \u5904\u7406");\n        // \u4f20\u64ad\u7ed9\u4e0b\u4e00\u4e2a Handler\n        ctx.fireChannelRead(msg);\n        // \u6216\u8005\u76f4\u63a5\u8c03\u7528\u4e0b\u4e00\u4e2a Handler \u7684\u65b9\u6cd5\n        ctx.fireChannelReadComplete();\n    }\n}\n\npublic class Handler2 extends ChannelInboundHandlerAdapter {\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) {\n        System.out.println("Handler2 \u5904\u7406");\n        // \u5fc5\u987b\u7ee7\u7eed\u4f20\u64ad\uff0c\u5426\u5219\u6570\u636e\u5c31\u4f1a\u505c\u7559\u5728\u8fd9\u91cc\n        ctx.fireChannelRead(msg);\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u603b\u7ed3\u8868\u683c",children:"\u603b\u7ed3\u8868\u683c"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u7ec4\u4ef6"}),(0,r.jsx)(e.th,{children:"\u804c\u8d23"}),(0,r.jsx)(e.th,{children:"\u5173\u952e\u65b9\u6cd5"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Channel"})}),(0,r.jsx)(e.td,{children:"\u7f51\u7edc\u8fde\u63a5\u7684\u62bd\u8c61"}),(0,r.jsx)(e.td,{children:"write\u3001flush\u3001close"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"EventLoop"})}),(0,r.jsx)(e.td,{children:"I/O \u4e8b\u4ef6\u5904\u7406\u7ebf\u7a0b"}),(0,r.jsx)(e.td,{children:"execute\u3001schedule"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"EventLoopGroup"})}),(0,r.jsx)(e.td,{children:"EventLoop \u7684\u5bb9\u5668\u548c\u7ba1\u7406\u5668"}),(0,r.jsx)(e.td,{children:"next\u3001shutdown"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Pipeline"})}),(0,r.jsx)(e.td,{children:"Handler \u7684\u5904\u7406\u94fe"}),(0,r.jsx)(e.td,{children:"addLast\u3001remove\u3001write"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Handler"})}),(0,r.jsx)(e.td,{children:"\u4e1a\u52a1\u903b\u8f91\u5904\u7406"}),(0,r.jsx)(e.td,{children:"channelRead\u3001write"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Context"})}),(0,r.jsx)(e.td,{children:"Handler \u4e4b\u95f4\u7684\u901a\u4fe1"}),(0,r.jsx)(e.td,{children:"fireChannelRead\u3001write"})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.a,{href:"/docs/netty/bytebuf",children:"\u4e0b\u4e00\u7ae0\uff1aByteBuf \u8be6\u89e3"})})]})}function h(n={}){const{wrapper:e}={...(0,d.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}}}]);