"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[40790],{3350:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"networking/socket-programming","title":"Socket \u7f16\u7a0b","description":"Socket\u7f51\u7edc\u7f16\u7a0b\u57fa\u7840\uff0c\u5305\u62ecTCP/UDP Socket\u3001IO\u6a21\u578b\u3001Java\u793a\u4f8b","source":"@site/docs/networking/socket-programming.md","sourceDirName":"networking","slug":"/networking/socket-programming","permalink":"/docs/networking/socket-programming","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/networking/socket-programming.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"Socket \u7f16\u7a0b","description":"Socket\u7f51\u7edc\u7f16\u7a0b\u57fa\u7840\uff0c\u5305\u62ecTCP/UDP Socket\u3001IO\u6a21\u578b\u3001Java\u793a\u4f8b","keywords":["Socket","\u7f51\u7edc\u7f16\u7a0b","TCP","UDP","BIO","NIO","IO\u591a\u8def\u590d\u7528"]},"sidebar":"networking","previous":{"title":"UDP \u534f\u8bae","permalink":"/docs/networking/udp"},"next":{"title":"HTTP \u534f\u8bae","permalink":"/docs/networking/http"}}');var s=t(22714),c=t(48885);const i={sidebar_position:7,title:"Socket \u7f16\u7a0b",description:"Socket\u7f51\u7edc\u7f16\u7a0b\u57fa\u7840\uff0c\u5305\u62ecTCP/UDP Socket\u3001IO\u6a21\u578b\u3001Java\u793a\u4f8b",keywords:["Socket","\u7f51\u7edc\u7f16\u7a0b","TCP","UDP","BIO","NIO","IO\u591a\u8def\u590d\u7528"]},l="Socket \u7f16\u7a0b",d={},a=[{value:"\u57fa\u672c\u6982\u5ff5",id:"\u57fa\u672c\u6982\u5ff5",level:2},{value:"\u4ec0\u4e48\u662f Socket\uff1f",id:"\u4ec0\u4e48\u662f-socket",level:3},{value:"Socket \u4e94\u5143\u7ec4",id:"socket-\u4e94\u5143\u7ec4",level:3},{value:"TCP Socket",id:"tcp-socket",level:2},{value:"\u901a\u4fe1\u6d41\u7a0b",id:"\u901a\u4fe1\u6d41\u7a0b",level:3},{value:"Java TCP \u670d\u52a1\u7aef",id:"java-tcp-\u670d\u52a1\u7aef",level:3},{value:"Java TCP \u5ba2\u6237\u7aef",id:"java-tcp-\u5ba2\u6237\u7aef",level:3},{value:"UDP Socket",id:"udp-socket",level:2},{value:"\u901a\u4fe1\u6d41\u7a0b",id:"\u901a\u4fe1\u6d41\u7a0b-1",level:3},{value:"Java UDP \u670d\u52a1\u7aef",id:"java-udp-\u670d\u52a1\u7aef",level:3},{value:"Java UDP \u5ba2\u6237\u7aef",id:"java-udp-\u5ba2\u6237\u7aef",level:3},{value:"I/O \u6a21\u578b",id:"io-\u6a21\u578b",level:2},{value:"\u4e94\u79cd I/O \u6a21\u578b",id:"\u4e94\u79cd-io-\u6a21\u578b",level:3},{value:"BIO vs NIO",id:"bio-vs-nio",level:3},{value:"I/O \u591a\u8def\u590d\u7528",id:"io-\u591a\u8def\u590d\u7528",level:3},{value:"Java NIO",id:"java-nio",level:2},{value:"\u6838\u5fc3\u7ec4\u4ef6",id:"\u6838\u5fc3\u7ec4\u4ef6",level:3},{value:"NIO \u670d\u52a1\u7aef\u793a\u4f8b",id:"nio-\u670d\u52a1\u7aef\u793a\u4f8b",level:3},{value:"\u5e38\u89c1\u6a21\u5f0f",id:"\u5e38\u89c1\u6a21\u5f0f",level:2},{value:"\u7ebf\u7a0b\u6c60\u5904\u7406",id:"\u7ebf\u7a0b\u6c60\u5904\u7406",level:3},{value:"Reactor \u6a21\u5f0f",id:"reactor-\u6a21\u5f0f",level:3},{value:"Socket \u9009\u9879",id:"socket-\u9009\u9879",level:2},{value:"\u4e0b\u4e00\u6b65",id:"\u4e0b\u4e00\u6b65",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"socket-\u7f16\u7a0b",children:"Socket \u7f16\u7a0b"})}),"\n",(0,s.jsx)(n.p,{children:"Socket\uff08\u5957\u63a5\u5b57\uff09\u662f\u7f51\u7edc\u901a\u4fe1\u7684\u7aef\u70b9\uff0c\u63d0\u4f9b\u4e86\u5e94\u7528\u5c42\u4e0e\u4f20\u8f93\u5c42\u4e4b\u95f4\u7684\u63a5\u53e3\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u57fa\u672c\u6982\u5ff5",children:"\u57fa\u672c\u6982\u5ff5"}),"\n",(0,s.jsx)(n.h3,{id:"\u4ec0\u4e48\u662f-socket",children:"\u4ec0\u4e48\u662f Socket\uff1f"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[\u5e94\u7528\u7a0b\u5e8f] --\x3e B[Socket API]\n    B --\x3e C[\u4f20\u8f93\u5c42 TCP/UDP]\n    C --\x3e D[\u7f51\u7edc\u5c42 IP]\n    D --\x3e E[\u7269\u7406\u7f51\u7edc]"}),"\n",(0,s.jsxs)(n.p,{children:["Socket \u672c\u8d28\u662f\u4e00\u4e2a",(0,s.jsx)(n.strong,{children:"\u6587\u4ef6\u63cf\u8ff0\u7b26"}),"\uff0c\u901a\u8fc7\u5b83\u53ef\u4ee5\u53d1\u9001\u548c\u63a5\u6536\u7f51\u7edc\u6570\u636e\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"socket-\u4e94\u5143\u7ec4",children:"Socket \u4e94\u5143\u7ec4"}),"\n",(0,s.jsx)(n.p,{children:"\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\u7531\u4ee5\u4e0b\u4e94\u4e2a\u5143\u7d20\u552f\u4e00\u6807\u8bc6\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"<\u534f\u8bae, \u6e90IP, \u6e90\u7aef\u53e3, \u76ee\u7684IP, \u76ee\u7684\u7aef\u53e3>\n"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u5143\u7d20"}),(0,s.jsx)(n.th,{children:"\u793a\u4f8b"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u534f\u8bae"}),(0,s.jsx)(n.td,{children:"TCP"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u6e90 IP"}),(0,s.jsx)(n.td,{children:"192.168.1.100"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u6e90\u7aef\u53e3"}),(0,s.jsx)(n.td,{children:"52341"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u76ee\u7684 IP"}),(0,s.jsx)(n.td,{children:"142.250.80.46"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u76ee\u7684\u7aef\u53e3"}),(0,s.jsx)(n.td,{children:"443"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"tcp-socket",children:"TCP Socket"}),"\n",(0,s.jsx)(n.h3,{id:"\u901a\u4fe1\u6d41\u7a0b",children:"\u901a\u4fe1\u6d41\u7a0b"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant S as \u670d\u52a1\u7aef\n    participant C as \u5ba2\u6237\u7aef\n\n    Note over S: socket()\n    Note over S: bind()\n    Note over S: listen()\n    Note over S: accept() \u963b\u585e\u7b49\u5f85\n\n    Note over C: socket()\n    C->>S: connect()\n    Note over S: accept() \u8fd4\u56de\u65b0 socket\n\n    C->>S: send()\n    S->>C: recv()\n\n    C->>S: close()\n    Note over S: close()"}),"\n",(0,s.jsx)(n.h3,{id:"java-tcp-\u670d\u52a1\u7aef",children:"Java TCP \u670d\u52a1\u7aef"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public class TcpServer {\n    public static void main(String[] args) throws IOException {\n        // 1. \u521b\u5efa ServerSocket\uff0c\u7ed1\u5b9a\u7aef\u53e3\n        ServerSocket serverSocket = new ServerSocket(8080);\n        System.out.println("\u670d\u52a1\u5668\u542f\u52a8\uff0c\u76d1\u542c\u7aef\u53e3 8080");\n\n        while (true) {\n            // 2. \u63a5\u53d7\u5ba2\u6237\u7aef\u8fde\u63a5\uff08\u963b\u585e\uff09\n            Socket clientSocket = serverSocket.accept();\n            System.out.println("\u5ba2\u6237\u7aef\u8fde\u63a5: " + clientSocket.getRemoteSocketAddress());\n\n            // 3. \u5904\u7406\u8bf7\u6c42\n            try (BufferedReader in = new BufferedReader(\n                     new InputStreamReader(clientSocket.getInputStream()));\n                 PrintWriter out = new PrintWriter(\n                     clientSocket.getOutputStream(), true)) {\n\n                String line;\n                while ((line = in.readLine()) != null) {\n                    System.out.println("\u6536\u5230: " + line);\n                    out.println("Echo: " + line);\n                }\n            }\n\n            // 4. \u5173\u95ed\u8fde\u63a5\n            clientSocket.close();\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"java-tcp-\u5ba2\u6237\u7aef",children:"Java TCP \u5ba2\u6237\u7aef"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public class TcpClient {\n    public static void main(String[] args) throws IOException {\n        // 1. \u521b\u5efa Socket\uff0c\u8fde\u63a5\u670d\u52a1\u5668\n        Socket socket = new Socket("localhost", 8080);\n\n        // 2. \u53d1\u9001\u548c\u63a5\u6536\u6570\u636e\n        try (PrintWriter out = new PrintWriter(socket.getOutputStream(), true);\n             BufferedReader in = new BufferedReader(\n                 new InputStreamReader(socket.getInputStream()))) {\n\n            out.println("Hello, Server!");\n            String response = in.readLine();\n            System.out.println("\u54cd\u5e94: " + response);\n        }\n\n        // 3. \u5173\u95ed\u8fde\u63a5\n        socket.close();\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"udp-socket",children:"UDP Socket"}),"\n",(0,s.jsx)(n.h3,{id:"\u901a\u4fe1\u6d41\u7a0b-1",children:"\u901a\u4fe1\u6d41\u7a0b"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant S as \u670d\u52a1\u7aef\n    participant C as \u5ba2\u6237\u7aef\n\n    Note over S: socket()\n    Note over S: bind()\n    Note over S: recvfrom() \u963b\u585e\u7b49\u5f85\n\n    Note over C: socket()\n    C->>S: sendto()\n    Note over S: recvfrom() \u8fd4\u56de\n    S->>C: sendto()"}),"\n",(0,s.jsx)(n.h3,{id:"java-udp-\u670d\u52a1\u7aef",children:"Java UDP \u670d\u52a1\u7aef"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public class UdpServer {\n    public static void main(String[] args) throws IOException {\n        DatagramSocket socket = new DatagramSocket(9999);\n        byte[] buffer = new byte[1024];\n\n        while (true) {\n            // \u63a5\u6536\u6570\u636e\n            DatagramPacket packet = new DatagramPacket(buffer, buffer.length);\n            socket.receive(packet);\n\n            String message = new String(packet.getData(), 0, packet.getLength());\n            System.out.println("\u6536\u5230: " + message);\n\n            // \u53d1\u9001\u54cd\u5e94\n            byte[] response = ("Echo: " + message).getBytes();\n            DatagramPacket reply = new DatagramPacket(\n                response, response.length,\n                packet.getAddress(), packet.getPort()\n            );\n            socket.send(reply);\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"java-udp-\u5ba2\u6237\u7aef",children:"Java UDP \u5ba2\u6237\u7aef"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public class UdpClient {\n    public static void main(String[] args) throws IOException {\n        DatagramSocket socket = new DatagramSocket();\n        InetAddress address = InetAddress.getByName("localhost");\n\n        // \u53d1\u9001\u6570\u636e\n        String message = "Hello UDP";\n        byte[] data = message.getBytes();\n        DatagramPacket packet = new DatagramPacket(data, data.length, address, 9999);\n        socket.send(packet);\n\n        // \u63a5\u6536\u54cd\u5e94\n        byte[] buffer = new byte[1024];\n        DatagramPacket response = new DatagramPacket(buffer, buffer.length);\n        socket.receive(response);\n\n        System.out.println("\u54cd\u5e94: " + new String(response.getData(), 0, response.getLength()));\n        socket.close();\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"io-\u6a21\u578b",children:"I/O \u6a21\u578b"}),"\n",(0,s.jsx)(n.h3,{id:"\u4e94\u79cd-io-\u6a21\u578b",children:"\u4e94\u79cd I/O \u6a21\u578b"}),"\n",(0,s.jsx)(n.mermaid,{value:'graph TB\n    subgraph "\u540c\u6b65\u963b\u585e BIO"\n        A1[\u7b49\u5f85\u6570\u636e] --\x3e A2[\u590d\u5236\u6570\u636e]\n        A1 -.\u963b\u585e.-> A2\n    end\n\n    subgraph "\u540c\u6b65\u975e\u963b\u585e NIO"\n        B1[\u8f6e\u8be2] --\x3e B2[\u6570\u636e\u5c31\u7eea]\n        B2 --\x3e B3[\u590d\u5236\u6570\u636e]\n    end\n\n    subgraph "I/O \u591a\u8def\u590d\u7528"\n        C1[select/poll/epoll] --\x3e C2[\u901a\u77e5\u5c31\u7eea]\n        C2 --\x3e C3[\u8bfb\u53d6\u6570\u636e]\n    end'}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u6a21\u578b"}),(0,s.jsx)(n.th,{children:"\u7279\u70b9"}),(0,s.jsx)(n.th,{children:"\u9002\u7528\u573a\u666f"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u963b\u585e I/O"}),(0,s.jsx)(n.td,{children:"\u7b80\u5355\uff0c\u4f46\u7ebf\u7a0b\u963b\u585e"}),(0,s.jsx)(n.td,{children:"\u8fde\u63a5\u6570\u5c11"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u975e\u963b\u585e I/O"}),(0,s.jsx)(n.td,{children:"\u8f6e\u8be2\u6d88\u8017 CPU"}),(0,s.jsx)(n.td,{children:"\u4e0d\u63a8\u8350\u5355\u72ec\u4f7f\u7528"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"I/O \u591a\u8def\u590d\u7528"}),(0,s.jsx)(n.td,{children:"\u5355\u7ebf\u7a0b\u7ba1\u7406\u591a\u8fde\u63a5"}),(0,s.jsx)(n.td,{children:"\u9ad8\u5e76\u53d1\u670d\u52a1\u5668"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u4fe1\u53f7\u9a71\u52a8 I/O"}),(0,s.jsx)(n.td,{children:"\u5185\u6838\u901a\u77e5"}),(0,s.jsx)(n.td,{children:"\u8f83\u5c11\u4f7f\u7528"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u5f02\u6b65 I/O"}),(0,s.jsx)(n.td,{children:"\u5b8c\u5168\u5f02\u6b65"}),(0,s.jsx)(n.td,{children:"\u9ad8\u6027\u80fd\u670d\u52a1\u5668"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"bio-vs-nio",children:"BIO vs NIO"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u5bf9\u6bd4\u9879"}),(0,s.jsx)(n.th,{children:"BIO\uff08\u963b\u585e\uff09"}),(0,s.jsx)(n.th,{children:"NIO\uff08\u975e\u963b\u585e\uff09"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u8fde\u63a5\u5904\u7406"}),(0,s.jsx)(n.td,{children:"\u4e00\u8fde\u63a5\u4e00\u7ebf\u7a0b"}),(0,s.jsx)(n.td,{children:"\u4e00\u7ebf\u7a0b\u5904\u7406\u591a\u8fde\u63a5"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u963b\u585e"}),(0,s.jsx)(n.td,{children:"accept/read/write \u963b\u585e"}),(0,s.jsx)(n.td,{children:"\u975e\u963b\u585e\uff0c\u53ef\u7acb\u5373\u8fd4\u56de"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u9002\u7528\u573a\u666f"}),(0,s.jsx)(n.td,{children:"\u8fde\u63a5\u5c11\uff0c\u77ed\u8fde\u63a5"}),(0,s.jsx)(n.td,{children:"\u9ad8\u5e76\u53d1\uff0c\u957f\u8fde\u63a5"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u6846\u67b6"}),(0,s.jsx)(n.td,{children:"\u4f20\u7edf Socket"}),(0,s.jsx)(n.td,{children:"Java NIO, Netty"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"io-\u591a\u8def\u590d\u7528",children:"I/O \u591a\u8def\u590d\u7528"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u7cfb\u7edf\u8c03\u7528"}),(0,s.jsx)(n.th,{children:"\u6700\u5927\u8fde\u63a5\u6570"}),(0,s.jsx)(n.th,{children:"\u6548\u7387"}),(0,s.jsx)(n.th,{children:"\u7279\u70b9"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"select"}),(0,s.jsx)(n.td,{children:"1024"}),(0,s.jsx)(n.td,{children:"O(n)"}),(0,s.jsx)(n.td,{children:"\u8de8\u5e73\u53f0"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"poll"}),(0,s.jsx)(n.td,{children:"\u65e0\u9650\u5236"}),(0,s.jsx)(n.td,{children:"O(n)"}),(0,s.jsx)(n.td,{children:"\u65e0\u8fde\u63a5\u6570\u9650\u5236"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"epoll"}),(0,s.jsx)(n.td,{children:"\u65e0\u9650\u5236"}),(0,s.jsx)(n.td,{children:"O(1)"}),(0,s.jsx)(n.td,{children:"Linux \u4e13\u7528\uff0c\u6027\u80fd\u6700\u597d"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"kqueue"}),(0,s.jsx)(n.td,{children:"\u65e0\u9650\u5236"}),(0,s.jsx)(n.td,{children:"O(1)"}),(0,s.jsx)(n.td,{children:"BSD/macOS"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"java-nio",children:"Java NIO"}),"\n",(0,s.jsx)(n.h3,{id:"\u6838\u5fc3\u7ec4\u4ef6",children:"\u6838\u5fc3\u7ec4\u4ef6"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[Channel \u901a\u9053] --\x3e B[Buffer \u7f13\u51b2\u533a]\n    B --\x3e A\n    C[Selector \u9009\u62e9\u5668] --\x3e A"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u7ec4\u4ef6"}),(0,s.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Channel"}),(0,s.jsx)(n.td,{children:"\u53cc\u5411\u6570\u636e\u901a\u9053"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Buffer"}),(0,s.jsx)(n.td,{children:"\u6570\u636e\u8bfb\u5199\u7f13\u51b2\u533a"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Selector"}),(0,s.jsx)(n.td,{children:"\u76d1\u63a7\u591a\u4e2a Channel \u7684\u4e8b\u4ef6"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"nio-\u670d\u52a1\u7aef\u793a\u4f8b",children:"NIO \u670d\u52a1\u7aef\u793a\u4f8b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public class NioServer {\n    public static void main(String[] args) throws IOException {\n        // 1. \u521b\u5efa Selector\n        Selector selector = Selector.open();\n\n        // 2. \u521b\u5efa ServerSocketChannel\n        ServerSocketChannel serverChannel = ServerSocketChannel.open();\n        serverChannel.bind(new InetSocketAddress(8080));\n        serverChannel.configureBlocking(false);\n        serverChannel.register(selector, SelectionKey.OP_ACCEPT);\n\n        System.out.println("NIO \u670d\u52a1\u5668\u542f\u52a8");\n\n        while (true) {\n            // 3. \u7b49\u5f85\u4e8b\u4ef6\n            selector.select();\n            Set<SelectionKey> keys = selector.selectedKeys();\n            Iterator<SelectionKey> iterator = keys.iterator();\n\n            while (iterator.hasNext()) {\n                SelectionKey key = iterator.next();\n                iterator.remove();\n\n                if (key.isAcceptable()) {\n                    // 4. \u5904\u7406\u8fde\u63a5\n                    ServerSocketChannel server = (ServerSocketChannel) key.channel();\n                    SocketChannel client = server.accept();\n                    client.configureBlocking(false);\n                    client.register(selector, SelectionKey.OP_READ);\n                    System.out.println("\u5ba2\u6237\u7aef\u8fde\u63a5: " + client.getRemoteAddress());\n\n                } else if (key.isReadable()) {\n                    // 5. \u5904\u7406\u8bfb\u53d6\n                    SocketChannel client = (SocketChannel) key.channel();\n                    ByteBuffer buffer = ByteBuffer.allocate(1024);\n                    int bytesRead = client.read(buffer);\n\n                    if (bytesRead > 0) {\n                        buffer.flip();\n                        String message = new String(buffer.array(), 0, bytesRead);\n                        System.out.println("\u6536\u5230: " + message);\n\n                        // \u56de\u590d\n                        buffer.clear();\n                        buffer.put(("Echo: " + message).getBytes());\n                        buffer.flip();\n                        client.write(buffer);\n                    } else if (bytesRead == -1) {\n                        client.close();\n                    }\n                }\n            }\n        }\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\u5e38\u89c1\u6a21\u5f0f",children:"\u5e38\u89c1\u6a21\u5f0f"}),"\n",(0,s.jsx)(n.h3,{id:"\u7ebf\u7a0b\u6c60\u5904\u7406",children:"\u7ebf\u7a0b\u6c60\u5904\u7406"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"ExecutorService executor = Executors.newFixedThreadPool(100);\n\nwhile (true) {\n    Socket client = serverSocket.accept();\n    executor.submit(() -> handleClient(client));\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"reactor-\u6a21\u5f0f",children:"Reactor \u6a21\u5f0f"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph TB\n    A[Acceptor] --\x3e B[Reactor]\n    B --\x3e C[Handler 1]\n    B --\x3e D[Handler 2]\n    B --\x3e E[Handler 3]"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5355 Reactor \u5355\u7ebf\u7a0b"}),"\uff1a\u7b80\u5355\uff0c\u9002\u5408\u5c0f\u89c4\u6a21"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5355 Reactor \u591a\u7ebf\u7a0b"}),"\uff1a\u5904\u7406\u80fd\u529b\u589e\u5f3a"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4e3b\u4ece Reactor"}),"\uff1aNetty \u91c7\u7528\u7684\u6a21\u5f0f"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"socket-\u9009\u9879",children:"Socket \u9009\u9879"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u9009\u9879"}),(0,s.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SO_REUSEADDR"}),(0,s.jsx)(n.td,{children:"\u5141\u8bb8\u5730\u5740\u91cd\u7528"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SO_KEEPALIVE"}),(0,s.jsx)(n.td,{children:"\u5f00\u542f TCP \u4fdd\u6d3b"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SO_RCVBUF"}),(0,s.jsx)(n.td,{children:"\u63a5\u6536\u7f13\u51b2\u533a\u5927\u5c0f"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SO_SNDBUF"}),(0,s.jsx)(n.td,{children:"\u53d1\u9001\u7f13\u51b2\u533a\u5927\u5c0f"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"TCP_NODELAY"}),(0,s.jsx)(n.td,{children:"\u7981\u7528 Nagle \u7b97\u6cd5"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"SO_TIMEOUT"}),(0,s.jsx)(n.td,{children:"\u8bfb\u53d6\u8d85\u65f6\u65f6\u95f4"})]})]})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"socket.setReuseAddress(true);\nsocket.setKeepAlive(true);\nsocket.setTcpNoDelay(true);\nsocket.setSoTimeout(30000);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u4e0b\u4e00\u6b65",children:"\u4e0b\u4e00\u6b65"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u5b66\u4e60 ",(0,s.jsx)(n.a,{href:"/docs/netty",children:"Netty \u6846\u67b6"})]}),"\n",(0,s.jsxs)(n.li,{children:["\u4e86\u89e3 ",(0,s.jsx)(n.a,{href:"./websocket",children:"WebSocket \u534f\u8bae"})]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},48885:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>l});var r=t(99378);const s={},c=r.createContext(s);function i(e){const n=r.useContext(c);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(c.Provider,{value:n},e.children)}}}]);