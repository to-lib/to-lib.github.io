"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[56846],{4026:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>s,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"java/reflection-annotation","title":"\u53cd\u5c04\u4e0e\u6ce8\u89e3","description":"\u53cd\u5c04\uff08Reflection\uff09\u662f Java \u7684\u4e00\u4e2a\u5f3a\u5927\u7279\u6027\uff0c\u5141\u8bb8\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u68c0\u67e5\u548c\u64cd\u4f5c\u7c7b\u3001\u65b9\u6cd5\u3001\u5b57\u6bb5\u7b49\u3002\u6ce8\u89e3\uff08Annotation\uff09\u5219\u4e3a\u53cd\u5c04\u63d0\u4f9b\u4e86\u5143\u6570\u636e\u3002\u672c\u6587\u4ecb\u7ecd\u53cd\u5c04 API \u548c\u81ea\u5b9a\u4e49\u6ce8\u89e3\u7684\u6df1\u5ea6\u5e94\u7528\u3002","source":"@site/docs/java/reflection-annotation.md","sourceDirName":"java","slug":"/java/reflection-annotation","permalink":"/docs/java/reflection-annotation","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/java/reflection-annotation.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"sidebar_position":11,"title":"\u53cd\u5c04\u4e0e\u6ce8\u89e3"},"sidebar":"java","previous":{"title":"\u51fd\u6570\u5f0f\u7f16\u7a0b","permalink":"/docs/java/functional-programming"},"next":{"title":"JVM \u57fa\u7840","permalink":"/docs/java/jvm-basics"}}');var a=t(22714),l=t(48885);const r={sidebar_position:11,title:"\u53cd\u5c04\u4e0e\u6ce8\u89e3"},s="\u53cd\u5c04\u4e0e\u6ce8\u89e3",o={},c=[{value:"\u53cd\u5c04\u57fa\u7840",id:"\u53cd\u5c04\u57fa\u7840",level:2},{value:"\u83b7\u53d6 Class \u5bf9\u8c61",id:"\u83b7\u53d6-class-\u5bf9\u8c61",level:3},{value:"\u83b7\u53d6\u7c7b\u7684\u4fe1\u606f",id:"\u83b7\u53d6\u7c7b\u7684\u4fe1\u606f",level:3},{value:"\u53cd\u5c04 Field\uff08\u5b57\u6bb5\uff09",id:"\u53cd\u5c04-field\u5b57\u6bb5",level:2},{value:"\u83b7\u53d6\u548c\u8bbe\u7f6e\u5b57\u6bb5\u503c",id:"\u83b7\u53d6\u548c\u8bbe\u7f6e\u5b57\u6bb5\u503c",level:3},{value:"\u53cd\u5c04 Method\uff08\u65b9\u6cd5\uff09",id:"\u53cd\u5c04-method\u65b9\u6cd5",level:2},{value:"\u83b7\u53d6\u548c\u8c03\u7528\u65b9\u6cd5",id:"\u83b7\u53d6\u548c\u8c03\u7528\u65b9\u6cd5",level:3},{value:"\u53cd\u5c04 Constructor\uff08\u6784\u9020\u65b9\u6cd5\uff09",id:"\u53cd\u5c04-constructor\u6784\u9020\u65b9\u6cd5",level:2},{value:"\u521b\u5efa\u5bf9\u8c61\u5b9e\u4f8b",id:"\u521b\u5efa\u5bf9\u8c61\u5b9e\u4f8b",level:3},{value:"\u52a8\u6001\u4ee3\u7406",id:"\u52a8\u6001\u4ee3\u7406",level:2},{value:"JDK \u52a8\u6001\u4ee3\u7406",id:"jdk-\u52a8\u6001\u4ee3\u7406",level:3},{value:"\u81ea\u5b9a\u4e49\u6ce8\u89e3\u7684\u6df1\u5ea6\u5e94\u7528",id:"\u81ea\u5b9a\u4e49\u6ce8\u89e3\u7684\u6df1\u5ea6\u5e94\u7528",level:2},{value:"\u521b\u5efa\u53c2\u6570\u9a8c\u8bc1\u6ce8\u89e3",id:"\u521b\u5efa\u53c2\u6570\u9a8c\u8bc1\u6ce8\u89e3",level:3},{value:"\u521b\u5efa\u6301\u4e45\u5316\u6ce8\u89e3",id:"\u521b\u5efa\u6301\u4e45\u5316\u6ce8\u89e3",level:3},{value:"\u521b\u5efa\u4e8b\u4ef6\u5904\u7406\u6ce8\u89e3",id:"\u521b\u5efa\u4e8b\u4ef6\u5904\u7406\u6ce8\u89e3",level:3},{value:"\u53cd\u5c04\u6027\u80fd\u4f18\u5316",id:"\u53cd\u5c04\u6027\u80fd\u4f18\u5316",level:2},{value:"\u53cd\u5c04\u6700\u4f73\u5b9e\u8df5",id:"\u53cd\u5c04\u6700\u4f73\u5b9e\u8df5",level:2},{value:"1. \u7f13\u5b58\u53cd\u5c04\u5bf9\u8c61",id:"1-\u7f13\u5b58\u53cd\u5c04\u5bf9\u8c61",level:3},{value:"2. \u5f02\u5e38\u5904\u7406",id:"2-\u5f02\u5e38\u5904\u7406",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"\u53cd\u5c04\u4e0e\u6ce8\u89e3",children:"\u53cd\u5c04\u4e0e\u6ce8\u89e3"})}),"\n",(0,a.jsx)(e.p,{children:"\u53cd\u5c04\uff08Reflection\uff09\u662f Java \u7684\u4e00\u4e2a\u5f3a\u5927\u7279\u6027\uff0c\u5141\u8bb8\u7a0b\u5e8f\u5728\u8fd0\u884c\u65f6\u68c0\u67e5\u548c\u64cd\u4f5c\u7c7b\u3001\u65b9\u6cd5\u3001\u5b57\u6bb5\u7b49\u3002\u6ce8\u89e3\uff08Annotation\uff09\u5219\u4e3a\u53cd\u5c04\u63d0\u4f9b\u4e86\u5143\u6570\u636e\u3002\u672c\u6587\u4ecb\u7ecd\u53cd\u5c04 API \u548c\u81ea\u5b9a\u4e49\u6ce8\u89e3\u7684\u6df1\u5ea6\u5e94\u7528\u3002"}),"\n",(0,a.jsx)(e.h2,{id:"\u53cd\u5c04\u57fa\u7840",children:"\u53cd\u5c04\u57fa\u7840"}),"\n",(0,a.jsx)(e.h3,{id:"\u83b7\u53d6-class-\u5bf9\u8c61",children:"\u83b7\u53d6 Class \u5bf9\u8c61"}),"\n",(0,a.jsx)(e.p,{children:"Class \u5bf9\u8c61\u4ee3\u8868\u4e86 Java \u4e2d\u7684\u7c7b\u3002\u6709\u4e09\u79cd\u83b7\u53d6\u65b9\u5f0f\uff1a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'public class GetClassExample {\n    public static void main(String[] args) throws ClassNotFoundException {\n        // \u65b9\u5f0f1\uff1a\u901a\u8fc7 .class \u83b7\u53d6\uff08\u63a8\u8350\uff09\n        Class<?> clazz1 = String.class;\n        \n        // \u65b9\u5f0f2\uff1a\u901a\u8fc7 object.getClass() \u83b7\u53d6\n        String str = "Hello";\n        Class<?> clazz2 = str.getClass();\n        \n        // \u65b9\u5f0f3\uff1a\u901a\u8fc7 Class.forName() \u83b7\u53d6\n        Class<?> clazz3 = Class.forName("java.lang.String");\n        \n        // \u4e09\u4e2a Class \u5bf9\u8c61\u90fd\u662f\u540c\u4e00\u4e2a\n        System.out.println(clazz1 == clazz2);  // true\n        System.out.println(clazz2 == clazz3);  // true\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h3,{id:"\u83b7\u53d6\u7c7b\u7684\u4fe1\u606f",children:"\u83b7\u53d6\u7c7b\u7684\u4fe1\u606f"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'import java.lang.reflect.*;\n\npublic class ClassInspection {\n    public static void main(String[] args) {\n        Class<?> clazz = String.class;\n        \n        // \u83b7\u53d6\u7c7b\u540d\n        System.out.println("\u7c7b\u540d: " + clazz.getSimpleName());\n        System.out.println("\u5168\u9650\u5b9a\u540d: " + clazz.getName());\n        \n        // \u83b7\u53d6\u7236\u7c7b\n        Class<?> superClass = clazz.getSuperclass();\n        System.out.println("\u7236\u7c7b: " + superClass.getSimpleName());\n        \n        // \u83b7\u53d6\u5b9e\u73b0\u7684\u63a5\u53e3\n        Class<?>[] interfaces = clazz.getInterfaces();\n        for (Class<?> iface : interfaces) {\n            System.out.println("\u5b9e\u73b0\u7684\u63a5\u53e3: " + iface.getSimpleName());\n        }\n        \n        // \u83b7\u53d6\u8bbf\u95ee\u4fee\u9970\u7b26\n        int modifiers = clazz.getModifiers();\n        System.out.println("\u662f\u5426 public: " + Modifier.isPublic(modifiers));\n        System.out.println("\u662f\u5426 final: " + Modifier.isFinal(modifiers));\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u53cd\u5c04-field\u5b57\u6bb5",children:"\u53cd\u5c04 Field\uff08\u5b57\u6bb5\uff09"}),"\n",(0,a.jsx)(e.h3,{id:"\u83b7\u53d6\u548c\u8bbe\u7f6e\u5b57\u6bb5\u503c",children:"\u83b7\u53d6\u548c\u8bbe\u7f6e\u5b57\u6bb5\u503c"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'import java.lang.reflect.Field;\n\npublic class Person {\n    private String name;\n    private int age;\n    \n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n    \n    public String getName() {\n        return name;\n    }\n    \n    public int getAge() {\n        return age;\n    }\n}\n\npublic class FieldReflectionExample {\n    public static void main(String[] args) throws Exception {\n        Person person = new Person("\u5f20\u4e09", 25);\n        Class<?> clazz = Person.class;\n        \n        // \u83b7\u53d6\u6240\u6709\u5b57\u6bb5\n        Field[] fields = clazz.getDeclaredFields();\n        for (Field field : fields) {\n            System.out.println("\u5b57\u6bb5\u540d: " + field.getName());\n            System.out.println("\u5b57\u6bb5\u7c7b\u578b: " + field.getType().getSimpleName());\n        }\n        \n        // \u83b7\u53d6\u7279\u5b9a\u5b57\u6bb5\n        Field nameField = clazz.getDeclaredField("name");\n        \n        // \u8bbe\u7f6e accessible\uff08\u8df3\u8fc7 private \u68c0\u67e5\uff09\n        nameField.setAccessible(true);\n        \n        // \u8bfb\u53d6\u5b57\u6bb5\u503c\n        Object value = nameField.get(person);\n        System.out.println("name \u5b57\u6bb5\u503c: " + value);\n        \n        // \u4fee\u6539\u5b57\u6bb5\u503c\n        nameField.set(person, "\u674e\u56db");\n        System.out.println("\u4fee\u6539\u540e\u7684\u540d\u5b57: " + person.getName());\n        \n        // \u83b7\u53d6 age \u5b57\u6bb5\n        Field ageField = clazz.getDeclaredField("age");\n        ageField.setAccessible(true);\n        ageField.set(person, 30);\n        System.out.println("\u4fee\u6539\u540e\u7684\u5e74\u9f84: " + person.getAge());\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u53cd\u5c04-method\u65b9\u6cd5",children:"\u53cd\u5c04 Method\uff08\u65b9\u6cd5\uff09"}),"\n",(0,a.jsx)(e.h3,{id:"\u83b7\u53d6\u548c\u8c03\u7528\u65b9\u6cd5",children:"\u83b7\u53d6\u548c\u8c03\u7528\u65b9\u6cd5"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'import java.lang.reflect.Method;\n\npublic class Calculator {\n    public int add(int a, int b) {\n        return a + b;\n    }\n    \n    public int subtract(int a, int b) {\n        return a - b;\n    }\n    \n    private int multiply(int a, int b) {\n        return a * b;\n    }\n}\n\npublic class MethodReflectionExample {\n    public static void main(String[] args) throws Exception {\n        Calculator calculator = new Calculator();\n        Class<?> clazz = Calculator.class;\n        \n        // \u83b7\u53d6\u6240\u6709\u516c\u5171\u65b9\u6cd5\n        Method[] methods = clazz.getDeclaredMethods();\n        for (Method method : methods) {\n            System.out.println("\u65b9\u6cd5: " + method.getName());\n        }\n        \n        // \u83b7\u53d6\u7279\u5b9a\u65b9\u6cd5\uff1aadd(int, int)\n        Method addMethod = clazz.getMethod("add", int.class, int.class);\n        System.out.println("\u65b9\u6cd5\u540d: " + addMethod.getName());\n        System.out.println("\u8fd4\u56de\u7c7b\u578b: " + addMethod.getReturnType().getSimpleName());\n        \n        // \u8c03\u7528\u65b9\u6cd5\n        int result = (int) addMethod.invoke(calculator, 5, 3);\n        System.out.println("5 + 3 = " + result);\n        \n        // \u8c03\u7528 subtract \u65b9\u6cd5\n        Method subtractMethod = clazz.getMethod("subtract", int.class, int.class);\n        result = (int) subtractMethod.invoke(calculator, 10, 4);\n        System.out.println("10 - 4 = " + result);\n        \n        // \u8c03\u7528 private \u65b9\u6cd5\n        Method multiplyMethod = clazz.getDeclaredMethod("multiply", int.class, int.class);\n        multiplyMethod.setAccessible(true);\n        result = (int) multiplyMethod.invoke(calculator, 6, 7);\n        System.out.println("6 * 7 = " + result);\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u53cd\u5c04-constructor\u6784\u9020\u65b9\u6cd5",children:"\u53cd\u5c04 Constructor\uff08\u6784\u9020\u65b9\u6cd5\uff09"}),"\n",(0,a.jsx)(e.h3,{id:"\u521b\u5efa\u5bf9\u8c61\u5b9e\u4f8b",children:"\u521b\u5efa\u5bf9\u8c61\u5b9e\u4f8b"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'import java.lang.reflect.Constructor;\n\npublic class User {\n    private String username;\n    private String password;\n    \n    // \u9ed8\u8ba4\u6784\u9020\u65b9\u6cd5\n    public User() {\n        this.username = "guest";\n        this.password = "123456";\n    }\n    \n    // \u5e26\u53c2\u6784\u9020\u65b9\u6cd5\n    public User(String username, String password) {\n        this.username = username;\n        this.password = password;\n    }\n    \n    @Override\n    public String toString() {\n        return "User{" + "username=\'" + username + \'\\\'\' + ", password=\'" + password + \'\\\'\' + \'}\';\n    }\n}\n\npublic class ConstructorReflectionExample {\n    public static void main(String[] args) throws Exception {\n        Class<?> clazz = User.class;\n        \n        // \u83b7\u53d6\u6240\u6709\u6784\u9020\u65b9\u6cd5\n        Constructor<?>[] constructors = clazz.getDeclaredConstructors();\n        for (Constructor<?> constructor : constructors) {\n            System.out.println("\u6784\u9020\u65b9\u6cd5: " + constructor);\n        }\n        \n        // \u83b7\u53d6\u65e0\u53c2\u6784\u9020\u65b9\u6cd5\u5e76\u521b\u5efa\u5bf9\u8c61\n        Constructor<?> noArgConstructor = clazz.getConstructor();\n        Object user1 = noArgConstructor.newInstance();\n        System.out.println("user1: " + user1);\n        \n        // \u83b7\u53d6\u5e26\u53c2\u6784\u9020\u65b9\u6cd5\u5e76\u521b\u5efa\u5bf9\u8c61\n        Constructor<?> argConstructor = clazz.getConstructor(String.class, String.class);\n        Object user2 = argConstructor.newInstance("admin", "password123");\n        System.out.println("user2: " + user2);\n        \n        // \u7b80\u4fbf\u65b9\u5f0f\uff1a\u76f4\u63a5 newInstance()\n        User user3 = (User) clazz.getDeclaredConstructor().newInstance();\n        System.out.println("user3: " + user3);\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u52a8\u6001\u4ee3\u7406",children:"\u52a8\u6001\u4ee3\u7406"}),"\n",(0,a.jsx)(e.h3,{id:"jdk-\u52a8\u6001\u4ee3\u7406",children:"JDK \u52a8\u6001\u4ee3\u7406"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'import java.lang.reflect.InvocationHandler;\nimport java.lang.reflect.Method;\nimport java.lang.reflect.Proxy;\n\n// \u5b9a\u4e49\u63a5\u53e3\npublic interface UserService {\n    void addUser(String name);\n    void deleteUser(int id);\n    void updateUser(String name);\n}\n\n// \u5b9e\u73b0\u63a5\u53e3\npublic class UserServiceImpl implements UserService {\n    @Override\n    public void addUser(String name) {\n        System.out.println("\u6dfb\u52a0\u7528\u6237: " + name);\n    }\n    \n    @Override\n    public void deleteUser(int id) {\n        System.out.println("\u5220\u9664\u7528\u6237: " + id);\n    }\n    \n    @Override\n    public void updateUser(String name) {\n        System.out.println("\u66f4\u65b0\u7528\u6237: " + name);\n    }\n}\n\n// \u521b\u5efa\u4ee3\u7406\u5904\u7406\u5668\npublic class UserServiceProxy implements InvocationHandler {\n    private UserService target;\n    \n    public UserServiceProxy(UserService target) {\n        this.target = target;\n    }\n    \n    @Override\n    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n        // \u8c03\u7528\u524d\u5904\u7406\n        System.out.println("[\u524d\u7f6e\u5904\u7406] \u6267\u884c\u65b9\u6cd5: " + method.getName());\n        long startTime = System.currentTimeMillis();\n        \n        // \u8c03\u7528\u5b9e\u9645\u65b9\u6cd5\n        Object result = method.invoke(target, args);\n        \n        // \u8c03\u7528\u540e\u5904\u7406\n        long endTime = System.currentTimeMillis();\n        System.out.println("[\u540e\u7f6e\u5904\u7406] \u6267\u884c\u8017\u65f6: " + (endTime - startTime) + "ms");\n        \n        return result;\n    }\n}\n\n// \u4f7f\u7528\u4ee3\u7406\npublic class ProxyExample {\n    public static void main(String[] args) {\n        UserService target = new UserServiceImpl();\n        \n        // \u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\n        UserService proxy = (UserService) Proxy.newProxyInstance(\n            UserService.class.getClassLoader(),\n            new Class[]{UserService.class},\n            new UserServiceProxy(target)\n        );\n        \n        // \u8c03\u7528\u4ee3\u7406\u65b9\u6cd5\n        proxy.addUser("\u5f20\u4e09");\n        proxy.deleteUser(1);\n        proxy.updateUser("\u674e\u56db");\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u81ea\u5b9a\u4e49\u6ce8\u89e3\u7684\u6df1\u5ea6\u5e94\u7528",children:"\u81ea\u5b9a\u4e49\u6ce8\u89e3\u7684\u6df1\u5ea6\u5e94\u7528"}),"\n",(0,a.jsx)(e.h3,{id:"\u521b\u5efa\u53c2\u6570\u9a8c\u8bc1\u6ce8\u89e3",children:"\u521b\u5efa\u53c2\u6570\u9a8c\u8bc1\u6ce8\u89e3"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'import java.lang.annotation.*;\nimport java.lang.reflect.Method;\nimport java.lang.reflect.Parameter;\n\n// \u5b9a\u4e49\u975e\u7a7a\u9a8c\u8bc1\u6ce8\u89e3\n@Target(ElementType.PARAMETER)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface NotNull {\n    String message() default "\u53c2\u6570\u4e0d\u80fd\u4e3a\u7a7a";\n}\n\n// \u5b9a\u4e49\u957f\u5ea6\u9a8c\u8bc1\u6ce8\u89e3\n@Target(ElementType.PARAMETER)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface Length {\n    int min() default 0;\n    int max() default Integer.MAX_VALUE;\n    String message() default "\u53c2\u6570\u957f\u5ea6\u4e0d\u7b26\u5408\u8981\u6c42";\n}\n\n// \u4f7f\u7528\u6ce8\u89e3\npublic class UserValidator {\n    public void register(@NotNull(message = "\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a") String username,\n                       @Length(min = 6, max = 20, message = "\u5bc6\u7801\u957f\u5ea6\u5fc5\u987b\u57286-20\u4e4b\u95f4") String password) {\n        System.out.println("\u6ce8\u518c\u7528\u6237: " + username);\n    }\n}\n\n// \u6ce8\u89e3\u5904\u7406\u5668\npublic class ValidationProcessor {\n    public static void validateParameters(Object obj, Method method, Object[] args) throws Exception {\n        Parameter[] parameters = method.getParameters();\n        \n        for (int i = 0; i < parameters.length; i++) {\n            Parameter param = parameters[i];\n            Object arg = args[i];\n            \n            // \u68c0\u67e5 @NotNull \u6ce8\u89e3\n            NotNull notNullAnnotation = param.getAnnotation(NotNull.class);\n            if (notNullAnnotation != null && arg == null) {\n                throw new IllegalArgumentException(notNullAnnotation.message());\n            }\n            \n            // \u68c0\u67e5 @Length \u6ce8\u89e3\n            Length lengthAnnotation = param.getAnnotation(Length.class);\n            if (lengthAnnotation != null && arg instanceof String) {\n                String str = (String) arg;\n                if (str.length() < lengthAnnotation.min() || str.length() > lengthAnnotation.max()) {\n                    throw new IllegalArgumentException(lengthAnnotation.message());\n                }\n            }\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h3,{id:"\u521b\u5efa\u6301\u4e45\u5316\u6ce8\u89e3",children:"\u521b\u5efa\u6301\u4e45\u5316\u6ce8\u89e3"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'import java.lang.annotation.*;\nimport java.lang.reflect.Field;\n\n// \u6807\u8bb0\u5b9e\u4f53\u7c7b\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface Entity {\n    String tableName();\n}\n\n// \u6807\u8bb0\u5b57\u6bb5\u6620\u5c04\u5230\u8868\u5217\n@Target(ElementType.FIELD)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface Column {\n    String name();\n    boolean primaryKey() default false;\n    boolean nullable() default true;\n}\n\n// \u4f7f\u7528\u6ce8\u89e3\u5b9a\u4e49\u5b9e\u4f53\n@Entity(tableName = "users")\npublic class User {\n    @Column(name = "id", primaryKey = true)\n    private int id;\n    \n    @Column(name = "username", nullable = false)\n    private String username;\n    \n    @Column(name = "email")\n    private String email;\n    \n    // \u7701\u7565 getter/setter\n}\n\n// SQL \u751f\u6210\u5668\npublic class SQLGenerator {\n    public static String generateCreateTableSQL(Class<?> clazz) {\n        Entity entity = clazz.getAnnotation(Entity.class);\n        if (entity == null) {\n            throw new IllegalArgumentException("\u7c7b\u5fc5\u987b\u88ab @Entity \u6ce8\u89e3\u6807\u8bb0");\n        }\n        \n        StringBuilder sql = new StringBuilder();\n        sql.append("CREATE TABLE ").append(entity.tableName()).append(" (\\n");\n        \n        Field[] fields = clazz.getDeclaredFields();\n        for (int i = 0; i < fields.length; i++) {\n            Field field = fields[i];\n            Column column = field.getAnnotation(Column.class);\n            \n            if (column != null) {\n                sql.append("  ").append(column.name()).append(" ");\n                \n                // \u6839\u636e Java \u7c7b\u578b\u63a8\u65ad SQL \u7c7b\u578b\n                if (field.getType() == int.class) {\n                    sql.append("INT");\n                } else if (field.getType() == String.class) {\n                    sql.append("VARCHAR(255)");\n                }\n                \n                if (column.primaryKey()) {\n                    sql.append(" PRIMARY KEY");\n                }\n                \n                if (!column.nullable()) {\n                    sql.append(" NOT NULL");\n                }\n                \n                if (i < fields.length - 1) {\n                    sql.append(",");\n                }\n                sql.append("\\n");\n            }\n        }\n        \n        sql.append(");");\n        return sql.toString();\n    }\n}\n\n// \u4f7f\u7528\npublic class ORM {\n    public static void main(String[] args) {\n        String sql = SQLGenerator.generateCreateTableSQL(User.class);\n        System.out.println(sql);\n        // \u8f93\u51fa\uff1a\n        // CREATE TABLE users (\n        //   id INT PRIMARY KEY,\n        //   username VARCHAR(255) NOT NULL,\n        //   email VARCHAR(255)\n        // );\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h3,{id:"\u521b\u5efa\u4e8b\u4ef6\u5904\u7406\u6ce8\u89e3",children:"\u521b\u5efa\u4e8b\u4ef6\u5904\u7406\u6ce8\u89e3"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'import java.lang.annotation.*;\nimport java.lang.reflect.Method;\n\n// \u4e8b\u4ef6\u6ce8\u89e3\n@Target(ElementType.METHOD)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface EventListener {\n    Class<?> eventType();\n}\n\n// \u5b9a\u4e49\u4e8b\u4ef6\npublic class UserRegisteredEvent {\n    private String username;\n    private long timestamp;\n    \n    public UserRegisteredEvent(String username) {\n        this.username = username;\n        this.timestamp = System.currentTimeMillis();\n    }\n    \n    public String getUsername() {\n        return username;\n    }\n}\n\n// \u4e8b\u4ef6\u5904\u7406\u5668\npublic class UserEventHandler {\n    @EventListener(eventType = UserRegisteredEvent.class)\n    public void onUserRegistered(UserRegisteredEvent event) {\n        System.out.println("\u7528\u6237\u5df2\u6ce8\u518c: " + event.getUsername());\n        // \u53d1\u9001\u6b22\u8fce\u90ae\u4ef6\u7b49\u64cd\u4f5c\n    }\n    \n    @EventListener(eventType = UserRegisteredEvent.class)\n    public void logUserRegistration(UserRegisteredEvent event) {\n        System.out.println("[\u65e5\u5fd7] \u7528\u6237\u6ce8\u518c\u65f6\u95f4: " + event.getUsername());\n    }\n}\n\n// \u4e8b\u4ef6\u603b\u7ebf\npublic class EventBus {\n    private Map<Class<?>, List<Method>> eventHandlers = new HashMap<>();\n    \n    public void register(Object handler) {\n        Class<?> handlerClass = handler.getClass();\n        \n        for (Method method : handlerClass.getDeclaredMethods()) {\n            EventListener listener = method.getAnnotation(EventListener.class);\n            if (listener != null) {\n                Class<?> eventType = listener.eventType();\n                eventHandlers.computeIfAbsent(eventType, k -> new ArrayList<>()).add(method);\n            }\n        }\n    }\n    \n    public void publish(Object event) {\n        Class<?> eventType = event.getClass();\n        List<Method> handlers = eventHandlers.getOrDefault(eventType, new ArrayList<>());\n        \n        for (Method method : handlers) {\n            try {\n                method.invoke(null, event);\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u53cd\u5c04\u6027\u80fd\u4f18\u5316",children:"\u53cd\u5c04\u6027\u80fd\u4f18\u5316"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'public class ReflectionPerformance {\n    private static final int ITERATIONS = 1000000;\n    \n    public static void main(String[] args) throws Exception {\n        // \u76f4\u63a5\u8c03\u7528\n        long startTime = System.currentTimeMillis();\n        for (int i = 0; i < ITERATIONS; i++) {\n            String str = "test";\n            int len = str.length();\n        }\n        long directTime = System.currentTimeMillis() - startTime;\n        \n        // \u53cd\u5c04\u8c03\u7528\n        startTime = System.currentTimeMillis();\n        Method lengthMethod = String.class.getMethod("length");\n        String str = "test";\n        for (int i = 0; i < ITERATIONS; i++) {\n            lengthMethod.invoke(str);\n        }\n        long reflectionTime = System.currentTimeMillis() - startTime;\n        \n        System.out.println("\u76f4\u63a5\u8c03\u7528\u8017\u65f6: " + directTime + "ms");\n        System.out.println("\u53cd\u5c04\u8c03\u7528\u8017\u65f6: " + reflectionTime + "ms");\n        System.out.println("\u6027\u80fd\u5dee\u5f02: " + (reflectionTime / directTime) + " \u500d");\n        \n        // \u6027\u80fd\u4f18\u5316\u5efa\u8bae\uff1a\n        // 1. \u7f13\u5b58 Method\u3001Field\u3001Constructor \u5bf9\u8c61\n        // 2. \u4f7f\u7528 MethodHandle\uff08Java 7+\uff09\n        // 3. \u5728\u5173\u952e\u5faa\u73af\u4e2d\u907f\u514d\u53cd\u5c04\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u53cd\u5c04\u6700\u4f73\u5b9e\u8df5",children:"\u53cd\u5c04\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,a.jsx)(e.h3,{id:"1-\u7f13\u5b58\u53cd\u5c04\u5bf9\u8c61",children:"1. \u7f13\u5b58\u53cd\u5c04\u5bf9\u8c61"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'public class ReflectionCache {\n    private static final Map<String, Method> methodCache = new HashMap<>();\n    private static final Map<String, Field> fieldCache = new HashMap<>();\n    \n    public static Method getMethod(Class<?> clazz, String methodName, Class<?>... paramTypes) {\n        String key = clazz.getName() + "." + methodName;\n        return methodCache.computeIfAbsent(key, k -> {\n            try {\n                return clazz.getMethod(methodName, paramTypes);\n            } catch (NoSuchMethodException e) {\n                throw new RuntimeException(e);\n            }\n        });\n    }\n    \n    public static Field getField(Class<?> clazz, String fieldName) {\n        String key = clazz.getName() + "." + fieldName;\n        return fieldCache.computeIfAbsent(key, k -> {\n            try {\n                Field field = clazz.getDeclaredField(fieldName);\n                field.setAccessible(true);\n                return field;\n            } catch (NoSuchFieldException e) {\n                throw new RuntimeException(e);\n            }\n        });\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u5f02\u5e38\u5904\u7406",children:"2. \u5f02\u5e38\u5904\u7406"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-java",children:'public class ReflectionExceptionHandling {\n    public static void invokeMethod(Object obj, String methodName) {\n        try {\n            Method method = obj.getClass().getMethod(methodName);\n            method.invoke(obj);\n        } catch (NoSuchMethodException e) {\n            System.err.println("\u65b9\u6cd5\u4e0d\u5b58\u5728: " + methodName);\n        } catch (IllegalAccessException e) {\n            System.err.println("\u65e0\u6743\u8bbf\u95ee\u65b9\u6cd5: " + methodName);\n        } catch (InvocationTargetException e) {\n            System.err.println("\u65b9\u6cd5\u6267\u884c\u5f02\u5e38: " + e.getCause());\n        }\n    }\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,a.jsx)(e.p,{children:"\u672c\u6587\u4ecb\u7ecd\u4e86 Java \u53cd\u5c04\u548c\u6ce8\u89e3\u7684\u6df1\u5ea6\u5e94\u7528\uff1a"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u2705 \u53cd\u5c04 API\uff1a\u83b7\u53d6 Class\u3001Field\u3001Method\u3001Constructor"}),"\n",(0,a.jsx)(e.li,{children:"\u2705 \u52a8\u6001\u4ee3\u7406\uff1aJDK \u52a8\u6001\u4ee3\u7406\u7684\u5b9e\u73b0\u548c\u5e94\u7528"}),"\n",(0,a.jsx)(e.li,{children:"\u2705 \u81ea\u5b9a\u4e49\u6ce8\u89e3\uff1a\u53c2\u6570\u9a8c\u8bc1\u3001\u6301\u4e45\u5316\u3001\u4e8b\u4ef6\u5904\u7406"}),"\n",(0,a.jsx)(e.li,{children:"\u2705 \u6027\u80fd\u4f18\u5316\uff1a\u7f13\u5b58\u53cd\u5c04\u5bf9\u8c61\u3001\u9009\u62e9\u5408\u9002\u7684\u5de5\u5177"}),"\n",(0,a.jsx)(e.li,{children:"\u2705 \u6700\u4f73\u5b9e\u8df5\uff1a\u5f02\u5e38\u5904\u7406\u3001\u8d44\u6e90\u7ba1\u7406"}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"\u53cd\u5c04\u548c\u6ce8\u89e3\u662f\u6784\u5efa\u6846\u67b6\u548c\u5b9e\u73b0 AOP \u7684\u57fa\u7840\uff0c\u4f46\u8981\u6ce8\u610f\u6027\u80fd\u548c\u5b89\u5168\u95ee\u9898\u3002"})]})}function u(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(d,{...n})}):d(n)}},48885:(n,e,t)=>{t.d(e,{R:()=>r,x:()=>s});var i=t(99378);const a={},l=i.createContext(a);function r(n){const e=i.useContext(l);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:r(n.components),i.createElement(l.Provider,{value:e},n.children)}}}]);