"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[47013],{48885:(n,e,r)=>{r.d(e,{R:()=>o,x:()=>d});var s=r(99378);const t={},i=s.createContext(t);function o(n){const e=s.useContext(i);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:o(n.components),s.createElement(i.Provider,{value:e},n.children)}},74937:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"ml/computer-vision","title":"\ud83d\uddbc\ufe0f \u8ba1\u7b97\u673a\u89c6\u89c9","description":"\u8ba1\u7b97\u673a\u89c6\u89c9\u8ba9\u673a\u5668\u7406\u89e3\u548c\u5904\u7406\u56fe\u50cf\u4e0e\u89c6\u9891\u3002","source":"@site/docs/ml/computer-vision.md","sourceDirName":"ml","slug":"/ml/computer-vision","permalink":"/docs/ml/computer-vision","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/computer-vision.md","tags":[],"version":"current","sidebarPosition":22,"frontMatter":{"sidebar_position":22,"title":"\ud83d\uddbc\ufe0f \u8ba1\u7b97\u673a\u89c6\u89c9"},"sidebar":"ml","previous":{"title":"\ud83d\udcdd NLP \u57fa\u7840","permalink":"/docs/ml/nlp-basics"},"next":{"title":"\ud83d\udccf \u6a21\u578b\u8bc4\u4f30","permalink":"/docs/ml/model-evaluation"}}');var t=r(22714),i=r(48885);const o={sidebar_position:22,title:"\ud83d\uddbc\ufe0f \u8ba1\u7b97\u673a\u89c6\u89c9"},d="\u8ba1\u7b97\u673a\u89c6\u89c9\u57fa\u7840",l={},c=[{value:"\u56fe\u50cf\u5904\u7406\u57fa\u7840",id:"\u56fe\u50cf\u5904\u7406\u57fa\u7840",level:2},{value:"\u56fe\u50cf\u5206\u7c7b",id:"\u56fe\u50cf\u5206\u7c7b",level:2},{value:"\u4f7f\u7528 PyTorch",id:"\u4f7f\u7528-pytorch",level:3},{value:"\u8fc1\u79fb\u5b66\u4e60",id:"\u8fc1\u79fb\u5b66\u4e60",level:3},{value:"\u76ee\u6807\u68c0\u6d4b",id:"\u76ee\u6807\u68c0\u6d4b",level:2},{value:"YOLO",id:"yolo",level:3},{value:"\u5e38\u89c1\u68c0\u6d4b\u6a21\u578b",id:"\u5e38\u89c1\u68c0\u6d4b\u6a21\u578b",level:3},{value:"\u56fe\u50cf\u5206\u5272",id:"\u56fe\u50cf\u5206\u5272",level:2},{value:"\u8bed\u4e49\u5206\u5272",id:"\u8bed\u4e49\u5206\u5272",level:3},{value:"\u5b9e\u4f8b\u5206\u5272",id:"\u5b9e\u4f8b\u5206\u5272",level:3},{value:"\u6570\u636e\u589e\u5f3a",id:"\u6570\u636e\u589e\u5f3a",level:2},{value:"\u5e38\u89c1\u4efb\u52a1",id:"\u5e38\u89c1\u4efb\u52a1",level:2}];function a(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"\u8ba1\u7b97\u673a\u89c6\u89c9\u57fa\u7840",children:"\u8ba1\u7b97\u673a\u89c6\u89c9\u57fa\u7840"})}),"\n",(0,t.jsx)(e.p,{children:"\u8ba1\u7b97\u673a\u89c6\u89c9\u8ba9\u673a\u5668\u7406\u89e3\u548c\u5904\u7406\u56fe\u50cf\u4e0e\u89c6\u9891\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"\u56fe\u50cf\u5904\u7406\u57fa\u7840",children:"\u56fe\u50cf\u5904\u7406\u57fa\u7840"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import cv2\nimport numpy as np\n\n# \u8bfb\u53d6\u56fe\u50cf\nimg = cv2.imread('image.jpg')\ngray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\n\n# \u8c03\u6574\u5927\u5c0f\nresized = cv2.resize(img, (224, 224))\n\n# \u6ee4\u6ce2\nblurred = cv2.GaussianBlur(img, (5, 5), 0)\n\n# \u8fb9\u7f18\u68c0\u6d4b\nedges = cv2.Canny(gray, 100, 200)\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u56fe\u50cf\u5206\u7c7b",children:"\u56fe\u50cf\u5206\u7c7b"}),"\n",(0,t.jsx)(e.h3,{id:"\u4f7f\u7528-pytorch",children:"\u4f7f\u7528 PyTorch"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import torch\nimport torchvision.transforms as transforms\nfrom torchvision import models\n\n# \u9884\u5904\u7406\ntransform = transforms.Compose([\n    transforms.Resize(256),\n    transforms.CenterCrop(224),\n    transforms.ToTensor(),\n    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])\n])\n\n# \u52a0\u8f7d\u9884\u8bad\u7ec3\u6a21\u578b\nmodel = models.resnet50(pretrained=True)\nmodel.eval()\n\n# \u9884\u6d4b\nwith torch.no_grad():\n    output = model(image_tensor.unsqueeze(0))\n    pred = torch.argmax(output, dim=1)\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u8fc1\u79fb\u5b66\u4e60",children:"\u8fc1\u79fb\u5b66\u4e60"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"# \u51bb\u7ed3\u7279\u5f81\u63d0\u53d6\u5c42\nfor param in model.parameters():\n    param.requires_grad = False\n\n# \u66ff\u6362\u5206\u7c7b\u5934\nmodel.fc = nn.Linear(model.fc.in_features, num_classes)\n\n# \u53ea\u8bad\u7ec3\u65b0\u7684\u5206\u7c7b\u5934\noptimizer = torch.optim.Adam(model.fc.parameters(), lr=0.001)\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u76ee\u6807\u68c0\u6d4b",children:"\u76ee\u6807\u68c0\u6d4b"}),"\n",(0,t.jsx)(e.h3,{id:"yolo",children:"YOLO"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from ultralytics import YOLO\n\n# \u52a0\u8f7d\u6a21\u578b\nmodel = YOLO('yolov8n.pt')\n\n# \u68c0\u6d4b\nresults = model('image.jpg')\n\n# \u83b7\u53d6\u7ed3\u679c\nfor r in results:\n    boxes = r.boxes  # \u8fb9\u754c\u6846\n    for box in boxes:\n        cls = box.cls      # \u7c7b\u522b\n        conf = box.conf    # \u7f6e\u4fe1\u5ea6\n        xyxy = box.xyxy    # \u5750\u6807\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u5e38\u89c1\u68c0\u6d4b\u6a21\u578b",children:"\u5e38\u89c1\u68c0\u6d4b\u6a21\u578b"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"\u6a21\u578b"}),(0,t.jsx)(e.th,{children:"\u7279\u70b9"}),(0,t.jsx)(e.th,{children:"\u901f\u5ea6"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"YOLOv8"}),(0,t.jsx)(e.td,{children:"\u5b9e\u65f6\u68c0\u6d4b"}),(0,t.jsx)(e.td,{children:"\u5feb"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"Faster R-CNN"}),(0,t.jsx)(e.td,{children:"\u9ad8\u7cbe\u5ea6"}),(0,t.jsx)(e.td,{children:"\u4e2d"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"SSD"}),(0,t.jsx)(e.td,{children:"\u5e73\u8861"}),(0,t.jsx)(e.td,{children:"\u4e2d"})]})]})]}),"\n",(0,t.jsx)(e.h2,{id:"\u56fe\u50cf\u5206\u5272",children:"\u56fe\u50cf\u5206\u5272"}),"\n",(0,t.jsx)(e.h3,{id:"\u8bed\u4e49\u5206\u5272",children:"\u8bed\u4e49\u5206\u5272"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from transformers import SegformerForSemanticSegmentation\n\nmodel = SegformerForSemanticSegmentation.from_pretrained(\n    'nvidia/segformer-b0-finetuned-ade-512-512'\n)\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u5b9e\u4f8b\u5206\u5272",children:"\u5b9e\u4f8b\u5206\u5272"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"# Mask R-CNN\nmodel = models.detection.maskrcnn_resnet50_fpn(pretrained=True)\nmodel.eval()\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u6570\u636e\u589e\u5f3a",children:"\u6570\u636e\u589e\u5f3a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from torchvision import transforms\n\ntrain_transform = transforms.Compose([\n    transforms.RandomResizedCrop(224),\n    transforms.RandomHorizontalFlip(),\n    transforms.RandomRotation(15),\n    transforms.ColorJitter(brightness=0.2, contrast=0.2, saturation=0.2),\n    transforms.ToTensor(),\n    transforms.Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])\n])\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u5e38\u89c1\u4efb\u52a1",children:"\u5e38\u89c1\u4efb\u52a1"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"\u4efb\u52a1"}),(0,t.jsx)(e.th,{children:"\u63cf\u8ff0"}),(0,t.jsx)(e.th,{children:"\u8f93\u51fa"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u56fe\u50cf\u5206\u7c7b"}),(0,t.jsx)(e.td,{children:"\u8bc6\u522b\u56fe\u50cf\u7c7b\u522b"}),(0,t.jsx)(e.td,{children:"\u7c7b\u522b\u6807\u7b7e"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u76ee\u6807\u68c0\u6d4b"}),(0,t.jsx)(e.td,{children:"\u5b9a\u4f4d\u5e76\u5206\u7c7b\u7269\u4f53"}),(0,t.jsx)(e.td,{children:"\u8fb9\u754c\u6846 + \u7c7b\u522b"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u8bed\u4e49\u5206\u5272"}),(0,t.jsx)(e.td,{children:"\u50cf\u7d20\u7ea7\u5206\u7c7b"}),(0,t.jsx)(e.td,{children:"\u5206\u5272\u63a9\u7801"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u5b9e\u4f8b\u5206\u5272"}),(0,t.jsx)(e.td,{children:"\u533a\u5206\u540c\u7c7b\u4e0d\u540c\u5b9e\u4f8b"}),(0,t.jsx)(e.td,{children:"\u5b9e\u4f8b\u63a9\u7801"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u59ff\u6001\u4f30\u8ba1"}),(0,t.jsx)(e.td,{children:"\u68c0\u6d4b\u4eba\u4f53\u5173\u952e\u70b9"}),(0,t.jsx)(e.td,{children:"\u5173\u952e\u70b9\u5750\u6807"})]})]})]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(a,{...n})}):a(n)}}}]);