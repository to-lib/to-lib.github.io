"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[9561],{26033:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"dsa/segment-tree","title":"\u7ebf\u6bb5\u6811\uff08Segment Tree\uff09","description":"\u7ebf\u6bb5\u6811\u7528\u4e8e\u7ef4\u62a4\u533a\u95f4\u4fe1\u606f\uff0c\u5178\u578b\u652f\u6301\uff1a","source":"@site/docs/dsa/segment-tree.md","sourceDirName":"dsa","slug":"/dsa/segment-tree","permalink":"/docs/dsa/segment-tree","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/dsa/segment-tree.md","tags":[],"version":"current","sidebarPosition":26,"frontMatter":{"sidebar_position":26,"title":"\u7ebf\u6bb5\u6811\uff08Segment Tree\uff09"},"sidebar":"dsa","previous":{"title":"\u6811\u72b6\u6570\u7ec4\uff08Fenwick Tree\uff09","permalink":"/docs/dsa/fenwick-tree"},"next":{"title":"\u6392\u5e8f\u7b97\u6cd5","permalink":"/docs/dsa/sorting"}}');var r=i(22714),d=i(48885);const s={sidebar_position:26,title:"\u7ebf\u6bb5\u6811\uff08Segment Tree\uff09"},t="\u7ebf\u6bb5\u6811\uff08Segment Tree\uff09",o={},c=[{value:"\ud83d\udccc \u9002\u7528\u573a\u666f",id:"-\u9002\u7528\u573a\u666f",level:2},{value:"\u2705 Java 8 \u6a21\u677f\uff08\u5355\u70b9\u66f4\u65b0 + \u533a\u95f4\u6c42\u548c\uff09",id:"-java-8-\u6a21\u677f\u5355\u70b9\u66f4\u65b0--\u533a\u95f4\u6c42\u548c",level:2},{value:"\ud83c\udfaf \u5e38\u89c1\u6269\u5c55",id:"-\u5e38\u89c1\u6269\u5c55",level:2},{value:"1) \u533a\u95f4\u6700\u5c0f\u503c / \u6700\u5927\u503c",id:"1-\u533a\u95f4\u6700\u5c0f\u503c--\u6700\u5927\u503c",level:3},{value:"2) \u533a\u95f4\u66f4\u65b0\uff08Lazy Propagation\uff09",id:"2-\u533a\u95f4\u66f4\u65b0lazy-propagation",level:3},{value:"\u2705 \u590d\u6742\u5ea6",id:"-\u590d\u6742\u5ea6",level:2},{value:"\ud83d\udca1 \u5e38\u89c1\u5751",id:"-\u5e38\u89c1\u5751",level:2}];function a(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,d.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"\u7ebf\u6bb5\u6811segment-tree",children:"\u7ebf\u6bb5\u6811\uff08Segment Tree\uff09"})}),"\n",(0,r.jsx)(e.p,{children:"\u7ebf\u6bb5\u6811\u7528\u4e8e\u7ef4\u62a4\u533a\u95f4\u4fe1\u606f\uff0c\u5178\u578b\u652f\u6301\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"update(pos, val)"}),"\uff1a\u5355\u70b9\u66f4\u65b0\uff08\u6216\u5355\u70b9\u589e\u91cf\uff09"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"query(l, r)"}),"\uff1a\u533a\u95f4\u67e5\u8be2\uff08\u548c / \u6700\u5c0f\u503c / \u6700\u5927\u503c \u7b49\uff09"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5b83\u7684\u6838\u5fc3\u4f18\u52bf\u662f\uff1a\u5728 ",(0,r.jsx)(e.code,{children:"O(log n)"})," \u5185\u5b8c\u6210\u66f4\u65b0\u4e0e\u67e5\u8be2\uff0c\u9002\u5408\u201c\u9700\u8981\u52a8\u6001\u4fee\u6539 + \u533a\u95f4\u7edf\u8ba1\u201d\u7684\u95ee\u9898\u3002"]}),"\n",(0,r.jsx)(e.h2,{id:"-\u9002\u7528\u573a\u666f",children:"\ud83d\udccc \u9002\u7528\u573a\u666f"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u533a\u95f4\u6c42\u548c / \u533a\u95f4\u6700\u503c\uff08min/max\uff09"}),"\n",(0,r.jsx)(e.li,{children:"\u9700\u8981\u9891\u7e41\u66f4\u65b0\u6570\u7ec4\u5143\u7d20\uff0c\u5e76\u67e5\u8be2\u4efb\u610f\u533a\u95f4\u7684\u7edf\u8ba1"}),"\n",(0,r.jsx)(e.li,{children:"\u8fdb\u9636\uff1a\u61d2\u6807\u8bb0\uff08lazy propagation\uff09\u53ef\u652f\u6301\u533a\u95f4\u66f4\u65b0\uff08\u533a\u95f4\u52a0\u3001\u533a\u95f4\u8d4b\u503c\uff09"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"-java-8-\u6a21\u677f\u5355\u70b9\u66f4\u65b0--\u533a\u95f4\u6c42\u548c",children:"\u2705 Java 8 \u6a21\u677f\uff08\u5355\u70b9\u66f4\u65b0 + \u533a\u95f4\u6c42\u548c\uff09"}),"\n",(0,r.jsxs)(e.p,{children:["\u7ea6\u5b9a\uff1a\u539f\u6570\u7ec4\u4f7f\u7528 0-based \u4e0b\u6807\uff0c\u7ebf\u6bb5\u6811\u7ef4\u62a4 ",(0,r.jsx)(e.code,{children:"[0..n-1]"}),"\u3002"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:"class SegmentTree {\n    private final int n;\n    private final long[] tree;\n\n    public SegmentTree(int[] nums) {\n        this.n = nums.length;\n        this.tree = new long[Math.max(1, 4 * n)];\n        if (n > 0) build(1, 0, n - 1, nums);\n    }\n\n    private void build(int node, int l, int r, int[] nums) {\n        if (l == r) {\n            tree[node] = nums[l];\n            return;\n        }\n        int mid = (l + r) >>> 1;\n        build(node << 1, l, mid, nums);\n        build(node << 1 | 1, mid + 1, r, nums);\n        tree[node] = tree[node << 1] + tree[node << 1 | 1];\n    }\n\n    // \u5355\u70b9\u8d4b\u503c\uff1anums[pos] = val\n    public void update(int pos, long val) {\n        update(1, 0, n - 1, pos, val);\n    }\n\n    private void update(int node, int l, int r, int pos, long val) {\n        if (l == r) {\n            tree[node] = val;\n            return;\n        }\n        int mid = (l + r) >>> 1;\n        if (pos <= mid) update(node << 1, l, mid, pos, val);\n        else update(node << 1 | 1, mid + 1, r, pos, val);\n        tree[node] = tree[node << 1] + tree[node << 1 | 1];\n    }\n\n    // \u533a\u95f4\u548c\uff1asum(nums[ql..qr])\n    public long query(int ql, int qr) {\n        if (ql > qr) return 0;\n        return query(1, 0, n - 1, ql, qr);\n    }\n\n    private long query(int node, int l, int r, int ql, int qr) {\n        if (ql <= l && r <= qr) return tree[node];\n        int mid = (l + r) >>> 1;\n        long res = 0;\n        if (ql <= mid) res += query(node << 1, l, mid, ql, qr);\n        if (qr > mid) res += query(node << 1 | 1, mid + 1, r, ql, qr);\n        return res;\n    }\n}\n"})}),"\n",(0,r.jsx)(e.h2,{id:"-\u5e38\u89c1\u6269\u5c55",children:"\ud83c\udfaf \u5e38\u89c1\u6269\u5c55"}),"\n",(0,r.jsx)(e.h3,{id:"1-\u533a\u95f4\u6700\u5c0f\u503c--\u6700\u5927\u503c",children:"1) \u533a\u95f4\u6700\u5c0f\u503c / \u6700\u5927\u503c"}),"\n",(0,r.jsxs)(e.p,{children:["\u628a ",(0,r.jsx)(e.code,{children:"tree[node]"})," \u7684\u542b\u4e49\u4ece\u201c\u548c\u201d\u6539\u4e3a\u201cmin / max\u201d\uff0c\u5e76\u628a ",(0,r.jsx)(e.code,{children:"pushUp"})," \u7684\u5408\u5e76\u4ece ",(0,r.jsx)(e.code,{children:"+"})," \u6539\u4e3a ",(0,r.jsx)(e.code,{children:"Math.min/Math.max"}),"\u3002"]}),"\n",(0,r.jsx)(e.h3,{id:"2-\u533a\u95f4\u66f4\u65b0lazy-propagation",children:"2) \u533a\u95f4\u66f4\u65b0\uff08Lazy Propagation\uff09"}),"\n",(0,r.jsx)(e.p,{children:"\u5982\u679c\u9898\u76ee\u9700\u8981\uff1a"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u5bf9\u533a\u95f4 ",(0,r.jsx)(e.code,{children:"[l, r]"})," \u5168\u90e8\u52a0 ",(0,r.jsx)(e.code,{children:"delta"})]}),"\n",(0,r.jsx)(e.li,{children:"\u540c\u65f6\u652f\u6301\u533a\u95f4\u67e5\u8be2"}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["\u5219\u9700\u8981 ",(0,r.jsx)(e.code,{children:"lazy[]"}),"\uff0c\u5728\u8bbf\u95ee\u5b50\u8282\u70b9\u524d\u628a\u6807\u8bb0\u4e0b\u63a8\uff08pushDown\uff09\u3002\u8fd9\u5757\u5efa\u8bae\u5728\u9700\u8981\u65f6\u518d\u5355\u72ec\u5199\u4e00\u4e2a\u5e26\u61d2\u6807\u8bb0\u7248\u672c\uff0c\u907f\u514d\u6a21\u677f\u8fc7\u91cd\u3002"]}),"\n",(0,r.jsx)(e.h2,{id:"-\u590d\u6742\u5ea6",children:"\u2705 \u590d\u6742\u5ea6"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u5efa\u6811\uff1a",(0,r.jsx)(e.code,{children:"O(n)"})]}),"\n",(0,r.jsxs)(e.li,{children:["\u5355\u70b9\u66f4\u65b0\uff1a",(0,r.jsx)(e.code,{children:"O(log n)"})]}),"\n",(0,r.jsxs)(e.li,{children:["\u533a\u95f4\u67e5\u8be2\uff1a",(0,r.jsx)(e.code,{children:"O(log n)"})]}),"\n",(0,r.jsxs)(e.li,{children:["\u7a7a\u95f4\uff1a",(0,r.jsx)(e.code,{children:"O(n)"}),"\uff08\u901a\u5e38\u7528 ",(0,r.jsx)(e.code,{children:"4n"})," \u6570\u7ec4\uff09"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"-\u5e38\u89c1\u5751",children:"\ud83d\udca1 \u5e38\u89c1\u5751"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\u8fb9\u754c\uff1a",(0,r.jsx)(e.code,{children:"mid"})," \u7684\u8ba1\u7b97\u4e0e\u9012\u5f52\u533a\u95f4\u5212\u5206\u8981\u4e25\u683c\u4fdd\u8bc1\u4e0d\u6b7b\u5faa\u73af\uff08\u5e38\u7528 ",(0,r.jsx)(e.code,{children:"[l, mid]"})," \u4e0e ",(0,r.jsx)(e.code,{children:"[mid+1, r]"}),"\uff09\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:["\u7a7a\u6570\u7ec4\uff1a",(0,r.jsx)(e.code,{children:"n = 0"})," \u65f6\u8981\u907f\u514d build/query/update \u8bbf\u95ee\u8d8a\u754c\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:["long \u6ea2\u51fa\uff1a\u533a\u95f4\u548c\u573a\u666f\u5efa\u8bae\u7528 ",(0,r.jsx)(e.code,{children:"long"}),"\u3002"]}),"\n",(0,r.jsxs)(e.li,{children:["\u4e0e BIT \u7684\u9009\u62e9\uff1a","\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"BIT \u66f4\u8f7b\u91cf\uff0c\u64c5\u957f\u524d\u7f00/\u53ef\u9006\u533a\u95f4\u7edf\u8ba1\u3002"}),"\n",(0,r.jsx)(e.li,{children:"\u7ebf\u6bb5\u6811\u66f4\u901a\u7528\uff0c\u9002\u5408\u590d\u6742\u533a\u95f4\u4fe1\u606f\u4e0e\u61d2\u6807\u8bb0\u533a\u95f4\u66f4\u65b0\u3002"}),"\n"]}),"\n"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,d.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(a,{...n})}):a(n)}},48885:(n,e,i)=>{i.d(e,{R:()=>s,x:()=>t});var l=i(99378);const r={},d=l.createContext(r);function s(n){const e=l.useContext(d);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:s(n.components),l.createElement(d.Provider,{value:e},n.children)}}}]);