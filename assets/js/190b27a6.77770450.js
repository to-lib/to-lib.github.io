"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[34803],{23229:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"ai/fine-tuning","title":"\ud83e\uddea Fine-tuning\uff08\u5fae\u8c03\uff09","description":"Fine-tuning\uff08\u5fae\u8c03\uff09\u662f\u7528\u4f60\u7684\u6570\u636e\u5bf9\u57fa\u7840\u6a21\u578b\u8fdb\u884c\u518d\u8bad\u7ec3\uff0c\u4f7f\u5176\u66f4\u7b26\u5408\u7279\u5b9a\u4efb\u52a1\u3001\u683c\u5f0f\u6216\u98ce\u683c\u3002\u5b83\u5e38\u7528\u4e8e\\"\u8ba9\u6a21\u578b\u66f4\u50cf\u4f60\u7684\u4ea7\u54c1\\"\uff0c\u800c\u4e0d\u662f\\"\u8ba9\u6a21\u578b\u77e5\u9053\u66f4\u591a\u4e8b\u5b9e\\"\u3002","source":"@site/docs/ai/fine-tuning.md","sourceDirName":"ai","slug":"/ai/fine-tuning","permalink":"/docs/ai/fine-tuning","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ai/fine-tuning.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9,"title":"\ud83e\uddea Fine-tuning\uff08\u5fae\u8c03\uff09"},"sidebar":"ai","previous":{"title":"\ud83c\udf0a \u6d41\u5f0f\u5904\u7406","permalink":"/docs/ai/streaming"},"next":{"title":"\ud83d\ude80 LoRA Fine-tuning\uff08\u5b9e\u6218\uff09","permalink":"/docs/ai/lora-fine-tuning"}}');var r=i(22714),s=i(48885);const l={sidebar_position:9,title:"\ud83e\uddea Fine-tuning\uff08\u5fae\u8c03\uff09"},d="Fine-tuning\uff08\u5fae\u8c03\uff09",a={},c=[{value:"\u4ec0\u4e48\u65f6\u5019\u9002\u5408\u5fae\u8c03",id:"\u4ec0\u4e48\u65f6\u5019\u9002\u5408\u5fae\u8c03",level:2},{value:"\u9002\u5408\u5fae\u8c03\u7684\u573a\u666f",id:"\u9002\u5408\u5fae\u8c03\u7684\u573a\u666f",level:3},{value:"\u4e0d\u592a\u9002\u5408\u5fae\u8c03\u7684\u573a\u666f",id:"\u4e0d\u592a\u9002\u5408\u5fae\u8c03\u7684\u573a\u666f",level:3},{value:"RAG vs Fine-tuning \u7684\u9009\u62e9",id:"rag-vs-fine-tuning-\u7684\u9009\u62e9",level:2},{value:"\u6570\u636e\u51c6\u5907",id:"\u6570\u636e\u51c6\u5907",level:2},{value:"\u6570\u636e\u8d28\u91cf\u539f\u5219",id:"\u6570\u636e\u8d28\u91cf\u539f\u5219",level:3},{value:"\u6570\u636e\u683c\u5f0f",id:"\u6570\u636e\u683c\u5f0f",level:3},{value:"OpenAI \u683c\u5f0f\uff08\u5bf9\u8bdd\uff09",id:"openai-\u683c\u5f0f\u5bf9\u8bdd",level:4},{value:"\u5206\u7c7b\u4efb\u52a1\u683c\u5f0f",id:"\u5206\u7c7b\u4efb\u52a1\u683c\u5f0f",level:4},{value:"\u4fe1\u606f\u62bd\u53d6\u683c\u5f0f",id:"\u4fe1\u606f\u62bd\u53d6\u683c\u5f0f",level:4},{value:"\u6570\u636e\u51c6\u5907\u811a\u672c",id:"\u6570\u636e\u51c6\u5907\u811a\u672c",level:3},{value:"OpenAI Fine-tuning \u5b9e\u6218",id:"openai-fine-tuning-\u5b9e\u6218",level:2},{value:"1. \u4e0a\u4f20\u8bad\u7ec3\u6570\u636e",id:"1-\u4e0a\u4f20\u8bad\u7ec3\u6570\u636e",level:3},{value:"2. \u521b\u5efa\u5fae\u8c03\u4efb\u52a1",id:"2-\u521b\u5efa\u5fae\u8c03\u4efb\u52a1",level:3},{value:"3. \u76d1\u63a7\u8bad\u7ec3\u8fdb\u5ea6",id:"3-\u76d1\u63a7\u8bad\u7ec3\u8fdb\u5ea6",level:3},{value:"4. \u4f7f\u7528\u5fae\u8c03\u6a21\u578b",id:"4-\u4f7f\u7528\u5fae\u8c03\u6a21\u578b",level:3},{value:"\u8bad\u7ec3\u53c2\u6570\u8c03\u4f18",id:"\u8bad\u7ec3\u53c2\u6570\u8c03\u4f18",level:2},{value:"\u5173\u952e\u8d85\u53c2\u6570",id:"\u5173\u952e\u8d85\u53c2\u6570",level:3},{value:"\u53c2\u6570\u9009\u62e9\u5efa\u8bae",id:"\u53c2\u6570\u9009\u62e9\u5efa\u8bae",level:3},{value:"\u8bc4\u4f30\u4e0e\u9a8c\u8bc1",id:"\u8bc4\u4f30\u4e0e\u9a8c\u8bc1",level:2},{value:"\u521b\u5efa\u8bc4\u4f30\u96c6",id:"\u521b\u5efa\u8bc4\u4f30\u96c6",level:3},{value:"\u8bc4\u4f30\u6307\u6807",id:"\u8bc4\u4f30\u6307\u6807",level:3},{value:"\u751f\u4ea7\u843d\u5730\u5efa\u8bae",id:"\u751f\u4ea7\u843d\u5730\u5efa\u8bae",level:2},{value:"\u7248\u672c\u7ba1\u7406",id:"\u7248\u672c\u7ba1\u7406",level:3},{value:"\u7070\u5ea6\u53d1\u5e03",id:"\u7070\u5ea6\u53d1\u5e03",level:3},{value:"\u56de\u6eda\u7b56\u7565",id:"\u56de\u6eda\u7b56\u7565",level:3},{value:"\u6210\u672c\u4f30\u7b97",id:"\u6210\u672c\u4f30\u7b97",level:2},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2},{value:"1. \u8fc7\u62df\u5408",id:"1-\u8fc7\u62df\u5408",level:3},{value:"2. \u6b20\u62df\u5408",id:"2-\u6b20\u62df\u5408",level:3},{value:"3. \u683c\u5f0f\u4e0d\u7a33\u5b9a",id:"3-\u683c\u5f0f\u4e0d\u7a33\u5b9a",level:3},{value:"\u5ef6\u4f38\u9605\u8bfb",id:"\u5ef6\u4f38\u9605\u8bfb",level:2}];function o(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"fine-tuning\u5fae\u8c03",children:"Fine-tuning\uff08\u5fae\u8c03\uff09"})}),"\n",(0,r.jsx)(e.p,{children:'Fine-tuning\uff08\u5fae\u8c03\uff09\u662f\u7528\u4f60\u7684\u6570\u636e\u5bf9\u57fa\u7840\u6a21\u578b\u8fdb\u884c\u518d\u8bad\u7ec3\uff0c\u4f7f\u5176\u66f4\u7b26\u5408\u7279\u5b9a\u4efb\u52a1\u3001\u683c\u5f0f\u6216\u98ce\u683c\u3002\u5b83\u5e38\u7528\u4e8e"\u8ba9\u6a21\u578b\u66f4\u50cf\u4f60\u7684\u4ea7\u54c1"\uff0c\u800c\u4e0d\u662f"\u8ba9\u6a21\u578b\u77e5\u9053\u66f4\u591a\u4e8b\u5b9e"\u3002'}),"\n",(0,r.jsx)(e.h2,{id:"\u4ec0\u4e48\u65f6\u5019\u9002\u5408\u5fae\u8c03",children:"\u4ec0\u4e48\u65f6\u5019\u9002\u5408\u5fae\u8c03"}),"\n",(0,r.jsx)(e.h3,{id:"\u9002\u5408\u5fae\u8c03\u7684\u573a\u666f",children:"\u9002\u5408\u5fae\u8c03\u7684\u573a\u666f"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u573a\u666f"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u7a33\u5b9a\u8f93\u51fa\u683c\u5f0f"})}),(0,r.jsx)(e.td,{children:"\u56fa\u5b9a JSON/SQL/\u51fd\u6570\u53c2\u6570\u7ed3\u6784"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u4efb\u52a1\u4e13\u7cbe"})}),(0,r.jsx)(e.td,{children:"\u5206\u7c7b\u3001\u4fe1\u606f\u62bd\u53d6\u3001\u5ba2\u670d\u610f\u56fe\u8bc6\u522b\u3001\u4ee3\u7801\u8865\u5168"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u8bed\u6c14\u98ce\u683c\u7edf\u4e00"})}),(0,r.jsx)(e.td,{children:"\u54c1\u724c\u53e3\u543b\u3001\u5199\u4f5c\u98ce\u683c\u4e00\u81f4"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\u51cf\u5c11 Prompt"})}),(0,r.jsx)(e.td,{children:'\u628a\u590d\u6742\u6307\u4ee4"\u5185\u5316"\u5230\u6a21\u578b\u4e2d'})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"\u4e0d\u592a\u9002\u5408\u5fae\u8c03\u7684\u573a\u666f",children:"\u4e0d\u592a\u9002\u5408\u5fae\u8c03\u7684\u573a\u666f"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u9700\u8981\u6700\u65b0\u77e5\u8bc6/\u79c1\u6709\u77e5\u8bc6"}),"\uff1a\u4f18\u5148\u7528 RAG"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u9891\u7e41\u53d8\u5316\u7684\u77e5\u8bc6"}),"\uff1a\u5fae\u8c03\u7ef4\u62a4\u6210\u672c\u9ad8"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7b80\u5355\u4efb\u52a1"}),"\uff1aFew-shot Prompting \u53ef\u80fd\u5c31\u591f\u4e86"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"rag-vs-fine-tuning-\u7684\u9009\u62e9",children:"RAG vs Fine-tuning \u7684\u9009\u62e9"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u76ee\u6807"}),(0,r.jsx)(e.th,{children:"\u63a8\u8350\u65b9\u6848"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u8865\u5145\u53ef\u53d8\u77e5\u8bc6/\u79c1\u6709\u77e5\u8bc6"}),(0,r.jsx)(e.td,{children:"RAG"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u6539\u53d8\u6a21\u578b\u884c\u4e3a/\u683c\u5f0f/\u98ce\u683c"}),(0,r.jsx)(e.td,{children:"Fine-tuning"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u4e24\u8005\u90fd\u9700\u8981"}),(0,r.jsx)(e.td,{children:"RAG + Fine-tuning\uff08\u6216 RAG + \u6307\u4ee4\u4f18\u5316\uff09"})]})]})]}),"\n",(0,r.jsx)(e.mermaid,{value:"graph TD\n    A[\u9700\u6c42\u5206\u6790] --\x3e B{\u9700\u8981\u5916\u90e8\u77e5\u8bc6?}\n    B --\x3e|\u662f| C{\u77e5\u8bc6\u9891\u7e41\u53d8\u5316?}\n    B --\x3e|\u5426| D{\u9700\u8981\u7279\u5b9a\u683c\u5f0f/\u98ce\u683c?}\n    C --\x3e|\u662f| E[RAG]\n    C --\x3e|\u5426| F[RAG \u6216 Fine-tuning]\n    D --\x3e|\u662f| G[Fine-tuning]\n    D --\x3e|\u5426| H[Prompt Engineering]"}),"\n",(0,r.jsx)(e.h2,{id:"\u6570\u636e\u51c6\u5907",children:"\u6570\u636e\u51c6\u5907"}),"\n",(0,r.jsx)(e.h3,{id:"\u6570\u636e\u8d28\u91cf\u539f\u5219",children:"\u6570\u636e\u8d28\u91cf\u539f\u5219"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6837\u672c\u8d28\u91cf > \u6570\u91cf"}),'\uff1a\u5148\u505a 100-500 \u6761\u9ad8\u8d28\u91cf"\u9ec4\u91d1\u6837\u672c"']}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u8986\u76d6\u8fb9\u754c\u60c5\u51b5"}),"\uff1a\u9519\u8bef\u8f93\u5165\u3001\u7f3a\u5b57\u6bb5\u3001\u6b67\u4e49\u95ee\u9898\u3001\u957f\u6587\u672c"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u53bb\u91cd\u4e0e\u4e00\u81f4\u6027"}),"\uff1a\u540c\u7c7b\u95ee\u9898\u7b54\u6848\u4e0d\u8981\u4e92\u76f8\u77db\u76fe"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5b89\u5168\u4e0e\u5408\u89c4"}),"\uff1a\u79fb\u9664\u654f\u611f\u4fe1\u606f\uff08PII\u3001\u5bc6\u94a5\u3001\u5185\u90e8\u673a\u5bc6\uff09"]}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\u6570\u636e\u683c\u5f0f",children:"\u6570\u636e\u683c\u5f0f"}),"\n",(0,r.jsx)(e.h4,{id:"openai-\u683c\u5f0f\u5bf9\u8bdd",children:"OpenAI \u683c\u5f0f\uff08\u5bf9\u8bdd\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{"messages": [\n  {"role": "system", "content": "\u4f60\u662f\u4f01\u4e1a\u5ba2\u670d\u52a9\u624b\u3002"},\n  {"role": "user", "content": "\u600e\u4e48\u91cd\u7f6e\u5bc6\u7801\uff1f"},\n  {"role": "assistant", "content": "\u4f60\u53ef\u4ee5\u5728\u767b\u5f55\u9875\u70b9\u51fb"\u5fd8\u8bb0\u5bc6\u7801"\uff0c\u7136\u540e\u6309\u7167\u90ae\u4ef6\u63d0\u793a\u64cd\u4f5c\u3002"}\n]}\n'})}),"\n",(0,r.jsx)(e.h4,{id:"\u5206\u7c7b\u4efb\u52a1\u683c\u5f0f",children:"\u5206\u7c7b\u4efb\u52a1\u683c\u5f0f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{"messages": [\n  {"role": "system", "content": "\u5bf9\u7528\u6237\u53cd\u9988\u8fdb\u884c\u5206\u7c7b\uff0c\u7c7b\u522b\uff1abug/feature/question/other"},\n  {"role": "user", "content": "\u767b\u5f55\u6309\u94ae\u70b9\u51fb\u6ca1\u53cd\u5e94"},\n  {"role": "assistant", "content": "bug"}\n]}\n'})}),"\n",(0,r.jsx)(e.h4,{id:"\u4fe1\u606f\u62bd\u53d6\u683c\u5f0f",children:"\u4fe1\u606f\u62bd\u53d6\u683c\u5f0f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{"messages": [\n  {"role": "system", "content": "\u4ece\u6587\u672c\u4e2d\u63d0\u53d6\u7ed3\u6784\u5316\u4fe1\u606f\uff0c\u8f93\u51fa JSON"},\n  {"role": "user", "content": "\u5f20\u4e09\uff0c\u7537\uff0c1990\u5e74\u51fa\u751f\uff0c\u73b0\u5c45\u5317\u4eac"},\n  {"role": "assistant", "content": "{\\"name\\": \\"\u5f20\u4e09\\", \\"gender\\": \\"\u7537\\", \\"birth_year\\": 1990, \\"city\\": \\"\u5317\u4eac\\"}"}\n]}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u6570\u636e\u51c6\u5907\u811a\u672c",children:"\u6570\u636e\u51c6\u5907\u811a\u672c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'import json\nfrom pathlib import Path\n\ndef prepare_training_data(raw_data: list[dict], output_path: str):\n    """\u5c06\u539f\u59cb\u6570\u636e\u8f6c\u6362\u4e3a OpenAI \u5fae\u8c03\u683c\u5f0f"""\n    formatted_data = []\n    \n    for item in raw_data:\n        formatted_item = {\n            "messages": [\n                {"role": "system", "content": item.get("system_prompt", "")},\n                {"role": "user", "content": item["input"]},\n                {"role": "assistant", "content": item["output"]}\n            ]\n        }\n        formatted_data.append(formatted_item)\n    \n    # \u5199\u5165 JSONL \u6587\u4ef6\n    with open(output_path, \'w\', encoding=\'utf-8\') as f:\n        for item in formatted_data:\n            f.write(json.dumps(item, ensure_ascii=False) + \'\\n\')\n    \n    print(f"\u5df2\u751f\u6210 {len(formatted_data)} \u6761\u8bad\u7ec3\u6570\u636e")\n    return formatted_data\n\ndef validate_data(file_path: str) -> dict:\n    """\u9a8c\u8bc1\u8bad\u7ec3\u6570\u636e\u683c\u5f0f"""\n    errors = []\n    total = 0\n    \n    with open(file_path, \'r\', encoding=\'utf-8\') as f:\n        for i, line in enumerate(f, 1):\n            total += 1\n            try:\n                data = json.loads(line)\n                if "messages" not in data:\n                    errors.append(f"Line {i}: missing \'messages\' field")\n                else:\n                    for msg in data["messages"]:\n                        if "role" not in msg or "content" not in msg:\n                            errors.append(f"Line {i}: invalid message format")\n            except json.JSONDecodeError as e:\n                errors.append(f"Line {i}: JSON parse error - {e}")\n    \n    return {\n        "total": total,\n        "valid": total - len(errors),\n        "errors": errors[:10]  # \u53ea\u8fd4\u56de\u524d 10 \u4e2a\u9519\u8bef\n    }\n'})}),"\n",(0,r.jsx)(e.h2,{id:"openai-fine-tuning-\u5b9e\u6218",children:"OpenAI Fine-tuning \u5b9e\u6218"}),"\n",(0,r.jsx)(e.h3,{id:"1-\u4e0a\u4f20\u8bad\u7ec3\u6570\u636e",children:"1. \u4e0a\u4f20\u8bad\u7ec3\u6570\u636e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'from openai import OpenAI\n\nclient = OpenAI()\n\n# \u4e0a\u4f20\u8bad\u7ec3\u6587\u4ef6\ntraining_file = client.files.create(\n    file=open("training_data.jsonl", "rb"),\n    purpose="fine-tune"\n)\n\nprint(f"File ID: {training_file.id}")\n'})}),"\n",(0,r.jsx)(e.h3,{id:"2-\u521b\u5efa\u5fae\u8c03\u4efb\u52a1",children:"2. \u521b\u5efa\u5fae\u8c03\u4efb\u52a1"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'# \u521b\u5efa\u5fae\u8c03\u4efb\u52a1\nfine_tune_job = client.fine_tuning.jobs.create(\n    training_file=training_file.id,\n    model="gpt-4o-mini-2024-07-18",  # \u57fa\u7840\u6a21\u578b\n    hyperparameters={\n        "n_epochs": 3,  # \u8bad\u7ec3\u8f6e\u6570\n        "batch_size": "auto",\n        "learning_rate_multiplier": "auto"\n    },\n    suffix="my-custom-model"  # \u6a21\u578b\u540d\u79f0\u540e\u7f00\n)\n\nprint(f"Job ID: {fine_tune_job.id}")\nprint(f"Status: {fine_tune_job.status}")\n'})}),"\n",(0,r.jsx)(e.h3,{id:"3-\u76d1\u63a7\u8bad\u7ec3\u8fdb\u5ea6",children:"3. \u76d1\u63a7\u8bad\u7ec3\u8fdb\u5ea6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'import time\n\ndef monitor_fine_tuning(job_id: str):\n    """\u76d1\u63a7\u5fae\u8c03\u4efb\u52a1\u8fdb\u5ea6"""\n    while True:\n        job = client.fine_tuning.jobs.retrieve(job_id)\n        print(f"Status: {job.status}")\n        \n        if job.status == "succeeded":\n            print(f"\u2705 \u8bad\u7ec3\u5b8c\u6210\uff01\u6a21\u578b ID: {job.fine_tuned_model}")\n            return job.fine_tuned_model\n        elif job.status == "failed":\n            print(f"\u274c \u8bad\u7ec3\u5931\u8d25: {job.error}")\n            return None\n        \n        # \u83b7\u53d6\u6700\u65b0\u4e8b\u4ef6\n        events = client.fine_tuning.jobs.list_events(job_id, limit=5)\n        for event in events.data:\n            print(f"  [{event.created_at}] {event.message}")\n        \n        time.sleep(60)  # \u6bcf\u5206\u949f\u68c0\u67e5\u4e00\u6b21\n\n# \u76d1\u63a7\u8bad\u7ec3\nmodel_id = monitor_fine_tuning(fine_tune_job.id)\n'})}),"\n",(0,r.jsx)(e.h3,{id:"4-\u4f7f\u7528\u5fae\u8c03\u6a21\u578b",children:"4. \u4f7f\u7528\u5fae\u8c03\u6a21\u578b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'# \u4f7f\u7528\u5fae\u8c03\u540e\u7684\u6a21\u578b\nresponse = client.chat.completions.create(\n    model=model_id,  # \u4f7f\u7528\u5fae\u8c03\u6a21\u578b ID\n    messages=[\n        {"role": "user", "content": "\u600e\u4e48\u4fee\u6539\u6536\u8d27\u5730\u5740\uff1f"}\n    ],\n    temperature=0.7\n)\n\nprint(response.choices[0].message.content)\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u8bad\u7ec3\u53c2\u6570\u8c03\u4f18",children:"\u8bad\u7ec3\u53c2\u6570\u8c03\u4f18"}),"\n",(0,r.jsx)(e.h3,{id:"\u5173\u952e\u8d85\u53c2\u6570",children:"\u5173\u952e\u8d85\u53c2\u6570"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u53c2\u6570"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"}),(0,r.jsx)(e.th,{children:"\u5efa\u8bae\u503c"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"n_epochs"})}),(0,r.jsx)(e.td,{children:"\u8bad\u7ec3\u8f6e\u6570"}),(0,r.jsx)(e.td,{children:"2-4"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"batch_size"})}),(0,r.jsx)(e.td,{children:"\u6279\u6b21\u5927\u5c0f"}),(0,r.jsx)(e.td,{children:"auto \u6216 4-32"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"learning_rate_multiplier"})}),(0,r.jsx)(e.td,{children:"\u5b66\u4e60\u7387\u500d\u6570"}),(0,r.jsx)(e.td,{children:"0.5-2.0"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"\u53c2\u6570\u9009\u62e9\u5efa\u8bae",children:"\u53c2\u6570\u9009\u62e9\u5efa\u8bae"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'# \u5c0f\u6570\u636e\u96c6 (< 100 \u6761)\nhyperparameters = {\n    "n_epochs": 4,\n    "learning_rate_multiplier": 0.5  # \u964d\u4f4e\u5b66\u4e60\u7387\u9632\u6b62\u8fc7\u62df\u5408\n}\n\n# \u4e2d\u7b49\u6570\u636e\u96c6 (100-1000 \u6761)\nhyperparameters = {\n    "n_epochs": 3,\n    "learning_rate_multiplier": "auto"\n}\n\n# \u5927\u6570\u636e\u96c6 (> 1000 \u6761)\nhyperparameters = {\n    "n_epochs": 2,\n    "learning_rate_multiplier": 1.0\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u8bc4\u4f30\u4e0e\u9a8c\u8bc1",children:"\u8bc4\u4f30\u4e0e\u9a8c\u8bc1"}),"\n",(0,r.jsx)(e.h3,{id:"\u521b\u5efa\u8bc4\u4f30\u96c6",children:"\u521b\u5efa\u8bc4\u4f30\u96c6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'def split_data(data: list, train_ratio: float = 0.9):\n    """\u5212\u5206\u8bad\u7ec3\u96c6\u548c\u9a8c\u8bc1\u96c6"""\n    import random\n    random.shuffle(data)\n    split_idx = int(len(data) * train_ratio)\n    return data[:split_idx], data[split_idx:]\n\n# \u4f7f\u7528\u9a8c\u8bc1\u96c6\nfine_tune_job = client.fine_tuning.jobs.create(\n    training_file=training_file.id,\n    validation_file=validation_file.id,  # \u6dfb\u52a0\u9a8c\u8bc1\u96c6\n    model="gpt-4o-mini-2024-07-18"\n)\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u8bc4\u4f30\u6307\u6807",children:"\u8bc4\u4f30\u6307\u6807"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'def evaluate_model(model_id: str, test_data: list) -> dict:\n    """\u8bc4\u4f30\u5fae\u8c03\u6a21\u578b"""\n    correct = 0\n    total = len(test_data)\n    \n    for item in test_data:\n        response = client.chat.completions.create(\n            model=model_id,\n            messages=[\n                {"role": "system", "content": item["system"]},\n                {"role": "user", "content": item["input"]}\n            ],\n            temperature=0\n        )\n        \n        predicted = response.choices[0].message.content.strip()\n        expected = item["expected"].strip()\n        \n        if predicted == expected:\n            correct += 1\n    \n    return {\n        "accuracy": correct / total,\n        "correct": correct,\n        "total": total\n    }\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u751f\u4ea7\u843d\u5730\u5efa\u8bae",children:"\u751f\u4ea7\u843d\u5730\u5efa\u8bae"}),"\n",(0,r.jsx)(e.h3,{id:"\u7248\u672c\u7ba1\u7406",children:"\u7248\u672c\u7ba1\u7406"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'# \u8bb0\u5f55\u6a21\u578b\u7248\u672c\u4fe1\u606f\nmodel_registry = {\n    "v1.0": {\n        "model_id": "ft:gpt-4o-mini:org::abc123",\n        "training_file": "training_v1.jsonl",\n        "metrics": {"accuracy": 0.92},\n        "created_at": "2024-01-15",\n        "status": "deprecated"\n    },\n    "v1.1": {\n        "model_id": "ft:gpt-4o-mini:org::def456",\n        "training_file": "training_v1.1.jsonl",\n        "metrics": {"accuracy": 0.95},\n        "created_at": "2024-02-01",\n        "status": "production"\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u7070\u5ea6\u53d1\u5e03",children:"\u7070\u5ea6\u53d1\u5e03"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'import random\n\ndef get_model_for_request(user_id: str, rollout_percentage: float = 0.1):\n    """\u7070\u5ea6\u53d1\u5e03\uff1a\u90e8\u5206\u6d41\u91cf\u4f7f\u7528\u65b0\u6a21\u578b"""\n    if random.random() < rollout_percentage:\n        return "ft:gpt-4o-mini:org::new_model"  # \u65b0\u6a21\u578b\n    return "ft:gpt-4o-mini:org::stable_model"   # \u7a33\u5b9a\u6a21\u578b\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u56de\u6eda\u7b56\u7565",children:"\u56de\u6eda\u7b56\u7565"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'class ModelManager:\n    def __init__(self):\n        self.current_model = "ft:gpt-4o-mini:org::v1.1"\n        self.fallback_model = "ft:gpt-4o-mini:org::v1.0"\n        self.error_count = 0\n        self.error_threshold = 10\n    \n    def get_model(self):\n        if self.error_count > self.error_threshold:\n            print("\u26a0\ufe0f \u9519\u8bef\u8fc7\u591a\uff0c\u56de\u6eda\u5230\u7a33\u5b9a\u7248\u672c")\n            return self.fallback_model\n        return self.current_model\n    \n    def report_error(self):\n        self.error_count += 1\n    \n    def reset_errors(self):\n        self.error_count = 0\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u6210\u672c\u4f30\u7b97",children:"\u6210\u672c\u4f30\u7b97"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u6a21\u578b"}),(0,r.jsx)(e.th,{children:"\u8bad\u7ec3\u6210\u672c"}),(0,r.jsx)(e.th,{children:"\u63a8\u7406\u6210\u672c\uff08\u8f93\u5165\uff09"}),(0,r.jsx)(e.th,{children:"\u63a8\u7406\u6210\u672c\uff08\u8f93\u51fa\uff09"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"gpt-4o-mini"}),(0,r.jsx)(e.td,{children:"$3.00 / 1M tokens"}),(0,r.jsx)(e.td,{children:"$0.30 / 1M"}),(0,r.jsx)(e.td,{children:"$1.20 / 1M"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"gpt-4o"}),(0,r.jsx)(e.td,{children:"$25.00 / 1M tokens"}),(0,r.jsx)(e.td,{children:"$5.00 / 1M"}),(0,r.jsx)(e.td,{children:"$15.00 / 1M"})]})]})]}),"\n",(0,r.jsx)(e.p,{children:":::tip \u6210\u672c\u4f18\u5316"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5148\u7528\u5c0f\u6a21\u578b (gpt-4o-mini) \u9a8c\u8bc1\u6548\u679c"}),"\n",(0,r.jsx)(e.li,{children:"\u7cbe\u7b80\u8bad\u7ec3\u6570\u636e\uff0c\u53bb\u9664\u5197\u4f59\u6837\u672c"}),"\n",(0,r.jsx)(e.li,{children:"\u4f7f\u7528\u9a8c\u8bc1\u96c6\u53ca\u65e9\u505c\u6b62\uff0c\u907f\u514d\u8fc7\u5ea6\u8bad\u7ec3\n:::"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,r.jsx)(e.h3,{id:"1-\u8fc7\u62df\u5408",children:"1. \u8fc7\u62df\u5408"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u75c7\u72b6"}),"\uff1a\u8bad\u7ec3\u96c6\u8868\u73b0\u597d\uff0c\u6d4b\u8bd5\u96c6\u8868\u73b0\u5dee"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u89e3\u51b3\u65b9\u6848"}),"\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u589e\u52a0\u8bad\u7ec3\u6570\u636e\u591a\u6837\u6027"}),"\n",(0,r.jsx)(e.li,{children:"\u51cf\u5c11\u8bad\u7ec3\u8f6e\u6570"}),"\n",(0,r.jsx)(e.li,{children:"\u964d\u4f4e\u5b66\u4e60\u7387"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"2-\u6b20\u62df\u5408",children:"2. \u6b20\u62df\u5408"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u75c7\u72b6"}),"\uff1a\u8bad\u7ec3\u96c6\u548c\u6d4b\u8bd5\u96c6\u8868\u73b0\u90fd\u4e0d\u597d"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u89e3\u51b3\u65b9\u6848"}),"\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u589e\u52a0\u8bad\u7ec3\u6570\u636e\u91cf"}),"\n",(0,r.jsx)(e.li,{children:"\u589e\u52a0\u8bad\u7ec3\u8f6e\u6570"}),"\n",(0,r.jsx)(e.li,{children:"\u68c0\u67e5\u6570\u636e\u8d28\u91cf"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"3-\u683c\u5f0f\u4e0d\u7a33\u5b9a",children:"3. \u683c\u5f0f\u4e0d\u7a33\u5b9a"}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u75c7\u72b6"}),"\uff1a\u8f93\u51fa\u683c\u5f0f\u65f6\u597d\u65f6\u574f"]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u89e3\u51b3\u65b9\u6848"}),"\uff1a"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\u5728\u8bad\u7ec3\u6570\u636e\u4e2d\u589e\u52a0\u683c\u5f0f\u793a\u4f8b"}),"\n",(0,r.jsx)(e.li,{children:"\u4f7f\u7528 JSON Mode"}),"\n",(0,r.jsx)(e.li,{children:"\u6dfb\u52a0\u683c\u5f0f\u9a8c\u8bc1\u540e\u5904\u7406"}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u5ef6\u4f38\u9605\u8bfb",children:"\u5ef6\u4f38\u9605\u8bfb"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:(0,r.jsx)(e.a,{href:"https://platform.openai.com/docs/guides/fine-tuning",children:"OpenAI Fine-tuning \u6587\u6863"})}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"./lora-fine-tuning",children:"LoRA Fine-tuning \u5b9e\u6218"})," - \u672c\u5730\u5fae\u8c03\u5f00\u6e90\u6a21\u578b"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}},48885:(n,e,i)=>{i.d(e,{R:()=>l,x:()=>d});var t=i(99378);const r={},s=t.createContext(r);function l(n){const e=t.useContext(s);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),t.createElement(s.Provider,{value:e},n.children)}}}]);