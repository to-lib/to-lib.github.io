"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[60987],{43734:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"kubernetes/faq","title":"\u5e38\u89c1\u95ee\u9898","description":"Kubernetes \u5e38\u89c1\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848","source":"@site/docs/kubernetes/faq.md","sourceDirName":"kubernetes","slug":"/kubernetes/faq","permalink":"/docs/kubernetes/faq","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/kubernetes/faq.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12,"title":"\u5e38\u89c1\u95ee\u9898","description":"Kubernetes \u5e38\u89c1\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848"},"sidebar":"kubernetes","previous":{"title":"\u6545\u969c\u6392\u67e5","permalink":"/docs/kubernetes/troubleshooting"},"next":{"title":"\u9762\u8bd5\u9898","permalink":"/docs/interview/kubernetes-interview-questions"}}');var r=l(22714),i=l(48885);const d={sidebar_position:12,title:"\u5e38\u89c1\u95ee\u9898",description:"Kubernetes \u5e38\u89c1\u95ee\u9898\u4e0e\u89e3\u51b3\u65b9\u6848"},c="Kubernetes \u5e38\u89c1\u95ee\u9898",a={},t=[{value:"Pod \u95ee\u9898",id:"pod-\u95ee\u9898",level:2},{value:"Pod \u4e00\u76f4\u5904\u4e8e Pending \u72b6\u6001",id:"pod-\u4e00\u76f4\u5904\u4e8e-pending-\u72b6\u6001",level:3},{value:"Pod \u4e00\u76f4\u5904\u4e8e CrashLoopBackOff",id:"pod-\u4e00\u76f4\u5904\u4e8e-crashloopbackoff",level:3},{value:"ImagePullBackOff",id:"imagepullbackoff",level:3},{value:"\u7f51\u7edc\u95ee\u9898",id:"\u7f51\u7edc\u95ee\u9898",level:2},{value:"Pod \u65e0\u6cd5\u8bbf\u95ee Service",id:"pod-\u65e0\u6cd5\u8bbf\u95ee-service",level:3},{value:"\u65e0\u6cd5\u4ece\u5916\u90e8\u8bbf\u95ee",id:"\u65e0\u6cd5\u4ece\u5916\u90e8\u8bbf\u95ee",level:3},{value:"\u5b58\u50a8\u95ee\u9898",id:"\u5b58\u50a8\u95ee\u9898",level:2},{value:"PVC \u4e00\u76f4\u5904\u4e8e Pending",id:"pvc-\u4e00\u76f4\u5904\u4e8e-pending",level:3},{value:"\u8d44\u6e90\u9650\u5236",id:"\u8d44\u6e90\u9650\u5236",level:2},{value:"OOMKilled",id:"oomkilled",level:3},{value:"\u8c03\u8bd5\u6280\u5de7",id:"\u8c03\u8bd5\u6280\u5de7",level:2},{value:"\u5b89\u5168\u95ee\u9898",id:"\u5b89\u5168\u95ee\u9898",level:2},{value:"\u5982\u4f55\u9650\u5236\u5bb9\u5668\u6743\u9650\uff1f",id:"\u5982\u4f55\u9650\u5236\u5bb9\u5668\u6743\u9650",level:3},{value:"Secret \u5982\u4f55\u5b89\u5168\u7ba1\u7406\uff1f",id:"secret-\u5982\u4f55\u5b89\u5168\u7ba1\u7406",level:3},{value:"\u6027\u80fd\u95ee\u9898",id:"\u6027\u80fd\u95ee\u9898",level:2},{value:"\u5982\u4f55\u4f18\u5316 Pod \u542f\u52a8\u901f\u5ea6\uff1f",id:"\u5982\u4f55\u4f18\u5316-pod-\u542f\u52a8\u901f\u5ea6",level:3},{value:"\u5982\u4f55\u5904\u7406\u8282\u70b9\u8d44\u6e90\u538b\u529b\uff1f",id:"\u5982\u4f55\u5904\u7406\u8282\u70b9\u8d44\u6e90\u538b\u529b",level:3},{value:"Helm \u95ee\u9898",id:"helm-\u95ee\u9898",level:2},{value:"Helm install \u5931\u8d25\u5982\u4f55\u6392\u67e5\uff1f",id:"helm-install-\u5931\u8d25\u5982\u4f55\u6392\u67e5",level:3},{value:"\u5982\u4f55\u56de\u6eda Helm Release\uff1f",id:"\u5982\u4f55\u56de\u6eda-helm-release",level:3},{value:"\u96c6\u7fa4\u5347\u7ea7",id:"\u96c6\u7fa4\u5347\u7ea7",level:2},{value:"\u5982\u4f55\u5b89\u5168\u5347\u7ea7 Kubernetes \u96c6\u7fa4\uff1f",id:"\u5982\u4f55\u5b89\u5168\u5347\u7ea7-kubernetes-\u96c6\u7fa4",level:3},{value:"API \u5e9f\u5f03\u5982\u4f55\u5904\u7406\uff1f",id:"api-\u5e9f\u5f03\u5982\u4f55\u5904\u7406",level:3},{value:"\u4e91\u5e73\u53f0\u7279\u5b9a\u95ee\u9898",id:"\u4e91\u5e73\u53f0\u7279\u5b9a\u95ee\u9898",level:2},{value:"EKS \u8282\u70b9\u65e0\u6cd5\u52a0\u5165\u96c6\u7fa4\uff1f",id:"eks-\u8282\u70b9\u65e0\u6cd5\u52a0\u5165\u96c6\u7fa4",level:3},{value:"AKS Pod \u65e0\u6cd5\u62c9\u53d6 ACR \u955c\u50cf\uff1f",id:"aks-pod-\u65e0\u6cd5\u62c9\u53d6-acr-\u955c\u50cf",level:3},{value:"GKE \u8d1f\u8f7d\u5747\u8861\u5668\u672a\u521b\u5efa\uff1f",id:"gke-\u8d1f\u8f7d\u5747\u8861\u5668\u672a\u521b\u5efa",level:3},{value:"\u76d1\u63a7\u544a\u8b66",id:"\u76d1\u63a7\u544a\u8b66",level:2},{value:"Prometheus \u6293\u53d6\u5931\u8d25\uff1f",id:"prometheus-\u6293\u53d6\u5931\u8d25",level:3},{value:"\u5982\u4f55\u8bbe\u7f6e\u6709\u6548\u7684\u544a\u8b66\u89c4\u5219\uff1f",id:"\u5982\u4f55\u8bbe\u7f6e\u6709\u6548\u7684\u544a\u8b66\u89c4\u5219",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"kubernetes-\u5e38\u89c1\u95ee\u9898",children:"Kubernetes \u5e38\u89c1\u95ee\u9898"})}),"\n",(0,r.jsx)(n.h2,{id:"pod-\u95ee\u9898",children:"Pod \u95ee\u9898"}),"\n",(0,r.jsx)(n.h3,{id:"pod-\u4e00\u76f4\u5904\u4e8e-pending-\u72b6\u6001",children:"Pod \u4e00\u76f4\u5904\u4e8e Pending \u72b6\u6001"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u53ef\u80fd\u539f\u56e0"}),"\uff1a"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u8d44\u6e90\u4e0d\u8db3\uff08CPU/\u5185\u5b58\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u8282\u70b9"}),"\n",(0,r.jsx)(n.li,{children:"PVC \u672a\u7ed1\u5b9a"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u6392\u67e5\u65b9\u6cd5"}),"\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl describe pod <pod-name>\nkubectl get events --sort-by='.lastTimestamp'\n"})}),"\n",(0,r.jsx)(n.h3,{id:"pod-\u4e00\u76f4\u5904\u4e8e-crashloopbackoff",children:"Pod \u4e00\u76f4\u5904\u4e8e CrashLoopBackOff"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u53ef\u80fd\u539f\u56e0"}),"\uff1a"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u5e94\u7528\u542f\u52a8\u5931\u8d25"}),"\n",(0,r.jsx)(n.li,{children:"\u914d\u7f6e\u9519\u8bef"}),"\n",(0,r.jsx)(n.li,{children:"\u5065\u5eb7\u68c0\u67e5\u5931\u8d25"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u6392\u67e5\u65b9\u6cd5"}),"\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl logs <pod-name> --previous\nkubectl describe pod <pod-name>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"imagepullbackoff",children:"ImagePullBackOff"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u53ef\u80fd\u539f\u56e0"}),"\uff1a"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"\u955c\u50cf\u4e0d\u5b58\u5728"}),"\n",(0,r.jsx)(n.li,{children:"\u4ed3\u5e93\u8ba4\u8bc1\u5931\u8d25"}),"\n",(0,r.jsx)(n.li,{children:"\u7f51\u7edc\u95ee\u9898"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u89e3\u51b3\u65b9\u6cd5"}),"\uff1a"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u68c0\u67e5\u955c\u50cf\u540d\u79f0\nkubectl describe pod <pod-name>\n\n# \u6dfb\u52a0\u955c\u50cf\u62c9\u53d6\u51ed\u8bc1\nkubectl create secret docker-registry my-registry \\\n  --docker-server=registry.example.com \\\n  --docker-username=user \\\n  --docker-password=pass\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u7f51\u7edc\u95ee\u9898",children:"\u7f51\u7edc\u95ee\u9898"}),"\n",(0,r.jsx)(n.h3,{id:"pod-\u65e0\u6cd5\u8bbf\u95ee-service",children:"Pod \u65e0\u6cd5\u8bbf\u95ee Service"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u68c0\u67e5 Service\nkubectl get svc\nkubectl get endpoints <service-name>\n\n# DNS \u6d4b\u8bd5\nkubectl run dns-test --image=busybox -it --rm -- nslookup <service-name>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u65e0\u6cd5\u4ece\u5916\u90e8\u8bbf\u95ee",children:"\u65e0\u6cd5\u4ece\u5916\u90e8\u8bbf\u95ee"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u68c0\u67e5 Service \u7c7b\u578b\uff08NodePort/LoadBalancer\uff09"}),"\n",(0,r.jsx)(n.li,{children:"\u68c0\u67e5\u9632\u706b\u5899\u89c4\u5219"}),"\n",(0,r.jsx)(n.li,{children:"\u68c0\u67e5 Ingress \u914d\u7f6e"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u5b58\u50a8\u95ee\u9898",children:"\u5b58\u50a8\u95ee\u9898"}),"\n",(0,r.jsx)(n.h3,{id:"pvc-\u4e00\u76f4\u5904\u4e8e-pending",children:"PVC \u4e00\u76f4\u5904\u4e8e Pending"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u68c0\u67e5 StorageClass\nkubectl get storageclass\n\n# \u67e5\u770b PVC \u4e8b\u4ef6\nkubectl describe pvc <pvc-name>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u8d44\u6e90\u9650\u5236",children:"\u8d44\u6e90\u9650\u5236"}),"\n",(0,r.jsx)(n.h3,{id:"oomkilled",children:"OOMKilled"}),"\n",(0,r.jsx)(n.p,{children:"\u5bb9\u5668\u5185\u5b58\u8d85\u51fa\u9650\u5236\u88ab\u6740\u6b7b\u3002"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u89e3\u51b3\u65b9\u6cd5"}),"\uff1a\u589e\u52a0\u5185\u5b58\u9650\u5236\u6216\u4f18\u5316\u5e94\u7528\u5185\u5b58\u4f7f\u7528\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'resources:\n  limits:\n    memory: "512Mi" # \u589e\u52a0\u9650\u5236\n'})}),"\n",(0,r.jsx)(n.h2,{id:"\u8c03\u8bd5\u6280\u5de7",children:"\u8c03\u8bd5\u6280\u5de7"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u4e8b\u4ef6\nkubectl get events -A --sort-by='.lastTimestamp'\n\n# \u8fdb\u5165\u4e34\u65f6\u8c03\u8bd5\u5bb9\u5668\nkubectl debug <pod-name> -it --image=busybox\n\n# \u7f51\u7edc\u8c03\u8bd5\nkubectl run netshoot --image=nicolaka/netshoot -it --rm\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u5b89\u5168\u95ee\u9898",children:"\u5b89\u5168\u95ee\u9898"}),"\n",(0,r.jsx)(n.h3,{id:"\u5982\u4f55\u9650\u5236\u5bb9\u5668\u6743\u9650",children:"\u5982\u4f55\u9650\u5236\u5bb9\u5668\u6743\u9650\uff1f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spec:\n  securityContext:\n    runAsNonRoot: true\n    runAsUser: 1000\n  containers:\n    - name: app\n      securityContext:\n        allowPrivilegeEscalation: false\n        readOnlyRootFilesystem: true\n        capabilities:\n          drop:\n            - ALL\n"})}),"\n",(0,r.jsx)(n.h3,{id:"secret-\u5982\u4f55\u5b89\u5168\u7ba1\u7406",children:"Secret \u5982\u4f55\u5b89\u5168\u7ba1\u7406\uff1f"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u542f\u7528 etcd \u52a0\u5bc6"}),"\uff1a\u914d\u7f6e EncryptionConfiguration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4f7f\u7528\u5916\u90e8 Secret \u7ba1\u7406\u5668"}),"\uff1aVault\u3001AWS Secrets Manager"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u9650\u5236 Secret \u8bbf\u95ee\u6743\u9650"}),"\uff1aRBAC \u6700\u5c0f\u6743\u9650\u539f\u5219"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u907f\u514d\u73af\u5883\u53d8\u91cf\u4f20\u9012"}),"\uff1a\u4f7f\u7528 Volume \u6302\u8f7d"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"\u6027\u80fd\u95ee\u9898",children:"\u6027\u80fd\u95ee\u9898"}),"\n",(0,r.jsx)(n.h3,{id:"\u5982\u4f55\u4f18\u5316-pod-\u542f\u52a8\u901f\u5ea6",children:"\u5982\u4f55\u4f18\u5316 Pod \u542f\u52a8\u901f\u5ea6\uff1f"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4f7f\u7528\u8f83\u5c0f\u7684\u57fa\u7840\u955c\u50cf"}),"\uff1aAlpine\u3001Distroless"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u9884\u62c9\u53d6\u955c\u50cf"}),"\uff1a\u4f7f\u7528 DaemonSet \u9884\u70ed\u955c\u50cf"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4f18\u5316\u5065\u5eb7\u68c0\u67e5"}),"\uff1a\u5408\u7406\u8bbe\u7f6e initialDelaySeconds"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u51cf\u5c11 Init Container"}),"\uff1a\u5408\u5e76\u521d\u59cb\u5316\u903b\u8f91"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u5982\u4f55\u5904\u7406\u8282\u70b9\u8d44\u6e90\u538b\u529b",children:"\u5982\u4f55\u5904\u7406\u8282\u70b9\u8d44\u6e90\u538b\u529b\uff1f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# \u67e5\u770b\u8282\u70b9\u8d44\u6e90\u72b6\u51b5\nkubectl describe node <node-name> | grep -A 10 "Conditions"\n\n# \u67e5\u627e\u8d44\u6e90\u6d88\u8017\u5927\u7684 Pod\nkubectl top pods -A --sort-by=memory | head -10\n\n# \u9a71\u9010\u8282\u70b9\u4e0a\u7684 Pod\nkubectl drain <node-name> --ignore-daemonsets --delete-emptydir-data\n'})}),"\n",(0,r.jsx)(n.h2,{id:"helm-\u95ee\u9898",children:"Helm \u95ee\u9898"}),"\n",(0,r.jsx)(n.h3,{id:"helm-install-\u5931\u8d25\u5982\u4f55\u6392\u67e5",children:"Helm install \u5931\u8d25\u5982\u4f55\u6392\u67e5\uff1f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b Release \u72b6\u6001\nhelm status my-release\n\n# \u67e5\u770b\u5b89\u88c5\u5386\u53f2\nhelm history my-release\n\n# \u4f7f\u7528 --debug \u83b7\u53d6\u8be6\u7ec6\u4fe1\u606f\nhelm install my-release ./chart --dry-run --debug\n\n# \u6a21\u677f\u6e32\u67d3\u6d4b\u8bd5\nhelm template my-release ./chart\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u5982\u4f55\u56de\u6eda-helm-release",children:"\u5982\u4f55\u56de\u6eda Helm Release\uff1f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u5386\u53f2\u7248\u672c\nhelm history my-release\n\n# \u56de\u6eda\u5230\u6307\u5b9a\u7248\u672c\nhelm rollback my-release 2\n\n# \u56de\u6eda\u5e76\u7b49\u5f85\u5b8c\u6210\nhelm rollback my-release 2 --wait\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u96c6\u7fa4\u5347\u7ea7",children:"\u96c6\u7fa4\u5347\u7ea7"}),"\n",(0,r.jsx)(n.h3,{id:"\u5982\u4f55\u5b89\u5168\u5347\u7ea7-kubernetes-\u96c6\u7fa4",children:"\u5982\u4f55\u5b89\u5168\u5347\u7ea7 Kubernetes \u96c6\u7fa4\uff1f"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u9605\u8bfb\u53d1\u5e03\u8bf4\u660e"}),"\uff1a\u4e86\u89e3\u5e9f\u5f03 API \u548c\u7834\u574f\u6027\u53d8\u66f4"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5907\u4efd etcd"}),"\uff1a",(0,r.jsx)(n.code,{children:"etcdctl snapshot save backup.db"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5347\u7ea7\u63a7\u5236\u5e73\u9762"}),"\uff1a",(0,r.jsx)(n.code,{children:"kubeadm upgrade apply v1.x.x"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u5347\u7ea7\u5de5\u4f5c\u8282\u70b9"}),"\uff1a\u9010\u4e2a drain \u540e\u5347\u7ea7"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u9a8c\u8bc1\u96c6\u7fa4\u72b6\u6001"}),"\uff1a",(0,r.jsx)(n.code,{children:"kubectl get nodes"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"api-\u5e9f\u5f03\u5982\u4f55\u5904\u7406",children:"API \u5e9f\u5f03\u5982\u4f55\u5904\u7406\uff1f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u68c0\u67e5\u5e9f\u5f03 API \u4f7f\u7528\u60c5\u51b5\nkubectl get --raw /metrics | grep apiserver_requested_deprecated_apis\n\n# \u4f7f\u7528 kubent \u5de5\u5177\u68c0\u67e5\nkubent\n\n# \u66f4\u65b0\u8d44\u6e90\u7248\u672c\nkubectl convert -f old.yaml --output-version apps/v1 > new.yaml\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u4e91\u5e73\u53f0\u7279\u5b9a\u95ee\u9898",children:"\u4e91\u5e73\u53f0\u7279\u5b9a\u95ee\u9898"}),"\n",(0,r.jsx)(n.h3,{id:"eks-\u8282\u70b9\u65e0\u6cd5\u52a0\u5165\u96c6\u7fa4",children:"EKS \u8282\u70b9\u65e0\u6cd5\u52a0\u5165\u96c6\u7fa4\uff1f"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u68c0\u67e5 IAM \u89d2\u8272\u6743\u9650"}),"\n",(0,r.jsx)(n.li,{children:"\u9a8c\u8bc1\u5b89\u5168\u7ec4\u89c4\u5219"}),"\n",(0,r.jsx)(n.li,{children:"\u68c0\u67e5 aws-auth ConfigMap"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"kubectl get configmap aws-auth -n kube-system -o yaml\n"})}),"\n",(0,r.jsx)(n.h3,{id:"aks-pod-\u65e0\u6cd5\u62c9\u53d6-acr-\u955c\u50cf",children:"AKS Pod \u65e0\u6cd5\u62c9\u53d6 ACR \u955c\u50cf\uff1f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u68c0\u67e5 ACR \u96c6\u6210\naz aks check-acr --name myAKSCluster --resource-group myResourceGroup --acr myACR.azurecr.io\n\n# \u624b\u52a8\u9644\u52a0 ACR\naz aks update -n myAKSCluster -g myResourceGroup --attach-acr myACR\n"})}),"\n",(0,r.jsx)(n.h3,{id:"gke-\u8d1f\u8f7d\u5747\u8861\u5668\u672a\u521b\u5efa",children:"GKE \u8d1f\u8f7d\u5747\u8861\u5668\u672a\u521b\u5efa\uff1f"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"\u68c0\u67e5\u670d\u52a1\u8d26\u53f7\u6743\u9650"}),"\n",(0,r.jsx)(n.li,{children:"\u9a8c\u8bc1\u914d\u989d\u9650\u5236"}),"\n",(0,r.jsx)(n.li,{children:"\u67e5\u770b Cloud Console \u4e8b\u4ef6"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b GKE \u670d\u52a1\u4e8b\u4ef6\nkubectl describe svc <service-name>\n"})}),"\n",(0,r.jsx)(n.h2,{id:"\u76d1\u63a7\u544a\u8b66",children:"\u76d1\u63a7\u544a\u8b66"}),"\n",(0,r.jsx)(n.h3,{id:"prometheus-\u6293\u53d6\u5931\u8d25",children:"Prometheus \u6293\u53d6\u5931\u8d25\uff1f"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u68c0\u67e5 ServiceMonitor\nkubectl get servicemonitor -A\n\n# \u9a8c\u8bc1\u6807\u7b7e\u5339\u914d\nkubectl get svc -l <label> --show-labels\n\n# \u67e5\u770b Prometheus targets\nkubectl port-forward svc/prometheus 9090:9090\n# \u8bbf\u95ee http://localhost:9090/targets\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u5982\u4f55\u8bbe\u7f6e\u6709\u6548\u7684\u544a\u8b66\u89c4\u5219",children:"\u5982\u4f55\u8bbe\u7f6e\u6709\u6548\u7684\u544a\u8b66\u89c4\u5219\uff1f"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u907f\u514d\u544a\u8b66\u98ce\u66b4"}),"\uff1a\u4f7f\u7528\u5408\u9002\u7684 for \u6301\u7eed\u65f6\u95f4"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u8bbe\u7f6e\u4f18\u5148\u7ea7"}),"\uff1acritical/warning/info \u5206\u7ea7"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u63d0\u4f9b\u4e0a\u4e0b\u6587"}),"\uff1a\u5728 annotations \u4e2d\u6dfb\u52a0 runbook \u94fe\u63a5"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u51cf\u5c11\u566a\u97f3"}),"\uff1a\u805a\u5408\u76f8\u5173\u544a\u8b66"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'- alert: PodCrashLooping\n  expr: rate(kube_pod_container_status_restarts_total[15m]) > 0\n  for: 5m # \u907f\u514d\u77ed\u6682\u91cd\u542f\u89e6\u53d1\u544a\u8b66\n  labels:\n    severity: warning\n  annotations:\n    summary: "Pod {{ $labels.pod }} \u9891\u7e41\u91cd\u542f"\n    runbook_url: "https://wiki.example.com/runbooks/pod-crash"\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},48885:(e,n,l)=>{l.d(n,{R:()=>d,x:()=>c});var s=l(99378);const r={},i=s.createContext(r);function d(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);