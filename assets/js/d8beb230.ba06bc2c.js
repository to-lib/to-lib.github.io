"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[42929],{37887:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>c,contentTitle:()=>t,default:()=>j,frontMatter:()=>l,metadata:()=>d,toc:()=>h});const d=JSON.parse('{"id":"flink/quick-reference","title":"\u5feb\u901f\u53c2\u8003","description":"Flink \u5e38\u7528\u914d\u7f6e\u548c\u547d\u4ee4\u901f\u67e5","source":"@site/docs/flink/quick-reference.md","sourceDirName":"flink","slug":"/flink/quick-reference","permalink":"/docs/flink/quick-reference","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/flink/quick-reference.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"\u5feb\u901f\u53c2\u8003","description":"Flink \u5e38\u7528\u914d\u7f6e\u548c\u547d\u4ee4\u901f\u67e5"},"sidebar":"flink","previous":{"title":"\u6700\u4f73\u5b9e\u8df5","permalink":"/docs/flink/best-practices"},"next":{"title":"\u5e38\u89c1\u95ee\u9898","permalink":"/docs/flink/faq"}}');var i=s(22714),r=s(48885);const l={sidebar_position:7,title:"\u5feb\u901f\u53c2\u8003",description:"Flink \u5e38\u7528\u914d\u7f6e\u548c\u547d\u4ee4\u901f\u67e5"},t="Flink \u5feb\u901f\u53c2\u8003",c={},h=[{value:"\u5e38\u7528\u547d\u4ee4",id:"\u5e38\u7528\u547d\u4ee4",level:2},{value:"\u96c6\u7fa4\u7ba1\u7406",id:"\u96c6\u7fa4\u7ba1\u7406",level:3},{value:"\u4f5c\u4e1a\u7ba1\u7406",id:"\u4f5c\u4e1a\u7ba1\u7406",level:3},{value:"\u5e38\u7528\u914d\u7f6e",id:"\u5e38\u7528\u914d\u7f6e",level:2},{value:"flink-conf.yaml",id:"flink-confyaml",level:3},{value:"API \u901f\u67e5",id:"api-\u901f\u67e5",level:2},{value:"DataStream \u5e38\u7528\u64cd\u4f5c",id:"datastream-\u5e38\u7528\u64cd\u4f5c",level:3},{value:"\u7a97\u53e3\u7c7b\u578b",id:"\u7a97\u53e3\u7c7b\u578b",level:3},{value:"\u72b6\u6001\u7c7b\u578b",id:"\u72b6\u6001\u7c7b\u578b",level:3},{value:"SQL \u901f\u67e5",id:"sql-\u901f\u67e5",level:2},{value:"\u5e38\u7528 DDL",id:"\u5e38\u7528-ddl",level:3},{value:"\u5e38\u7528\u51fd\u6570",id:"\u5e38\u7528\u51fd\u6570",level:3},{value:"\u7a97\u53e3\u51fd\u6570",id:"\u7a97\u53e3\u51fd\u6570",level:3},{value:"\u5e38\u89c1\u95ee\u9898\u5feb\u901f\u89e3\u51b3",id:"\u5e38\u89c1\u95ee\u9898\u5feb\u901f\u89e3\u51b3",level:2}];function a(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"flink-\u5feb\u901f\u53c2\u8003",children:"Flink \u5feb\u901f\u53c2\u8003"})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"\u9002\u7528\u7248\u672c\uff1aApache Flink v2.2.0"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u5e38\u7528\u547d\u4ee4",children:"\u5e38\u7528\u547d\u4ee4"}),"\n",(0,i.jsx)(e.h3,{id:"\u96c6\u7fa4\u7ba1\u7406",children:"\u96c6\u7fa4\u7ba1\u7406"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u542f\u52a8/\u505c\u6b62\u96c6\u7fa4\n./bin/start-cluster.sh\n./bin/stop-cluster.sh\n\n# \u542f\u52a8/\u505c\u6b62 JobManager\n./bin/jobmanager.sh start\n./bin/jobmanager.sh stop\n\n# \u542f\u52a8/\u505c\u6b62 TaskManager\n./bin/taskmanager.sh start\n./bin/taskmanager.sh stop\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u4f5c\u4e1a\u7ba1\u7406",children:"\u4f5c\u4e1a\u7ba1\u7406"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u63d0\u4ea4\u4f5c\u4e1a\nflink run -c com.example.MyJob myJob.jar\nflink run -p 4 myJob.jar                    # \u5e76\u884c\u5ea6\u4e3a 4\nflink run -d myJob.jar                       # \u540e\u53f0\u8fd0\u884c\nflink run -s /path/to/savepoint myJob.jar   # \u4ece\u4fdd\u5b58\u70b9\u6062\u590d\n\n# \u67e5\u770b\u4f5c\u4e1a\nflink list                                   # \u8fd0\u884c\u4e2d\u7684\u4f5c\u4e1a\nflink list -a                                # \u6240\u6709\u4f5c\u4e1a\n\n# \u53d6\u6d88\u4f5c\u4e1a\nflink cancel <jobId>\nflink cancel -s /path/to/savepoint <jobId>  # \u53d6\u6d88\u5e76\u4fdd\u5b58\u70b9\n\n# \u4fdd\u5b58\u70b9\nflink savepoint <jobId> /path/to/savepoints\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5e38\u7528\u914d\u7f6e",children:"\u5e38\u7528\u914d\u7f6e"}),"\n",(0,i.jsx)(e.h3,{id:"flink-confyaml",children:"flink-conf.yaml"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# JobManager \u914d\u7f6e\njobmanager.rpc.address: localhost\njobmanager.rpc.port: 6123\njobmanager.memory.process.size: 1600m\n\n# TaskManager \u914d\u7f6e\ntaskmanager.memory.process.size: 4096m\ntaskmanager.numberOfTaskSlots: 4\n\n# \u5e76\u884c\u5ea6\nparallelism.default: 4\n\n# \u68c0\u67e5\u70b9\nexecution.checkpointing.interval: 60000\nstate.backend: rocksdb\nstate.checkpoints.dir: hdfs:///checkpoints\n\n# Web UI\nrest.port: 8081\n"})}),"\n",(0,i.jsx)(e.h2,{id:"api-\u901f\u67e5",children:"API \u901f\u67e5"}),"\n",(0,i.jsx)(e.h3,{id:"datastream-\u5e38\u7528\u64cd\u4f5c",children:"DataStream \u5e38\u7528\u64cd\u4f5c"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u64cd\u4f5c"}),(0,i.jsx)(e.th,{children:"\u793a\u4f8b"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"map"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"stream.map(x -> x * 2)"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"flatMap"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:'stream.flatMap((s, c) -> { for(String w : s.split(" ")) c.collect(w); })'})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"filter"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"stream.filter(x -> x > 0)"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"keyBy"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"stream.keyBy(e -> e.getKey())"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"reduce"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"keyed.reduce((a, b) -> a + b)"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"sum"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:'keyed.sum("field")'})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"window"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"keyed.window(TumblingEventTimeWindows.of(Time.seconds(5)))"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"union"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"stream1.union(stream2)"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"connect"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"stream1.connect(stream2)"})})]})]})]}),"\n",(0,i.jsx)(e.h3,{id:"\u7a97\u53e3\u7c7b\u578b",children:"\u7a97\u53e3\u7c7b\u578b"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u7a97\u53e3"}),(0,i.jsx)(e.th,{children:"\u521b\u5efa\u65b9\u5f0f"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u6eda\u52a8\u4e8b\u4ef6\u65f6\u95f4\u7a97\u53e3"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"TumblingEventTimeWindows.of(Time.hours(1))"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u6ed1\u52a8\u4e8b\u4ef6\u65f6\u95f4\u7a97\u53e3"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"SlidingEventTimeWindows.of(Time.hours(1), Time.minutes(15))"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u4f1a\u8bdd\u7a97\u53e3"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"EventTimeSessionWindows.withGap(Time.minutes(10))"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u6eda\u52a8\u5904\u7406\u65f6\u95f4\u7a97\u53e3"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"TumblingProcessingTimeWindows.of(Time.hours(1))"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u8ba1\u6570\u7a97\u53e3"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"countWindow(100)"})})]})]})]}),"\n",(0,i.jsx)(e.h3,{id:"\u72b6\u6001\u7c7b\u578b",children:"\u72b6\u6001\u7c7b\u578b"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u72b6\u6001"}),(0,i.jsx)(e.th,{children:"\u63cf\u8ff0"}),(0,i.jsx)(e.th,{children:"\u521d\u59cb\u5316"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"ValueState"}),(0,i.jsx)(e.td,{children:"\u5355\u503c"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:'new ValueStateDescriptor<>("name", Type.class)'})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"ListState"}),(0,i.jsx)(e.td,{children:"\u5217\u8868"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:'new ListStateDescriptor<>("name", Type.class)'})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"MapState"}),(0,i.jsx)(e.td,{children:"\u6620\u5c04"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:'new MapStateDescriptor<>("name", Key.class, Value.class)'})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"ReducingState"}),(0,i.jsx)(e.td,{children:"\u805a\u5408"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:'new ReducingStateDescriptor<>("name", reducer, Type.class)'})})]})]})]}),"\n",(0,i.jsx)(e.h2,{id:"sql-\u901f\u67e5",children:"SQL \u901f\u67e5"}),"\n",(0,i.jsx)(e.h3,{id:"\u5e38\u7528-ddl",children:"\u5e38\u7528 DDL"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"-- \u521b\u5efa\u8868\nCREATE TABLE table_name (\n    column_name TYPE,\n    ts TIMESTAMP(3),\n    WATERMARK FOR ts AS ts - INTERVAL '5' SECOND,\n    PRIMARY KEY (id) NOT ENFORCED\n) WITH (...);\n\n-- \u5220\u9664\u8868\nDROP TABLE IF EXISTS table_name;\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u5e38\u7528\u51fd\u6570",children:"\u5e38\u7528\u51fd\u6570"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u51fd\u6570"}),(0,i.jsx)(e.th,{children:"\u63cf\u8ff0"}),(0,i.jsx)(e.th,{children:"\u793a\u4f8b"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"CONCAT"}),(0,i.jsx)(e.td,{children:"\u5b57\u7b26\u4e32\u8fde\u63a5"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"CONCAT(a, b)"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"UPPER/LOWER"}),(0,i.jsx)(e.td,{children:"\u5927\u5c0f\u5199"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"UPPER(name)"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"SUBSTRING"}),(0,i.jsx)(e.td,{children:"\u622a\u53d6"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"SUBSTRING(str, 1, 5)"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"CAST"}),(0,i.jsx)(e.td,{children:"\u7c7b\u578b\u8f6c\u6362"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"CAST(x AS STRING)"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"COALESCE"}),(0,i.jsx)(e.td,{children:"\u7a7a\u503c\u5904\u7406"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"COALESCE(a, b, 'default')"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"DATE_FORMAT"}),(0,i.jsx)(e.td,{children:"\u65e5\u671f\u683c\u5f0f\u5316"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"DATE_FORMAT(ts, 'yyyy-MM-dd')"})})]})]})]}),"\n",(0,i.jsx)(e.h3,{id:"\u7a97\u53e3\u51fd\u6570",children:"\u7a97\u53e3\u51fd\u6570"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"-- \u6eda\u52a8\u7a97\u53e3\nTUMBLE(time_col, INTERVAL '1' HOUR)\n\n-- \u6ed1\u52a8\u7a97\u53e3\nHOP(time_col, INTERVAL '5' MINUTE, INTERVAL '1' HOUR)\n\n-- \u4f1a\u8bdd\u7a97\u53e3\nSESSION(time_col, INTERVAL '30' MINUTE)\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5e38\u89c1\u95ee\u9898\u5feb\u901f\u89e3\u51b3",children:"\u5e38\u89c1\u95ee\u9898\u5feb\u901f\u89e3\u51b3"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u95ee\u9898"}),(0,i.jsx)(e.th,{children:"\u89e3\u51b3\u65b9\u6848"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u4f5c\u4e1a\u63d0\u4ea4\u5931\u8d25"}),(0,i.jsx)(e.td,{children:"\u68c0\u67e5\u96c6\u7fa4\u72b6\u6001\u3001\u68c0\u67e5 JAR \u5305"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5185\u5b58\u4e0d\u8db3"}),(0,i.jsx)(e.td,{children:"\u589e\u52a0 TaskManager \u5185\u5b58\u6216\u51cf\u5c11\u5e76\u884c\u5ea6"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u68c0\u67e5\u70b9\u5931\u8d25"}),(0,i.jsx)(e.td,{children:"\u68c0\u67e5\u72b6\u6001\u540e\u7aef\u914d\u7f6e\u3001\u589e\u5927\u8d85\u65f6\u65f6\u95f4"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u6570\u636e\u503e\u659c"}),(0,i.jsx)(e.td,{children:"\u6dfb\u52a0\u968f\u673a\u524d\u7f00\u3001\u4f7f\u7528 rebalance()"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5ef6\u8fdf\u6570\u636e"}),(0,i.jsx)(e.td,{children:"\u4f7f\u7528\u4fa7\u8f93\u51fa\u3001\u589e\u5927\u6c34\u5370\u5ef6\u8fdf"})]})]})]})]})}function j(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(a,{...n})}):a(n)}},48885:(n,e,s)=>{s.d(e,{R:()=>l,x:()=>t});var d=s(99378);const i={},r=d.createContext(i);function l(n){const e=d.useContext(r);return d.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),d.createElement(r.Provider,{value:e},n.children)}}}]);