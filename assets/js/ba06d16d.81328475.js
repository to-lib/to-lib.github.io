"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[8309],{20835:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>o,frontMatter:()=>i,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"rust/testing","title":"\u6d4b\u8bd5","description":"Rust \u5185\u7f6e\u4e86\u6d4b\u8bd5\u6846\u67b6,\u652f\u6301\u5355\u5143\u6d4b\u8bd5\u3001\u96c6\u6210\u6d4b\u8bd5\u3001\u6587\u6863\u6d4b\u8bd5\u548c\u57fa\u51c6\u6d4b\u8bd5\u3002\u7f16\u5199\u6d4b\u8bd5\u662f\u4fdd\u8bc1\u4ee3\u7801\u8d28\u91cf\u7684\u91cd\u8981\u624b\u6bb5\u3002","source":"@site/docs/rust/testing.md","sourceDirName":"rust","slug":"/rust/testing","permalink":"/docs/rust/testing","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/rust/testing.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"sidebar_position":11,"title":"\u6d4b\u8bd5"},"sidebar":"rust","previous":{"title":"\u6a21\u5757\u548c\u5305\u7ba1\u7406","permalink":"/docs/rust/modules-packages"},"next":{"title":"\u5b8f\u7f16\u7a0b","permalink":"/docs/rust/macros"}}');var l=s(22714),r=s(48885);const i={sidebar_position:11,title:"\u6d4b\u8bd5"},a="\u6d4b\u8bd5",c={},d=[{value:"\u6d4b\u8bd5\u57fa\u7840",id:"\u6d4b\u8bd5\u57fa\u7840",level:2},{value:"\u7b2c\u4e00\u4e2a\u6d4b\u8bd5",id:"\u7b2c\u4e00\u4e2a\u6d4b\u8bd5",level:3},{value:"\u8fd0\u884c\u6d4b\u8bd5",id:"\u8fd0\u884c\u6d4b\u8bd5",level:3},{value:"\u65ad\u8a00\u5b8f",id:"\u65ad\u8a00\u5b8f",level:2},{value:"assert",id:"assert",level:3},{value:"assert_eq! \u548c assert_ne",id:"assert_eq-\u548c-assert_ne",level:3},{value:"\u81ea\u5b9a\u4e49\u9519\u8bef\u6d88\u606f",id:"\u81ea\u5b9a\u4e49\u9519\u8bef\u6d88\u606f",level:3},{value:"\u5355\u5143\u6d4b\u8bd5",id:"\u5355\u5143\u6d4b\u8bd5",level:2},{value:"\u6d4b\u8bd5\u79c1\u6709\u51fd\u6570",id:"\u6d4b\u8bd5\u79c1\u6709\u51fd\u6570",level:3},{value:"\u6d4b\u8bd5\u6a21\u5f0f",id:"\u6d4b\u8bd5\u6a21\u5f0f",level:3},{value:"should_panic",id:"should_panic",level:2},{value:"\u57fa\u672c\u7528\u6cd5",id:"\u57fa\u672c\u7528\u6cd5",level:3},{value:"\u68c0\u67e5 panic \u6d88\u606f",id:"\u68c0\u67e5-panic-\u6d88\u606f",level:3},{value:"Result \u6d4b\u8bd5",id:"result-\u6d4b\u8bd5",level:2},{value:"\u4f7f\u7528 <code>Result&lt;T, E&gt;</code>",id:"\u4f7f\u7528-resultt-e",level:3},{value:"\u6d4b\u8bd5\u9519\u8bef\u60c5\u51b5",id:"\u6d4b\u8bd5\u9519\u8bef\u60c5\u51b5",level:3},{value:"\u96c6\u6210\u6d4b\u8bd5",id:"\u96c6\u6210\u6d4b\u8bd5",level:2},{value:"tests \u76ee\u5f55",id:"tests-\u76ee\u5f55",level:3},{value:"tests/integration_test.rs",id:"testsintegration_testrs",level:3},{value:"\u5171\u4eab\u4ee3\u7801",id:"\u5171\u4eab\u4ee3\u7801",level:3},{value:"\u6587\u6863\u6d4b\u8bd5",id:"\u6587\u6863\u6d4b\u8bd5",level:2},{value:"\u7f16\u5199\u6587\u6863\u6d4b\u8bd5",id:"\u7f16\u5199\u6587\u6863\u6d4b\u8bd5",level:3},{value:"\u9690\u85cf\u90e8\u5206\u4ee3\u7801",id:"\u9690\u85cf\u90e8\u5206\u4ee3\u7801",level:3},{value:"\u6807\u8bb0\u5931\u8d25\u7684\u6d4b\u8bd5",id:"\u6807\u8bb0\u5931\u8d25\u7684\u6d4b\u8bd5",level:3},{value:"\u7ec4\u7ec7\u6d4b\u8bd5",id:"\u7ec4\u7ec7\u6d4b\u8bd5",level:2},{value:"\u6309\u6a21\u5757\u7ec4\u7ec7",id:"\u6309\u6a21\u5757\u7ec4\u7ec7",level:3},{value:"\u6d4b\u8bd5\u8fc7\u6ee4",id:"\u6d4b\u8bd5\u8fc7\u6ee4",level:3},{value:"\u6d4b\u8bd5\u8f85\u52a9\u5de5\u5177",id:"\u6d4b\u8bd5\u8f85\u52a9\u5de5\u5177",level:2},{value:"Setup \u548c Teardown",id:"setup-\u548c-teardown",level:3},{value:"\u6d4b\u8bd5fixture",id:"\u6d4b\u8bd5fixture",level:3},{value:"Mock \u548c Stub",id:"mock-\u548c-stub",level:2},{value:"\u4f7f\u7528 trait \u8fdb\u884c Mock",id:"\u4f7f\u7528-trait-\u8fdb\u884c-mock",level:3},{value:"\u57fa\u51c6\u6d4b\u8bd5",id:"\u57fa\u51c6\u6d4b\u8bd5",level:2},{value:"\u4f7f\u7528 Criterion",id:"\u4f7f\u7528-criterion",level:3},{value:"benches/my_benchmark.rs",id:"benchesmy_benchmarkrs",level:3},{value:"\u8fd0\u884c\u57fa\u51c6\u6d4b\u8bd5",id:"\u8fd0\u884c\u57fa\u51c6\u6d4b\u8bd5",level:3},{value:"\u4ee3\u7801\u8986\u76d6\u7387",id:"\u4ee3\u7801\u8986\u76d6\u7387",level:2},{value:"\u4f7f\u7528 tarpaulin",id:"\u4f7f\u7528-tarpaulin",level:3},{value:"\u4f7f\u7528 llvm-cov",id:"\u4f7f\u7528-llvm-cov",level:3},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2},{value:"1. AAA \u6a21\u5f0f(Arrange-Act-Assert)",id:"1-aaa-\u6a21\u5f0farrange-act-assert",level:3},{value:"2. \u4e00\u4e2a\u6d4b\u8bd5\u4e00\u4e2a\u65ad\u8a00",id:"2-\u4e00\u4e2a\u6d4b\u8bd5\u4e00\u4e2a\u65ad\u8a00",level:3},{value:"3. \u63cf\u8ff0\u6027\u6d4b\u8bd5\u540d\u79f0",id:"3-\u63cf\u8ff0\u6027\u6d4b\u8bd5\u540d\u79f0",level:3},{value:"4. \u6d4b\u8bd5\u8fb9\u754c\u60c5\u51b5",id:"4-\u6d4b\u8bd5\u8fb9\u754c\u60c5\u51b5",level:3},{value:"\u6301\u7eed\u96c6\u6210",id:"\u6301\u7eed\u96c6\u6210",level:2},{value:"GitHub Actions \u914d\u7f6e",id:"github-actions-\u914d\u7f6e",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"\u6d4b\u8bd5",children:"\u6d4b\u8bd5"})}),"\n",(0,l.jsx)(n.p,{children:"Rust \u5185\u7f6e\u4e86\u6d4b\u8bd5\u6846\u67b6,\u652f\u6301\u5355\u5143\u6d4b\u8bd5\u3001\u96c6\u6210\u6d4b\u8bd5\u3001\u6587\u6863\u6d4b\u8bd5\u548c\u57fa\u51c6\u6d4b\u8bd5\u3002\u7f16\u5199\u6d4b\u8bd5\u662f\u4fdd\u8bc1\u4ee3\u7801\u8d28\u91cf\u7684\u91cd\u8981\u624b\u6bb5\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"\u6d4b\u8bd5\u57fa\u7840",children:"\u6d4b\u8bd5\u57fa\u7840"}),"\n",(0,l.jsx)(n.h3,{id:"\u7b2c\u4e00\u4e2a\u6d4b\u8bd5",children:"\u7b2c\u4e00\u4e2a\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"#[cfg(test)]\nmod tests {\n    #[test]\n    fn it_works() {\n        let result = 2 + 2;\n        assert_eq!(result, 4);\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u8fd0\u884c\u6d4b\u8bd5",children:"\u8fd0\u884c\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u8fd0\u884c\u6240\u6709\u6d4b\u8bd5\ncargo test\n\n# \u8fd0\u884c\u7279\u5b9a\u6d4b\u8bd5\ncargo test it_works\n\n# \u663e\u793a\u6253\u5370\u8f93\u51fa\ncargo test -- --show-output\n\n# \u5e76\u884c/\u4e32\u884c\u8fd0\u884c\ncargo test -- --test-threads=1\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u65ad\u8a00\u5b8f",children:"\u65ad\u8a00\u5b8f"}),"\n",(0,l.jsx)(n.h3,{id:"assert",children:"assert"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'#[test]\nfn test_assert() {\n    let value = true;\n    assert!(value, "value should be true");\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"assert_eq-\u548c-assert_ne",children:"assert_eq! \u548c assert_ne"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"#[test]\nfn test_equality() {\n    assert_eq!(2 + 2, 4);\n    assert_ne!(2 + 2, 5);\n}\n\n#[derive(Debug, PartialEq)]\nstruct Point {\n    x: i32,\n    y: i32,\n}\n\n#[test]\nfn test_struct_equality() {\n    let p1 = Point { x: 1, y: 2 };\n    let p2 = Point { x: 1, y: 2 };\n    assert_eq!(p1, p2);\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49\u9519\u8bef\u6d88\u606f",children:"\u81ea\u5b9a\u4e49\u9519\u8bef\u6d88\u606f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'#[test]\nfn test_with_message() {\n    let expected = 5;\n    let actual = 2 + 2;\n    \n    assert_eq!(\n        expected,\n        actual,\n        "\u671f\u671b\u503c {} \u4e0d\u7b49\u4e8e\u5b9e\u9645\u503c {}",\n        expected,\n        actual\n    );\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u5355\u5143\u6d4b\u8bd5",children:"\u5355\u5143\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.h3,{id:"\u6d4b\u8bd5\u79c1\u6709\u51fd\u6570",children:"\u6d4b\u8bd5\u79c1\u6709\u51fd\u6570"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"pub fn add_two(a: i32) -> i32 {\n    internal_adder(a, 2)\n}\n\nfn internal_adder(a: i32, b: i32) -> i32 {\n    a + b\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    \n    #[test]\n    fn internal() {\n        // \u53ef\u4ee5\u6d4b\u8bd5\u79c1\u6709\u51fd\u6570\n        assert_eq!(4, internal_adder(2, 2));\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u6d4b\u8bd5\u6a21\u5f0f",children:"\u6d4b\u8bd5\u6a21\u5f0f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"pub struct Rectangle {\n    width: u32,\n    height: u32,\n}\n\nimpl Rectangle {\n    pub fn can_hold(&self, other: &Rectangle) -> bool {\n        self.width > other.width && self.height > other.height\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    \n    #[test]\n    fn larger_can_hold_smaller() {\n        let larger = Rectangle { width: 8, height: 7 };\n        let smaller = Rectangle { width: 5, height: 1 };\n        \n        assert!(larger.can_hold(&smaller));\n    }\n    \n    #[test]\n    fn smaller_cannot_hold_larger() {\n        let larger = Rectangle { width: 8, height: 7 };\n        let smaller = Rectangle { width: 5, height: 1 };\n        \n        assert!(!smaller.can_hold(&larger));\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"should_panic",children:"should_panic"}),"\n",(0,l.jsx)(n.h3,{id:"\u57fa\u672c\u7528\u6cd5",children:"\u57fa\u672c\u7528\u6cd5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'pub struct Guess {\n    value: i32,\n}\n\nimpl Guess {\n    pub fn new(value: i32) -> Guess {\n        if value < 1 || value > 100 {\n            panic!("Guess value must be between 1 and 100, got {}.", value);\n        }\n        \n        Guess { value }\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    \n    #[test]\n    #[should_panic]\n    fn greater_than_100() {\n        Guess::new(200);\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u68c0\u67e5-panic-\u6d88\u606f",children:"\u68c0\u67e5 panic \u6d88\u606f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'#[cfg(test)]\nmod tests {\n    use super::*;\n    \n    #[test]\n    #[should_panic(expected = "between 1 and 100")]\n    fn greater_than_100() {\n        Guess::new(200);\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"result-\u6d4b\u8bd5",children:"Result \u6d4b\u8bd5"}),"\n",(0,l.jsxs)(n.h3,{id:"\u4f7f\u7528-resultt-e",children:["\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"Result<T, E>"})]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'#[cfg(test)]\nmod tests {\n    #[test]\n    fn it_works() -> Result<(), String> {\n        if 2 + 2 == 4 {\n            Ok(())\n        } else {\n            Err(String::from("two plus two does not equal four"))\n        }\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u6d4b\u8bd5\u9519\u8bef\u60c5\u51b5",children:"\u6d4b\u8bd5\u9519\u8bef\u60c5\u51b5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'fn divide(a: f64, b: f64) -> Result<f64, String> {\n    if b == 0.0 {\n        Err(String::from("division by zero"))\n    } else {\n        Ok(a / b)\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    \n    #[test]\n    fn test_divide_success() -> Result<(), String> {\n        let result = divide(10.0, 2.0)?;\n        assert_eq!(result, 5.0);\n        Ok(())\n    }\n    \n    #[test]\n    fn test_divide_by_zero() {\n        let result = divide(10.0, 0.0);\n        assert!(result.is_err());\n        assert_eq!(result.unwrap_err(), "division by zero");\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u96c6\u6210\u6d4b\u8bd5",children:"\u96c6\u6210\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.h3,{id:"tests-\u76ee\u5f55",children:"tests \u76ee\u5f55"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"my_project/\n\u251c\u2500\u2500 Cargo.toml\n\u251c\u2500\u2500 src/\n\u2502   \u2514\u2500\u2500 lib.rs\n\u2514\u2500\u2500 tests/\n    \u251c\u2500\u2500 integration_test.rs\n    \u2514\u2500\u2500 common/\n        \u2514\u2500\u2500 mod.rs\n"})}),"\n",(0,l.jsx)(n.h3,{id:"testsintegration_testrs",children:"tests/integration_test.rs"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"use my_project;\n\n#[test]\nfn it_adds_two() {\n    assert_eq!(4, my_project::add_two(2));\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u5171\u4eab\u4ee3\u7801",children:"\u5171\u4eab\u4ee3\u7801"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"// tests/common/mod.rs\npub fn setup() {\n    // \u6d4b\u8bd5\u8bbe\u7f6e\u4ee3\u7801\n}\n\n// tests/integration_test.rs\nmod common;\n\n#[test]\nfn test_with_setup() {\n    common::setup();\n    // \u6d4b\u8bd5\u4ee3\u7801\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6587\u6863\u6d4b\u8bd5",children:"\u6587\u6863\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.h3,{id:"\u7f16\u5199\u6587\u6863\u6d4b\u8bd5",children:"\u7f16\u5199\u6587\u6863\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"/// \u5c06\u4e24\u4e2a\u6570\u5b57\u76f8\u52a0\n///\n/// # Examples\n///\n/// ```\n/// let result = my_crate::add(2, 2);\n/// assert_eq!(result, 4);\n/// ```\npub fn add(a: i32, b: i32) -> i32 {\n    a + b\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u9690\u85cf\u90e8\u5206\u4ee3\u7801",children:"\u9690\u85cf\u90e8\u5206\u4ee3\u7801"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"/// ```\n/// # fn expensive_function() -> i32 { 42 }\n/// let result = expensive_function();\n/// assert_eq!(result, 42);\n/// ```\npub fn example() {}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u6807\u8bb0\u5931\u8d25\u7684\u6d4b\u8bd5",children:"\u6807\u8bb0\u5931\u8d25\u7684\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'/// ```should_panic\n/// panic!("this will panic");\n/// ```\npub fn will_panic() {}\n\n/// ```no_run\n/// loop {\n///     // \u65e0\u9650\u5faa\u73af,\u4f46\u4e0d\u8fd0\u884c\n/// }\n/// ```\npub fn infinite_loop() {}\n\n/// ```ignore\n/// // \u6682\u65f6\u5ffd\u7565\u8fd9\u4e2a\u6d4b\u8bd5\n/// ```\npub fn ignored() {}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u7ec4\u7ec7\u6d4b\u8bd5",children:"\u7ec4\u7ec7\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.h3,{id:"\u6309\u6a21\u5757\u7ec4\u7ec7",children:"\u6309\u6a21\u5757\u7ec4\u7ec7"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"#[cfg(test)]\nmod unit_tests {\n    use super::*;\n    \n    #[test]\n    fn test_1() {}\n    \n    #[test]\n    fn test_2() {}\n}\n\n#[cfg(test)]\nmod integration_tests {\n    use super::*;\n    \n    #[test]\n    fn test_3() {}\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u6d4b\u8bd5\u8fc7\u6ee4",children:"\u6d4b\u8bd5\u8fc7\u6ee4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# \u8fd0\u884c\u540d\u79f0\u5305\u542b "add" \u7684\u6d4b\u8bd5\ncargo test add\n\n# \u8fd0\u884c\u7279\u5b9a\u6a21\u5757\u7684\u6d4b\u8bd5\ncargo test unit_tests::\n\n# \u5ffd\u7565\u7684\u6d4b\u8bd5\ncargo test -- --ignored\n\n# \u8fd0\u884c\u6240\u6709\u6d4b\u8bd5(\u5305\u62ec\u5ffd\u7565\u7684)\ncargo test -- --include-ignored\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u6d4b\u8bd5\u8f85\u52a9\u5de5\u5177",children:"\u6d4b\u8bd5\u8f85\u52a9\u5de5\u5177"}),"\n",(0,l.jsx)(n.h3,{id:"setup-\u548c-teardown",children:"Setup \u548c Teardown"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'struct TestContext {\n    value: i32,\n}\n\nimpl TestContext {\n    fn new() -> Self {\n        println!("Setting up test");\n        TestContext { value: 42 }\n    }\n}\n\nimpl Drop for TestContext {\n    fn drop(&mut self) {\n        println!("Tearing down test");\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    \n    #[test]\n    fn test_with_context() {\n        let ctx = TestContext::new();\n        assert_eq!(ctx.value, 42);\n        // Drop \u4f1a\u5728\u8fd9\u91cc\u81ea\u52a8\u8c03\u7528\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u6d4b\u8bd5fixture",children:"\u6d4b\u8bd5fixture"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"#[cfg(test)]\nmod tests {\n    fn setup() -> Vec<i32> {\n        vec![1, 2, 3, 4, 5]\n    }\n    \n    #[test]\n    fn test_with_fixture() {\n        let data = setup();\n        assert_eq!(data.len(), 5);\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"mock-\u548c-stub",children:"Mock \u548c Stub"}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528-trait-\u8fdb\u884c-mock",children:"\u4f7f\u7528 trait \u8fdb\u884c Mock"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'trait Database {\n    fn get_user(&self, id: u32) -> Option<String>;\n}\n\nstruct RealDatabase;\n\nimpl Database for RealDatabase {\n    fn get_user(&self, id: u32) -> Option<String> {\n        // \u771f\u5b9e\u7684\u6570\u636e\u5e93\u67e5\u8be2\n        None\n    }\n}\n\n#[cfg(test)]\nmod tests {\n    use super::*;\n    \n    struct MockDatabase;\n    \n    impl Database for MockDatabase {\n        fn get_user(&self, id: u32) -> Option<String> {\n            if id == 1 {\n                Some(String::from("Alice"))\n            } else {\n                None\n            }\n        }\n    }\n    \n    #[test]\n    fn test_with_mock() {\n        let db = MockDatabase;\n        assert_eq!(db.get_user(1), Some(String::from("Alice")));\n        assert_eq!(db.get_user(2), None);\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u57fa\u51c6\u6d4b\u8bd5",children:"\u57fa\u51c6\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528-criterion",children:"\u4f7f\u7528 Criterion"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-toml",children:'[dev-dependencies]\ncriterion = "0.5"\n\n[[bench]]\nname = "my_benchmark"\nharness = false\n'})}),"\n",(0,l.jsx)(n.h3,{id:"benchesmy_benchmarkrs",children:"benches/my_benchmark.rs"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:'use criterion::{black_box, criterion_group, criterion_main, Criterion};\n\nfn fibonacci(n: u64) -> u64 {\n    match n {\n        0 => 1,\n        1 => 1,\n        n => fibonacci(n - 1) + fibonacci(n - 2),\n    }\n}\n\nfn criterion_benchmark(c: &mut Criterion) {\n    c.bench_function("fib 20", |b| b.iter(|| fibonacci(black_box(20))));\n}\n\ncriterion_group!(benches, criterion_benchmark);\ncriterion_main!(benches);\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u8fd0\u884c\u57fa\u51c6\u6d4b\u8bd5",children:"\u8fd0\u884c\u57fa\u51c6\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"cargo bench\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u4ee3\u7801\u8986\u76d6\u7387",children:"\u4ee3\u7801\u8986\u76d6\u7387"}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528-tarpaulin",children:"\u4f7f\u7528 tarpaulin"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u5b89\u88c5\ncargo install cargo-tarpaulin\n\n# \u751f\u6210\u8986\u76d6\u7387\u62a5\u544a\ncargo tarpaulin --out Html\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528-llvm-cov",children:"\u4f7f\u7528 llvm-cov"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u5b89\u88c5\nrustup component add llvm-tools-preview\ncargo install cargo-llvm-cov\n\n# \u8fd0\u884c\ncargo llvm-cov --html\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,l.jsx)(n.h3,{id:"1-aaa-\u6a21\u5f0farrange-act-assert",children:"1. AAA \u6a21\u5f0f(Arrange-Act-Assert)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"#[test]\nfn test_with_aaa() {\n    // Arrange: \u51c6\u5907\u6d4b\u8bd5\u6570\u636e\n    let mut vec = Vec::new();\n    \n    // Act: \u6267\u884c\u64cd\u4f5c\n    vec.push(1);\n    vec.push(2);\n    \n    // Assert: \u9a8c\u8bc1\u7ed3\u679c\n    assert_eq!(vec.len(), 2);\n    assert_eq!(vec[0], 1);\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-\u4e00\u4e2a\u6d4b\u8bd5\u4e00\u4e2a\u65ad\u8a00",children:"2. \u4e00\u4e2a\u6d4b\u8bd5\u4e00\u4e2a\u65ad\u8a00"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"// \u597d:\u6bcf\u4e2a\u6d4b\u8bd5\u5173\u6ce8\u4e00\u4e2a\u65b9\u9762\n#[test]\nfn test_push_increases_length() {\n    let mut vec = Vec::new();\n    vec.push(1);\n    assert_eq!(vec.len(), 1);\n}\n\n#[test]\nfn test_push_adds_element() {\n    let mut vec = Vec::new();\n    vec.push(42);\n    assert_eq!(vec[0], 42);\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-\u63cf\u8ff0\u6027\u6d4b\u8bd5\u540d\u79f0",children:"3. \u63cf\u8ff0\u6027\u6d4b\u8bd5\u540d\u79f0"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"// \u597d:\u6e05\u6670\u63cf\u8ff0\u6d4b\u8bd5\u5185\u5bb9\n#[test]\nfn empty_vector_has_zero_length() {\n    let vec: Vec<i32> = Vec::new();\n    assert_eq!(vec.len(), 0);\n}\n\n// \u907f\u514d:\u6a21\u7cca\u7684\u540d\u79f0\n#[test]\nfn test1() {\n    // ...\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"4-\u6d4b\u8bd5\u8fb9\u754c\u60c5\u51b5",children:"4. \u6d4b\u8bd5\u8fb9\u754c\u60c5\u51b5"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-rust",children:"#[cfg(test)]\nmod tests {\n    use super::*;\n    \n    #[test]\n    fn test_empty_input() {\n        // \u6d4b\u8bd5\u7a7a\u8f93\u5165\n    }\n    \n    #[test]\n    fn test_single_element() {\n        // \u6d4b\u8bd5\u5355\u4e2a\u5143\u7d20\n    }\n    \n    #[test]\n    fn test_maximum_size() {\n        // \u6d4b\u8bd5\u6700\u5927\u503c\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6301\u7eed\u96c6\u6210",children:"\u6301\u7eed\u96c6\u6210"}),"\n",(0,l.jsx)(n.h3,{id:"github-actions-\u914d\u7f6e",children:"GitHub Actions \u914d\u7f6e"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"name: Rust\n\non: [push, pull_request]\n\njobs:\n  test:\n    runs-on: ubuntu-latest\n    \n    steps:\n    - uses: actions/checkout@v2\n    - name: Build\n      run: cargo build --verbose\n    - name: Run tests\n      run: cargo test --verbose\n    - name: Run clippy\n      run: cargo clippy -- -D warnings\n    - name: Check formatting\n      run: cargo fmt -- --check\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,l.jsx)(n.p,{children:"\u672c\u6587\u5168\u9762\u4ecb\u7ecd\u4e86 Rust \u7684\u6d4b\u8bd5:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u2705 \u5355\u5143\u6d4b\u8bd5\u3001\u96c6\u6210\u6d4b\u8bd5\u3001\u6587\u6863\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 \u65ad\u8a00\u5b8f\u548c\u9519\u8bef\u5904\u7406"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 should_panic \u548c Result \u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 Mock \u548c Stub \u6280\u672f"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 \u57fa\u51c6\u6d4b\u8bd5\u548c\u4ee3\u7801\u8986\u76d6\u7387"}),"\n",(0,l.jsx)(n.li,{children:"\u2705 \u6d4b\u8bd5\u6700\u4f73\u5b9e\u8df5"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u5173\u952e\u8981\u70b9:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\u4f7f\u7528 ",(0,l.jsx)(n.code,{children:"#[test]"})," \u6807\u8bb0\u6d4b\u8bd5\u51fd\u6570"]}),"\n",(0,l.jsxs)(n.li,{children:["\u96c6\u6210\u6d4b\u8bd5\u653e\u5728 ",(0,l.jsx)(n.code,{children:"tests/"})," \u76ee\u5f55"]}),"\n",(0,l.jsx)(n.li,{children:"\u6587\u6863\u6d4b\u8bd5\u786e\u4fdd\u793a\u4f8b\u4ee3\u7801\u6b63\u786e"}),"\n",(0,l.jsx)(n.li,{children:"\u9075\u5faa AAA \u6a21\u5f0f\u7ec4\u7ec7\u6d4b\u8bd5"}),"\n",(0,l.jsx)(n.li,{children:"\u4f7f\u7528 CI/CD \u81ea\u52a8\u5316\u6d4b\u8bd5"}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["\u638c\u63e1\u6d4b\u8bd5\u540e,\u7ee7\u7eed\u5b66\u4e60 ",(0,l.jsx)(n.a,{href:"./macros",children:"\u5b8f\u7f16\u7a0b"})," \u6216 ",(0,l.jsx)(n.a,{href:"./best-practices",children:"\u6700\u4f73\u5b9e\u8df5"}),"\u3002"]})]})}function o(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(u,{...e})}):u(e)}},48885:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>a});var t=s(99378);const l={},r=t.createContext(l);function i(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);