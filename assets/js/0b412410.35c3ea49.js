"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[36165],{48885:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>d});var s=r(99378);const l={},i=s.createContext(l);function o(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),s.createElement(i.Provider,{value:n},e.children)}},56181:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"rocketmq/cluster-management","title":"\u96c6\u7fa4\u7ba1\u7406","description":"RocketMQ \u96c6\u7fa4\u67b6\u6784\u3001\u90e8\u7f72\u4e0e\u7ba1\u7406","source":"@site/docs/rocketmq/cluster-management.md","sourceDirName":"rocketmq","slug":"/rocketmq/cluster-management","permalink":"/docs/rocketmq/cluster-management","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/rocketmq/cluster-management.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12,"title":"\u96c6\u7fa4\u7ba1\u7406","description":"RocketMQ \u96c6\u7fa4\u67b6\u6784\u3001\u90e8\u7f72\u4e0e\u7ba1\u7406"},"sidebar":"rocketmq","previous":{"title":"\u6d88\u8d39\u8005\u8be6\u89e3","permalink":"/docs/rocketmq/consumer"},"next":{"title":"\u76d1\u63a7\u4e0e\u8fd0\u7ef4","permalink":"/docs/rocketmq/monitoring"}}');var l=r(22714),i=r(48885);const o={sidebar_position:12,title:"\u96c6\u7fa4\u7ba1\u7406",description:"RocketMQ \u96c6\u7fa4\u67b6\u6784\u3001\u90e8\u7f72\u4e0e\u7ba1\u7406"},d="RocketMQ \u96c6\u7fa4\u7ba1\u7406",c={},a=[{value:"\u96c6\u7fa4\u67b6\u6784",id:"\u96c6\u7fa4\u67b6\u6784",level:2},{value:"\u6574\u4f53\u67b6\u6784",id:"\u6574\u4f53\u67b6\u6784",level:3},{value:"\u7ec4\u4ef6\u804c\u8d23",id:"\u7ec4\u4ef6\u804c\u8d23",level:3},{value:"\u90e8\u7f72\u6a21\u5f0f",id:"\u90e8\u7f72\u6a21\u5f0f",level:2},{value:"1. \u5355 Master \u6a21\u5f0f",id:"1-\u5355-master-\u6a21\u5f0f",level:3},{value:"2. \u591a Master \u6a21\u5f0f",id:"2-\u591a-master-\u6a21\u5f0f",level:3},{value:"3. \u591a Master \u591a Slave\uff08\u5f02\u6b65\u590d\u5236\uff09",id:"3-\u591a-master-\u591a-slave\u5f02\u6b65\u590d\u5236",level:3},{value:"4. \u591a Master \u591a Slave\uff08\u540c\u6b65\u590d\u5236\uff09",id:"4-\u591a-master-\u591a-slave\u540c\u6b65\u590d\u5236",level:3},{value:"5. Dledger \u81ea\u52a8\u9009\u4e3b\u6a21\u5f0f",id:"5-dledger-\u81ea\u52a8\u9009\u4e3b\u6a21\u5f0f",level:3},{value:"\u4e3b\u4ece\u67b6\u6784\u914d\u7f6e",id:"\u4e3b\u4ece\u67b6\u6784\u914d\u7f6e",level:2},{value:"Master \u914d\u7f6e",id:"master-\u914d\u7f6e",level:3},{value:"Slave \u914d\u7f6e",id:"slave-\u914d\u7f6e",level:3},{value:"\u542f\u52a8\u987a\u5e8f",id:"\u542f\u52a8\u987a\u5e8f",level:3},{value:"Dledger \u6a21\u5f0f\u914d\u7f6e",id:"dledger-\u6a21\u5f0f\u914d\u7f6e",level:2},{value:"\u914d\u7f6e\u6587\u4ef6",id:"\u914d\u7f6e\u6587\u4ef6",level:3},{value:"\u542f\u52a8 Dledger \u96c6\u7fa4",id:"\u542f\u52a8-dledger-\u96c6\u7fa4",level:3},{value:"\u96c6\u7fa4\u7ba1\u7406\u547d\u4ee4",id:"\u96c6\u7fa4\u7ba1\u7406\u547d\u4ee4",level:2},{value:"\u67e5\u770b\u96c6\u7fa4\u72b6\u6001",id:"\u67e5\u770b\u96c6\u7fa4\u72b6\u6001",level:3},{value:"Broker \u7ba1\u7406",id:"broker-\u7ba1\u7406",level:3},{value:"Topic \u7ba1\u7406",id:"topic-\u7ba1\u7406",level:3},{value:"\u6d88\u8d39\u8005\u7ec4\u7ba1\u7406",id:"\u6d88\u8d39\u8005\u7ec4\u7ba1\u7406",level:3},{value:"\u6d88\u606f\u7ba1\u7406",id:"\u6d88\u606f\u7ba1\u7406",level:3},{value:"\u6269\u7f29\u5bb9\u64cd\u4f5c",id:"\u6269\u7f29\u5bb9\u64cd\u4f5c",level:2},{value:"\u589e\u52a0 Broker \u8282\u70b9",id:"\u589e\u52a0-broker-\u8282\u70b9",level:3},{value:"\u7f29\u51cf Broker \u8282\u70b9",id:"\u7f29\u51cf-broker-\u8282\u70b9",level:3},{value:"\u589e\u52a0 Queue \u6570\u91cf",id:"\u589e\u52a0-queue-\u6570\u91cf",level:3},{value:"\u6545\u969c\u5904\u7406",id:"\u6545\u969c\u5904\u7406",level:2},{value:"Master \u5b95\u673a\u5904\u7406",id:"master-\u5b95\u673a\u5904\u7406",level:3},{value:"Slave \u5b95\u673a\u5904\u7406",id:"slave-\u5b95\u673a\u5904\u7406",level:3},{value:"NameServer \u5b95\u673a\u5904\u7406",id:"nameserver-\u5b95\u673a\u5904\u7406",level:3},{value:"\u6d88\u606f\u5806\u79ef\u5904\u7406",id:"\u6d88\u606f\u5806\u79ef\u5904\u7406",level:3},{value:"\u6570\u636e\u8fc1\u79fb",id:"\u6570\u636e\u8fc1\u79fb",level:2},{value:"Topic \u6570\u636e\u8fc1\u79fb",id:"topic-\u6570\u636e\u8fc1\u79fb",level:3},{value:"\u4e0b\u4e00\u6b65",id:"\u4e0b\u4e00\u6b65",level:2},{value:"\u53c2\u8003\u8d44\u6599",id:"\u53c2\u8003\u8d44\u6599",level:2}];function t(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"rocketmq-\u96c6\u7fa4\u7ba1\u7406",children:"RocketMQ \u96c6\u7fa4\u7ba1\u7406"})}),"\n",(0,l.jsx)(n.p,{children:"\u672c\u6587\u6863\u4ecb\u7ecd RocketMQ \u96c6\u7fa4\u7684\u67b6\u6784\u8bbe\u8ba1\u3001\u90e8\u7f72\u65b9\u6848\u548c\u65e5\u5e38\u7ba1\u7406\u64cd\u4f5c\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"\u96c6\u7fa4\u67b6\u6784",children:"\u96c6\u7fa4\u67b6\u6784"}),"\n",(0,l.jsx)(n.h3,{id:"\u6574\u4f53\u67b6\u6784",children:"\u6574\u4f53\u67b6\u6784"}),"\n",(0,l.jsx)(n.mermaid,{value:"graph TB\n    subgraph \u751f\u4ea7\u8005\u96c6\u7fa4\n        P1[Producer 1]\n        P2[Producer 2]\n    end\n\n    subgraph NameServer \u96c6\u7fa4\n        NS1[NameServer 1]\n        NS2[NameServer 2]\n    end\n\n    subgraph Broker \u96c6\u7fa4\n        subgraph Broker-a\n            BA_M[Broker-a Master]\n            BA_S[Broker-a Slave]\n        end\n        subgraph Broker-b\n            BB_M[Broker-b Master]\n            BB_S[Broker-b Slave]\n        end\n    end\n\n    subgraph \u6d88\u8d39\u8005\u96c6\u7fa4\n        C1[Consumer 1]\n        C2[Consumer 2]\n    end\n\n    P1 --\x3e NS1\n    P2 --\x3e NS2\n    NS1 --\x3e BA_M\n    NS1 --\x3e BB_M\n    NS2 --\x3e BA_M\n    NS2 --\x3e BB_M\n    BA_M --\x3e BA_S\n    BB_M --\x3e BB_S\n    C1 --\x3e NS1\n    C2 --\x3e NS2"}),"\n",(0,l.jsx)(n.h3,{id:"\u7ec4\u4ef6\u804c\u8d23",children:"\u7ec4\u4ef6\u804c\u8d23"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u7ec4\u4ef6"}),(0,l.jsx)(n.th,{children:"\u804c\u8d23"}),(0,l.jsx)(n.th,{children:"\u7279\u70b9"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"NameServer"}),(0,l.jsx)(n.td,{children:"\u8def\u7531\u6ce8\u518c\u4e0e\u53d1\u73b0"}),(0,l.jsx)(n.td,{children:"\u65e0\u72b6\u6001\uff0c\u53ef\u6c34\u5e73\u6269\u5c55"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Broker Master"}),(0,l.jsx)(n.td,{children:"\u6d88\u606f\u8bfb\u5199"}),(0,l.jsx)(n.td,{children:"\u63a5\u6536\u751f\u4ea7\u8005\u6d88\u606f\uff0c\u63d0\u4f9b\u6d88\u8d39\u8005\u6d88\u606f"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Broker Slave"}),(0,l.jsx)(n.td,{children:"\u6d88\u606f\u5907\u4efd"}),(0,l.jsx)(n.td,{children:"\u4ece Master \u540c\u6b65\u6570\u636e\uff0c\u53ef\u63d0\u4f9b\u8bfb\u670d\u52a1"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Producer"}),(0,l.jsx)(n.td,{children:"\u6d88\u606f\u751f\u4ea7"}),(0,l.jsx)(n.td,{children:"\u4ece NameServer \u83b7\u53d6\u8def\u7531\uff0c\u53d1\u9001\u6d88\u606f\u5230 Broker"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"Consumer"}),(0,l.jsx)(n.td,{children:"\u6d88\u606f\u6d88\u8d39"}),(0,l.jsx)(n.td,{children:"\u4ece NameServer \u83b7\u53d6\u8def\u7531\uff0c\u4ece Broker \u62c9\u53d6\u6d88\u606f"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"\u90e8\u7f72\u6a21\u5f0f",children:"\u90e8\u7f72\u6a21\u5f0f"}),"\n",(0,l.jsx)(n.h3,{id:"1-\u5355-master-\u6a21\u5f0f",children:"1. \u5355 Master \u6a21\u5f0f"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u9002\u7528\u573a\u666f\uff1a"})," \u5f00\u53d1\u6d4b\u8bd5\u73af\u5883"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"NameServer \xd7 1\nBroker-Master \xd7 1\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u98ce\u9669\uff1a"})," Master \u5b95\u673a\uff0c\u670d\u52a1\u4e0d\u53ef\u7528"]}),"\n",(0,l.jsx)(n.h3,{id:"2-\u591a-master-\u6a21\u5f0f",children:"2. \u591a Master \u6a21\u5f0f"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u9002\u7528\u573a\u666f\uff1a"})," \u5bf9\u6d88\u606f\u4e22\u5931\u6709\u5bb9\u5fcd\u5ea6\u7684\u573a\u666f"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"NameServer \xd7 2\nBroker-a-Master\nBroker-b-Master\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u7279\u70b9\uff1a"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5355\u4e2a Master \u5b95\u673a\uff0c\u672a\u6d88\u8d39\u6d88\u606f\u4e0d\u53ef\u6062\u590d"}),"\n",(0,l.jsx)(n.li,{children:"\u7b80\u5355\u9ad8\u6548"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"3-\u591a-master-\u591a-slave\u5f02\u6b65\u590d\u5236",children:"3. \u591a Master \u591a Slave\uff08\u5f02\u6b65\u590d\u5236\uff09"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u9002\u7528\u573a\u666f\uff1a"})," \u4e00\u822c\u751f\u4ea7\u73af\u5883"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"NameServer \xd7 2\nBroker-a-Master \u2500\u2500async\u2500\u2500> Broker-a-Slave\nBroker-b-Master \u2500\u2500async\u2500\u2500> Broker-b-Slave\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u7279\u70b9\uff1a"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Master \u5b95\u673a\uff0c\u53ef\u80fd\u4e22\u5931\u5c11\u91cf\u6d88\u606f"}),"\n",(0,l.jsx)(n.li,{children:"\u6027\u80fd\u8f83\u9ad8"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"4-\u591a-master-\u591a-slave\u540c\u6b65\u590d\u5236",children:"4. \u591a Master \u591a Slave\uff08\u540c\u6b65\u590d\u5236\uff09"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u9002\u7528\u573a\u666f\uff1a"})," \u91d1\u878d\u7b49\u9ad8\u53ef\u9760\u573a\u666f"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"NameServer \xd7 2\nBroker-a-Master \u2500\u2500sync\u2500\u2500> Broker-a-Slave\nBroker-b-Master \u2500\u2500sync\u2500\u2500> Broker-b-Slave\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u7279\u70b9\uff1a"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Master \u5b95\u673a\uff0c\u6d88\u606f\u4e0d\u4e22\u5931"}),"\n",(0,l.jsx)(n.li,{children:"\u6027\u80fd\u7565\u4f4e"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"5-dledger-\u81ea\u52a8\u9009\u4e3b\u6a21\u5f0f",children:"5. Dledger \u81ea\u52a8\u9009\u4e3b\u6a21\u5f0f"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"\u9002\u7528\u573a\u666f\uff1a"})," \u9ad8\u53ef\u7528\u751f\u4ea7\u73af\u5883\uff08\u63a8\u8350\uff09"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"NameServer \xd7 3\nDledger Group (3\u4e2a\u8282\u70b9\uff0c\u81ea\u52a8\u9009\u4e3b)\n  \u251c\u2500\u2500 Broker-a-0\n  \u251c\u2500\u2500 Broker-a-1\n  \u2514\u2500\u2500 Broker-a-2\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u7279\u70b9\uff1a"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u81ea\u52a8\u6545\u969c\u8f6c\u79fb"}),"\n",(0,l.jsx)(n.li,{children:"\u57fa\u4e8e Raft \u534f\u8bae"}),"\n",(0,l.jsx)(n.li,{children:"Master \u5b95\u673a\u81ea\u52a8\u9009\u4e3e\u65b0 Master"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u4e3b\u4ece\u67b6\u6784\u914d\u7f6e",children:"\u4e3b\u4ece\u67b6\u6784\u914d\u7f6e"}),"\n",(0,l.jsx)(n.h3,{id:"master-\u914d\u7f6e",children:"Master \u914d\u7f6e"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-properties",children:"# broker-a-master.conf\nbrokerClusterName=DefaultCluster\nbrokerName=broker-a\nbrokerId=0\nnamesrvAddr=192.168.1.1:9876;192.168.1.2:9876\nstorePathRootDir=/data/rocketmq/store\nstorePathCommitLog=/data/rocketmq/store/commitlog\n\n# \u76d1\u542c\u7aef\u53e3\nlistenPort=10911\n\n# \u540c\u6b65\u590d\u5236\uff08\u9ad8\u53ef\u9760\uff09\nbrokerRole=SYNC_MASTER\n\n# \u5f02\u6b65\u5237\u76d8\nflushDiskType=ASYNC_FLUSH\n\n# \u6d88\u606f\u5b58\u50a8\u4fdd\u7559\u65f6\u95f4\uff08\u5c0f\u65f6\uff09\nfileReservedTime=72\n\n# \u5220\u9664\u8fc7\u671f\u6587\u4ef6\u65f6\u95f4\ndeleteWhen=04\n"})}),"\n",(0,l.jsx)(n.h3,{id:"slave-\u914d\u7f6e",children:"Slave \u914d\u7f6e"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-properties",children:"# broker-a-slave.conf\nbrokerClusterName=DefaultCluster\nbrokerName=broker-a\nbrokerId=1\nnamesrvAddr=192.168.1.1:9876;192.168.1.2:9876\nstorePathRootDir=/data/rocketmq/store\nstorePathCommitLog=/data/rocketmq/store/commitlog\n\n# \u76d1\u542c\u7aef\u53e3\nlistenPort=10911\n\n# Slave \u89d2\u8272\nbrokerRole=SLAVE\n\n# \u5f02\u6b65\u5237\u76d8\nflushDiskType=ASYNC_FLUSH\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u542f\u52a8\u987a\u5e8f",children:"\u542f\u52a8\u987a\u5e8f"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# 1. \u542f\u52a8\u6240\u6709 NameServer\nnohup sh bin/mqnamesrv &\n\n# 2. \u542f\u52a8 Master Broker\nnohup sh bin/mqbroker -c conf/broker-a-master.conf &\n\n# 3. \u542f\u52a8 Slave Broker\nnohup sh bin/mqbroker -c conf/broker-a-slave.conf &\n"})}),"\n",(0,l.jsx)(n.h2,{id:"dledger-\u6a21\u5f0f\u914d\u7f6e",children:"Dledger \u6a21\u5f0f\u914d\u7f6e"}),"\n",(0,l.jsx)(n.h3,{id:"\u914d\u7f6e\u6587\u4ef6",children:"\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-properties",children:"# broker-a-0.conf\nbrokerClusterName=DledgerCluster\nbrokerName=broker-a\nbrokerId=-1\nnamesrvAddr=192.168.1.1:9876;192.168.1.2:9876\n\n# \u5f00\u542f Dledger \u6a21\u5f0f\nenableDLegerCommitLog=true\n\n# Dledger Group \u540d\u79f0\ndLegerGroup=broker-a\n\n# \u96c6\u7fa4\u8282\u70b9\ndLegerPeers=n0-192.168.1.10:40911;n1-192.168.1.11:40911;n2-192.168.1.12:40911\n\n# \u5f53\u524d\u8282\u70b9 ID\ndLegerSelfId=n0\n\n# \u76d1\u542c\u7aef\u53e3\nlistenPort=10911\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u542f\u52a8-dledger-\u96c6\u7fa4",children:"\u542f\u52a8 Dledger \u96c6\u7fa4"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u5728\u4e09\u4e2a\u8282\u70b9\u4e0a\u5206\u522b\u542f\u52a8\nnohup sh bin/mqbroker -c conf/broker-a-0.conf &\nnohup sh bin/mqbroker -c conf/broker-a-1.conf &\nnohup sh bin/mqbroker -c conf/broker-a-2.conf &\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u96c6\u7fa4\u7ba1\u7406\u547d\u4ee4",children:"\u96c6\u7fa4\u7ba1\u7406\u547d\u4ee4"}),"\n",(0,l.jsx)(n.h3,{id:"\u67e5\u770b\u96c6\u7fa4\u72b6\u6001",children:"\u67e5\u770b\u96c6\u7fa4\u72b6\u6001"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u96c6\u7fa4\u5217\u8868\nsh bin/mqadmin clusterList -n localhost:9876\n\n# \u8f93\u51fa\u793a\u4f8b\nCluster Name     Broker Name     Broker Addr:Port      Version\nDefaultCluster   broker-a        192.168.1.10:10911    V5_1_4\nDefaultCluster   broker-a        192.168.1.11:10911    V5_1_4\nDefaultCluster   broker-b        192.168.1.12:10911    V5_1_4\n"})}),"\n",(0,l.jsx)(n.h3,{id:"broker-\u7ba1\u7406",children:"Broker \u7ba1\u7406"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b Broker \u72b6\u6001\nsh bin/mqadmin brokerStatus -n localhost:9876 -b 192.168.1.10:10911\n\n# \u67e5\u770b Broker \u914d\u7f6e\nsh bin/mqadmin getBrokerConfig -n localhost:9876 -b 192.168.1.10:10911\n\n# \u66f4\u65b0 Broker \u914d\u7f6e\uff08\u8fd0\u884c\u65f6\uff09\nsh bin/mqadmin updateBrokerConfig -n localhost:9876 -b 192.168.1.10:10911 \\\n    -k sendMessageThreadPoolNums -v 16\n"})}),"\n",(0,l.jsx)(n.h3,{id:"topic-\u7ba1\u7406",children:"Topic \u7ba1\u7406"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u521b\u5efa Topic\nsh bin/mqadmin updateTopic -n localhost:9876 -c DefaultCluster -t OrderTopic \\\n    -r 8 -w 8\n\n# \u67e5\u770b Topic \u5217\u8868\nsh bin/mqadmin topicList -n localhost:9876\n\n# \u67e5\u770b Topic \u8def\u7531\nsh bin/mqadmin topicRoute -n localhost:9876 -t OrderTopic\n\n# \u67e5\u770b Topic \u72b6\u6001\nsh bin/mqadmin topicStatus -n localhost:9876 -t OrderTopic\n\n# \u5220\u9664 Topic\nsh bin/mqadmin deleteTopic -n localhost:9876 -c DefaultCluster -t OrderTopic\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u6d88\u8d39\u8005\u7ec4\u7ba1\u7406",children:"\u6d88\u8d39\u8005\u7ec4\u7ba1\u7406"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u6d88\u8d39\u8fdb\u5ea6\nsh bin/mqadmin consumerProgress -n localhost:9876 -g ConsumerGroup\n\n# \u67e5\u770b\u6d88\u8d39\u8005\u8fde\u63a5\nsh bin/mqadmin consumerConnection -n localhost:9876 -g ConsumerGroup\n\n# \u91cd\u7f6e\u6d88\u8d39\u4f4d\u70b9\nsh bin/mqadmin resetOffsetByTime -n localhost:9876 \\\n    -g ConsumerGroup -t OrderTopic -s now\n\n# \u5220\u9664\u6d88\u8d39\u8005\u7ec4\nsh bin/mqadmin deleteSubGroup -n localhost:9876 -c DefaultCluster -g ConsumerGroup\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u6d88\u606f\u7ba1\u7406",children:"\u6d88\u606f\u7ba1\u7406"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u6309 MsgId \u67e5\u8be2\nsh bin/mqadmin queryMsgById -n localhost:9876 -i <msgId>\n\n# \u6309 Key \u67e5\u8be2\nsh bin/mqadmin queryMsgByKey -n localhost:9876 -t OrderTopic -k ORDER_123\n\n# \u6309\u65f6\u95f4\u67e5\u8be2\nsh bin/mqadmin queryMsgByOffset -n localhost:9876 -t OrderTopic -q 0 -o 100\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6269\u7f29\u5bb9\u64cd\u4f5c",children:"\u6269\u7f29\u5bb9\u64cd\u4f5c"}),"\n",(0,l.jsx)(n.h3,{id:"\u589e\u52a0-broker-\u8282\u70b9",children:"\u589e\u52a0 Broker \u8282\u70b9"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# 1. \u51c6\u5907\u65b0 Broker \u914d\u7f6e\n# broker-c-master.conf\nbrokerClusterName=DefaultCluster\nbrokerName=broker-c\nbrokerId=0\nnamesrvAddr=192.168.1.1:9876;192.168.1.2:9876\n\n# 2. \u542f\u52a8\u65b0 Broker\nnohup sh bin/mqbroker -c conf/broker-c-master.conf &\n\n# 3. \u6269\u5c55 Topic\uff08\u5c06\u65b0 Broker \u52a0\u5165 Topic\uff09\nsh bin/mqadmin updateTopic -n localhost:9876 -c DefaultCluster -t OrderTopic \\\n    -r 12 -w 12\n\n# 4. \u7b49\u5f85\u8d1f\u8f7d\u5747\u8861\u5b8c\u6210\n# \u6d88\u8d39\u8005\u4f1a\u81ea\u52a8\u91cd\u65b0\u5206\u914d Queue\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u7f29\u51cf-broker-\u8282\u70b9",children:"\u7f29\u51cf Broker \u8282\u70b9"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# 1. \u7981\u6b62\u5199\u5165\uff08\u4ec5\u5141\u8bb8\u8bfb\u53d6\uff09\nsh bin/mqadmin updateBrokerConfig -n localhost:9876 -b 192.168.1.12:10911 \\\n    -k brokerPermission -v 4\n\n# 2. \u7b49\u5f85\u8be5 Broker \u4e0a\u7684\u6d88\u606f\u88ab\u6d88\u8d39\u5b8c\nsh bin/mqadmin topicStatus -n localhost:9876 -t OrderTopic\n\n# 3. \u505c\u6b62 Broker\nsh bin/mqshutdown broker\n\n# 4. \u66f4\u65b0 Topic\uff08\u51cf\u5c11 Queue \u6570\u91cf\uff09\nsh bin/mqadmin updateTopic -n localhost:9876 -c DefaultCluster -t OrderTopic \\\n    -r 8 -w 8\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u589e\u52a0-queue-\u6570\u91cf",children:"\u589e\u52a0 Queue \u6570\u91cf"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u4ec5\u589e\u52a0\u5199\u961f\u5217\uff08\u9884\u70ed\uff09\nsh bin/mqadmin updateTopic -n localhost:9876 -t OrderTopic -r 8 -w 16\n\n# \u786e\u8ba4\u65e0\u95ee\u9898\u540e\u589e\u52a0\u8bfb\u961f\u5217\nsh bin/mqadmin updateTopic -n localhost:9876 -t OrderTopic -r 16 -w 16\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6545\u969c\u5904\u7406",children:"\u6545\u969c\u5904\u7406"}),"\n",(0,l.jsx)(n.h3,{id:"master-\u5b95\u673a\u5904\u7406",children:"Master \u5b95\u673a\u5904\u7406"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"\u4e3b\u4ece\u6a21\u5f0f\uff1a"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Slave \u81ea\u52a8\u5207\u6362\u4e3a\u53ef\u8bfb\uff08\u6d88\u8d39\u8005\u53ef\u7ee7\u7eed\u6d88\u8d39\uff09"}),"\n",(0,l.jsx)(n.li,{children:"\u751f\u4ea7\u8005\u5207\u6362\u5230\u5176\u4ed6 Master"}),"\n",(0,l.jsx)(n.li,{children:"\u6062\u590d\u539f Master \u6216\u624b\u52a8\u5207\u6362"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Dledger \u6a21\u5f0f\uff1a"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u81ea\u52a8\u89e6\u53d1\u9009\u4e3e"}),"\n",(0,l.jsx)(n.li,{children:"\u65b0 Leader \u81ea\u52a8\u63a5\u7ba1"}),"\n",(0,l.jsx)(n.li,{children:"\u65e0\u9700\u4eba\u5de5\u5e72\u9884"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"slave-\u5b95\u673a\u5904\u7406",children:"Slave \u5b95\u673a\u5904\u7406"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u4e0d\u5f71\u54cd\u6b63\u5e38\u8bfb\u5199"}),"\n",(0,l.jsx)(n.li,{children:"\u6570\u636e\u590d\u5236\u6682\u505c"}),"\n",(0,l.jsx)(n.li,{children:"\u53ca\u65f6\u6062\u590d Slave"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"nameserver-\u5b95\u673a\u5904\u7406",children:"NameServer \u5b95\u673a\u5904\u7406"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u5ba2\u6237\u7aef\u4f1a\u81ea\u52a8\u5207\u6362\u5230\u5176\u4ed6 NameServer"}),"\n",(0,l.jsx)(n.li,{children:"\u53ea\u5f71\u54cd\u65b0\u5efa\u8fde\u63a5\u7684\u8def\u7531\u83b7\u53d6"}),"\n",(0,l.jsx)(n.li,{children:"\u5df2\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\u4e0d\u53d7\u5f71\u54cd"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u6d88\u606f\u5806\u79ef\u5904\u7406",children:"\u6d88\u606f\u5806\u79ef\u5904\u7406"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# 1. \u67e5\u770b\u5806\u79ef\u60c5\u51b5\nsh bin/mqadmin consumerProgress -n localhost:9876 -g ConsumerGroup\n\n# 2. \u4e34\u65f6\u589e\u52a0 Queue\nsh bin/mqadmin updateTopic -n localhost:9876 -t OrderTopic -r 16 -w 16\n\n# 3. \u589e\u52a0\u6d88\u8d39\u8005\u5b9e\u4f8b\n# \u90e8\u7f72\u66f4\u591a\u6d88\u8d39\u8005\u5e94\u7528\n\n# 4. \u8df3\u8fc7\u5806\u79ef\u6d88\u606f\uff08\u8c28\u614e\u4f7f\u7528\uff09\nsh bin/mqadmin resetOffsetByTime -n localhost:9876 \\\n    -g ConsumerGroup -t OrderTopic -s now\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6570\u636e\u8fc1\u79fb",children:"\u6570\u636e\u8fc1\u79fb"}),"\n",(0,l.jsx)(n.h3,{id:"topic-\u6570\u636e\u8fc1\u79fb",children:"Topic \u6570\u636e\u8fc1\u79fb"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# 1. \u521b\u5efa\u65b0 Topic\nsh bin/mqadmin updateTopic -n localhost:9876 -c NewCluster -t NewTopic\n\n# 2. \u6d88\u8d39\u8005\u53cc\u8ba2\u9605\nconsumer.subscribe("OldTopic", "*");\nconsumer.subscribe("NewTopic", "*");\n\n# 3. \u751f\u4ea7\u8005\u5207\u6362\u5230\u65b0 Topic\nproducer.send(new Message("NewTopic", body));\n\n# 4. \u7b49\u5f85\u65e7 Topic \u6d88\u606f\u6d88\u8d39\u5b8c\u6bd5\n\n# 5. \u5220\u9664\u65e7 Topic\nsh bin/mqadmin deleteTopic -n localhost:9876 -c OldCluster -t OldTopic\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u4e0b\u4e00\u6b65",children:"\u4e0b\u4e00\u6b65"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u26a1 ",(0,l.jsx)(n.a,{href:"/docs/rocketmq/performance-optimization",children:"\u6027\u80fd\u4f18\u5316"})," - \u63d0\u5347\u96c6\u7fa4\u6027\u80fd"]}),"\n",(0,l.jsxs)(n.li,{children:["\ud83d\udcca ",(0,l.jsx)(n.a,{href:"/docs/rocketmq/monitoring",children:"\u76d1\u63a7\u8fd0\u7ef4"})," - \u5efa\u8bbe\u76d1\u63a7\u4f53\u7cfb"]}),"\n",(0,l.jsxs)(n.li,{children:["\u2705 ",(0,l.jsx)(n.a,{href:"/docs/rocketmq/best-practices",children:"\u6700\u4f73\u5b9e\u8df5"})," - \u751f\u4ea7\u73af\u5883\u5b9e\u8df5"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u53c2\u8003\u8d44\u6599",children:"\u53c2\u8003\u8d44\u6599"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://rocketmq.apache.org/docs/deploymentOperations/",children:"RocketMQ \u90e8\u7f72\u6587\u6863"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://rocketmq.apache.org/docs/dleger/quick-start/",children:"Dledger \u5feb\u901f\u5f00\u59cb"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(t,{...e})}):t(e)}}}]);