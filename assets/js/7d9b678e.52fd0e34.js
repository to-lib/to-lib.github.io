"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[76403],{48885:(e,n,l)=>{l.d(n,{R:()=>a,x:()=>d});var r=l(99378);const s={},i=r.createContext(s);function a(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:n},e.children)}},57189:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>m,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"ml/continual-learning","title":"\ud83e\udde0 \u6301\u7eed\u5b66\u4e60","description":"\u6301\u7eed\u5b66\u4e60\u4f7f\u6a21\u578b\u80fd\u591f\u5b66\u4e60\u65b0\u4efb\u52a1\u800c\u4e0d\u9057\u5fd8\u65e7\u77e5\u8bc6\uff08\u907f\u514d\u707e\u96be\u6027\u9057\u5fd8\uff09\u3002","source":"@site/docs/ml/continual-learning.md","sourceDirName":"ml","slug":"/ml/continual-learning","permalink":"/docs/ml/continual-learning","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/continual-learning.md","tags":[],"version":"current","sidebarPosition":34,"frontMatter":{"sidebar_position":34,"title":"\ud83e\udde0 \u6301\u7eed\u5b66\u4e60"},"sidebar":"ml","previous":{"title":"\ud83d\udcca \u5728\u7ebf\u5b66\u4e60","permalink":"/docs/ml/online-learning"},"next":{"title":"\ud83d\udce6 \u6a21\u578b\u538b\u7f29","permalink":"/docs/ml/model-compression"}}');var s=l(22714),i=l(48885);const a={sidebar_position:34,title:"\ud83e\udde0 \u6301\u7eed\u5b66\u4e60"},d="\u6301\u7eed\u5b66\u4e60",t={},o=[{value:"\u707e\u96be\u6027\u9057\u5fd8",id:"\u707e\u96be\u6027\u9057\u5fd8",level:2},{value:"\u89e3\u51b3\u65b9\u6848",id:"\u89e3\u51b3\u65b9\u6848",level:2},{value:"\u6b63\u5219\u5316\u65b9\u6cd5 (EWC)",id:"\u6b63\u5219\u5316\u65b9\u6cd5-ewc",level:3},{value:"\u56de\u653e\u65b9\u6cd5",id:"\u56de\u653e\u65b9\u6cd5",level:3},{value:"\u67b6\u6784\u65b9\u6cd5",id:"\u67b6\u6784\u65b9\u6cd5",level:3},{value:"\u65b9\u6cd5\u5bf9\u6bd4",id:"\u65b9\u6cd5\u5bf9\u6bd4",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",mermaid:"mermaid",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u6301\u7eed\u5b66\u4e60",children:"\u6301\u7eed\u5b66\u4e60"})}),"\n",(0,s.jsx)(n.p,{children:"\u6301\u7eed\u5b66\u4e60\u4f7f\u6a21\u578b\u80fd\u591f\u5b66\u4e60\u65b0\u4efb\u52a1\u800c\u4e0d\u9057\u5fd8\u65e7\u77e5\u8bc6\uff08\u907f\u514d\u707e\u96be\u6027\u9057\u5fd8\uff09\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u707e\u96be\u6027\u9057\u5fd8",children:"\u707e\u96be\u6027\u9057\u5fd8"}),"\n",(0,s.jsx)(n.mermaid,{value:"graph LR\n    A[\u5b66\u4e60\u4efb\u52a1A] --\x3e B[\u4efb\u52a1A\u8868\u73b0\u597d]\n    B --\x3e C[\u5b66\u4e60\u4efb\u52a1B]\n    C --\x3e D[\u4efb\u52a1B\u8868\u73b0\u597d]\n    D --\x3e E[\u4efb\u52a1A\u8868\u73b0\u4e0b\u964d!]"}),"\n",(0,s.jsx)(n.h2,{id:"\u89e3\u51b3\u65b9\u6848",children:"\u89e3\u51b3\u65b9\u6848"}),"\n",(0,s.jsx)(n.h3,{id:"\u6b63\u5219\u5316\u65b9\u6cd5-ewc",children:"\u6b63\u5219\u5316\u65b9\u6cd5 (EWC)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import torch\nimport torch.nn as nn\n\nclass EWC:\n    def __init__(self, model, dataloader, importance=1000):\n        self.model = model\n        self.importance = importance\n\n        # \u8ba1\u7b97 Fisher \u4fe1\u606f\u77e9\u9635\n        self.fisher = {}\n        self.old_params = {}\n\n        self._compute_fisher(dataloader)\n\n    def _compute_fisher(self, dataloader):\n        self.model.eval()\n        for name, param in self.model.named_parameters():\n            self.fisher[name] = torch.zeros_like(param)\n            self.old_params[name] = param.clone()\n\n        for x, y in dataloader:\n            self.model.zero_grad()\n            output = self.model(x)\n            loss = nn.functional.cross_entropy(output, y)\n            loss.backward()\n\n            for name, param in self.model.named_parameters():\n                self.fisher[name] += param.grad ** 2 / len(dataloader)\n\n    def penalty(self):\n        loss = 0\n        for name, param in self.model.named_parameters():\n            loss += (self.fisher[name] * (param - self.old_params[name]) ** 2).sum()\n        return self.importance * loss\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u56de\u653e\u65b9\u6cd5",children:"\u56de\u653e\u65b9\u6cd5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"class ReplayBuffer:\n    def __init__(self, capacity):\n        self.buffer = []\n        self.capacity = capacity\n\n    def add(self, samples):\n        self.buffer.extend(samples)\n        if len(self.buffer) > self.capacity:\n            # \u968f\u673a\u4fdd\u7559\n            indices = np.random.choice(len(self.buffer), self.capacity, replace=False)\n            self.buffer = [self.buffer[i] for i in indices]\n\n    def sample(self, n):\n        return random.sample(self.buffer, min(n, len(self.buffer)))\n\n# \u8bad\u7ec3\u65f6\u6df7\u5408\u65b0\u65e7\u6570\u636e\ndef train_with_replay(model, new_data, replay_buffer, replay_ratio=0.5):\n    replay_size = int(len(new_data) * replay_ratio)\n    replay_data = replay_buffer.sample(replay_size)\n    combined = new_data + replay_data\n    train(model, combined)\n    replay_buffer.add(new_data)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u67b6\u6784\u65b9\u6cd5",children:"\u67b6\u6784\u65b9\u6cd5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"class ProgressiveNetwork(nn.Module):\n    def __init__(self, input_dim, hidden_dim):\n        super().__init__()\n        self.columns = nn.ModuleList()\n        self.laterals = nn.ModuleList()\n        self.input_dim = input_dim\n        self.hidden_dim = hidden_dim\n\n    def add_column(self, output_dim):\n        # \u65b0\u4efb\u52a1\u6dfb\u52a0\u65b0\u5217\n        column = nn.Sequential(\n            nn.Linear(self.input_dim, self.hidden_dim),\n            nn.ReLU(),\n            nn.Linear(self.hidden_dim, output_dim)\n        )\n\n        # \u51bb\u7ed3\u65e7\u5217\n        for old_col in self.columns:\n            for param in old_col.parameters():\n                param.requires_grad = False\n\n        self.columns.append(column)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u65b9\u6cd5\u5bf9\u6bd4",children:"\u65b9\u6cd5\u5bf9\u6bd4"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u65b9\u6cd5"}),(0,s.jsx)(n.th,{children:"\u601d\u60f3"}),(0,s.jsx)(n.th,{children:"\u4f18\u70b9"}),(0,s.jsx)(n.th,{children:"\u7f3a\u70b9"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"EWC"}),(0,s.jsx)(n.td,{children:"\u4fdd\u62a4\u91cd\u8981\u53c2\u6570"}),(0,s.jsx)(n.td,{children:"\u65e0\u9700\u5b58\u50a8\u6570\u636e"}),(0,s.jsx)(n.td,{children:"\u4efb\u52a1\u6570\u589e\u52a0\u6548\u679c\u4e0b\u964d"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u56de\u653e"}),(0,s.jsx)(n.td,{children:"\u4fdd\u7559\u65e7\u6570\u636e\u6837\u672c"}),(0,s.jsx)(n.td,{children:"\u7b80\u5355\u6709\u6548"}),(0,s.jsx)(n.td,{children:"\u9700\u8981\u5b58\u50a8\u7a7a\u95f4"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u67b6\u6784\u6269\u5c55"}),(0,s.jsx)(n.td,{children:"\u6bcf\u4efb\u52a1\u65b0\u7f51\u7edc"}),(0,s.jsx)(n.td,{children:"\u4e0d\u9057\u5fd8"}),(0,s.jsx)(n.td,{children:"\u6a21\u578b\u6301\u7eed\u589e\u5927"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u77e5\u8bc6\u84b8\u998f"}),(0,s.jsx)(n.td,{children:"\u65e7\u6a21\u578b\u6307\u5bfc\u65b0\u6a21\u578b"}),(0,s.jsx)(n.td,{children:"\u7075\u6d3b"}),(0,s.jsx)(n.td,{children:"\u8ba1\u7b97\u5f00\u9500"})]})]})]})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);