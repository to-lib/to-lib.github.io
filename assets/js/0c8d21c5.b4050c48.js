"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[8863],{48885:(n,e,l)=>{l.d(e,{R:()=>d,x:()=>r});var s=l(99378);const a={},i=s.createContext(a);function d(n){const e=s.useContext(i);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:d(n.components),s.createElement(i.Provider,{value:e},n.children)}},80757:(n,e,l)=>{l.r(e),l.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"linux/best-practices","title":"\u6700\u4f73\u5b9e\u8df5","description":"\u672c\u6587\u603b\u7ed3 Linux \u7cfb\u7edf\u7ba1\u7406\u548c\u4f7f\u7528\u7684\u6700\u4f73\u5b9e\u8df5\uff0c\u5e2e\u52a9\u4f60\u6784\u5efa\u7a33\u5b9a\u3001\u5b89\u5168\u3001\u9ad8\u6548\u7684\u7cfb\u7edf\u3002","source":"@site/docs/linux/best-practices.md","sourceDirName":"linux","slug":"/linux/best-practices","permalink":"/docs/linux/best-practices","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/linux/best-practices.md","tags":[],"version":"current","sidebarPosition":17,"frontMatter":{"sidebar_position":17,"title":"\u6700\u4f73\u5b9e\u8df5"},"sidebar":"linux","previous":{"title":"\u5feb\u901f\u53c2\u8003","permalink":"/docs/linux/quick-reference"},"next":{"title":"\u5e38\u89c1\u95ee\u9898","permalink":"/docs/linux/faq"}}');var a=l(22714),i=l(48885);const d={sidebar_position:17,title:"\u6700\u4f73\u5b9e\u8df5"},r="Linux \u6700\u4f73\u5b9e\u8df5",c={},t=[{value:"\u7cfb\u7edf\u7ba1\u7406",id:"\u7cfb\u7edf\u7ba1\u7406",level:2},{value:"1. \u6700\u5c0f\u5b89\u88c5\u539f\u5219",id:"1-\u6700\u5c0f\u5b89\u88c5\u539f\u5219",level:3},{value:"2. \u5b9a\u671f\u66f4\u65b0",id:"2-\u5b9a\u671f\u66f4\u65b0",level:3},{value:"3. \u914d\u7f6e\u7ba1\u7406",id:"3-\u914d\u7f6e\u7ba1\u7406",level:3},{value:"\u5b89\u5168\u5b9e\u8df5",id:"\u5b89\u5168\u5b9e\u8df5",level:2},{value:"1. \u7528\u6237\u7ba1\u7406",id:"1-\u7528\u6237\u7ba1\u7406",level:3},{value:"2. SSH \u5b89\u5168",id:"2-ssh-\u5b89\u5168",level:3},{value:"3. \u9632\u706b\u5899",id:"3-\u9632\u706b\u5899",level:3},{value:"4. \u7cfb\u7edf\u52a0\u56fa",id:"4-\u7cfb\u7edf\u52a0\u56fa",level:3},{value:"\u6587\u4ef6\u7cfb\u7edf",id:"\u6587\u4ef6\u7cfb\u7edf",level:2},{value:"1. \u76ee\u5f55\u7ec4\u7ec7",id:"1-\u76ee\u5f55\u7ec4\u7ec7",level:3},{value:"2. \u6743\u9650\u7ba1\u7406",id:"2-\u6743\u9650\u7ba1\u7406",level:3},{value:"3. \u5907\u4efd\u7b56\u7565",id:"3-\u5907\u4efd\u7b56\u7565",level:3},{value:"\u6027\u80fd\u4f18\u5316",id:"\u6027\u80fd\u4f18\u5316",level:2},{value:"1. \u7cfb\u7edf\u8c03\u4f18",id:"1-\u7cfb\u7edf\u8c03\u4f18",level:3},{value:"2. \u76d1\u63a7",id:"2-\u76d1\u63a7",level:3},{value:"\u7f51\u7edc\u914d\u7f6e",id:"\u7f51\u7edc\u914d\u7f6e",level:2},{value:"1. DNS \u914d\u7f6e",id:"1-dns-\u914d\u7f6e",level:3},{value:"2. \u7f51\u7edc\u5b89\u5168",id:"2-\u7f51\u7edc\u5b89\u5168",level:3},{value:"\u65e5\u5fd7\u7ba1\u7406",id:"\u65e5\u5fd7\u7ba1\u7406",level:2},{value:"1. \u65e5\u5fd7\u8f6e\u8f6c",id:"1-\u65e5\u5fd7\u8f6e\u8f6c",level:3},{value:"2. \u65e5\u5fd7\u76d1\u63a7",id:"2-\u65e5\u5fd7\u76d1\u63a7",level:3},{value:"Shell \u811a\u672c",id:"shell-\u811a\u672c",level:2},{value:"1. \u811a\u672c\u89c4\u8303",id:"1-\u811a\u672c\u89c4\u8303",level:3},{value:"2. \u811a\u672c\u6700\u4f73\u5b9e\u8df5",id:"2-\u811a\u672c\u6700\u4f73\u5b9e\u8df5",level:3},{value:"\u670d\u52a1\u7ba1\u7406",id:"\u670d\u52a1\u7ba1\u7406",level:2},{value:"1. Systemd \u670d\u52a1",id:"1-systemd-\u670d\u52a1",level:3},{value:"2. \u670d\u52a1\u76d1\u63a7",id:"2-\u670d\u52a1\u76d1\u63a7",level:3},{value:"\u6570\u636e\u5e93",id:"\u6570\u636e\u5e93",level:2},{value:"1. MySQL/MariaDB",id:"1-mysqlmariadb",level:3},{value:"2. Redis",id:"2-redis",level:3},{value:"\u5bb9\u5668\u5316",id:"\u5bb9\u5668\u5316",level:2},{value:"1. Docker \u6700\u4f73\u5b9e\u8df5",id:"1-docker-\u6700\u4f73\u5b9e\u8df5",level:3},{value:"\u6587\u6863\u5316",id:"\u6587\u6863\u5316",level:2},{value:"1. \u7cfb\u7edf\u6587\u6863",id:"1-\u7cfb\u7edf\u6587\u6863",level:3},{value:"2. \u6ce8\u91ca\u89c4\u8303",id:"2-\u6ce8\u91ca\u89c4\u8303",level:3},{value:"\u56e2\u961f\u534f\u4f5c",id:"\u56e2\u961f\u534f\u4f5c",level:2},{value:"1. \u6743\u9650\u5206\u79bb",id:"1-\u6743\u9650\u5206\u79bb",level:3},{value:"2. \u5ba1\u8ba1\u8ffd\u8e2a",id:"2-\u5ba1\u8ba1\u8ffd\u8e2a",level:3},{value:"\u707e\u96be\u6062\u590d",id:"\u707e\u96be\u6062\u590d",level:2},{value:"1. \u5907\u4efd\u9a8c\u8bc1",id:"1-\u5907\u4efd\u9a8c\u8bc1",level:3},{value:"2. \u5e94\u6025\u9884\u6848",id:"2-\u5e94\u6025\u9884\u6848",level:3},{value:"\u81ea\u52a8\u5316",id:"\u81ea\u52a8\u5316",level:2},{value:"1. \u4f7f\u7528\u81ea\u52a8\u5316\u5de5\u5177",id:"1-\u4f7f\u7528\u81ea\u52a8\u5316\u5de5\u5177",level:3},{value:"2. \u811a\u672c\u81ea\u52a8\u5316",id:"2-\u811a\u672c\u81ea\u52a8\u5316",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function o(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"linux-\u6700\u4f73\u5b9e\u8df5",children:"Linux \u6700\u4f73\u5b9e\u8df5"})}),"\n",(0,a.jsx)(e.p,{children:"\u672c\u6587\u603b\u7ed3 Linux \u7cfb\u7edf\u7ba1\u7406\u548c\u4f7f\u7528\u7684\u6700\u4f73\u5b9e\u8df5\uff0c\u5e2e\u52a9\u4f60\u6784\u5efa\u7a33\u5b9a\u3001\u5b89\u5168\u3001\u9ad8\u6548\u7684\u7cfb\u7edf\u3002"}),"\n",(0,a.jsx)(e.h2,{id:"\u7cfb\u7edf\u7ba1\u7406",children:"\u7cfb\u7edf\u7ba1\u7406"}),"\n",(0,a.jsx)(e.h3,{id:"1-\u6700\u5c0f\u5b89\u88c5\u539f\u5219",children:"1. \u6700\u5c0f\u5b89\u88c5\u539f\u5219"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u53ea\u5b89\u88c5\u5fc5\u8981\u7684\u8f6f\u4ef6\u5305\n# \u2705 \u7981\u7528\u4e0d\u9700\u8981\u7684\u670d\u52a1\n# \u2705 \u79fb\u9664\u9ed8\u8ba4\u5b89\u88c5\u4f46\u4e0d\u4f7f\u7528\u7684\u8f6f\u4ef6\n\n# \u67e5\u770b\u8fd0\u884c\u7684\u670d\u52a1\nsystemctl list-units --type=service --state=running\n\n# \u7981\u7528\u4e0d\u9700\u8981\u7684\u670d\u52a1\nsudo systemctl disable bluetooth\nsudo systemctl stop bluetooth\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u5b9a\u671f\u66f4\u65b0",children:"2. \u5b9a\u671f\u66f4\u65b0"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u542f\u7528\u81ea\u52a8\u5b89\u5168\u66f4\u65b0\nsudo apt install unattended-upgrades\nsudo dpkg-reconfigure unattended-upgrades\n\n# \u624b\u52a8\u66f4\u65b0\nsudo apt update && sudo apt upgrade -y\n\n# \u91cd\u542f\u540e\u66f4\u65b0\nsudo apt dist-upgrade\nsudo reboot\n"})}),"\n",(0,a.jsx)(e.h3,{id:"3-\u914d\u7f6e\u7ba1\u7406",children:"3. \u914d\u7f6e\u7ba1\u7406"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'# \u2705 \u4f7f\u7528\u7248\u672c\u63a7\u5236\u7ba1\u7406\u914d\u7f6e\ncd /etc\nsudo git init\nsudo git add nginx/ apache2/\nsudo git commit -m "Initial config"\n\n# \u2705 \u4fee\u6539\u524d\u5907\u4efd\nsudo cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.backup.$(date +%Y%m%d)\n\n# \u2705 \u4f7f\u7528\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\n# - Ansible\n# - Puppet\n# - Chef\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u5b89\u5168\u5b9e\u8df5",children:"\u5b89\u5168\u5b9e\u8df5"}),"\n",(0,a.jsx)(e.h3,{id:"1-\u7528\u6237\u7ba1\u7406",children:"1. \u7528\u6237\u7ba1\u7406"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u4f7f\u7528\u666e\u901a\u7528\u6237\u65e5\u5e38\u5de5\u4f5c\n# \u2705 \u9700\u8981\u65f6\u4f7f\u7528 sudo\n# \u2705 \u7981\u7528 root \u8fdc\u7a0b\u767b\u5f55\n\nsudo vim /etc/ssh/sshd_config\nPermitRootLogin no\n\n# \u2705 \u4f7f\u7528\u5f3a\u5bc6\u7801\u7b56\u7565\nsudo vim /etc/security/pwquality.conf\nminlen = 12\ndcredit = -1\nucredit = -1\nlcredit = -1\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-ssh-\u5b89\u5168",children:"2. SSH \u5b89\u5168"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u4fee\u6539\u9ed8\u8ba4\u7aef\u53e3\nPort 2222\n\n# \u2705 \u7981\u7528\u5bc6\u7801\u8ba4\u8bc1\uff0c\u4f7f\u7528\u5bc6\u94a5\nPasswordAuthentication no\nPubkeyAuthentication yes\n\n# \u2705 \u9650\u5236\u767b\u5f55\u5c1d\u8bd5\nMaxAuthTries 3\n\n# \u2705 \u4f7f\u7528 Fail2ban\nsudo apt install fail2ban\n"})}),"\n",(0,a.jsx)(e.h3,{id:"3-\u9632\u706b\u5899",children:"3. \u9632\u706b\u5899"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u542f\u7528\u9632\u706b\u5899\nsudo ufw enable\nsudo ufw default deny incoming\nsudo ufw default allow outgoing\n\n# \u2705 \u53ea\u5f00\u653e\u5fc5\u8981\u7684\u7aef\u53e3\nsudo ufw allow 22/tcp    # \u6216\u4f60\u7684 SSH \u7aef\u53e3\nsudo ufw allow 80/tcp\nsudo ufw allow 443/tcp\n"})}),"\n",(0,a.jsx)(e.h3,{id:"4-\u7cfb\u7edf\u52a0\u56fa",children:"4. \u7cfb\u7edf\u52a0\u56fa"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u7981\u7528\u4e0d\u9700\u8981\u7684\u670d\u52a1\nsudo systemctl disable bluetooth\nsudo systemctl disable cups\n\n# \u2705\u4f7f\u7528 SELinux \u6216 AppArmor\nsudo aa-status\n\n# \u2705 \u5b9a\u671f\u5ba1\u8ba1\nsudo apt install lynis\nsudo lynis audit system\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u6587\u4ef6\u7cfb\u7edf",children:"\u6587\u4ef6\u7cfb\u7edf"}),"\n",(0,a.jsx)(e.h3,{id:"1-\u76ee\u5f55\u7ec4\u7ec7",children:"1. \u76ee\u5f55\u7ec4\u7ec7"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u9075\u5faa FHS\uff08\u6587\u4ef6\u7cfb\u7edf\u5c42\u6b21\u6807\u51c6\uff09\n/home/          # \u7528\u6237\u6570\u636e\n/opt/           # \u7b2c\u4e09\u65b9\u5e94\u7528\n/usr/local/     # \u672c\u5730\u5b89\u88c5\u8f6f\u4ef6\n/var/log/       # \u65e5\u5fd7\u6587\u4ef6\n/etc/           # \u914d\u7f6e\u6587\u4ef6\n\n# \u2705 \u5206\u79bb\u5206\u533a\n/boot           # \u5f15\u5bfc\u5206\u533a\n/home           # \u7528\u6237\u6570\u636e\uff08\u5355\u72ec\u5206\u533a\u4fbf\u4e8e\u91cd\u88c5\u7cfb\u7edf\uff09\n/var            # \u53d8\u5316\u6570\u636e\uff08\u9632\u6b62\u65e5\u5fd7\u586b\u6ee1\u6839\u5206\u533a\uff09\n/tmp            # \u4e34\u65f6\u6587\u4ef6\uff08\u53ef\u4f7f\u7528 tmpfs\uff09\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u6743\u9650\u7ba1\u7406",children:"2. \u6743\u9650\u7ba1\u7406"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u6700\u5c0f\u6743\u9650\u539f\u5219\nchmod 755 /path/to/directory     # \u76ee\u5f55\nchmod 644 /path/to/file          # \u666e\u901a\u6587\u4ef6\nchmod 600 ~/.ssh/id_rsa          # \u79c1\u94a5\nchmod 700 ~/.ssh                 # SSH \u76ee\u5f55\n\n# \u2705 \u5b9a\u671f\u68c0\u67e5\u6743\u9650\nfind / -perm -4000 2>/dev/null   # SUID \u6587\u4ef6\nfind / -perm -002 -type f 2>/dev/null  # \u6240\u6709\u4eba\u53ef\u5199\n"})}),"\n",(0,a.jsx)(e.h3,{id:"3-\u5907\u4efd\u7b56\u7565",children:"3. \u5907\u4efd\u7b56\u7565"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 3-2-1 \u5907\u4efd\u539f\u5219\n# - 3 \u4efd\u526f\u672c\n# - 2 \u79cd\u4e0d\u540c\u4ecb\u8d28\n# - 1 \u4efd\u5f02\u5730\u5907\u4efd\n\n# \u2705 \u5b9a\u671f\u5907\u4efd\n# - \u6bcf\u65e5\u589e\u91cf\u5907\u4efd\n# - \u6bcf\u5468\u5b8c\u6574\u5907\u4efd\n# - \u6bcf\u6708\u5f02\u5730\u5907\u4efd\n\n# \u4f7f\u7528 rsync\nrsync -av --delete /source/ /backup/\n\n# \u4f7f\u7528 tar\ntar -czf backup-$(date +%Y%m%d).tar.gz /important/data\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u6027\u80fd\u4f18\u5316",children:"\u6027\u80fd\u4f18\u5316"}),"\n",(0,a.jsx)(e.h3,{id:"1-\u7cfb\u7edf\u8c03\u4f18",children:"1. \u7cfb\u7edf\u8c03\u4f18"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u8c03\u6574 swappiness\necho 'vm.swappiness=10' | sudo tee -a /etc/sysctl.conf\n\n# \u2705 \u6587\u4ef6\u7cfb\u7edf\u6302\u8f7d\u4f18\u5316\n# /etc/fstab\n/dev/sda1 / ext4 defaults,noatime,nodiratime 0 1\n\n# \u2705 \u589e\u52a0\u6587\u4ef6\u63cf\u8ff0\u7b26\u9650\u5236\nsudo vim /etc/security/limits.conf\n*  soft  nofile  65536\n*  hard  nofile  65536\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u76d1\u63a7",children:"2. \u76d1\u63a7"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u8bbe\u7f6e\u76d1\u63a7\u7cfb\u7edf\n# - CPU \u4f7f\u7528\u7387 > 80%\n# - \u5185\u5b58\u4f7f\u7528\u7387 > 90%\n# - \u78c1\u76d8\u4f7f\u7528\u7387 > 85%\n# - \u8d1f\u8f7d > CPU \u6838\u5fc3\u6570\n\n# \u2705 \u5b9a\u671f\u67e5\u770b\u65e5\u5fd7\nsudo journalctl -p err\nsudo grep -i error /var/log/syslog\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u7f51\u7edc\u914d\u7f6e",children:"\u7f51\u7edc\u914d\u7f6e"}),"\n",(0,a.jsx)(e.h3,{id:"1-dns-\u914d\u7f6e",children:"1. DNS \u914d\u7f6e"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u914d\u7f6e\u53ef\u9760\u7684 DNS\nsudo vim /etc/resolv.conf\nnameserver 8.8.8.8\nnameserver 8.8.4.4\nnameserver 1.1.1.1\n\n# \u2705 \u4f7f\u7528 systemd-resolved\nsudo vim /etc/systemd/resolved.conf\nDNS=8.8.8.8 1.1.1.1\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u7f51\u7edc\u5b89\u5168",children:"2. \u7f51\u7edc\u5b89\u5168"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u7981\u7528\u4e0d\u9700\u8981\u7684\u7f51\u7edc\u670d\u52a1\nsudo systemctl disable avahi-daemon\n\n# \u2705 \u914d\u7f6e\u9632\u706b\u5899\u89c4\u5219\nsudo ufw default deny incoming\n\n# \u2705 \u4f7f\u7528 fail2ban \u9632\u6b62\u66b4\u529b\u7834\u89e3\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u65e5\u5fd7\u7ba1\u7406",children:"\u65e5\u5fd7\u7ba1\u7406"}),"\n",(0,a.jsx)(e.h3,{id:"1-\u65e5\u5fd7\u8f6e\u8f6c",children:"1. \u65e5\u5fd7\u8f6e\u8f6c"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u914d\u7f6e logrotate\nsudo vim /etc/logrotate.d/myapp\n\n/var/log/myapp/*.log {\n    daily\n    rotate 14\n    compress\n    delaycompress\n    notifempty\n    create 0640 www-data adm\n    sharedscripts\n    postrotate\n        systemctl reload myapp\n    endscript\n}\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u65e5\u5fd7\u76d1\u63a7",children:"2. \u65e5\u5fd7\u76d1\u63a7"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u5b9a\u671f\u68c0\u67e5\u91cd\u8981\u65e5\u5fd7\n# - /var/log/auth.log - \u8ba4\u8bc1\u65e5\u5fd7\n# - /var/log/syslog - \u7cfb\u7edf\u65e5\u5fd7\n# - /var/log/nginx/ - Web \u670d\u52a1\u5668\u65e5\u5fd7\n\n# \u2705 \u8bbe\u7f6e\u65e5\u5fd7\u544a\u8b66\nsudo apt install logwatch\n"})}),"\n",(0,a.jsx)(e.h2,{id:"shell-\u811a\u672c",children:"Shell \u811a\u672c"}),"\n",(0,a.jsx)(e.h3,{id:"1-\u811a\u672c\u89c4\u8303",children:"1. \u811a\u672c\u89c4\u8303"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'#!/bin/bash\nset -euo pipefail\n\n# \u811a\u672c\u8bf4\u660e\n# \u7528\u9014\uff1a\u7cfb\u7edf\u5907\u4efd\n# \u4f5c\u8005\uff1aYour Name\n# \u65e5\u671f\uff1a2024-12-10\n\n# \u5168\u5c40\u53d8\u91cf\u4f7f\u7528\u5927\u5199\nBACKUP_DIR="/backup"\nLOG_FILE="/var/log/backup.log"\n\n# \u51fd\u6570\u4f7f\u7528\u5c0f\u5199\nlog() {\n    echo "[$(date +\'%Y-%m-%d %H:%M:%S\')] $*" | tee -a "$LOG_FILE"\n}\n\n# \u9519\u8bef\u5904\u7406\nerror_exit() {\n    log "ERROR: $1"\n    exit 1\n}\n\n# \u4e3b\u51fd\u6570\nmain() {\n    log "Backup started"\n    # \u5907\u4efd\u903b\u8f91\n    log "Backup completed"\n}\n\nmain "$@"\n'})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u811a\u672c\u6700\u4f73\u5b9e\u8df5",children:"2. \u811a\u672c\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'# \u2705 \u4f7f\u7528 set \u9009\u9879\nset -e              # \u9047\u5230\u9519\u8bef\u9000\u51fa\nset -u              # \u4f7f\u7528\u672a\u5b9a\u4e49\u53d8\u91cf\u9000\u51fa\nset -o pipefail     # \u7ba1\u9053\u9519\u8bef\u9000\u51fa\n\n# \u2705 \u4f7f\u7528\u5f15\u53f7\necho "$variable"    # \u800c\u4e0d\u662f echo $variable\n\n# \u2705 \u68c0\u67e5\u547d\u4ee4\u662f\u5426\u5b58\u5728\nif ! command -v rsync &> /dev/null; then\n    echo "rsync not found"\n    exit 1\nfi\n\n# \u2705 \u4f7f\u7528\u51fd\u6570\nfunction backup() {\n    local source=$1\n    local dest=$2\n    # \u5907\u4efd\u903b\u8f91\n}\n\n# \u2705 \u8bb0\u5f55\u65e5\u5fd7\nlog() {\n    echo "[$(date)] $*" >> /var/log/script.log\n}\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u670d\u52a1\u7ba1\u7406",children:"\u670d\u52a1\u7ba1\u7406"}),"\n",(0,a.jsx)(e.h3,{id:"1-systemd-\u670d\u52a1",children:"1. Systemd \u670d\u52a1"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u4f7f\u7528 systemd \u7ba1\u7406\u670d\u52a1\nsudo vim /etc/systemd/system/myapp.service\n\n[Unit]\nDescription=My Application\nAfter=network.target\n\n[Service]\nType=simple\nUser=myapp\nWorkingDirectory=/opt/myapp\nExecStart=/opt/myapp/bin/myapp\nRestart=on-failure\nRestartSec=5s\n\n# \u8d44\u6e90\u9650\u5236\nLimitNOFILE=65536\nLimitNPROC=4096\n\n[Install]\nWantedBy=multi-user.target\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u670d\u52a1\u76d1\u63a7",children:"2. \u670d\u52a1\u76d1\u63a7"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u76d1\u63a7\u670d\u52a1\u72b6\u6001\nsystemctl status myapp\n\n# \u2705 \u67e5\u770b\u670d\u52a1\u65e5\u5fd7\njournalctl -u myapp -f\n\n# \u2705 \u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\nsudo systemctl enable myapp\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u6570\u636e\u5e93",children:"\u6570\u636e\u5e93"}),"\n",(0,a.jsx)(e.h3,{id:"1-mysqlmariadb",children:"1. MySQL/MariaDB"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u5b9a\u671f\u5907\u4efd\nmysqldump -u root -p --all-databases > backup.sql\n\n# \u2705 \u4f18\u5316\u914d\u7f6e\n[mysqld]\ninnodb_buffer_pool_size = 2G    # 70% \u53ef\u7528\u5185\u5b58\nmax_connections = 500\nquery_cache_size = 64M\n\n# \u2705 \u6162\u67e5\u8be2\u65e5\u5fd7\nslow_query_log = 1\nslow_query_log_file = /var/log/mysql/slow.log\nlong_query_time = 2\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-redis",children:"2. Redis"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u6301\u4e45\u5316\u914d\u7f6e\nappendonly yes\nappendfsync everysec\n\n# \u2705 \u5185\u5b58\u7ba1\u7406\nmaxmemory 2gb\nmaxmemory-policy allkeys-lru\n\n# \u2705 \u5b9a\u671f\u5907\u4efd RDB\nsave 900 1\nsave 300 10\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u5bb9\u5668\u5316",children:"\u5bb9\u5668\u5316"}),"\n",(0,a.jsx)(e.h3,{id:"1-docker-\u6700\u4f73\u5b9e\u8df5",children:"1. Docker \u6700\u4f73\u5b9e\u8df5"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'# \u2705 \u4f7f\u7528\u5b98\u65b9\u955c\u50cf\nFROM node:18-alpine\n\n# \u2705 \u6700\u5c0f\u5316\u955c\u50cf\u5c42\nRUN apt-get update && apt-get install -y \\\n    package1 \\\n    package2 \\\n    && rm -rf /var/lib/apt/lists/*\n\n# \u2705 \u4f7f\u7528 .dockerignore\n.git\nnode_modules\n*.log\n\n# \u2705 \u8bbe\u7f6e\u8d44\u6e90\u9650\u5236\ndocker run --memory="512m" --cpus="1.0" myapp\n'})}),"\n",(0,a.jsx)(e.h2,{id:"\u6587\u6863\u5316",children:"\u6587\u6863\u5316"}),"\n",(0,a.jsx)(e.h3,{id:"1-\u7cfb\u7edf\u6587\u6863",children:"1. \u7cfb\u7edf\u6587\u6863"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u8bb0\u5f55\u7cfb\u7edf\u914d\u7f6e\n# - \u670d\u52a1\u5668\u89c4\u683c\n# - \u5b89\u88c5\u7684\u8f6f\u4ef6\n# - \u914d\u7f6e\u66f4\u6539\n# - \u7f51\u7edc\u62d3\u6251\n\n# \u2705 \u7ef4\u62a4\u8fd0\u7ef4\u624b\u518c\n# - \u5e38\u89c1\u64cd\u4f5c\u6d41\u7a0b\n# - \u6545\u969c\u6392\u67e5\u6b65\u9aa4\n# - \u5e94\u6025\u54cd\u5e94\u8ba1\u5212\n\n# \u2705 \u8bb0\u5f55\u53d8\u66f4\n# - \u4f7f\u7528 Git \u7ba1\u7406\u914d\u7f6e\u6587\u4ef6\n# - \u7ef4\u62a4\u53d8\u66f4\u65e5\u5fd7\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u6ce8\u91ca\u89c4\u8303",children:"2. \u6ce8\u91ca\u89c4\u8303"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 Shell \u811a\u672c\u6ce8\u91ca\n# \u811a\u672c\u5f00\u5934\u8bf4\u660e\u7528\u9014\n# \u590d\u6742\u903b\u8f91\u6dfb\u52a0\u6ce8\u91ca\n# \u51fd\u6570\u6dfb\u52a0\u8bf4\u660e\n\n# \u2705 \u914d\u7f6e\u6587\u4ef6\u6ce8\u91ca\n# \u8bf4\u660e\u6bcf\u4e2a\u914d\u7f6e\u9879\u7684\u4f5c\u7528\n# \u8bb0\u5f55\u4fee\u6539\u539f\u56e0\u548c\u65f6\u95f4\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u56e2\u961f\u534f\u4f5c",children:"\u56e2\u961f\u534f\u4f5c"}),"\n",(0,a.jsx)(e.h3,{id:"1-\u6743\u9650\u5206\u79bb",children:"1. \u6743\u9650\u5206\u79bb"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u6309\u804c\u80fd\u5206\u914d\u6743\u9650\n# - \u5f00\u53d1\u4eba\u5458\uff1a\u53ea\u8bfb\u8bbf\u95ee\u751f\u4ea7\u73af\u5883\n# - \u8fd0\u7ef4\u4eba\u5458\uff1a\u5b8c\u6574\u6743\u9650\n# - \u5ba1\u8ba1\u4eba\u5458\uff1a\u65e5\u5fd7\u8bbf\u95ee\u6743\u9650\n\n# \u2705 \u4f7f\u7528\u7ec4\u7ba1\u7406\nsudo groupadd developers\nsudo groupadd operators\nsudo usermod -aG developers alice\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u5ba1\u8ba1\u8ffd\u8e2a",children:"2. \u5ba1\u8ba1\u8ffd\u8e2a"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u542f\u7528\u547d\u4ee4\u5ba1\u8ba1\nsudo apt install auditd\n\n# \u2705 \u8bb0\u5f55 sudo \u4f7f\u7528\nDefaults logfile=/var/log/sudo.log\n\n# \u2705 \u5b9a\u671f\u5ba1\u67e5\u65e5\u5fd7\nsudo grep sudo /var/log/auth.log\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u707e\u96be\u6062\u590d",children:"\u707e\u96be\u6062\u590d"}),"\n",(0,a.jsx)(e.h3,{id:"1-\u5907\u4efd\u9a8c\u8bc1",children:"1. \u5907\u4efd\u9a8c\u8bc1"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u5b9a\u671f\u6d4b\u8bd5\u5907\u4efd\u6062\u590d\n# \u2705 \u6587\u6863\u5316\u6062\u590d\u6d41\u7a0b\n# \u2705 \u6f14\u7ec3\u707e\u96be\u6062\u590d\n\n# \u9a8c\u8bc1\u5907\u4efd\u5b8c\u6574\u6027\ntar -tzf backup.tar.gz > /dev/null\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u5e94\u6025\u9884\u6848",children:"2. \u5e94\u6025\u9884\u6848"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u5236\u5b9a\u5e94\u6025\u54cd\u5e94\u8ba1\u5212\n# - \u95ee\u9898\u5206\u7c7b\u548c\u4f18\u5148\u7ea7\n# - \u8054\u7cfb\u4eba\u5217\u8868\n# - \u5904\u7406\u6d41\u7a0b\n\n# \u2705 \u51c6\u5907\u5e94\u6025\u5de5\u5177\n# - Live CD/USB\n# - \u5907\u4efd\u914d\u7f6e\u6587\u4ef6\n# - \u5e38\u7528\u811a\u672c\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u81ea\u52a8\u5316",children:"\u81ea\u52a8\u5316"}),"\n",(0,a.jsx)(e.h3,{id:"1-\u4f7f\u7528\u81ea\u52a8\u5316\u5de5\u5177",children:"1. \u4f7f\u7528\u81ea\u52a8\u5316\u5de5\u5177"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 Ansible for \u914d\u7f6e\u7ba1\u7406\n# \u2705 Cron for \u5b9a\u65f6\u4efb\u52a1\n# \u2705 Systemd timers for \u670d\u52a1\u5b9a\u65f6\n\n# Ansible playbook \u793a\u4f8b\n- hosts: servers\n  tasks:\n    - name: Update packages\n      apt:\n        update_cache: yes\n        upgrade: dist\n"})}),"\n",(0,a.jsx)(e.h3,{id:"2-\u811a\u672c\u81ea\u52a8\u5316",children:"2. \u811a\u672c\u81ea\u52a8\u5316"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u2705 \u81ea\u52a8\u5316\u91cd\u590d\u4efb\u52a1\n# - \u7cfb\u7edf\u66f4\u65b0\n# - \u65e5\u5fd7\u6e05\u7406\n# - \u5907\u4efd\n\n# \u2705 \u4f7f\u7528\u7248\u672c\u63a7\u5236\u7ba1\u7406\u811a\u672c\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,a.jsx)(e.p,{children:"\u672c\u6587\u603b\u7ed3\u4e86 Linux \u6700\u4f73\u5b9e\u8df5\uff1a"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u2705 \u7cfb\u7edf\u7ba1\u7406\uff08\u6700\u5c0f\u5b89\u88c5\u3001\u5b9a\u671f\u66f4\u65b0\uff09"}),"\n",(0,a.jsx)(e.li,{children:"\u2705 \u5b89\u5168\u5b9e\u8df5\uff08\u7528\u6237\u7ba1\u7406\u3001SSH\u3001\u9632\u706b\u5899\uff09"}),"\n",(0,a.jsx)(e.li,{children:"\u2705 \u6027\u80fd\u4f18\u5316\uff08\u7cfb\u7edf\u8c03\u4f18\u3001\u76d1\u63a7\uff09"}),"\n",(0,a.jsx)(e.li,{children:"\u2705 \u5907\u4efd\u548c\u6062\u590d"}),"\n",(0,a.jsx)(e.li,{children:"\u2705 \u6587\u6863\u5316\u548c\u56e2\u961f\u534f\u4f5c"}),"\n",(0,a.jsx)(e.li,{children:"\u2705 \u81ea\u52a8\u5316\u8fd0\u7ef4"}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:["\u7ee7\u7eed\u5b66\u4e60 ",(0,a.jsx)(e.a,{href:"/docs/linux/quick-reference",children:"\u5feb\u901f\u53c2\u8003"})," \u548c ",(0,a.jsx)(e.a,{href:"/docs/linux/faq",children:"\u5e38\u89c1\u95ee\u9898"}),"\u3002"]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(o,{...n})}):o(n)}}}]);