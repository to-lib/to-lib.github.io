"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[76801],{8209:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"ml/online-learning","title":"\ud83d\udcca \u5728\u7ebf\u5b66\u4e60","description":"\u5728\u7ebf\u5b66\u4e60\u4ece\u6d41\u5f0f\u6570\u636e\u4e2d\u6301\u7eed\u5b66\u4e60\uff0c\u65e0\u9700\u91cd\u65b0\u8bad\u7ec3\u3002","source":"@site/docs/ml/online-learning.md","sourceDirName":"ml","slug":"/ml/online-learning","permalink":"/docs/ml/online-learning","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/online-learning.md","tags":[],"version":"current","sidebarPosition":33,"frontMatter":{"sidebar_position":33,"title":"\ud83d\udcca \u5728\u7ebf\u5b66\u4e60"},"sidebar":"ml","previous":{"title":"\ud83c\udfaf \u4e3b\u52a8\u5b66\u4e60","permalink":"/docs/ml/active-learning"},"next":{"title":"\ud83e\udde0 \u6301\u7eed\u5b66\u4e60","permalink":"/docs/ml/continual-learning"}}');var l=r(22714),s=r(48885);const t={sidebar_position:33,title:"\ud83d\udcca \u5728\u7ebf\u5b66\u4e60"},d="\u5728\u7ebf\u5b66\u4e60\u4e0e\u589e\u91cf\u5b66\u4e60",a={},c=[{value:"\u6838\u5fc3\u6982\u5ff5",id:"\u6838\u5fc3\u6982\u5ff5",level:2},{value:"\u5728\u7ebf\u5b66\u4e60\u7b97\u6cd5",id:"\u5728\u7ebf\u5b66\u4e60\u7b97\u6cd5",level:2},{value:"\u968f\u673a\u68af\u5ea6\u4e0b\u964d",id:"\u968f\u673a\u68af\u5ea6\u4e0b\u964d",level:3},{value:"sklearn \u589e\u91cf\u5b66\u4e60",id:"sklearn-\u589e\u91cf\u5b66\u4e60",level:3},{value:"River (\u6d41\u5f0f\u5b66\u4e60\u5e93)",id:"river-\u6d41\u5f0f\u5b66\u4e60\u5e93",level:3},{value:"\u6982\u5ff5\u6f02\u79fb\u68c0\u6d4b",id:"\u6982\u5ff5\u6f02\u79fb\u68c0\u6d4b",level:2},{value:"\u589e\u91cf\u795e\u7ecf\u7f51\u7edc",id:"\u589e\u91cf\u795e\u7ecf\u7f51\u7edc",level:2},{value:"\u5e94\u7528\u573a\u666f",id:"\u5e94\u7528\u573a\u666f",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"\u5728\u7ebf\u5b66\u4e60\u4e0e\u589e\u91cf\u5b66\u4e60",children:"\u5728\u7ebf\u5b66\u4e60\u4e0e\u589e\u91cf\u5b66\u4e60"})}),"\n",(0,l.jsx)(n.p,{children:"\u5728\u7ebf\u5b66\u4e60\u4ece\u6d41\u5f0f\u6570\u636e\u4e2d\u6301\u7eed\u5b66\u4e60\uff0c\u65e0\u9700\u91cd\u65b0\u8bad\u7ec3\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"\u6838\u5fc3\u6982\u5ff5",children:"\u6838\u5fc3\u6982\u5ff5"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u672f\u8bed"}),(0,l.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5728\u7ebf\u5b66\u4e60"}),(0,l.jsx)(n.td,{children:"\u9010\u6837\u672c\u66f4\u65b0\u6a21\u578b"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u589e\u91cf\u5b66\u4e60"}),(0,l.jsx)(n.td,{children:"\u6279\u91cf\u66f4\u65b0\uff0c\u4e0d\u8bbf\u95ee\u65e7\u6570\u636e"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u6d41\u5f0f\u5b66\u4e60"}),(0,l.jsx)(n.td,{children:"\u5904\u7406\u65e0\u9650\u6570\u636e\u6d41"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"\u5728\u7ebf\u5b66\u4e60\u7b97\u6cd5",children:"\u5728\u7ebf\u5b66\u4e60\u7b97\u6cd5"}),"\n",(0,l.jsx)(n.h3,{id:"\u968f\u673a\u68af\u5ea6\u4e0b\u964d",children:"\u968f\u673a\u68af\u5ea6\u4e0b\u964d"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"class OnlineSGD:\n    def __init__(self, n_features, lr=0.01):\n        self.weights = np.zeros(n_features)\n        self.lr = lr\n\n    def partial_fit(self, x, y):\n        pred = np.dot(x, self.weights)\n        error = y - pred\n        self.weights += self.lr * error * x\n\n    def predict(self, x):\n        return np.dot(x, self.weights)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"sklearn-\u589e\u91cf\u5b66\u4e60",children:"sklearn \u589e\u91cf\u5b66\u4e60"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"from sklearn.linear_model import SGDClassifier, PassiveAggressiveClassifier\nfrom sklearn.naive_bayes import MultinomialNB\n\n# \u652f\u6301 partial_fit \u7684\u6a21\u578b\nmodel = SGDClassifier()\n\n# \u589e\u91cf\u8bad\u7ec3\nfor X_batch, y_batch in data_stream:\n    model.partial_fit(X_batch, y_batch, classes=classes)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"river-\u6d41\u5f0f\u5b66\u4e60\u5e93",children:"River (\u6d41\u5f0f\u5b66\u4e60\u5e93)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"from river import linear_model, metrics, preprocessing\n\nmodel = preprocessing.StandardScaler() | linear_model.LogisticRegression()\nmetric = metrics.Accuracy()\n\nfor x, y in stream:\n    y_pred = model.predict_one(x)\n    metric.update(y, y_pred)\n    model.learn_one(x, y)\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6982\u5ff5\u6f02\u79fb\u68c0\u6d4b",children:"\u6982\u5ff5\u6f02\u79fb\u68c0\u6d4b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'from river import drift\n\n# ADWIN \u68c0\u6d4b\u5668\nadwin = drift.ADWIN()\n\nfor i, (x, y) in enumerate(stream):\n    adwin.update(error)  # \u66f4\u65b0\u9519\u8bef\u7387\n    if adwin.drift_detected:\n        print(f"\u68c0\u6d4b\u5230\u6f02\u79fb: {i}")\n        # \u91cd\u7f6e\u6216\u8c03\u6574\u6a21\u578b\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u589e\u91cf\u795e\u7ecf\u7f51\u7edc",children:"\u589e\u91cf\u795e\u7ecf\u7f51\u7edc"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"import torch\n\nclass IncrementalModel:\n    def __init__(self, model, replay_buffer_size=1000):\n        self.model = model\n        self.buffer = []\n        self.buffer_size = replay_buffer_size\n\n    def learn(self, new_data, epochs=1):\n        # \u5408\u5e76\u65b0\u6570\u636e\u548c\u56de\u653e\u7f13\u51b2\u533a\n        combined = new_data + self.buffer[-self.buffer_size:]\n\n        # \u8bad\u7ec3\n        for _ in range(epochs):\n            for x, y in combined:\n                self.model.train_step(x, y)\n\n        # \u66f4\u65b0\u7f13\u51b2\u533a\n        self.buffer.extend(new_data)\n        if len(self.buffer) > self.buffer_size:\n            self.buffer = self.buffer[-self.buffer_size:]\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u5e94\u7528\u573a\u666f",children:"\u5e94\u7528\u573a\u666f"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u573a\u666f"}),(0,l.jsx)(n.th,{children:"\u7279\u70b9"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u63a8\u8350\u7cfb\u7edf"}),(0,l.jsx)(n.td,{children:"\u5b9e\u65f6\u66f4\u65b0\u7528\u6237\u504f\u597d"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u6b3a\u8bc8\u68c0\u6d4b"}),(0,l.jsx)(n.td,{children:"\u9002\u5e94\u65b0\u7684\u6b3a\u8bc8\u6a21\u5f0f"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u4f20\u611f\u5668\u6570\u636e"}),(0,l.jsx)(n.td,{children:"\u5904\u7406\u8fde\u7eed\u6570\u636e\u6d41"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"\u5e7f\u544a\u70b9\u51fb"}),(0,l.jsx)(n.td,{children:"\u5b9e\u65f6\u4f18\u5316\u6295\u653e"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},48885:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>d});var i=r(99378);const l={},s=i.createContext(l);function t(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);