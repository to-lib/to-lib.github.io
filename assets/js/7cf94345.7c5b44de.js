"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[1444],{48885:(n,e,a)=>{a.d(e,{R:()=>i,x:()=>t});var l=a(99378);const r={},s=l.createContext(r);function i(n){const e=l.useContext(s);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:i(n.components),l.createElement(s.Provider,{value:e},n.children)}},99885:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>o,contentTitle:()=>t,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"springboot/deployment","title":"\u90e8\u7f72\u4e0a\u7ebf","description":"\u6784\u5efa\u4e0e\u6253\u5305","source":"@site/docs/springboot/deployment.md","sourceDirName":"springboot","slug":"/springboot/deployment","permalink":"/docs/springboot/deployment","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/springboot/deployment.md","tags":[],"version":"current","sidebarPosition":18,"frontMatter":{"sidebar_position":18},"sidebar":"springboot","previous":{"title":"\u6027\u80fd\u4f18\u5316","permalink":"/docs/springboot/performance-optimization"},"next":{"title":"Docker \u5bb9\u5668\u5316","permalink":"/docs/springboot/docker"}}');var r=a(22714),s=a(48885);const i={sidebar_position:18},t="\u90e8\u7f72\u4e0a\u7ebf",o={},c=[{value:"\u6784\u5efa\u4e0e\u6253\u5305",id:"\u6784\u5efa\u4e0e\u6253\u5305",level:2},{value:"Gradle \u6253\u5305",id:"gradle-\u6253\u5305",level:3},{value:"\u68c0\u67e5\u6253\u5305\u7ed3\u679c",id:"\u68c0\u67e5\u6253\u5305\u7ed3\u679c",level:3},{value:"JAR \u8fd0\u884c",id:"jar-\u8fd0\u884c",level:2},{value:"\u57fa\u672c\u8fd0\u884c",id:"\u57fa\u672c\u8fd0\u884c",level:3},{value:"JVM \u53c2\u6570\u8c03\u4f18",id:"jvm-\u53c2\u6570\u8c03\u4f18",level:3},{value:"\u540e\u53f0\u8fd0\u884c",id:"\u540e\u53f0\u8fd0\u884c",level:3},{value:"Docker \u90e8\u7f72",id:"docker-\u90e8\u7f72",level:2},{value:"Dockerfile \u521b\u5efa",id:"dockerfile-\u521b\u5efa",level:3},{value:"Docker Compose",id:"docker-compose",level:3},{value:"Kubernetes \u90e8\u7f72",id:"kubernetes-\u90e8\u7f72",level:2},{value:"Deployment \u914d\u7f6e",id:"deployment-\u914d\u7f6e",level:3},{value:"Service \u914d\u7f6e",id:"service-\u914d\u7f6e",level:3},{value:"\u914d\u7f6e\u7ba1\u7406",id:"\u914d\u7f6e\u7ba1\u7406",level:2},{value:"\u73af\u5883\u53d8\u91cf\u914d\u7f6e",id:"\u73af\u5883\u53d8\u91cf\u914d\u7f6e",level:3},{value:"\u914d\u7f6e\u6587\u4ef6\u65b9\u5f0f",id:"\u914d\u7f6e\u6587\u4ef6\u65b9\u5f0f",level:3},{value:"\u5916\u90e8\u914d\u7f6e\u4e2d\u5fc3\uff08Spring Cloud Config\uff09",id:"\u5916\u90e8\u914d\u7f6e\u4e2d\u5fc3spring-cloud-config",level:3},{value:"\u76d1\u63a7\u548c\u65e5\u5fd7",id:"\u76d1\u63a7\u548c\u65e5\u5fd7",level:2},{value:"Actuator \u7aef\u70b9\u914d\u7f6e",id:"actuator-\u7aef\u70b9\u914d\u7f6e",level:3},{value:"\u8bbf\u95ee\u76d1\u63a7\u7aef\u70b9",id:"\u8bbf\u95ee\u76d1\u63a7\u7aef\u70b9",level:3},{value:"\u65e5\u5fd7\u914d\u7f6e",id:"\u65e5\u5fd7\u914d\u7f6e",level:3},{value:"\u5065\u5eb7\u68c0\u67e5",id:"\u5065\u5eb7\u68c0\u67e5",level:2},{value:"\u81ea\u5b9a\u4e49\u5065\u5eb7\u68c0\u67e5",id:"\u81ea\u5b9a\u4e49\u5065\u5eb7\u68c0\u67e5",level:3},{value:"\u5c31\u7eea\u6027\u548c\u5b58\u6d3b\u6027\u63a2\u9488",id:"\u5c31\u7eea\u6027\u548c\u5b58\u6d3b\u6027\u63a2\u9488",level:3},{value:"\u6027\u80fd\u4f18\u5316\u5efa\u8bae",id:"\u6027\u80fd\u4f18\u5316\u5efa\u8bae",level:2},{value:"JVM \u53c2\u6570",id:"jvm-\u53c2\u6570",level:3},{value:"\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u4f18\u5316",id:"\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u4f18\u5316",level:3},{value:"\u7f13\u5b58\u914d\u7f6e",id:"\u7f13\u5b58\u914d\u7f6e",level:3},{value:"\u707e\u96be\u6062\u590d",id:"\u707e\u96be\u6062\u590d",level:2},{value:"\u5907\u4efd\u7b56\u7565",id:"\u5907\u4efd\u7b56\u7565",level:3},{value:"\u5e94\u7528\u91cd\u542f\u7b56\u7565",id:"\u5e94\u7528\u91cd\u542f\u7b56\u7565",level:3},{value:"\u53d1\u5e03\u7b56\u7565",id:"\u53d1\u5e03\u7b56\u7565",level:2},{value:"\u84dd\u7eff\u90e8\u7f72",id:"\u84dd\u7eff\u90e8\u7f72",level:3},{value:"\u91d1\u4e1d\u96c0\u90e8\u7f72\uff08Canary\uff09",id:"\u91d1\u4e1d\u96c0\u90e8\u7f72canary",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"\u90e8\u7f72\u4e0a\u7ebf",children:"\u90e8\u7f72\u4e0a\u7ebf"})}),"\n",(0,r.jsx)(e.h2,{id:"\u6784\u5efa\u4e0e\u6253\u5305",children:"\u6784\u5efa\u4e0e\u6253\u5305"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u6e05\u7406\u5e76\u6253\u5305\nmvn clean package\n\n# \u8df3\u8fc7\u6d4b\u8bd5\u6253\u5305\nmvn clean package -DskipTests\n\n# \u6253\u5305 WAR \u6587\u4ef6\uff08\u7528\u4e8e\u5e94\u7528\u670d\u52a1\u5668\uff09\nmvn clean package -P war\n"})}),"\n",(0,r.jsx)(e.h3,{id:"gradle-\u6253\u5305",children:"Gradle \u6253\u5305"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u7f16\u8bd1\u5e76\u6784\u5efa\ngradle build\n\n# \u8df3\u8fc7\u6d4b\u8bd5\ngradle build -x test\n\n# \u751f\u6210 JAR\ngradle bootJar\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u68c0\u67e5\u6253\u5305\u7ed3\u679c",children:"\u68c0\u67e5\u6253\u5305\u7ed3\u679c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b JAR \u5185\u5bb9\njar tf target/myapp.jar\n\n# \u67e5\u770b MANIFEST \u6587\u4ef6\njar xf target/myapp.jar META-INF/MANIFEST.MF\n"})}),"\n",(0,r.jsx)(e.h2,{id:"jar-\u8fd0\u884c",children:"JAR \u8fd0\u884c"}),"\n",(0,r.jsx)(e.h3,{id:"\u57fa\u672c\u8fd0\u884c",children:"\u57fa\u672c\u8fd0\u884c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u9ed8\u8ba4\u53c2\u6570\u8fd0\u884c\njava -jar myapp.jar\n\n# \u6307\u5b9a\u73af\u5883\njava -jar myapp.jar --spring.profiles.active=prod\n\n# \u6307\u5b9a\u7aef\u53e3\njava -jar myapp.jar --server.port=9000\n\n# \u6307\u5b9a\u591a\u4e2a\u53c2\u6570\njava -jar myapp.jar \\\n  --spring.profiles.active=prod \\\n  --server.port=8443 \\\n  --spring.datasource.url=jdbc:mysql://db:3306/mydb\n"})}),"\n",(0,r.jsx)(e.h3,{id:"jvm-\u53c2\u6570\u8c03\u4f18",children:"JVM \u53c2\u6570\u8c03\u4f18"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u5185\u5b58\u914d\u7f6e\njava -Xms512m -Xmx1024m -jar myapp.jar\n\n# \u5783\u573e\u56de\u6536\u914d\u7f6e\njava -XX:+UseG1GC \\\n     -XX:MaxGCPauseMillis=200 \\\n     -jar myapp.jar\n\n# \u8be6\u7ec6 GC \u65e5\u5fd7\njava -Xms512m -Xmx1024m \\\n     -XX:+PrintGCDetails \\\n     -XX:+PrintGCTimeStamps \\\n     -Xloggc:gc.log \\\n     -jar myapp.jar\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u540e\u53f0\u8fd0\u884c",children:"\u540e\u53f0\u8fd0\u884c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u4f7f\u7528 nohup\nnohup java -jar myapp.jar > app.log 2>&1 &\n\n# \u4f7f\u7528 systemd (Linux)\nsystemctl start myapp\n\n# \u4f7f\u7528 screen\nscreen -dmS myapp java -jar myapp.jar\n"})}),"\n",(0,r.jsx)(e.h2,{id:"docker-\u90e8\u7f72",children:"Docker \u90e8\u7f72"}),"\n",(0,r.jsx)(e.h3,{id:"dockerfile-\u521b\u5efa",children:"Dockerfile \u521b\u5efa"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-dockerfile",children:'# \u591a\u9636\u6bb5\u6784\u5efa\nFROM maven:3.8-openjdk-17 AS builder\nWORKDIR /app\nCOPY pom.xml .\nRUN mvn dependency:go-offline\nCOPY src ./src\nRUN mvn clean package -DskipTests\n\n# \u6700\u7ec8\u955c\u50cf\nFROM openjdk:17-slim\nWORKDIR /app\nCOPY --from=builder /app/target/*.jar app.jar\nEXPOSE 8080\nENTRYPOINT ["java", "-jar", "/app/app.jar"]\n'})}),"\n",(0,r.jsx)(e.h3,{id:"docker-compose",children:"Docker Compose"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:'version: \'3.8\'\n\nservices:\n  app:\n    build: .\n    ports:\n      - "8080:8080"\n    environment:\n      - SPRING_PROFILES_ACTIVE=prod\n      - SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/mydb\n      - SPRING_DATASOURCE_USERNAME=root\n      - SPRING_DATASOURCE_PASSWORD=password\n    depends_on:\n      - mysql\n      - redis\n    networks:\n      - myapp-network\n\n  mysql:\n    image: mysql:8.0\n    environment:\n      - MYSQL_ROOT_PASSWORD=password\n      - MYSQL_DATABASE=mydb\n    volumes:\n      - mysql-data:/var/lib/mysql\n    networks:\n      - myapp-network\n\n  redis:\n    image: redis:7-alpine\n    ports:\n      - "6379:6379"\n    networks:\n      - myapp-network\n\nvolumes:\n  mysql-data:\n\nnetworks:\n  myapp-network:\n'})}),"\n",(0,r.jsx)(e.p,{children:"\u6784\u5efa\u548c\u8fd0\u884c\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"docker-compose up -d\n"})}),"\n",(0,r.jsx)(e.h2,{id:"kubernetes-\u90e8\u7f72",children:"Kubernetes \u90e8\u7f72"}),"\n",(0,r.jsx)(e.h3,{id:"deployment-\u914d\u7f6e",children:"Deployment \u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:'apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: myapp\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: myapp\n  template:\n    metadata:\n      labels:\n        app: myapp\n    spec:\n      containers:\n      - name: myapp\n        image: myrepo/myapp:1.0.0\n        ports:\n        - containerPort: 8080\n        env:\n        - name: SPRING_PROFILES_ACTIVE\n          value: prod\n        - name: SPRING_DATASOURCE_URL\n          valueFrom:\n            configMapKeyRef:\n              name: app-config\n              key: database-url\n        resources:\n          requests:\n            memory: "512Mi"\n            cpu: "500m"\n          limits:\n            memory: "1024Mi"\n            cpu: "1000m"\n        livenessProbe:\n          httpGet:\n            path: /actuator/health\n            port: 8080\n          initialDelaySeconds: 30\n          periodSeconds: 10\n        readinessProbe:\n          httpGet:\n            path: /actuator/health/readiness\n            port: 8080\n          initialDelaySeconds: 10\n          periodSeconds: 5\n'})}),"\n",(0,r.jsx)(e.h3,{id:"service-\u914d\u7f6e",children:"Service \u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Service\nmetadata:\n  name: myapp-service\nspec:\n  type: LoadBalancer\n  ports:\n  - protocol: TCP\n    port: 80\n    targetPort: 8080\n  selector:\n    app: myapp\n"})}),"\n",(0,r.jsx)(e.p,{children:"\u90e8\u7f72\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"kubectl apply -f deployment.yaml\nkubectl apply -f service.yaml\nkubectl get pods\nkubectl logs -f deployment/myapp\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u914d\u7f6e\u7ba1\u7406",children:"\u914d\u7f6e\u7ba1\u7406"}),"\n",(0,r.jsx)(e.h3,{id:"\u73af\u5883\u53d8\u91cf\u914d\u7f6e",children:"\u73af\u5883\u53d8\u91cf\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u7f16\u8f91 .env \u6587\u4ef6\nexport SPRING_PROFILES_ACTIVE=prod\nexport SPRING_DATASOURCE_URL=jdbc:mysql://db:3306/mydb\nexport SPRING_DATASOURCE_USERNAME=root\nexport SPRING_DATASOURCE_PASSWORD=password\nexport SERVER_PORT=8080\nexport LOGGING_LEVEL_ROOT=WARN\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u914d\u7f6e\u6587\u4ef6\u65b9\u5f0f",children:"\u914d\u7f6e\u6587\u4ef6\u65b9\u5f0f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"java -jar myapp.jar --spring.config.location=file:/etc/config/application.yml\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u5916\u90e8\u914d\u7f6e\u4e2d\u5fc3spring-cloud-config",children:"\u5916\u90e8\u914d\u7f6e\u4e2d\u5fc3\uff08Spring Cloud Config\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"spring:\n  cloud:\n    config:\n      uri: http://config-server:8888\n      fail-fast: true\n      retry:\n        initial-interval: 1000\n        max-interval: 2000\n        multiplier: 1.1\n        max-attempts: 6\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u76d1\u63a7\u548c\u65e5\u5fd7",children:"\u76d1\u63a7\u548c\u65e5\u5fd7"}),"\n",(0,r.jsx)(e.h3,{id:"actuator-\u7aef\u70b9\u914d\u7f6e",children:"Actuator \u7aef\u70b9\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"management:\n  endpoints:\n    web:\n      exposure:\n        include: health,metrics,env,configprops,prometheus\n      base-path: /actuator\n  \n  metrics:\n    export:\n      prometheus:\n        enabled: true\n  \n  endpoint:\n    health:\n      show-details: always\n      show-components: always\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u8bbf\u95ee\u76d1\u63a7\u7aef\u70b9",children:"\u8bbf\u95ee\u76d1\u63a7\u7aef\u70b9"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u5065\u5eb7\u68c0\u67e5\ncurl http://localhost:8080/actuator/health\n\n# \u5e94\u7528\u4fe1\u606f\ncurl http://localhost:8080/actuator/info\n\n# \u83b7\u53d6\u6307\u6807\ncurl http://localhost:8080/actuator/metrics\n\n# Prometheus \u683c\u5f0f\u6307\u6807\ncurl http://localhost:8080/actuator/prometheus\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u65e5\u5fd7\u914d\u7f6e",children:"\u65e5\u5fd7\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:'logging:\n  level:\n    root: WARN\n    com.example: INFO\n  \n  file:\n    name: /var/log/myapp/application.log\n    max-size: 10MB\n    max-history: 30\n    total-size-cap: 1GB\n  \n  pattern:\n    console: "%d{yyyy-MM-dd HH:mm:ss} %-5level %logger{36} - %msg%n"\n    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"\n\n# Logback \u914d\u7f6e\uff08\u53ef\u9009\uff09\n  config: classpath:logback-spring.xml\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u5065\u5eb7\u68c0\u67e5",children:"\u5065\u5eb7\u68c0\u67e5"}),"\n",(0,r.jsx)(e.h3,{id:"\u81ea\u5b9a\u4e49\u5065\u5eb7\u68c0\u67e5",children:"\u81ea\u5b9a\u4e49\u5065\u5eb7\u68c0\u67e5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-java",children:'import org.springframework.boot.actuate.health.Health;\nimport org.springframework.boot.actuate.health.HealthIndicator;\nimport org.springframework.stereotype.Component;\n\n@Component\npublic class CustomHealthIndicator implements HealthIndicator {\n    \n    @Override\n    public Health health() {\n        try {\n            // \u68c0\u67e5\u81ea\u5b9a\u4e49\u6761\u4ef6\n            boolean serviceRunning = checkServiceStatus();\n            \n            if (serviceRunning) {\n                return Health.up()\n                    .withDetail("status", "All systems operational")\n                    .build();\n            } else {\n                return Health.down()\n                    .withDetail("status", "Service is not responding")\n                    .build();\n            }\n        } catch (Exception e) {\n            return Health.unknown()\n                .withDetail("error", e.getMessage())\n                .build();\n        }\n    }\n    \n    private boolean checkServiceStatus() {\n        // \u81ea\u5b9a\u4e49\u68c0\u67e5\u903b\u8f91\n        return true;\n    }\n}\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u5c31\u7eea\u6027\u548c\u5b58\u6d3b\u6027\u63a2\u9488",children:"\u5c31\u7eea\u6027\u548c\u5b58\u6d3b\u6027\u63a2\u9488"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"management:\n  health:\n    livenessState:\n      enabled: true\n    readinessState:\n      enabled: true\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u5b58\u6d3b\u6027\u63a2\u9488\uff08\u5e94\u7528\u662f\u5426\u8fd8\u5728\u8fd0\u884c\uff09\ncurl http://localhost:8080/actuator/health/liveness\n\n# \u5c31\u7eea\u6027\u63a2\u9488\uff08\u5e94\u7528\u662f\u5426\u51c6\u5907\u597d\u5904\u7406\u8bf7\u6c42\uff09\ncurl http://localhost:8080/actuator/health/readiness\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u6027\u80fd\u4f18\u5316\u5efa\u8bae",children:"\u6027\u80fd\u4f18\u5316\u5efa\u8bae"}),"\n",(0,r.jsx)(e.h3,{id:"jvm-\u53c2\u6570",children:"JVM \u53c2\u6570"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# G1 \u5783\u573e\u56de\u6536\n-XX:+UseG1GC \\\n-XX:MaxGCPauseMillis=200 \\\n-XX:InitiatingHeapOccupancyPercent=35\n\n# \u7c7b\u52a0\u8f7d\u7f13\u5b58\n-XX:+UnlockDiagnosticVMOptions \\\n-XX:+TraceClassLoading\n\n# \u5185\u5b58\u914d\u7f6e\n-Xms512m -Xmx2048m\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u4f18\u5316",children:"\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u4f18\u5316"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"spring:\n  datasource:\n    hikari:\n      maximum-pool-size: 20\n      minimum-idle: 5\n      connection-timeout: 30000\n      idle-timeout: 600000\n      max-lifetime: 1800000\n      auto-commit: true\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u7f13\u5b58\u914d\u7f6e",children:"\u7f13\u5b58\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"spring:\n  cache:\n    type: redis\n    redis:\n      time-to-live: 600000\n\n  redis:\n    jedis:\n      pool:\n        max-active: 16\n        max-idle: 8\n        min-idle: 0\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u707e\u96be\u6062\u590d",children:"\u707e\u96be\u6062\u590d"}),"\n",(0,r.jsx)(e.h3,{id:"\u5907\u4efd\u7b56\u7565",children:"\u5907\u4efd\u7b56\u7565"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u5b9a\u671f\u5907\u4efd\u6570\u636e\u5e93\nmysqldump -u root -p mydb > backup-$(date +%Y%m%d).sql\n\n# \u5907\u4efd\u5e94\u7528\u914d\u7f6e\ntar -czf config-backup-$(date +%Y%m%d).tar.gz /etc/config/\n\n# \u5907\u4efd Redis \u6570\u636e\nredis-cli BGSAVE\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u5e94\u7528\u91cd\u542f\u7b56\u7565",children:"\u5e94\u7528\u91cd\u542f\u7b56\u7565"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Pod\nmetadata:\n  name: myapp\nspec:\n  restartPolicy: Always  # Always, OnFailure, Never\n  containers:\n  - name: app\n    image: myapp:1.0\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u53d1\u5e03\u7b56\u7565",children:"\u53d1\u5e03\u7b56\u7565"}),"\n",(0,r.jsx)(e.h3,{id:"\u84dd\u7eff\u90e8\u7f72",children:"\u84dd\u7eff\u90e8\u7f72"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u542f\u52a8\u65b0\u7248\u672c\uff08\u7eff\uff09\ndocker run -d --name myapp-green myapp:2.0\n\n# \u9a8c\u8bc1\u65b0\u7248\u672c\ncurl http://localhost:8080/actuator/health\n\n# \u5207\u6362\u6d41\u91cf\u5230\u65b0\u7248\u672c\nnginx reload  # \u66f4\u65b0 nginx \u914d\u7f6e\u6307\u5411\u65b0\u7248\u672c\n\n# \u505c\u6b62\u65e7\u7248\u672c\uff08\u84dd\uff09\ndocker stop myapp-blue\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u91d1\u4e1d\u96c0\u90e8\u7f72canary",children:"\u91d1\u4e1d\u96c0\u90e8\u7f72\uff08Canary\uff09"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:"apiVersion: fluxcd.io/v1alpha1\nkind: Canary\nmetadata:\n  name: myapp\nspec:\n  targetRef:\n    apiVersion: apps/v1\n    kind: Deployment\n    name: myapp\n  progressDeadlineSeconds: 60\n  service:\n    port: 8080\n  analysis:\n    interval: 1m\n    threshold: 5\n    metrics:\n    - name: error-rate\n      thresholdRange:\n        max: 1\n  skipAnalysis: false\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,r.jsx)(e.p,{children:"\u6210\u529f\u7684\u90e8\u7f72\u9700\u8981\uff1a"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsx)(e.li,{children:"\u2705 \u5408\u7406\u7684\u6253\u5305\u548c\u6784\u5efa\u6d41\u7a0b"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 \u5145\u5206\u7684\u76d1\u63a7\u548c\u65e5\u5fd7"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 \u5b9a\u671f\u7684\u5907\u4efd\u548c\u6062\u590d\u6d4b\u8bd5"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 \u9002\u5f53\u7684\u707e\u96be\u6062\u590d\u8ba1\u5212"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 \u7a33\u59a5\u7684\u53d1\u5e03\u7b56\u7565"}),"\n",(0,r.jsx)(e.li,{children:"\u2705 \u6027\u80fd\u548c\u8d44\u6e90\u4f18\u5316"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\u63d0\u793a"}),"\uff1a\u59cb\u7ec8\u5728\u751f\u4ea7\u73af\u5883\u524d\u8fdb\u884c\u5145\u5206\u7684\u6d4b\u8bd5\u548c\u9a8c\u8bc1\uff01"]})]})}function p(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}}}]);