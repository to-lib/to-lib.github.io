"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[50170],{48885:(n,e,t)=>{t.d(e,{R:()=>l,x:()=>a});var s=t(99378);const i={},r=s.createContext(i);function l(n){const e=s.useContext(r);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),s.createElement(r.Provider,{value:e},n.children)}},51800:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>a,default:()=>c,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"ml/evolutionary-algorithms","title":"\ud83e\uddec \u8fdb\u5316\u7b97\u6cd5","description":"\u8fdb\u5316\u7b97\u6cd5\u53d7\u751f\u7269\u8fdb\u5316\u542f\u53d1\uff0c\u901a\u8fc7\u9009\u62e9\u3001\u4ea4\u53c9\u3001\u53d8\u5f02\u6765\u4f18\u5316\u3002","source":"@site/docs/ml/evolutionary-algorithms.md","sourceDirName":"ml","slug":"/ml/evolutionary-algorithms","permalink":"/docs/ml/evolutionary-algorithms","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/evolutionary-algorithms.md","tags":[],"version":"current","sidebarPosition":48,"frontMatter":{"sidebar_position":48,"title":"\ud83e\uddec \u8fdb\u5316\u7b97\u6cd5"},"sidebar":"ml","previous":{"title":"\ud83d\udd10 \u9690\u79c1\u8ba1\u7b97","permalink":"/docs/ml/privacy-computing"},"next":{"title":"\ud83e\udde9 \u795e\u7ecf\u7b26\u53f7\u7ed3\u5408","permalink":"/docs/ml/neuro-symbolic"}}');var i=t(22714),r=t(48885);const l={sidebar_position:48,title:"\ud83e\uddec \u8fdb\u5316\u7b97\u6cd5"},a="\u8fdb\u5316\u7b97\u6cd5",o={},d=[{value:"\u6838\u5fc3\u6982\u5ff5",id:"\u6838\u5fc3\u6982\u5ff5",level:2},{value:"\u9057\u4f20\u7b97\u6cd5",id:"\u9057\u4f20\u7b97\u6cd5",level:2},{value:"\u8fdb\u5316\u7b56\u7565 (ES)",id:"\u8fdb\u5316\u7b56\u7565-es",level:2},{value:"\u795e\u7ecf\u7f51\u7edc\u6f14\u5316",id:"\u795e\u7ecf\u7f51\u7edc\u6f14\u5316",level:2},{value:"\u5e94\u7528\u573a\u666f",id:"\u5e94\u7528\u573a\u666f",level:2}];function p(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",mermaid:"mermaid",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"\u8fdb\u5316\u7b97\u6cd5",children:"\u8fdb\u5316\u7b97\u6cd5"})}),"\n",(0,i.jsx)(e.p,{children:"\u8fdb\u5316\u7b97\u6cd5\u53d7\u751f\u7269\u8fdb\u5316\u542f\u53d1\uff0c\u901a\u8fc7\u9009\u62e9\u3001\u4ea4\u53c9\u3001\u53d8\u5f02\u6765\u4f18\u5316\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u6838\u5fc3\u6982\u5ff5",children:"\u6838\u5fc3\u6982\u5ff5"}),"\n",(0,i.jsx)(e.mermaid,{value:"graph LR\n    A[\u521d\u59cb\u79cd\u7fa4] --\x3e B[\u8bc4\u4f30\u9002\u5e94\u5ea6]\n    B --\x3e C[\u9009\u62e9]\n    C --\x3e D[\u4ea4\u53c9]\n    D --\x3e E[\u53d8\u5f02]\n    E --\x3e F[\u65b0\u79cd\u7fa4]\n    F --\x3e B"}),"\n",(0,i.jsx)(e.h2,{id:"\u9057\u4f20\u7b97\u6cd5",children:"\u9057\u4f20\u7b97\u6cd5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'import numpy as np\n\nclass GeneticAlgorithm:\n    def __init__(self, pop_size, gene_length, fitness_fn):\n        self.pop_size = pop_size\n        self.gene_length = gene_length\n        self.fitness_fn = fitness_fn\n\n    def initialize(self):\n        return np.random.randint(0, 2, (self.pop_size, self.gene_length))\n\n    def select(self, population, fitness, k=2):\n        """\u9526\u6807\u8d5b\u9009\u62e9"""\n        selected = []\n        for _ in range(len(population)):\n            candidates = np.random.choice(len(population), k)\n            winner = candidates[np.argmax(fitness[candidates])]\n            selected.append(population[winner])\n        return np.array(selected)\n\n    def crossover(self, parent1, parent2, rate=0.8):\n        """\u5355\u70b9\u4ea4\u53c9"""\n        if np.random.random() < rate:\n            point = np.random.randint(1, len(parent1))\n            child1 = np.concatenate([parent1[:point], parent2[point:]])\n            child2 = np.concatenate([parent2[:point], parent1[point:]])\n            return child1, child2\n        return parent1, parent2\n\n    def mutate(self, individual, rate=0.01):\n        """\u4f4d\u7ffb\u8f6c\u53d8\u5f02"""\n        for i in range(len(individual)):\n            if np.random.random() < rate:\n                individual[i] = 1 - individual[i]\n        return individual\n\n    def evolve(self, generations):\n        population = self.initialize()\n\n        for gen in range(generations):\n            fitness = np.array([self.fitness_fn(ind) for ind in population])\n\n            # \u7cbe\u82f1\u4fdd\u7559\n            elite_idx = np.argmax(fitness)\n            elite = population[elite_idx].copy()\n\n            # \u9009\u62e9\u3001\u4ea4\u53c9\u3001\u53d8\u5f02\n            selected = self.select(population, fitness)\n            new_pop = [elite]\n\n            for i in range(0, len(selected) - 1, 2):\n                c1, c2 = self.crossover(selected[i], selected[i+1])\n                new_pop.extend([self.mutate(c1), self.mutate(c2)])\n\n            population = np.array(new_pop[:self.pop_size])\n\n        return population[np.argmax(fitness)]\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u8fdb\u5316\u7b56\u7565-es",children:"\u8fdb\u5316\u7b56\u7565 (ES)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:'class EvolutionStrategy:\n    def __init__(self, n_params, pop_size=50, sigma=0.1, lr=0.01):\n        self.n_params = n_params\n        self.pop_size = pop_size\n        self.sigma = sigma\n        self.lr = lr\n        self.mean = np.zeros(n_params)\n\n    def ask(self):\n        """\u751f\u6210\u5019\u9009\u89e3"""\n        self.noise = np.random.randn(self.pop_size, self.n_params)\n        return self.mean + self.sigma * self.noise\n\n    def tell(self, fitness):\n        """\u66f4\u65b0\u5206\u5e03"""\n        # \u6807\u51c6\u5316\u9002\u5e94\u5ea6\n        fitness = (fitness - fitness.mean()) / (fitness.std() + 1e-8)\n\n        # \u52a0\u6743\u66f4\u65b0\n        grad = np.dot(self.noise.T, fitness) / (self.pop_size * self.sigma)\n        self.mean += self.lr * grad\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u795e\u7ecf\u7f51\u7edc\u6f14\u5316",children:"\u795e\u7ecf\u7f51\u7edc\u6f14\u5316"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# \u4f7f\u7528 ES \u8bad\u7ec3\u795e\u7ecf\u7f51\u7edc\ndef fitness_fn(params, env):\n    model = create_model(params)\n    total_reward = 0\n    obs = env.reset()\n    for _ in range(1000):\n        action = model(obs)\n        obs, reward, done, _ = env.step(action)\n        total_reward += reward\n        if done:\n            break\n    return total_reward\n\nes = EvolutionStrategy(n_params=model.num_params)\nfor gen in range(100):\n    candidates = es.ask()\n    fitness = [fitness_fn(c, env) for c in candidates]\n    es.tell(fitness)\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5e94\u7528\u573a\u666f",children:"\u5e94\u7528\u573a\u666f"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u5e94\u7528"}),(0,i.jsx)(e.th,{children:"\u65b9\u6cd5"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u8d85\u53c2\u6570\u4f18\u5316"}),(0,i.jsx)(e.td,{children:"GA, ES"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u795e\u7ecf\u67b6\u6784\u641c\u7d22"}),(0,i.jsx)(e.td,{children:"NEAT, ES"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5f3a\u5316\u5b66\u4e60"}),(0,i.jsx)(e.td,{children:"ES, CMA-ES"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u7279\u5f81\u9009\u62e9"}),(0,i.jsx)(e.td,{children:"GA"})]})]})]})]})}function c(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(p,{...n})}):p(n)}}}]);