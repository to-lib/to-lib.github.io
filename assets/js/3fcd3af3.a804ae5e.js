"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[56708],{3477:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"ml/meta-learning","title":"\ud83e\uddec \u5143\u5b66\u4e60","description":"\u5143\u5b66\u4e60\u662f\\"\u5b66\u4e60\u5982\u4f55\u5b66\u4e60\\"\uff0c\u4f7f\u6a21\u578b\u80fd\u591f\u5feb\u901f\u9002\u5e94\u65b0\u4efb\u52a1\u3002","source":"@site/docs/ml/meta-learning.md","sourceDirName":"ml","slug":"/ml/meta-learning","permalink":"/docs/ml/meta-learning","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/meta-learning.md","tags":[],"version":"current","sidebarPosition":28,"frontMatter":{"sidebar_position":28,"title":"\ud83e\uddec \u5143\u5b66\u4e60"},"sidebar":"ml","previous":{"title":"\ud83c\udfaf \u591a\u4efb\u52a1\u5b66\u4e60","permalink":"/docs/ml/multi-task-learning"},"next":{"title":"\ud83d\udd12 \u8054\u90a6\u5b66\u4e60","permalink":"/docs/ml/federated-learning"}}');var s=t(22714),i=t(48885);const o={sidebar_position:28,title:"\ud83e\uddec \u5143\u5b66\u4e60"},l="\u5143\u5b66\u4e60 (Meta-Learning)",a={},d=[{value:"\u6838\u5fc3\u601d\u60f3",id:"\u6838\u5fc3\u601d\u60f3",level:2},{value:"Few-Shot Learning",id:"few-shot-learning",level:2},{value:"MAML (Model-Agnostic Meta-Learning)",id:"maml-model-agnostic-meta-learning",level:2},{value:"Prototypical Networks",id:"prototypical-networks",level:2},{value:"Matching Networks",id:"matching-networks",level:2},{value:"\u65b9\u6cd5\u5bf9\u6bd4",id:"\u65b9\u6cd5\u5bf9\u6bd4",level:2}];function c(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",mermaid:"mermaid",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"\u5143\u5b66\u4e60-meta-learning",children:"\u5143\u5b66\u4e60 (Meta-Learning)"})}),"\n",(0,s.jsx)(e.p,{children:'\u5143\u5b66\u4e60\u662f"\u5b66\u4e60\u5982\u4f55\u5b66\u4e60"\uff0c\u4f7f\u6a21\u578b\u80fd\u591f\u5feb\u901f\u9002\u5e94\u65b0\u4efb\u52a1\u3002'}),"\n",(0,s.jsx)(e.h2,{id:"\u6838\u5fc3\u601d\u60f3",children:"\u6838\u5fc3\u601d\u60f3"}),"\n",(0,s.jsx)(e.mermaid,{value:"graph LR\n    A[\u4efb\u52a11] --\x3e B[Meta-Learner]\n    C[\u4efb\u52a12] --\x3e B\n    D[\u4efb\u52a13] --\x3e B\n    B --\x3e E[\u5b66\u4e60\u7b56\u7565]\n    E --\x3e F[\u5feb\u901f\u9002\u5e94\u65b0\u4efb\u52a1]"}),"\n",(0,s.jsx)(e.h2,{id:"few-shot-learning",children:"Few-Shot Learning"}),"\n",(0,s.jsx)(e.p,{children:"\u7ed9\u5b9a\u5c11\u91cf\u6837\u672c\u5b66\u4e60\u65b0\u7c7b\u522b\u3002"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u672f\u8bed"}),(0,s.jsx)(e.th,{children:"\u63cf\u8ff0"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"N-way"}),(0,s.jsx)(e.td,{children:"N \u4e2a\u7c7b\u522b"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"K-shot"}),(0,s.jsx)(e.td,{children:"\u6bcf\u7c7b K \u4e2a\u6837\u672c"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Support Set"}),(0,s.jsx)(e.td,{children:"\u7528\u4e8e\u5b66\u4e60\u7684\u5c11\u91cf\u6837\u672c"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Query Set"}),(0,s.jsx)(e.td,{children:"\u7528\u4e8e\u8bc4\u4f30\u7684\u6837\u672c"})]})]})]}),"\n",(0,s.jsx)(e.h2,{id:"maml-model-agnostic-meta-learning",children:"MAML (Model-Agnostic Meta-Learning)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import torch\nimport torch.nn as nn\nfrom copy import deepcopy\n\nclass MAML:\n    def __init__(self, model, lr_inner=0.01, lr_outer=0.001):\n        self.model = model\n        self.lr_inner = lr_inner\n        self.optimizer = torch.optim.Adam(model.parameters(), lr=lr_outer)\n\n    def inner_loop(self, support_x, support_y, num_steps=5):\n        # \u590d\u5236\u6a21\u578b\u53c2\u6570\n        fast_weights = {name: param.clone() for name, param in self.model.named_parameters()}\n\n        for _ in range(num_steps):\n            # \u524d\u5411\u4f20\u64ad\n            logits = self.model(support_x)\n            loss = nn.functional.cross_entropy(logits, support_y)\n\n            # \u8ba1\u7b97\u68af\u5ea6\u5e76\u66f4\u65b0\u5feb\u53c2\u6570\n            grads = torch.autograd.grad(loss, fast_weights.values(), create_graph=True)\n            fast_weights = {name: param - self.lr_inner * grad\n                           for (name, param), grad in zip(fast_weights.items(), grads)}\n\n        return fast_weights\n\n    def outer_loop(self, tasks):\n        meta_loss = 0\n\n        for support_x, support_y, query_x, query_y in tasks:\n            # \u5185\u5faa\u73af\uff1a\u5728\u652f\u6301\u96c6\u4e0a\u5feb\u901f\u9002\u5e94\n            fast_weights = self.inner_loop(support_x, support_y)\n\n            # \u5916\u5faa\u73af\uff1a\u5728\u67e5\u8be2\u96c6\u4e0a\u8ba1\u7b97\u635f\u5931\n            with torch.no_grad():\n                # \u4e34\u65f6\u4f7f\u7528 fast_weights\n                pass\n            logits = self.model(query_x)  # \u4f7f\u7528 fast_weights\n            meta_loss += nn.functional.cross_entropy(logits, query_y)\n\n        # \u66f4\u65b0\u5143\u53c2\u6570\n        self.optimizer.zero_grad()\n        meta_loss.backward()\n        self.optimizer.step()\n"})}),"\n",(0,s.jsx)(e.h2,{id:"prototypical-networks",children:"Prototypical Networks"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"class PrototypicalNetwork(nn.Module):\n    def __init__(self, encoder):\n        super().__init__()\n        self.encoder = encoder\n\n    def forward(self, support_x, support_y, query_x, n_way, k_shot):\n        # \u7f16\u7801\u6240\u6709\u6837\u672c\n        support_emb = self.encoder(support_x)  # (n_way * k_shot, dim)\n        query_emb = self.encoder(query_x)\n\n        # \u8ba1\u7b97\u6bcf\u7c7b\u7684\u539f\u578b\n        support_emb = support_emb.view(n_way, k_shot, -1)\n        prototypes = support_emb.mean(dim=1)  # (n_way, dim)\n\n        # \u8ba1\u7b97\u67e5\u8be2\u6837\u672c\u5230\u5404\u539f\u578b\u7684\u8ddd\u79bb\n        distances = torch.cdist(query_emb, prototypes)  # (n_query, n_way)\n\n        return -distances  # \u8d1f\u8ddd\u79bb\u4f5c\u4e3a logits\n"})}),"\n",(0,s.jsx)(e.h2,{id:"matching-networks",children:"Matching Networks"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"class MatchingNetwork(nn.Module):\n    def __init__(self, encoder):\n        super().__init__()\n        self.encoder = encoder\n\n    def forward(self, support_x, support_y, query_x):\n        support_emb = self.encoder(support_x)\n        query_emb = self.encoder(query_x)\n\n        # \u4f59\u5f26\u76f8\u4f3c\u5ea6\n        support_emb = nn.functional.normalize(support_emb, dim=1)\n        query_emb = nn.functional.normalize(query_emb, dim=1)\n        similarity = torch.mm(query_emb, support_emb.t())\n\n        # \u6ce8\u610f\u529b\u6743\u91cd\n        attention = nn.functional.softmax(similarity, dim=1)\n\n        # \u52a0\u6743\u9884\u6d4b\n        support_labels_onehot = nn.functional.one_hot(support_y)\n        predictions = torch.mm(attention, support_labels_onehot.float())\n\n        return predictions\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u65b9\u6cd5\u5bf9\u6bd4",children:"\u65b9\u6cd5\u5bf9\u6bd4"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u65b9\u6cd5"}),(0,s.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,s.jsx)(e.th,{children:"\u7279\u70b9"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"MAML"}),(0,s.jsx)(e.td,{children:"\u4f18\u5316"}),(0,s.jsx)(e.td,{children:"\u6a21\u578b\u65e0\u5173\uff0c\u4e8c\u9636\u5bfc\u6570"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Prototypical"}),(0,s.jsx)(e.td,{children:"\u5ea6\u91cf"}),(0,s.jsx)(e.td,{children:"\u7b80\u5355\u9ad8\u6548"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Matching"}),(0,s.jsx)(e.td,{children:"\u5ea6\u91cf"}),(0,s.jsx)(e.td,{children:"\u57fa\u4e8e\u6ce8\u610f\u529b"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Reptile"}),(0,s.jsx)(e.td,{children:"\u4f18\u5316"}),(0,s.jsx)(e.td,{children:"MAML \u7684\u7b80\u5316\u7248"})]})]})]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(c,{...n})}):c(n)}},48885:(n,e,t)=>{t.d(e,{R:()=>o,x:()=>l});var r=t(99378);const s={},i=r.createContext(s);function o(n){const e=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:o(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);