"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[8745],{48885:(e,n,l)=>{l.d(n,{R:()=>r,x:()=>c});var a=l(99378);const i={},s=a.createContext(i);function r(e){const n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(s.Provider,{value:n},e.children)}},74386:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>a,toc:()=>t});const a=JSON.parse('{"id":"rabbitmq/core-concepts","title":"\u6838\u5fc3\u6982\u5ff5","description":"RabbitMQ \u6838\u5fc3\u7ec4\u4ef6\u8be6\u89e3","source":"@site/docs/rabbitmq/core-concepts.md","sourceDirName":"rabbitmq","slug":"/rabbitmq/core-concepts","permalink":"/docs/rabbitmq/core-concepts","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/rabbitmq/core-concepts.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"\u6838\u5fc3\u6982\u5ff5","description":"RabbitMQ \u6838\u5fc3\u7ec4\u4ef6\u8be6\u89e3"}}');var i=l(22714),s=l(48885);const r={sidebar_position:3,title:"\u6838\u5fc3\u6982\u5ff5",description:"RabbitMQ \u6838\u5fc3\u7ec4\u4ef6\u8be6\u89e3"},c="RabbitMQ \u6838\u5fc3\u6982\u5ff5",d={},t=[{value:"\u6838\u5fc3\u7ec4\u4ef6\u6982\u89c8",id:"\u6838\u5fc3\u7ec4\u4ef6\u6982\u89c8",level:2},{value:"1. Connection (\u8fde\u63a5)",id:"1-connection-\u8fde\u63a5",level:2},{value:"\u7279\u70b9",id:"\u7279\u70b9",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b",level:3},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:3},{value:"2. Channel (\u901a\u9053)",id:"2-channel-\u901a\u9053",level:2},{value:"\u7279\u70b9",id:"\u7279\u70b9-1",level:3},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b-1",level:3},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5-1",level:3},{value:"3. Exchange (\u4ea4\u6362\u673a)",id:"3-exchange-\u4ea4\u6362\u673a",level:2},{value:"\u4ea4\u6362\u673a\u7c7b\u578b",id:"\u4ea4\u6362\u673a\u7c7b\u578b",level:3},{value:"3.1 Direct Exchange (\u76f4\u8fde\u4ea4\u6362\u673a)",id:"31-direct-exchange-\u76f4\u8fde\u4ea4\u6362\u673a",level:4},{value:"3.2 Fanout Exchange (\u6247\u51fa\u4ea4\u6362\u673a)",id:"32-fanout-exchange-\u6247\u51fa\u4ea4\u6362\u673a",level:4},{value:"3.3 Topic Exchange (\u4e3b\u9898\u4ea4\u6362\u673a)",id:"33-topic-exchange-\u4e3b\u9898\u4ea4\u6362\u673a",level:4},{value:"3.4 Headers Exchange (\u5934\u4ea4\u6362\u673a)",id:"34-headers-exchange-\u5934\u4ea4\u6362\u673a",level:4},{value:"4. Queue (\u961f\u5217)",id:"4-queue-\u961f\u5217",level:2},{value:"\u961f\u5217\u5c5e\u6027",id:"\u961f\u5217\u5c5e\u6027",level:3},{value:"\u961f\u5217\u53c2\u6570",id:"\u961f\u5217\u53c2\u6570",level:3},{value:"\u961f\u5217\u7c7b\u578b",id:"\u961f\u5217\u7c7b\u578b",level:3},{value:"Classic \u961f\u5217(\u7ecf\u5178\u961f\u5217)",id:"classic-\u961f\u5217\u7ecf\u5178\u961f\u5217",level:4},{value:"Quorum \u961f\u5217(\u4ef2\u88c1\u961f\u5217)",id:"quorum-\u961f\u5217\u4ef2\u88c1\u961f\u5217",level:4},{value:"Stream \u961f\u5217(\u6d41\u961f\u5217)",id:"stream-\u961f\u5217\u6d41\u961f\u5217",level:4},{value:"5. Binding (\u7ed1\u5b9a)",id:"5-binding-\u7ed1\u5b9a",level:2},{value:"\u7ed1\u5b9a\u793a\u4f8b",id:"\u7ed1\u5b9a\u793a\u4f8b",level:3},{value:"\u4ea4\u6362\u673a\u5230\u4ea4\u6362\u673a\u7ed1\u5b9a",id:"\u4ea4\u6362\u673a\u5230\u4ea4\u6362\u673a\u7ed1\u5b9a",level:3},{value:"6. Message (\u6d88\u606f)",id:"6-message-\u6d88\u606f",level:2},{value:"\u6d88\u606f\u5c5e\u6027",id:"\u6d88\u606f\u5c5e\u6027",level:3},{value:"\u6d88\u606f\u786e\u8ba4\u6a21\u5f0f",id:"\u6d88\u606f\u786e\u8ba4\u6a21\u5f0f",level:3},{value:"\u81ea\u52a8\u786e\u8ba4",id:"\u81ea\u52a8\u786e\u8ba4",level:4},{value:"\u624b\u52a8\u786e\u8ba4",id:"\u624b\u52a8\u786e\u8ba4",level:4},{value:"7. Virtual Host (\u865a\u62df\u4e3b\u673a)",id:"7-virtual-host-\u865a\u62df\u4e3b\u673a",level:2},{value:"\u7279\u70b9",id:"\u7279\u70b9-2",level:3},{value:"\u4f7f\u7528\u793a\u4f8b",id:"\u4f7f\u7528\u793a\u4f8b",level:3},{value:"\u547d\u4ee4\u884c\u7ba1\u7406",id:"\u547d\u4ee4\u884c\u7ba1\u7406",level:3},{value:"\u6d88\u606f\u6d41\u7a0b\u603b\u7ed3",id:"\u6d88\u606f\u6d41\u7a0b\u603b\u7ed3",level:2},{value:"\u4e0b\u4e00\u6b65\u5b66\u4e60",id:"\u4e0b\u4e00\u6b65\u5b66\u4e60",level:2},{value:"\u53c2\u8003\u8d44\u6e90",id:"\u53c2\u8003\u8d44\u6e90",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"rabbitmq-\u6838\u5fc3\u6982\u5ff5",children:"RabbitMQ \u6838\u5fc3\u6982\u5ff5"})}),"\n",(0,i.jsx)(n.h2,{id:"\u6838\u5fc3\u7ec4\u4ef6\u6982\u89c8",children:"\u6838\u5fc3\u7ec4\u4ef6\u6982\u89c8"}),"\n",(0,i.jsx)(n.p,{children:"RabbitMQ \u7684\u6d88\u606f\u4f20\u9012\u6a21\u578b\u7531\u51e0\u4e2a\u6838\u5fc3\u7ec4\u4ef6\u6784\u6210,\u7406\u89e3\u8fd9\u4e9b\u7ec4\u4ef6\u662f\u638c\u63e1 RabbitMQ \u7684\u5173\u952e\u3002"}),"\n",(0,i.jsx)(n.mermaid,{value:'graph TB\n    subgraph "RabbitMQ Server"\n        E1[Direct Exchange]\n        E2[Fanout Exchange]\n        E3[Topic Exchange]\n\n        Q1[Queue 1]\n        Q2[Queue 2]\n        Q3[Queue 3]\n\n        E1 --\x3e|Binding| Q1\n        E2 --\x3e|Binding| Q2\n        E3 --\x3e|Binding| Q3\n    end\n\n    P1[Producer 1] --\x3e|Publish| E1\n    P2[Producer 2] --\x3e|Publish| E2\n    P3[Producer 3] --\x3e|Publish| E3\n\n    Q1 --\x3e C1[Consumer 1]\n    Q2 --\x3e C2[Consumer 2]\n    Q3 --\x3e C3[Consumer 3]\n\n    style E1 fill:#ff6b6b,color:#fff\n    style E2 fill:#ff6b6b,color:#fff\n    style E3 fill:#ff6b6b,color:#fff\n    style Q1 fill:#4ecdc4,color:#fff\n    style Q2 fill:#4ecdc4,color:#fff\n    style Q3 fill:#4ecdc4,color:#fff'}),"\n",(0,i.jsx)(n.h2,{id:"1-connection-\u8fde\u63a5",children:"1. Connection (\u8fde\u63a5)"}),"\n",(0,i.jsx)(n.p,{children:"Connection \u662f\u5e94\u7528\u7a0b\u5e8f\u4e0e RabbitMQ \u670d\u52a1\u5668\u4e4b\u95f4\u7684 TCP \u8fde\u63a5\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u7279\u70b9",children:"\u7279\u70b9"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u57fa\u4e8e TCP \u534f\u8bae"}),"\n",(0,i.jsx)(n.li,{children:"\u957f\u8fde\u63a5,\u590d\u7528\u6027\u9ad8"}),"\n",(0,i.jsx)(n.li,{children:"\u652f\u6301\u5fc3\u8df3\u673a\u5236"}),"\n",(0,i.jsx)(n.li,{children:"\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a Channel"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'ConnectionFactory factory = new ConnectionFactory();\nfactory.setHost("localhost");\nfactory.setPort(5672);\nfactory.setUsername("guest");\nfactory.setPassword("guest");\nfactory.setVirtualHost("/");\n\n// \u8bbe\u7f6e\u8fde\u63a5\u8d85\u65f6\nfactory.setConnectionTimeout(30000);\n\n// \u8bbe\u7f6e\u5fc3\u8df3\u95f4\u9694\nfactory.setRequestedHeartbeat(60);\n\n// \u521b\u5efa\u8fde\u63a5\nConnection connection = factory.newConnection();\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4e00\u4e2a\u5e94\u7528\u7a0b\u5e8f\u901a\u5e38\u53ea\u9700\u8981\u4e00\u4e2a Connection"}),"\n",(0,i.jsx)(n.li,{children:"Connection \u662f\u7ebf\u7a0b\u5b89\u5168\u7684"}),"\n",(0,i.jsx)(n.li,{children:"\u4f7f\u7528\u5b8c\u6bd5\u540e\u8bb0\u5f97\u5173\u95ed\u8fde\u63a5"}),"\n",(0,i.jsx)(n.li,{children:"\u5b9e\u73b0\u8fde\u63a5\u91cd\u8fde\u673a\u5236"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"2-channel-\u901a\u9053",children:"2. Channel (\u901a\u9053)"}),"\n",(0,i.jsx)(n.p,{children:"Channel \u662f\u5728 Connection \u5185\u5efa\u7acb\u7684\u903b\u8f91\u8fde\u63a5,\u662f\u8fdb\u884c\u6d88\u606f\u64cd\u4f5c\u7684\u4e3b\u8981\u63a5\u53e3\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u7279\u70b9-1",children:"\u7279\u70b9"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u8f7b\u91cf\u7ea7,\u53ef\u4ee5\u521b\u5efa\u591a\u4e2a"}),"\n",(0,i.jsx)(n.li,{children:"\u5171\u4eab\u4e00\u4e2a TCP \u8fde\u63a5"}),"\n",(0,i.jsx)(n.li,{children:"\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684"}),"\n",(0,i.jsx)(n.li,{children:"\u6bcf\u4e2a\u7ebf\u7a0b\u5e94\u8be5\u4f7f\u7528\u72ec\u7acb\u7684 Channel"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4ee3\u7801\u793a\u4f8b-1",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// \u4ece\u8fde\u63a5\u4e2d\u521b\u5efa\u901a\u9053\nChannel channel = connection.createChannel();\n\n// \u8bbe\u7f6e\u901a\u9053\u7684 QoS\nchannel.basicQos(1); // \u4e00\u6b21\u53ea\u5904\u7406\u4e00\u6761\u6d88\u606f\n\n// \u58f0\u660e\u4ea4\u6362\u673a\nchannel.exchangeDeclare("my_exchange", "direct", true);\n\n// \u58f0\u660e\u961f\u5217\nchannel.queueDeclare("my_queue", true, false, false, null);\n\n// \u7ed1\u5b9a\u961f\u5217\u5230\u4ea4\u6362\u673a\nchannel.queueBind("my_queue", "my_exchange", "routing_key");\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u6700\u4f73\u5b9e\u8df5-1",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6bcf\u4e2a\u7ebf\u7a0b\u4f7f\u7528\u72ec\u7acb\u7684 Channel"}),"\n",(0,i.jsx)(n.li,{children:"\u4e0d\u8981\u5728\u591a\u4e2a\u7ebf\u7a0b\u95f4\u5171\u4eab Channel"}),"\n",(0,i.jsx)(n.li,{children:"\u5f02\u5e38\u53d1\u751f\u65f6,Channel \u4f1a\u88ab\u5173\u95ed"}),"\n",(0,i.jsx)(n.li,{children:"\u4f7f\u7528 Channel \u6c60\u7ba1\u7406\u5927\u91cf Channel"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"3-exchange-\u4ea4\u6362\u673a",children:"3. Exchange (\u4ea4\u6362\u673a)"}),"\n",(0,i.jsx)(n.p,{children:"Exchange \u8d1f\u8d23\u63a5\u6536\u751f\u4ea7\u8005\u53d1\u9001\u7684\u6d88\u606f,\u5e76\u6839\u636e\u89c4\u5219\u5c06\u6d88\u606f\u8def\u7531\u5230\u4e00\u4e2a\u6216\u591a\u4e2a\u961f\u5217\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u4ea4\u6362\u673a\u7c7b\u578b",children:"\u4ea4\u6362\u673a\u7c7b\u578b"}),"\n",(0,i.jsx)(n.h4,{id:"31-direct-exchange-\u76f4\u8fde\u4ea4\u6362\u673a",children:"3.1 Direct Exchange (\u76f4\u8fde\u4ea4\u6362\u673a)"}),"\n",(0,i.jsx)(n.p,{children:"\u6839\u636e\u8def\u7531\u952e\u7cbe\u786e\u5339\u914d\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// \u58f0\u660e Direct \u4ea4\u6362\u673a\nchannel.exchangeDeclare("direct_logs", "direct", true);\n\n// \u53d1\u9001\u6d88\u606f\u5230\u6307\u5b9a\u8def\u7531\u952e\nchannel.basicPublish("direct_logs", "error", null, message.getBytes());\n\n// \u7ed1\u5b9a\u961f\u5217\nchannel.queueBind(queueName, "direct_logs", "error");\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u4f7f\u7528\u573a\u666f:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u65e5\u5fd7\u7ea7\u522b\u8def\u7531(error, warning, info)"}),"\n",(0,i.jsx)(n.li,{children:"\u4efb\u52a1\u5206\u7c7b\u5904\u7406"}),"\n",(0,i.jsx)(n.li,{children:"\u9700\u8981\u7cbe\u786e\u5339\u914d\u7684\u573a\u666f"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"32-fanout-exchange-\u6247\u51fa\u4ea4\u6362\u673a",children:"3.2 Fanout Exchange (\u6247\u51fa\u4ea4\u6362\u673a)"}),"\n",(0,i.jsx)(n.p,{children:"\u5c06\u6d88\u606f\u5e7f\u64ad\u5230\u6240\u6709\u7ed1\u5b9a\u7684\u961f\u5217,\u5ffd\u7565\u8def\u7531\u952e\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// \u58f0\u660e Fanout \u4ea4\u6362\u673a\nchannel.exchangeDeclare("logs", "fanout", true);\n\n// \u53d1\u9001\u6d88\u606f(\u8def\u7531\u952e\u88ab\u5ffd\u7565)\nchannel.basicPublish("logs", "", null, message.getBytes());\n\n// \u7ed1\u5b9a\u961f\u5217\nchannel.queueBind(queueName, "logs", "");\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u4f7f\u7528\u573a\u666f:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u6d88\u606f\u5e7f\u64ad"}),"\n",(0,i.jsx)(n.li,{children:"\u5b9e\u65f6\u901a\u77e5"}),"\n",(0,i.jsx)(n.li,{children:"\u65e5\u5fd7\u6536\u96c6"}),"\n",(0,i.jsx)(n.li,{children:"\u7f13\u5b58\u540c\u6b65"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"33-topic-exchange-\u4e3b\u9898\u4ea4\u6362\u673a",children:"3.3 Topic Exchange (\u4e3b\u9898\u4ea4\u6362\u673a)"}),"\n",(0,i.jsx)(n.p,{children:"\u6839\u636e\u8def\u7531\u952e\u7684\u6a21\u5f0f\u5339\u914d\u8fdb\u884c\u8def\u7531\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// \u58f0\u660e Topic \u4ea4\u6362\u673a\nchannel.exchangeDeclare("topic_logs", "topic", true);\n\n// \u53d1\u9001\u6d88\u606f\nchannel.basicPublish("topic_logs", "kern.critical", null, message.getBytes());\n\n// \u7ed1\u5b9a\u961f\u5217(\u4f7f\u7528\u901a\u914d\u7b26)\nchannel.queueBind(queueName, "topic_logs", "kern.*");  // * \u5339\u914d\u4e00\u4e2a\u5355\u8bcd\nchannel.queueBind(queueName, "topic_logs", "*.critical"); // \u5339\u914d\u6240\u6709 critical\nchannel.queueBind(queueName, "topic_logs", "kern.#");  // # \u5339\u914d\u96f6\u4e2a\u6216\u591a\u4e2a\u5355\u8bcd\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u901a\u914d\u7b26\u89c4\u5219:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"*"})," (\u661f\u53f7): \u5339\u914d\u4e00\u4e2a\u5355\u8bcd"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"#"})," (\u4e95\u53f7): \u5339\u914d\u96f6\u4e2a\u6216\u591a\u4e2a\u5355\u8bcd"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u4f7f\u7528\u573a\u666f:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u590d\u6742\u8def\u7531\u89c4\u5219"}),"\n",(0,i.jsx)(n.li,{children:"\u591a\u7ef4\u5ea6\u6d88\u606f\u5206\u7c7b"}),"\n",(0,i.jsx)(n.li,{children:"\u7075\u6d3b\u7684\u8ba2\u9605\u6a21\u5f0f"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"34-headers-exchange-\u5934\u4ea4\u6362\u673a",children:"3.4 Headers Exchange (\u5934\u4ea4\u6362\u673a)"}),"\n",(0,i.jsx)(n.p,{children:"\u6839\u636e\u6d88\u606f\u5934\u5c5e\u6027\u8fdb\u884c\u8def\u7531,\u800c\u4e0d\u662f\u8def\u7531\u952e\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// \u58f0\u660e Headers \u4ea4\u6362\u673a\nchannel.exchangeDeclare("headers_exchange", "headers", true);\n\n// \u8bbe\u7f6e\u6d88\u606f\u5c5e\u6027\nMap<String, Object> headers = new HashMap<>();\nheaders.put("format", "pdf");\nheaders.put("type", "report");\n\nAMQP.BasicProperties properties = new AMQP.BasicProperties.Builder()\n    .headers(headers)\n    .build();\n\n// \u53d1\u9001\u6d88\u606f\nchannel.basicPublish("headers_exchange", "", properties, message.getBytes());\n\n// \u7ed1\u5b9a\u961f\u5217(x-match: all \u8868\u793a\u6240\u6709\u5934\u90fd\u8981\u5339\u914d)\nMap<String, Object> bindHeaders = new HashMap<>();\nbindHeaders.put("x-match", "all");\nbindHeaders.put("format", "pdf");\nbindHeaders.put("type", "report");\n\nchannel.queueBind(queueName, "headers_exchange", "", bindHeaders);\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u4f7f\u7528\u573a\u666f:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u9700\u8981\u57fa\u4e8e\u591a\u4e2a\u5c5e\u6027\u8def\u7531"}),"\n",(0,i.jsx)(n.li,{children:"\u8def\u7531\u952e\u4e0d\u591f\u7528\u7684\u573a\u666f"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"4-queue-\u961f\u5217",children:"4. Queue (\u961f\u5217)"}),"\n",(0,i.jsx)(n.p,{children:"Queue \u662f\u6d88\u606f\u7684\u5bb9\u5668,\u5b58\u50a8\u7b49\u5f85\u88ab\u6d88\u8d39\u7684\u6d88\u606f\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u961f\u5217\u5c5e\u6027",children:"\u961f\u5217\u5c5e\u6027"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'/**\n * \u58f0\u660e\u961f\u5217\n * @param queue \u961f\u5217\u540d\u79f0\n * @param durable \u6301\u4e45\u5316(\u91cd\u542f\u540e\u961f\u5217\u4f9d\u7136\u5b58\u5728)\n * @param exclusive \u6392\u4ed6\u6027(\u53ea\u80fd\u88ab\u4e00\u4e2a\u8fde\u63a5\u4f7f\u7528)\n * @param autoDelete \u81ea\u52a8\u5220\u9664(\u6ca1\u6709\u6d88\u8d39\u8005\u65f6\u81ea\u52a8\u5220\u9664)\n * @param arguments \u5176\u4ed6\u53c2\u6570\n */\nchannel.queueDeclare("my_queue",\n    true,     // durable\n    false,    // exclusive\n    false,    // autoDelete\n    null);    // arguments\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u961f\u5217\u53c2\u6570",children:"\u961f\u5217\u53c2\u6570"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'Map<String, Object> args = new HashMap<>();\n\n// \u6d88\u606f TTL(\u6beb\u79d2)\nargs.put("x-message-ttl", 60000);\n\n// \u961f\u5217 TTL(\u6beb\u79d2)\nargs.put("x-expires", 1800000);\n\n// \u961f\u5217\u6700\u5927\u957f\u5ea6\nargs.put("x-max-length", 1000);\n\n// \u961f\u5217\u6700\u5927\u5b57\u8282\u6570\nargs.put("x-max-length-bytes", 1048576);\n\n// \u6b7b\u4fe1\u4ea4\u6362\u673a\nargs.put("x-dead-letter-exchange", "dlx_exchange");\nargs.put("x-dead-letter-routing-key", "dead_letter");\n\n// \u961f\u5217\u6a21\u5f0f(lazy \u6216 default)\nargs.put("x-queue-mode", "lazy");\n\n// \u6700\u5927\u4f18\u5148\u7ea7\nargs.put("x-max-priority", 10);\n\nchannel.queueDeclare("my_queue", true, false, false, args);\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u961f\u5217\u7c7b\u578b",children:"\u961f\u5217\u7c7b\u578b"}),"\n",(0,i.jsx)(n.h4,{id:"classic-\u961f\u5217\u7ecf\u5178\u961f\u5217",children:"Classic \u961f\u5217(\u7ecf\u5178\u961f\u5217)"}),"\n",(0,i.jsx)(n.p,{children:"\u9ed8\u8ba4\u961f\u5217\u7c7b\u578b,\u9002\u5408\u5927\u591a\u6570\u573a\u666f\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"quorum-\u961f\u5217\u4ef2\u88c1\u961f\u5217",children:"Quorum \u961f\u5217(\u4ef2\u88c1\u961f\u5217)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'Map<String, Object> args = new HashMap<>();\nargs.put("x-queue-type", "quorum");\n\nchannel.queueDeclare("quorum_queue", true, false, false, args);\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u7279\u70b9:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u57fa\u4e8e Raft \u534f\u8bae"}),"\n",(0,i.jsx)(n.li,{children:"\u66f4\u597d\u7684\u6570\u636e\u5b89\u5168\u6027"}),"\n",(0,i.jsx)(n.li,{children:"\u9002\u5408\u5173\u952e\u4e1a\u52a1"}),"\n",(0,i.jsx)(n.li,{children:"RabbitMQ 3.8+ \u652f\u6301"}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"stream-\u961f\u5217\u6d41\u961f\u5217",children:"Stream \u961f\u5217(\u6d41\u961f\u5217)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'Map<String, Object> args = new HashMap<>();\nargs.put("x-queue-type", "stream");\nargs.put("x-max-length-bytes", 20000000000L); // 20GB\n\nchannel.queueDeclare("stream_queue", true, false, false, args);\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u7279\u70b9:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u652f\u6301\u6d88\u606f\u91cd\u590d\u6d88\u8d39"}),"\n",(0,i.jsx)(n.li,{children:"\u9002\u5408\u5927\u6570\u636e\u91cf\u573a\u666f"}),"\n",(0,i.jsx)(n.li,{children:"RabbitMQ 3.9+ \u652f\u6301"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"5-binding-\u7ed1\u5b9a",children:"5. Binding (\u7ed1\u5b9a)"}),"\n",(0,i.jsx)(n.p,{children:"Binding \u662f\u4ea4\u6362\u673a\u548c\u961f\u5217\u4e4b\u95f4\u7684\u5173\u7cfb,\u5b9a\u4e49\u4e86\u6d88\u606f\u7684\u8def\u7531\u89c4\u5219\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u7ed1\u5b9a\u793a\u4f8b",children:"\u7ed1\u5b9a\u793a\u4f8b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// \u7b80\u5355\u7ed1\u5b9a\nchannel.queueBind(queueName, exchangeName, routingKey);\n\n// \u5e26\u53c2\u6570\u7684\u7ed1\u5b9a\nMap<String, Object> bindArgs = new HashMap<>();\nbindArgs.put("x-match", "any");\nchannel.queueBind(queueName, exchangeName, "", bindArgs);\n\n// \u89e3\u9664\u7ed1\u5b9a\nchannel.queueUnbind(queueName, exchangeName, routingKey);\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u4ea4\u6362\u673a\u5230\u4ea4\u6362\u673a\u7ed1\u5b9a",children:"\u4ea4\u6362\u673a\u5230\u4ea4\u6362\u673a\u7ed1\u5b9a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// Exchange to Exchange binding\nchannel.exchangeBind("destination_exchange", "source_exchange", "routing_key");\n'})}),"\n",(0,i.jsx)(n.h2,{id:"6-message-\u6d88\u606f",children:"6. Message (\u6d88\u606f)"}),"\n",(0,i.jsx)(n.p,{children:"Message \u7531\u6d88\u606f\u4f53\u548c\u6d88\u606f\u5c5e\u6027\u7ec4\u6210\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u6d88\u606f\u5c5e\u6027",children:"\u6d88\u606f\u5c5e\u6027"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'AMQP.BasicProperties properties = new AMQP.BasicProperties.Builder()\n    // \u6301\u4e45\u5316\n    .deliveryMode(2)\n\n    // \u4f18\u5148\u7ea7(0-9)\n    .priority(5)\n\n    // \u5185\u5bb9\u7c7b\u578b\n    .contentType("application/json")\n\n    // \u5185\u5bb9\u7f16\u7801\n    .contentEncoding("UTF-8")\n\n    // \u6d88\u606f ID\n    .messageId(UUID.randomUUID().toString())\n\n    // \u65f6\u95f4\u6233\n    .timestamp(new Date())\n\n    // \u8fc7\u671f\u65f6\u95f4(\u6beb\u79d2)\n    .expiration("60000")\n\n    // \u76f8\u5173 ID\n    .correlationId("request-123")\n\n    // \u56de\u590d\u961f\u5217\n    .replyTo("reply_queue")\n\n    // \u7528\u6237 ID\n    .userId("admin")\n\n    // \u5e94\u7528 ID\n    .appId("my-app")\n\n    // \u81ea\u5b9a\u4e49\u5934\n    .headers(Collections.singletonMap("custom-header", "value"))\n\n    .build();\n\nchannel.basicPublish(exchangeName, routingKey, properties, messageBody);\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u6d88\u606f\u786e\u8ba4\u6a21\u5f0f",children:"\u6d88\u606f\u786e\u8ba4\u6a21\u5f0f"}),"\n",(0,i.jsx)(n.h4,{id:"\u81ea\u52a8\u786e\u8ba4",children:"\u81ea\u52a8\u786e\u8ba4"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"boolean autoAck = true;\nchannel.basicConsume(queueName, autoAck, deliverCallback, cancelCallback);\n"})}),"\n",(0,i.jsx)(n.h4,{id:"\u624b\u52a8\u786e\u8ba4",children:"\u624b\u52a8\u786e\u8ba4"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"boolean autoAck = false;\nDeliverCallback deliverCallback = (consumerTag, delivery) -> {\n    try {\n        // \u5904\u7406\u6d88\u606f\n        processMessage(delivery.getBody());\n\n        // \u786e\u8ba4\u6d88\u606f\n        channel.basicAck(delivery.getEnvelope().getDeliveryTag(), false);\n    } catch (Exception e) {\n        // \u62d2\u7edd\u6d88\u606f\u5e76\u91cd\u65b0\u5165\u961f\n        channel.basicNack(delivery.getEnvelope().getDeliveryTag(), false, true);\n    }\n};\n\nchannel.basicConsume(queueName, autoAck, deliverCallback, cancelCallback);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"7-virtual-host-\u865a\u62df\u4e3b\u673a",children:"7. Virtual Host (\u865a\u62df\u4e3b\u673a)"}),"\n",(0,i.jsx)(n.p,{children:"Virtual Host \u662f RabbitMQ \u4e2d\u7684\u903b\u8f91\u9694\u79bb\u5355\u5143,\u7c7b\u4f3c\u4e8e\u6570\u636e\u5e93\u4e2d\u7684\u547d\u540d\u7a7a\u95f4\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u7279\u70b9-2",children:"\u7279\u70b9"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4e0d\u540c\u7684 vhost \u4e4b\u95f4\u5b8c\u5168\u9694\u79bb"}),"\n",(0,i.jsx)(n.li,{children:"\u6bcf\u4e2a vhost \u6709\u81ea\u5df1\u7684\u4ea4\u6362\u673a\u3001\u961f\u5217\u548c\u7ed1\u5b9a"}),"\n",(0,i.jsx)(n.li,{children:"\u53ef\u4ee5\u4e3a\u4e0d\u540c\u7684 vhost \u8bbe\u7f6e\u4e0d\u540c\u7684\u6743\u9650"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4f7f\u7528\u793a\u4f8b",children:"\u4f7f\u7528\u793a\u4f8b"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'ConnectionFactory factory = new ConnectionFactory();\nfactory.setVirtualHost("/production");  // \u8bbe\u7f6e\u865a\u62df\u4e3b\u673a\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u547d\u4ee4\u884c\u7ba1\u7406",children:"\u547d\u4ee4\u884c\u7ba1\u7406"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# \u521b\u5efa\u865a\u62df\u4e3b\u673a\nrabbitmqctl add_vhost /my_vhost\n\n# \u5220\u9664\u865a\u62df\u4e3b\u673a\nrabbitmqctl delete_vhost /my_vhost\n\n# \u5217\u51fa\u6240\u6709\u865a\u62df\u4e3b\u673a\nrabbitmqctl list_vhosts\n\n# \u8bbe\u7f6e\u7528\u6237\u6743\u9650\nrabbitmqctl set_permissions -p /my_vhost username ".*" ".*" ".*"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u6d88\u606f\u6d41\u7a0b\u603b\u7ed3",children:"\u6d88\u606f\u6d41\u7a0b\u603b\u7ed3"}),"\n",(0,i.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant P as Producer\n    participant E as Exchange\n    participant Q as Queue\n    participant C as Consumer\n\n    P->>E: 1. Publish Message\n    Note over E: 2. \u6839\u636e\u8def\u7531\u89c4\u5219<br/>\u5339\u914d\u961f\u5217\n    E->>Q: 3. Route Message\n    Note over Q: 4. \u5b58\u50a8\u6d88\u606f\n    C->>Q: 5. Consume Message\n    Q->>C: 6. Deliver Message\n    C->>Q: 7. Ack/Nack\n    Note over Q: 8. \u5220\u9664/\u91cd\u65b0\u5165\u961f"}),"\n",(0,i.jsx)(n.h2,{id:"\u4e0b\u4e00\u6b65\u5b66\u4e60",children:"\u4e0b\u4e00\u6b65\u5b66\u4e60"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\ud83d\ude80 ",(0,i.jsx)(n.a,{href:"./quick-start.md",children:"\u5feb\u901f\u5f00\u59cb"})," - \u5b9e\u8df5\u8fd9\u4e9b\u6838\u5fc3\u6982\u5ff5"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83d\udcbb ",(0,i.jsx)(n.a,{href:"./java-client.md",children:"Java \u5ba2\u6237\u7aef"})," - \u5728\u4ee3\u7801\u4e2d\u5e94\u7528\u8fd9\u4e9b\u6982\u5ff5"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83d\udd27 ",(0,i.jsx)(n.a,{href:"./advanced-features.md",children:"\u9ad8\u7ea7\u7279\u6027"})," - \u5b66\u4e60\u66f4\u591a\u9ad8\u7ea7\u529f\u80fd"]}),"\n",(0,i.jsxs)(n.li,{children:["\ud83d\udcca ",(0,i.jsx)(n.a,{href:"./best-practices.md",children:"\u6700\u4f73\u5b9e\u8df5"})," - \u638c\u63e1\u4f7f\u7528\u6280\u5de7"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u53c2\u8003\u8d44\u6e90",children:"\u53c2\u8003\u8d44\u6e90"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.rabbitmq.com/tutorials/amqp-concepts.html",children:"RabbitMQ AMQP \u6982\u5ff5"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.rabbitmq.com/getstarted.html",children:"RabbitMQ \u5b98\u65b9\u6559\u7a0b"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\ud83d\udca1 \u63d0\u793a"}),": \u7406\u89e3\u8fd9\u4e9b\u6838\u5fc3\u6982\u5ff5\u662f\u9ad8\u6548\u4f7f\u7528 RabbitMQ \u7684\u57fa\u7840,\u5efa\u8bae\u901a\u8fc7\u5b9e\u9645\u7f16\u7801\u52a0\u6df1\u7406\u89e3\u3002"]})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);