"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[2560],{18299:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>a,default:()=>g,frontMatter:()=>o,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"springboot/i18n","title":"\u56fd\u9645\u5316 (i18n)","description":"[!TIP]","source":"@site/docs/springboot/i18n.md","sourceDirName":"springboot","slug":"/springboot/i18n","permalink":"/docs/springboot/i18n","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/springboot/i18n.md","tags":[],"version":"current","sidebarPosition":22,"frontMatter":{"sidebar_position":22},"sidebar":"springboot","previous":{"title":"\u6587\u4ef6\u4e0a\u4f20\u4e0b\u8f7d","permalink":"/docs/springboot/file-upload"},"next":{"title":"\u6570\u636e\u8bbf\u95ee","permalink":"/docs/springboot/data-access"}}');var l=s(22714),i=s(48885);const o={sidebar_position:22},a="\u56fd\u9645\u5316 (i18n)",t={},c=[{value:"\u57fa\u672c\u914d\u7f6e",id:"\u57fa\u672c\u914d\u7f6e",level:2},{value:"\u521b\u5efa\u8d44\u6e90\u6587\u4ef6",id:"\u521b\u5efa\u8d44\u6e90\u6587\u4ef6",level:3},{value:"messages.properties (\u9ed8\u8ba4\u82f1\u6587)",id:"messagesproperties-\u9ed8\u8ba4\u82f1\u6587",level:3},{value:"messages_zh_CN.properties (\u4e2d\u6587)",id:"messages_zh_cnproperties-\u4e2d\u6587",level:3},{value:"\u914d\u7f6e MessageSource",id:"\u914d\u7f6e-messagesource",level:3},{value:"\u4f7f\u7528\u56fd\u9645\u5316",id:"\u4f7f\u7528\u56fd\u9645\u5316",level:2},{value:"\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528",id:"\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528",level:3},{value:"\u5728 Controller \u4e2d\u4f7f\u7528",id:"\u5728-controller-\u4e2d\u4f7f\u7528",level:3},{value:"\u52a8\u6001\u5207\u6362\u8bed\u8a00",id:"\u52a8\u6001\u5207\u6362\u8bed\u8a00",level:2},{value:"\u6dfb\u52a0\u62e6\u622a\u5668",id:"\u6dfb\u52a0\u62e6\u622a\u5668",level:3},{value:"\u4f7f\u7528",id:"\u4f7f\u7528",level:3},{value:"\u9a8c\u8bc1\u6d88\u606f\u56fd\u9645\u5316",id:"\u9a8c\u8bc1\u6d88\u606f\u56fd\u9645\u5316",level:2},{value:"\u5b9e\u4f53\u7c7b",id:"\u5b9e\u4f53\u7c7b",level:3},{value:"ValidationMessages.properties",id:"validationmessagesproperties",level:3},{value:"\u5b8c\u6574\u793a\u4f8b",id:"\u5b8c\u6574\u793a\u4f8b",level:2},{value:"\u7edf\u4e00\u54cd\u5e94\u7c7b",id:"\u7edf\u4e00\u54cd\u5e94\u7c7b",level:3},{value:"\u5168\u5c40\u5f02\u5e38\u5904\u7406",id:"\u5168\u5c40\u5f02\u5e38\u5904\u7406",level:3},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"\u56fd\u9645\u5316-i18n",children:"\u56fd\u9645\u5316 (i18n)"})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["[!TIP]\n",(0,l.jsx)(n.strong,{children:"\u56fd\u9645\u5316\u7684\u91cd\u8981\u6027"}),": \u8ba9\u5e94\u7528\u652f\u6301\u591a\u8bed\u8a00\uff0c\u9762\u5411\u5168\u7403\u7528\u6237\uff0c\u63d0\u5347\u7528\u6237\u4f53\u9a8c\u3002Spring Boot \u63d0\u4f9b\u4e86\u5b8c\u5584\u7684\u56fd\u9645\u5316\u652f\u6301\u3002"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u57fa\u672c\u914d\u7f6e",children:"\u57fa\u672c\u914d\u7f6e"}),"\n",(0,l.jsx)(n.h3,{id:"\u521b\u5efa\u8d44\u6e90\u6587\u4ef6",children:"\u521b\u5efa\u8d44\u6e90\u6587\u4ef6"}),"\n",(0,l.jsxs)(n.p,{children:["\u5728 ",(0,l.jsx)(n.code,{children:"src/main/resources"})," \u76ee\u5f55\u4e0b\u521b\u5efa\u56fd\u9645\u5316\u8d44\u6e90\u6587\u4ef6\uff1a"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"resources/\n  \u251c\u2500\u2500 messages.properties (\u9ed8\u8ba4,\u82f1\u6587)\n  \u251c\u2500\u2500 messages_zh_CN.properties (\u4e2d\u6587\u7b80\u4f53)\n  \u251c\u2500\u2500 messages_zh_TW.properties (\u4e2d\u6587\u7e41\u4f53)\n  \u2514\u2500\u2500 messages_ja.properties (\u65e5\u8bed)\n"})}),"\n",(0,l.jsx)(n.h3,{id:"messagesproperties-\u9ed8\u8ba4\u82f1\u6587",children:"messages.properties (\u9ed8\u8ba4\u82f1\u6587)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-properties",children:"greeting=Hello\nwelcome=Welcome, {0}!\nuser.not.found=User not found\nerror.invalid.email=Invalid email format\n"})}),"\n",(0,l.jsx)(n.h3,{id:"messages_zh_cnproperties-\u4e2d\u6587",children:"messages_zh_CN.properties (\u4e2d\u6587)"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-properties",children:"greeting=\u4f60\u597d\nwelcome=\u6b22\u8fce, {0}!\nuser.not.found=\u7528\u6237\u672a\u627e\u5230\nerror.invalid.email=\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u914d\u7f6e-messagesource",children:"\u914d\u7f6e MessageSource"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Configuration\npublic class I18nConfig {\n    \n    @Bean\n    public MessageSource messageSource() {\n        ResourceBundleMessageSource messageSource = \n            new ResourceBundleMessageSource();\n        messageSource.setBasename("messages");\n        messageSource.setDefaultEncoding("UTF-8");\n        messageSource.setCacheSeconds(3600);\n        return messageSource;\n    }\n    \n    @Bean\n    public LocaleResolver localeResolver() {\n        // \u65b9\u5f0f1\uff1a\u4ece\u8bf7\u6c42\u5934\u83b7\u53d6\u8bed\u8a00\uff08\u63a8\u8350\uff09\n        AcceptHeaderLocaleResolver resolver = new AcceptHeaderLocaleResolver();\n        resolver.setDefaultLocale(Locale.SIMPLIFIED_CHINESE);\n        return resolver;\n        \n        // \u65b9\u5f0f2\uff1a\u4ece Cookie \u83b7\u53d6\n        // CookieLocaleResolver resolver = new CookieLocaleResolver();\n        // resolver.setDefaultLocale(Locale.SIMPLIFIED_CHINESE);\n        // return resolver;\n        \n        // \u65b9\u5f0f3\uff1a\u4ece Session \u83b7\u53d6\n        // SessionLocaleResolver resolver = new SessionLocaleResolver();\n        // resolver.setDefaultLocale(Locale.SIMPLIFIED_CHINESE);\n        // return resolver;\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u4f7f\u7528\u56fd\u9645\u5316",children:"\u4f7f\u7528\u56fd\u9645\u5316"}),"\n",(0,l.jsx)(n.h3,{id:"\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528",children:"\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Service\npublic class UserService {\n    \n    @Autowired\n    private MessageSource messageSource;\n    \n    public String getGreeting(Locale locale) {\n        return messageSource.getMessage("greeting", null, locale);\n    }\n    \n    public String getWelcomeMessage(String username, Locale locale) {\n        return messageSource.getMessage(\n            "welcome", \n            new Object[]{username}, \n            locale\n        );\n    }\n    \n    public void validateUser(User user, Locale locale) {\n        if (user == null) {\n            String message = messageSource.getMessage(\n                "user.not.found", null, locale);\n            throw new NotFoundException(message);\n        }\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u5728-controller-\u4e2d\u4f7f\u7528",children:"\u5728 Controller \u4e2d\u4f7f\u7528"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@RestController\n@RequestMapping("/api")\npublic class GreetingController {\n    \n    @Autowired\n    private MessageSource messageSource;\n    \n    @GetMapping("/greeting")\n    public ResponseEntity<String> greeting(\n            @RequestHeader(value = "Accept-Language", required = false) Locale locale) {\n        \n        String message = messageSource.getMessage("greeting", null, locale);\n        return ResponseEntity.ok(message);\n    }\n    \n    // \u4f7f\u7528 LocaleContextHolder\n    @GetMapping("/welcome")\n    public ResponseEntity<String> welcome(@RequestParam String name) {\n        Locale locale = LocaleContextHolder.getLocale();\n        String message = messageSource.getMessage(\n            "welcome", new Object[]{name}, locale);\n        return ResponseEntity.ok(message);\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u52a8\u6001\u5207\u6362\u8bed\u8a00",children:"\u52a8\u6001\u5207\u6362\u8bed\u8a00"}),"\n",(0,l.jsx)(n.h3,{id:"\u6dfb\u52a0\u62e6\u622a\u5668",children:"\u6dfb\u52a0\u62e6\u622a\u5668"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@Configuration\npublic class WebMvcConfig implements WebMvcConfigurer {\n    \n    @Override\n    public void addInterceptors(InterceptorRegistry registry) {\n        LocaleChangeInterceptor interceptor = new LocaleChangeInterceptor();\n        interceptor.setParamName("lang"); // URL\u53c2\u6570\u540d\n        registry.addInterceptor(interceptor);\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528",children:"\u4f7f\u7528"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"# \u5207\u6362\u5230\u4e2d\u6587\nGET /api/greeting?lang=zh_CN\n\n# \u5207\u6362\u5230\u82f1\u6587\nGET /api/greeting?lang=en\n\n# \u5207\u6362\u5230\u65e5\u8bed\nGET /api/greeting?lang=ja\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u9a8c\u8bc1\u6d88\u606f\u56fd\u9645\u5316",children:"\u9a8c\u8bc1\u6d88\u606f\u56fd\u9645\u5316"}),"\n",(0,l.jsx)(n.h3,{id:"\u5b9e\u4f53\u7c7b",children:"\u5b9e\u4f53\u7c7b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'public class User {\n    @NotBlank(message = "{user.username.notblank}")\n    @Size(min = 3, max = 20, message = "{user.username.size}")\n    private String username;\n    \n    @NotBlank(message = "{user.email.notblank}")\n    @Email(message = "{user.email.invalid}")\n    private String email;\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"validationmessagesproperties",children:"ValidationMessages.properties"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-properties",children:"user.username.notblank=\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\nuser.username.size=\u7528\u6237\u540d\u957f\u5ea6\u5fc5\u987b\u5728 {min} \u5230 {max} \u4e4b\u95f4\nuser.email.notblank=\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a\nuser.email.invalid=\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u5b8c\u6574\u793a\u4f8b",children:"\u5b8c\u6574\u793a\u4f8b"}),"\n",(0,l.jsx)(n.h3,{id:"\u7edf\u4e00\u54cd\u5e94\u7c7b",children:"\u7edf\u4e00\u54cd\u5e94\u7c7b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:"@Data\n@AllArgsConstructor\npublic class ApiResponse<T> {\n    private int code;\n    private String message;\n    private T data;\n    \n    public static <T> ApiResponse<T> success(String messageKey, T data) {\n        Locale locale = LocaleContextHolder.getLocale();\n        String message = SpringContextHolder.getBean(MessageSource.class)\n            .getMessage(messageKey, null, locale);\n        return new ApiResponse<>(200, message, data);\n    }\n    \n    public static <T> ApiResponse<T> error(String messageKey) {\n        Locale locale = LocaleContextHolder.getLocale();\n        String message = SpringContextHolder.getBean(MessageSource.class)\n            .getMessage(messageKey, null, locale);\n        return new ApiResponse<>(500, message, null);\n    }\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u5168\u5c40\u5f02\u5e38\u5904\u7406",children:"\u5168\u5c40\u5f02\u5e38\u5904\u7406"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'@RestControllerAdvice\npublic class GlobalExceptionHandler {\n    \n    @Autowired\n    private MessageSource messageSource;\n    \n    @ExceptionHandler(NotFoundException.class)\n    public ResponseEntity<ApiResponse<Void>> handleNotFound(\n            NotFoundException ex, Locale locale) {\n        \n        String message = messageSource.getMessage(\n            "user.not.found", null, locale);\n        return ResponseEntity.status(HttpStatus.NOT_FOUND)\n            .body(new ApiResponse<>(404, message, null));\n    }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["[!TIP]\n",(0,l.jsx)(n.strong,{children:"\u56fd\u9645\u5316\u6700\u4f73\u5b9e\u8df5"}),"\uff1a"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4f7f\u7528 UTF-8 \u7f16\u7801"})," - \u786e\u4fdd\u6240\u6709\u8d44\u6e90\u6587\u4ef6\u4f7f\u7528 UTF-8"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5408\u7406\u7684\u9ed8\u8ba4\u8bed\u8a00"})," - \u8bbe\u7f6e\u5408\u9002\u7684\u9ed8\u8ba4\u8bed\u8a00"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5360\u4f4d\u7b26\u53c2\u6570\u5316"})," - \u4f7f\u7528\u53c2\u6570\u800c\u975e\u786c\u7f16\u7801"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u7edf\u4e00\u7ba1\u7406"})," - \u5c06\u6240\u6709\u6587\u672c\u96c6\u4e2d\u5728\u8d44\u6e90\u6587\u4ef6\u4e2d"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6d4b\u8bd5\u8986\u76d6"})," - \u6d4b\u8bd5\u6240\u6709\u652f\u6301\u7684\u8bed\u8a00"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"MessageSource"})," - Spring \u56fd\u9645\u5316\u6838\u5fc3\u63a5\u53e3"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"LocaleResolver"})," - \u8bed\u8a00\u89e3\u6790\u5668"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u8d44\u6e90\u6587\u4ef6"})," - messages*.properties \u6587\u4ef6"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u52a8\u6001\u5207\u6362"})," - \u652f\u6301\u8fd0\u884c\u65f6\u5207\u6362\u8bed\u8a00"]}),"\n"]}),"\n",(0,l.jsxs)(n.p,{children:["\u4e0b\u4e00\u6b65\u5b66\u4e60 ",(0,l.jsx)(n.a,{href:"/docs/springboot/devtools",children:"\u5f00\u53d1\u8005\u5de5\u5177"}),"\u3002"]})]})}function g(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},48885:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>a});var r=s(99378);const l={},i=r.createContext(l);function o(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:o(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);