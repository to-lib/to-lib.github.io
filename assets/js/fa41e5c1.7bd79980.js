"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[5055],{998:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"spring/bean-management","title":"Bean\u7ba1\u7406","description":"1. Bean\u7684\u5b9a\u4e49","source":"@site/docs/spring/bean-management.md","sourceDirName":"spring","slug":"/spring/bean-management","permalink":"/docs/spring/bean-management","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/spring/bean-management.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"id":"bean-management","title":"Bean\u7ba1\u7406","sidebar_label":"Bean\u7ba1\u7406","sidebar_position":4},"sidebar":"docs","previous":{"title":"\u4f9d\u8d56\u6ce8\u5165","permalink":"/docs/spring/dependency-injection"},"next":{"title":"AOP","permalink":"/docs/spring/aop"}}');var t=i(2714),a=i(1266);const o={id:"bean-management",title:"Bean\u7ba1\u7406",sidebar_label:"Bean\u7ba1\u7406",sidebar_position:4},s="Bean\u7ba1\u7406",c={},l=[{value:"1. Bean\u7684\u5b9a\u4e49",id:"1-bean\u7684\u5b9a\u4e49",level:2},{value:"1.1 \u4f7f\u7528@Bean\u6ce8\u89e3",id:"11-\u4f7f\u7528bean\u6ce8\u89e3",level:3},{value:"1.2 \u4f7f\u7528@Component\u6ce8\u89e3",id:"12-\u4f7f\u7528component\u6ce8\u89e3",level:3},{value:"1.3 XML\u914d\u7f6e",id:"13-xml\u914d\u7f6e",level:3},{value:"2. Bean\u7684\u547d\u540d",id:"2-bean\u7684\u547d\u540d",level:2},{value:"2.1 \u6307\u5b9aBean\u540d\u79f0",id:"21-\u6307\u5b9abean\u540d\u79f0",level:3},{value:"2.2 \u8bbf\u95eeBean",id:"22-\u8bbf\u95eebean",level:3},{value:"3. Bean\u7684\u4f5c\u7528\u57df",id:"3-bean\u7684\u4f5c\u7528\u57df",level:2},{value:"3.1 \u5355\u4f8b\u4f5c\u7528\u57df\uff08Singleton\uff09",id:"31-\u5355\u4f8b\u4f5c\u7528\u57dfsingleton",level:3},{value:"3.2 \u539f\u578b\u4f5c\u7528\u57df\uff08Prototype\uff09",id:"32-\u539f\u578b\u4f5c\u7528\u57dfprototype",level:3},{value:"3.3 Web\u5e94\u7528\u4f5c\u7528\u57df",id:"33-web\u5e94\u7528\u4f5c\u7528\u57df",level:3},{value:"3.4 \u5728\u5355\u4f8bBean\u4e2d\u6ce8\u5165\u539f\u578bBean",id:"34-\u5728\u5355\u4f8bbean\u4e2d\u6ce8\u5165\u539f\u578bbean",level:3},{value:"4. \u61d2\u52a0\u8f7d",id:"4-\u61d2\u52a0\u8f7d",level:2},{value:"5. \u6761\u4ef6\u5316Bean",id:"5-\u6761\u4ef6\u5316bean",level:2},{value:"5.1 @Conditional\u6ce8\u89e3",id:"51-conditional\u6ce8\u89e3",level:3},{value:"5.2 Spring Boot\u6761\u4ef6\u6ce8\u89e3",id:"52-spring-boot\u6761\u4ef6\u6ce8\u89e3",level:3},{value:"6. Bean\u7684\u521d\u59cb\u5316\u548c\u9500\u6bc1",id:"6-bean\u7684\u521d\u59cb\u5316\u548c\u9500\u6bc1",level:2},{value:"6.1 \u4f7f\u7528\u751f\u547d\u5468\u671f\u6ce8\u89e3",id:"61-\u4f7f\u7528\u751f\u547d\u5468\u671f\u6ce8\u89e3",level:3},{value:"6.2 \u4f7f\u7528InitializingBean\u548cDisposableBean",id:"62-\u4f7f\u7528initializingbean\u548cdisposablebean",level:3},{value:"6.3 \u4f7f\u7528initMethod\u548cdestroyMethod",id:"63-\u4f7f\u7528initmethod\u548cdestroymethod",level:3},{value:"6.4 \u5b8c\u6574\u793a\u4f8b",id:"64-\u5b8c\u6574\u793a\u4f8b",level:3},{value:"7. Primary Bean\u548cQualifier",id:"7-primary-bean\u548cqualifier",level:2},{value:"8. \u83b7\u53d6Bean\u4fe1\u606f",id:"8-\u83b7\u53d6bean\u4fe1\u606f",level:2},{value:"9. \u603b\u7ed3",id:"9-\u603b\u7ed3",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"bean\u7ba1\u7406",children:"Bean\u7ba1\u7406"})}),"\n",(0,t.jsx)(n.h2,{id:"1-bean\u7684\u5b9a\u4e49",children:"1. Bean\u7684\u5b9a\u4e49"}),"\n",(0,t.jsx)(n.h3,{id:"11-\u4f7f\u7528bean\u6ce8\u89e3",children:"1.1 \u4f7f\u7528@Bean\u6ce8\u89e3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Configuration\npublic class AppConfig {\n    // \u57fa\u672cBean\u5b9a\u4e49\n    @Bean\n    public UserRepository userRepository() {\n        return new UserRepository();\n    }\n    \n    // \u4f9d\u8d56\u6ce8\u5165\n    @Bean\n    public UserService userService(UserRepository userRepository) {\n        return new UserService(userRepository);\n    }\n    \n    // \u4f7f\u7528\u65b9\u6cd5\u53c2\u6570\u83b7\u53d6\u4f9d\u8d56\n    @Bean\n    public OrderService orderService(UserService userService, ProductService productService) {\n        return new OrderService(userService, productService);\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"12-\u4f7f\u7528component\u6ce8\u89e3",children:"1.2 \u4f7f\u7528@Component\u6ce8\u89e3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Component\npublic class UserRepository {\n    // \u81ea\u52a8\u6ce8\u518c\u4e3aBean\n}\n\n@Service  // @Component\u7684\u7279\u5316\npublic class UserService {\n    @Autowired\n    private UserRepository userRepository;\n}\n\n@Repository  // @Component\u7684\u7279\u5316\npublic class UserRepository {\n    // \u6570\u636e\u8bbf\u95ee\u5c42\u7ec4\u4ef6\n}\n\n@Controller  // @Component\u7684\u7279\u5316\npublic class UserController {\n    // \u63a7\u5236\u5c42\u7ec4\u4ef6\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"13-xml\u914d\u7f6e",children:"1.3 XML\u914d\u7f6e"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8"?>\n<beans xmlns="http://www.springframework.org/schema/beans"\n       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n       xsi:schemaLocation="http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans.xsd">\n    \n    \x3c!-- \u57fa\u672cBean\u5b9a\u4e49 --\x3e\n    <bean id="userRepository" class="com.example.repository.UserRepository" />\n    \n    \x3c!-- \u4f7f\u7528constructor-arg\u6ce8\u5165 --\x3e\n    <bean id="userService" class="com.example.service.UserService">\n        <constructor-arg ref="userRepository" />\n    </bean>\n    \n    \x3c!-- \u4f7f\u7528property\u6ce8\u5165 --\x3e\n    <bean id="orderService" class="com.example.service.OrderService">\n        <property name="userService" ref="userService" />\n        <property name="productService" ref="productService" />\n    </bean>\n    \n    \x3c!-- \u5de5\u5382\u65b9\u6cd5\u521b\u5efaBean --\x3e\n    <bean id="userFactory" class="com.example.factory.UserFactory" />\n    <bean id="user" factory-bean="userFactory" factory-method="createUser" />\n</beans>\n'})}),"\n",(0,t.jsx)(n.h2,{id:"2-bean\u7684\u547d\u540d",children:"2. Bean\u7684\u547d\u540d"}),"\n",(0,t.jsx)(n.h3,{id:"21-\u6307\u5b9abean\u540d\u79f0",children:"2.1 \u6307\u5b9aBean\u540d\u79f0"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'// \u4f7f\u7528@Bean\u6307\u5b9a\u540d\u79f0\n@Configuration\npublic class AppConfig {\n    @Bean(name = "userRepo")\n    public UserRepository userRepository() {\n        return new UserRepository();\n    }\n    \n    // \u591a\u4e2a\u522b\u540d\n    @Bean(name = {"userRepository", "userRepo", "repo"})\n    public UserRepository userRepository() {\n        return new UserRepository();\n    }\n}\n\n// \u4f7f\u7528@Component\u6307\u5b9a\u540d\u79f0\n@Component("userService")\npublic class UserService {\n}\n\n// \u4f7f\u7528@Component\u9ed8\u8ba4\u540d\u79f0\uff08\u7c7b\u540d\u9996\u5b57\u6bcd\u5c0f\u5199\uff09\n@Component\npublic class UserService {  // Bean\u540d\u79f0\u4e3a userService\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"22-\u8bbf\u95eebean",children:"2.2 \u8bbf\u95eeBean"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Autowired\nApplicationContext applicationContext;\n\npublic void accessBeans() {\n    // \u6309\u7c7b\u578b\u83b7\u53d6\n    UserService userService = applicationContext.getBean(UserService.class);\n    \n    // \u6309\u540d\u79f0\u83b7\u53d6\n    UserService userService = (UserService) applicationContext.getBean("userService");\n    \n    // \u6309\u540d\u79f0\u548c\u7c7b\u578b\u83b7\u53d6\n    UserService userService = applicationContext.getBean("userService", UserService.class);\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"3-bean\u7684\u4f5c\u7528\u57df",children:"3. Bean\u7684\u4f5c\u7528\u57df"}),"\n",(0,t.jsx)(n.h3,{id:"31-\u5355\u4f8b\u4f5c\u7528\u57dfsingleton",children:"3.1 \u5355\u4f8b\u4f5c\u7528\u57df\uff08Singleton\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Component\n@Scope("singleton")  // \u6216\u4f7f\u7528 @Scope(ConfigurableBeanFactory.SCOPE_SINGLETON)\npublic class UserService {\n    // \u5bb9\u5668\u4e2d\u53ea\u6709\u4e00\u4e2a\u5b9e\u4f8b\n}\n\n// \u9a8c\u8bc1\u5355\u4f8b\n@Test\npublic void testSingleton() {\n    UserService service1 = context.getBean(UserService.class);\n    UserService service2 = context.getBean(UserService.class);\n    \n    assertSame(service1, service2);  // \u540c\u4e00\u4e2a\u5b9e\u4f8b\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"32-\u539f\u578b\u4f5c\u7528\u57dfprototype",children:"3.2 \u539f\u578b\u4f5c\u7528\u57df\uff08Prototype\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Component\n@Scope("prototype")  // \u6216\u4f7f\u7528 @Scope(ConfigurableBeanFactory.SCOPE_PROTOTYPE)\npublic class RequestData {\n    // \u6bcf\u6b21\u83b7\u53d6\u90fd\u521b\u5efa\u65b0\u5b9e\u4f8b\n}\n\n// \u9a8c\u8bc1\u539f\u578b\n@Test\npublic void testPrototype() {\n    RequestData data1 = context.getBean(RequestData.class);\n    RequestData data2 = context.getBean(RequestData.class);\n    \n    assertNotSame(data1, data2);  // \u4e0d\u540c\u7684\u5b9e\u4f8b\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"33-web\u5e94\u7528\u4f5c\u7528\u57df",children:"3.3 Web\u5e94\u7528\u4f5c\u7528\u57df"}),"\n",(0,t.jsx)(n.p,{children:"\u5728Spring MVC/Web\u73af\u5883\u4e2d\u53ef\u7528\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'// \u8bf7\u6c42\u4f5c\u7528\u57df - \u6bcf\u4e2aHTTP\u8bf7\u6c42\u4e00\u4e2a\u5b9e\u4f8b\n@Component\n@Scope(value = "request", proxyMode = ScopedProxyMode.TARGET_CLASS)\npublic class RequestContext {\n    private String requestId;\n    \n    @PostConstruct\n    public void init() {\n        requestId = UUID.randomUUID().toString();\n    }\n}\n\n// \u4f1a\u8bdd\u4f5c\u7528\u57df - \u6bcf\u4e2aHTTP\u4f1a\u8bdd\u4e00\u4e2a\u5b9e\u4f8b\n@Component\n@Scope(value = "session", proxyMode = ScopedProxyMode.TARGET_CLASS)\npublic class UserSession {\n    private User currentUser;\n}\n\n// \u5e94\u7528\u4f5c\u7528\u57df - \u5e94\u7528\u542f\u52a8\u5230\u5173\u95ed\u671f\u95f4\u4e00\u4e2a\u5b9e\u4f8b\n@Component\n@Scope("application")\npublic class ApplicationConfig {\n    private String appName;\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"34-\u5728\u5355\u4f8bbean\u4e2d\u6ce8\u5165\u539f\u578bbean",children:"3.4 \u5728\u5355\u4f8bBean\u4e2d\u6ce8\u5165\u539f\u578bBean"}),"\n",(0,t.jsx)(n.p,{children:"\u95ee\u9898\uff1a\u5355\u4f8bBean\u4e2d\u7684\u539f\u578bBean\u53ea\u88ab\u6ce8\u5165\u4e00\u6b21\u3002"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Component\npublic class SingletonService {\n    @Autowired\n    private PrototypeService prototypeService;  // \u53ea\u6ce8\u5165\u4e00\u6b21\n    \n    public void process() {\n        prototypeService.execute();  // \u6bcf\u6b21\u90fd\u4f7f\u7528\u540c\u4e00\u4e2a\u5b9e\u4f8b\n    }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u89e3\u51b3\u65b9\u68481\uff1a\u4f7f\u7528ObjectFactory"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Component\npublic class SingletonService {\n    @Autowired\n    private ObjectFactory<PrototypeService> prototypeBeanFactory;\n    \n    public void process() {\n        PrototypeService prototypeService = prototypeBeanFactory.getObject();\n        prototypeService.execute();  // \u6bcf\u6b21\u90fd\u83b7\u53d6\u65b0\u5b9e\u4f8b\n    }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u89e3\u51b3\u65b9\u68482\uff1a\u4f7f\u7528ObjectProvider"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Component\npublic class SingletonService {\n    @Autowired\n    private ObjectProvider<PrototypeService> prototypeBeanProvider;\n    \n    public void process() {\n        PrototypeService prototypeService = prototypeBeanProvider.getObject();\n        prototypeService.execute();  // \u6bcf\u6b21\u90fd\u83b7\u53d6\u65b0\u5b9e\u4f8b\n    }\n}\n"})}),"\n",(0,t.jsx)(n.p,{children:"\u89e3\u51b3\u65b9\u68483\uff1a\u4f7f\u7528Lookup Method"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:"@Component\npublic abstract class SingletonService {\n    @Lookup\n    protected abstract PrototypeService getPrototypeService();\n    \n    public void process() {\n        PrototypeService service = getPrototypeService();  // \u6bcf\u6b21\u90fd\u83b7\u53d6\u65b0\u5b9e\u4f8b\n        service.execute();\n    }\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"4-\u61d2\u52a0\u8f7d",children:"4. \u61d2\u52a0\u8f7d"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'// \u5bb9\u5668\u542f\u52a8\u65f6\u4e0d\u521b\u5efaBean\uff0c\u800c\u662f\u5728\u9996\u6b21\u4f7f\u7528\u65f6\u521b\u5efa\n@Component\n@Lazy\npublic class ExpensiveService {\n    public ExpensiveService() {\n        System.out.println("ExpensiveService created!");\n    }\n}\n\n// @Bean\u4e5f\u53ef\u4ee5\u4f7f\u7528@Lazy\n@Configuration\npublic class AppConfig {\n    @Bean\n    @Lazy\n    public ExpensiveService expensiveService() {\n        System.out.println("Creating ExpensiveService");\n        return new ExpensiveService();\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"5-\u6761\u4ef6\u5316bean",children:"5. \u6761\u4ef6\u5316Bean"}),"\n",(0,t.jsx)(n.h3,{id:"51-conditional\u6ce8\u89e3",children:"5.1 @Conditional\u6ce8\u89e3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'// \u81ea\u5b9a\u4e49\u6761\u4ef6\npublic class RedisCondition implements Condition {\n    @Override\n    public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {\n        return context.getEnvironment().containsProperty("redis.host");\n    }\n}\n\n// \u4f7f\u7528\u6761\u4ef6\n@Configuration\npublic class CacheConfig {\n    @Bean\n    @Conditional(RedisCondition.class)\n    public CacheManager redisCacheManager() {\n        return new RedisCacheManager();\n    }\n    \n    @Bean\n    @ConditionalOnMissingBean\n    public CacheManager defaultCacheManager() {\n        return new DefaultCacheManager();\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"52-spring-boot\u6761\u4ef6\u6ce8\u89e3",children:"5.2 Spring Boot\u6761\u4ef6\u6ce8\u89e3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'// \u5f53\u7c7b\u5728classpath\u4e0a\u65f6\n@ConditionalOnClass(RedisTemplate.class)\npublic class RedisAutoConfiguration {\n}\n\n// \u5f53\u5c5e\u6027\u5b58\u5728\u65f6\n@ConditionalOnProperty(name = "cache.enabled", havingValue = "true")\n@Configuration\npublic class CacheConfiguration {\n}\n\n// \u5f53Bean\u4e0d\u5b58\u5728\u65f6\n@ConditionalOnMissingBean(CacheManager.class)\n@Bean\npublic CacheManager defaultCacheManager() {\n    return new DefaultCacheManager();\n}\n\n// \u5f53\u5bb9\u5668\u4e2d\u6709\u6307\u5b9aBean\u65f6\n@ConditionalOnBean(DataSource.class)\n@Configuration\npublic class JdbcConfiguration {\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"6-bean\u7684\u521d\u59cb\u5316\u548c\u9500\u6bc1",children:"6. Bean\u7684\u521d\u59cb\u5316\u548c\u9500\u6bc1"}),"\n",(0,t.jsx)(n.h3,{id:"61-\u4f7f\u7528\u751f\u547d\u5468\u671f\u6ce8\u89e3",children:"6.1 \u4f7f\u7528\u751f\u547d\u5468\u671f\u6ce8\u89e3"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Component\npublic class DataSource {\n    private Connection connection;\n    \n    @PostConstruct\n    public void init() {\n        System.out.println("\u521d\u59cb\u5316\u8fde\u63a5");\n        this.connection = createConnection();\n    }\n    \n    @PreDestroy\n    public void cleanup() {\n        System.out.println("\u5173\u95ed\u8fde\u63a5");\n        if (connection != null) {\n            connection.close();\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"62-\u4f7f\u7528initializingbean\u548cdisposablebean",children:"6.2 \u4f7f\u7528InitializingBean\u548cDisposableBean"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Component\npublic class DataSource implements InitializingBean, DisposableBean {\n    private Connection connection;\n    \n    @Override\n    public void afterPropertiesSet() throws Exception {\n        System.out.println("\u5c5e\u6027\u8bbe\u7f6e\u5b8c\u6210\uff0c\u8fdb\u884c\u521d\u59cb\u5316");\n        this.connection = createConnection();\n    }\n    \n    @Override\n    public void destroy() throws Exception {\n        System.out.println("\u9500\u6bc1\u65f6\u8c03\u7528");\n        if (connection != null) {\n            connection.close();\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"63-\u4f7f\u7528initmethod\u548cdestroymethod",children:"6.3 \u4f7f\u7528initMethod\u548cdestroyMethod"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Configuration\npublic class AppConfig {\n    @Bean(initMethod = "init", destroyMethod = "cleanup")\n    public DataSource dataSource() {\n        return new DataSource();\n    }\n}\n\n// \u6216\u5728XML\u4e2d\n// <bean id="dataSource" class="com.example.DataSource"\n//       init-method="init"\n//       destroy-method="cleanup" />\n'})}),"\n",(0,t.jsx)(n.h3,{id:"64-\u5b8c\u6574\u793a\u4f8b",children:"6.4 \u5b8c\u6574\u793a\u4f8b"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Component\npublic class DatabaseConnection implements InitializingBean, DisposableBean {\n    private Connection connection;\n    private String host;\n    private int port;\n    \n    @Autowired\n    private ApplicationContext applicationContext;\n    \n    @PostConstruct\n    public void init() {\n        System.out.println("1. @PostConstruct - \u521d\u59cb\u5316\u5f00\u59cb");\n    }\n    \n    @Override\n    public void afterPropertiesSet() throws Exception {\n        System.out.println("2. afterPropertiesSet - \u5c5e\u6027\u8bbe\u7f6e\u5b8c\u6210");\n        this.connection = DriverManager.getConnection(\n            String.format("jdbc:mysql://%s:%d/test", host, port));\n    }\n    \n    public void customInit() {\n        System.out.println("3. customInit - \u81ea\u5b9a\u4e49\u521d\u59cb\u5316");\n    }\n    \n    @PreDestroy\n    public void preDestroy() {\n        System.out.println("4. @PreDestroy - \u9500\u6bc1\u524d");\n    }\n    \n    @Override\n    public void destroy() throws Exception {\n        System.out.println("5. destroy - \u9500\u6bc1\u8d44\u6e90");\n        if (connection != null) {\n            connection.close();\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"\u751f\u547d\u5468\u671f\u987a\u5e8f\uff1a"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"@PostConstruct"}),"\n",(0,t.jsx)(n.li,{children:"afterPropertiesSet()"}),"\n",(0,t.jsx)(n.li,{children:"\u81ea\u5b9a\u4e49init-method/initMethod"}),"\n",(0,t.jsx)(n.li,{children:"\u4f7f\u7528\u4e2d..."}),"\n",(0,t.jsx)(n.li,{children:"@PreDestroy"}),"\n",(0,t.jsx)(n.li,{children:"destroy()"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"7-primary-bean\u548cqualifier",children:"7. Primary Bean\u548cQualifier"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'// \u5b9a\u4e49\u591a\u4e2a\u5b9e\u73b0\n@Component\npublic class MysqlRepository implements UserRepository {\n}\n\n@Component\n@Primary  // \u6807\u8bb0\u4e3a\u4e3b\u8981\u5b9e\u73b0\npublic class MongoRepository implements UserRepository {\n}\n\n// \u6ce8\u5165\u65f6\n@Component\npublic class UserService {\n    // \u9ed8\u8ba4\u6ce8\u5165MongoRepository\uff08\u56e0\u4e3a\u662f@Primary\uff09\n    @Autowired\n    private UserRepository repository;\n    \n    // \u6307\u5b9a\u6ce8\u5165MysqlRepository\n    @Autowired\n    @Qualifier("mysqlRepository")\n    private UserRepository mysqlRepository;\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"8-\u83b7\u53d6bean\u4fe1\u606f",children:"8. \u83b7\u53d6Bean\u4fe1\u606f"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'@Autowired\nprivate ApplicationContext applicationContext;\n\npublic void inspectBeans() {\n    // \u83b7\u53d6\u6240\u6709Bean\u540d\u79f0\n    String[] beanNames = applicationContext.getBeanDefinitionNames();\n    Arrays.stream(beanNames).forEach(System.out::println);\n    \n    // \u68c0\u67e5Bean\u662f\u5426\u5b58\u5728\n    boolean exists = applicationContext.containsBean("userService");\n    \n    // \u83b7\u53d6Bean\u5b9a\u4e49\n    BeanDefinition definition = applicationContext.getBeanDefinition("userService");\n    System.out.println("Scope: " + definition.getScope());\n    \n    // \u83b7\u53d6\u6240\u6709\u7279\u5b9a\u7c7b\u578b\u7684Bean\n    Map<String, UserRepository> repos = applicationContext.getBeansOfType(UserRepository.class);\n    repos.forEach((name, repo) -> System.out.println(name + ": " + repo));\n    \n    // \u83b7\u53d6\u5e26\u6307\u5b9a\u6ce8\u89e3\u7684Bean\n    Map<String, Object> beans = applicationContext.getBeansWithAnnotation(Component.class);\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"9-\u603b\u7ed3",children:"9. \u603b\u7ed3"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u529f\u80fd"}),(0,t.jsx)(n.th,{children:"\u8bf4\u660e"}),(0,t.jsx)(n.th,{children:"\u63a8\u8350\u7528\u6cd5"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"@Bean"}),(0,t.jsx)(n.td,{children:"\u5728\u914d\u7f6e\u7c7b\u4e2d\u5b9a\u4e49Bean"}),(0,t.jsx)(n.td,{children:"\u7b2c\u4e09\u65b9\u7c7b"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"@Component"}),(0,t.jsx)(n.td,{children:"\u6807\u8bb0\u7ec4\u4ef6"}),(0,t.jsx)(n.td,{children:"\u81ea\u5df1\u7684\u7c7b"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"\u4f5c\u7528\u57df"}),(0,t.jsx)(n.td,{children:"Bean\u7684\u751f\u547d\u5468\u671f\u8303\u56f4"}),(0,t.jsx)(n.td,{children:"\u6839\u636e\u9700\u8981\u9009\u62e9"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"\u521d\u59cb\u5316"}),(0,t.jsx)(n.td,{children:"Bean\u521b\u5efa\u540e\u7684\u521d\u59cb\u5316"}),(0,t.jsx)(n.td,{children:"@PostConstruct"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"\u9500\u6bc1"}),(0,t.jsx)(n.td,{children:"Bean\u9500\u6bc1\u524d\u7684\u6e05\u7406"}),(0,t.jsx)(n.td,{children:"@PreDestroy"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Lazy"}),(0,t.jsx)(n.td,{children:"\u5ef6\u8fdf\u52a0\u8f7d"}),(0,t.jsx)(n.td,{children:"\u8d44\u6e90\u5bc6\u96c6\u578bBean"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Conditional"}),(0,t.jsx)(n.td,{children:"\u6761\u4ef6\u5316Bean\u521b\u5efa"}),(0,t.jsx)(n.td,{children:"\u73af\u5883\u76f8\u5173"})]})]})]}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u5173\u952e\u8981\u70b9"}),"\uff1a"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"\u4f18\u5148\u4f7f\u7528@Component\u7cfb\u5217\u6ce8\u89e3"}),"\n",(0,t.jsx)(n.li,{children:"\u5408\u7406\u4f7f\u7528@Bean\u5904\u7406\u7b2c\u4e09\u65b9\u5bf9\u8c61"}),"\n",(0,t.jsx)(n.li,{children:"\u9009\u62e9\u5408\u9002\u7684\u4f5c\u7528\u57df"}),"\n",(0,t.jsx)(n.li,{children:"\u6b63\u786e\u5904\u7406\u8d44\u6e90\u7684\u521d\u59cb\u5316\u548c\u9500\u6bc1"}),"\n",(0,t.jsx)(n.li,{children:"\u4f7f\u7528ObjectFactory/ObjectProvider\u5728\u5355\u4f8b\u4e2d\u83b7\u53d6\u539f\u578bBean"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"\u4e0b\u4e00\u6b65"}),"\uff1a\u5b66\u4e60",(0,t.jsx)(n.a,{href:"/docs/spring/aop",children:"\u9762\u5411\u5207\u9762\u7f16\u7a0b(AOP)"})]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(p,{...e})}):p(e)}},1266:(e,n,i)=>{i.d(n,{R:()=>o,x:()=>s});var r=i(9378);const t={},a=r.createContext(t);function o(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);