"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[27489],{48885:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>i});var s=r(99378);const d={},c=s.createContext(d);function l(n){const e=s.useContext(c);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:l(n.components),s.createElement(c.Provider,{value:e},n.children)}},65201:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>t,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"docker/security","title":"Docker \u5b89\u5168","description":"Docker \u5b89\u5168\u6700\u4f73\u5b9e\u8df5\u4e0e\u914d\u7f6e\u6307\u5357","source":"@site/docs/docker/security.md","sourceDirName":"docker","slug":"/docker/security","permalink":"/docs/docker/security","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/docker/security.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12,"title":"Docker \u5b89\u5168","description":"Docker \u5b89\u5168\u6700\u4f73\u5b9e\u8df5\u4e0e\u914d\u7f6e\u6307\u5357"},"sidebar":"docker","previous":{"title":"Docker Context","permalink":"/docs/docker/context"},"next":{"title":"Rootless Docker","permalink":"/docs/docker/rootless"}}');var d=r(22714),c=r(48885);const l={sidebar_position:12,title:"Docker \u5b89\u5168",description:"Docker \u5b89\u5168\u6700\u4f73\u5b9e\u8df5\u4e0e\u914d\u7f6e\u6307\u5357"},i="Docker \u5b89\u5168",t={},a=[{value:"\u955c\u50cf\u5b89\u5168",id:"\u955c\u50cf\u5b89\u5168",level:2},{value:"\u4f7f\u7528\u5b98\u65b9\u955c\u50cf",id:"\u4f7f\u7528\u5b98\u65b9\u955c\u50cf",level:3},{value:"\u6307\u5b9a\u7cbe\u786e\u7248\u672c",id:"\u6307\u5b9a\u7cbe\u786e\u7248\u672c",level:3},{value:"\u955c\u50cf\u626b\u63cf",id:"\u955c\u50cf\u626b\u63cf",level:3},{value:"\u6700\u5c0f\u5316\u955c\u50cf",id:"\u6700\u5c0f\u5316\u955c\u50cf",level:3},{value:"\u8fd0\u884c\u65f6\u5b89\u5168",id:"\u8fd0\u884c\u65f6\u5b89\u5168",level:2},{value:"\u4f7f\u7528\u975e root \u7528\u6237",id:"\u4f7f\u7528\u975e-root-\u7528\u6237",level:3},{value:"\u53ea\u8bfb\u6587\u4ef6\u7cfb\u7edf",id:"\u53ea\u8bfb\u6587\u4ef6\u7cfb\u7edf",level:3},{value:"\u8d44\u6e90\u9650\u5236",id:"\u8d44\u6e90\u9650\u5236",level:3},{value:"\u7981\u7528 capabilities",id:"\u7981\u7528-capabilities",level:3},{value:"\u7981\u7528\u7279\u6743\u6a21\u5f0f",id:"\u7981\u7528\u7279\u6743\u6a21\u5f0f",level:3},{value:"\u5b89\u5168\u9009\u9879",id:"\u5b89\u5168\u9009\u9879",level:3},{value:"\u7f51\u7edc\u5b89\u5168",id:"\u7f51\u7edc\u5b89\u5168",level:2},{value:"\u9694\u79bb\u654f\u611f\u7f51\u7edc",id:"\u9694\u79bb\u654f\u611f\u7f51\u7edc",level:3},{value:"\u9650\u5236\u5bb9\u5668\u95f4\u901a\u4fe1",id:"\u9650\u5236\u5bb9\u5668\u95f4\u901a\u4fe1",level:3},{value:"\u4f7f\u7528 TLS",id:"\u4f7f\u7528-tls",level:3},{value:"\u654f\u611f\u6570\u636e\u7ba1\u7406",id:"\u654f\u611f\u6570\u636e\u7ba1\u7406",level:2},{value:"Docker Secrets\uff08Swarm \u6a21\u5f0f\uff09",id:"docker-secretsswarm-\u6a21\u5f0f",level:3},{value:"\u73af\u5883\u53d8\u91cf\u5b89\u5168",id:"\u73af\u5883\u53d8\u91cf\u5b89\u5168",level:3},{value:"\u6784\u5efa\u65f6\u654f\u611f\u4fe1\u606f",id:"\u6784\u5efa\u65f6\u654f\u611f\u4fe1\u606f",level:3},{value:"\u955c\u50cf\u7b7e\u540d\u4e0e\u9a8c\u8bc1",id:"\u955c\u50cf\u7b7e\u540d\u4e0e\u9a8c\u8bc1",level:2},{value:"Docker Content Trust",id:"docker-content-trust",level:3},{value:"\u914d\u7f6e\u4fe1\u4efb\u7b56\u7565",id:"\u914d\u7f6e\u4fe1\u4efb\u7b56\u7565",level:3},{value:"\u5ba1\u8ba1\u4e0e\u76d1\u63a7",id:"\u5ba1\u8ba1\u4e0e\u76d1\u63a7",level:2},{value:"\u542f\u7528\u5ba1\u8ba1\u65e5\u5fd7",id:"\u542f\u7528\u5ba1\u8ba1\u65e5\u5fd7",level:3},{value:"\u76d1\u63a7\u7cfb\u7edf\u8c03\u7528",id:"\u76d1\u63a7\u7cfb\u7edf\u8c03\u7528",level:3},{value:"\u5b89\u5168\u68c0\u67e5\u6e05\u5355",id:"\u5b89\u5168\u68c0\u67e5\u6e05\u5355",level:2},{value:"Dockerfile \u68c0\u67e5",id:"dockerfile-\u68c0\u67e5",level:3},{value:"\u8fd0\u884c\u65f6\u68c0\u67e5",id:"\u8fd0\u884c\u65f6\u68c0\u67e5",level:3},{value:"\u7f51\u7edc\u68c0\u67e5",id:"\u7f51\u7edc\u68c0\u67e5",level:3},{value:"\u5b89\u5168\u914d\u7f6e\u793a\u4f8b",id:"\u5b89\u5168\u914d\u7f6e\u793a\u4f8b",level:2}];function o(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.header,{children:(0,d.jsx)(e.h1,{id:"docker-\u5b89\u5168",children:"Docker \u5b89\u5168"})}),"\n",(0,d.jsx)(e.p,{children:"\u672c\u6587\u4ecb\u7ecd Docker \u5bb9\u5668\u5316\u73af\u5883\u4e2d\u7684\u5b89\u5168\u6700\u4f73\u5b9e\u8df5\u3002"}),"\n",(0,d.jsx)(e.h2,{id:"\u955c\u50cf\u5b89\u5168",children:"\u955c\u50cf\u5b89\u5168"}),"\n",(0,d.jsx)(e.h3,{id:"\u4f7f\u7528\u5b98\u65b9\u955c\u50cf",children:"\u4f7f\u7528\u5b98\u65b9\u955c\u50cf"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-dockerfile",children:"# \u2705 \u63a8\u8350\uff1a\u4f7f\u7528\u5b98\u65b9\u955c\u50cf\nFROM node:18-alpine\nFROM nginx:1.25\n\n# \u274c \u907f\u514d\uff1a\u4f7f\u7528\u6765\u6e90\u4e0d\u660e\u7684\u955c\u50cf\nFROM randomuser/unknown-image\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u6307\u5b9a\u7cbe\u786e\u7248\u672c",children:"\u6307\u5b9a\u7cbe\u786e\u7248\u672c"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-dockerfile",children:"# \u2705 \u63a8\u8350\uff1a\u6307\u5b9a\u7cbe\u786e\u7248\u672c\nFROM node:18.19.0-alpine3.19\n\n# \u274c \u907f\u514d\uff1a\u4f7f\u7528 latest \u6807\u7b7e\nFROM node:latest\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u955c\u50cf\u626b\u63cf",children:"\u955c\u50cf\u626b\u63cf"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u4f7f\u7528 Docker Scout \u626b\u63cf\ndocker scout cves myimage:tag\n\n# \u4f7f\u7528 Trivy \u626b\u63cf\ntrivy image myimage:tag\n\n# \u4f7f\u7528 Grype \u626b\u63cf\ngrype myimage:tag\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u6700\u5c0f\u5316\u955c\u50cf",children:"\u6700\u5c0f\u5316\u955c\u50cf"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-dockerfile",children:"# \u4f7f\u7528 Alpine\nFROM node:18-alpine\n\n# \u4f7f\u7528 Distroless\uff08\u66f4\u5b89\u5168\uff09\nFROM gcr.io/distroless/nodejs18\n\n# \u4f7f\u7528 scratch\uff08\u6700\u5c0f\u5316\uff09\nFROM scratch\nCOPY myapp /\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u8fd0\u884c\u65f6\u5b89\u5168",children:"\u8fd0\u884c\u65f6\u5b89\u5168"}),"\n",(0,d.jsx)(e.h3,{id:"\u4f7f\u7528\u975e-root-\u7528\u6237",children:"\u4f7f\u7528\u975e root \u7528\u6237"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-dockerfile",children:"# \u521b\u5efa\u4e13\u7528\u7528\u6237\nRUN groupadd -r app && useradd -r -g app app\n\n# \u8bbe\u7f6e\u76ee\u5f55\u6743\u9650\nRUN chown -R app:app /app\n\n# \u5207\u6362\u7528\u6237\nUSER app\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u9a8c\u8bc1\uff1a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"docker run myimage whoami\n# \u5e94\u8f93\u51fa app \u800c\u4e0d\u662f root\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u53ea\u8bfb\u6587\u4ef6\u7cfb\u7edf",children:"\u53ea\u8bfb\u6587\u4ef6\u7cfb\u7edf"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u53ea\u8bfb\u6839\u6587\u4ef6\u7cfb\u7edf\ndocker run --read-only nginx\n\n# \u5141\u8bb8\u5199\u5165\u7279\u5b9a\u76ee\u5f55\ndocker run --read-only \\\n  --tmpfs /tmp \\\n  --tmpfs /var/run \\\n  -v logs:/var/log \\\n  nginx\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u8d44\u6e90\u9650\u5236",children:"\u8d44\u6e90\u9650\u5236"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"docker run -d \\\n  --memory=512m \\\n  --memory-swap=512m \\    # \u7981\u7528 swap\n  --cpus=1.0 \\\n  --pids-limit=100 \\       # \u9632\u6b62 fork \u70b8\u5f39\n  --ulimit nofile=1024:1024 \\\n  nginx\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u7981\u7528-capabilities",children:"\u7981\u7528 capabilities"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u5220\u9664\u6240\u6709 capabilities\ndocker run --cap-drop=ALL nginx\n\n# \u53ea\u6dfb\u52a0\u5fc5\u9700\u7684\ndocker run --cap-drop=ALL --cap-add=NET_BIND_SERVICE nginx\n"})}),"\n",(0,d.jsx)(e.p,{children:"\u5e38\u89c1 capabilities\uff1a"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"Capability"}),(0,d.jsx)(e.th,{children:"\u8bf4\u660e"}),(0,d.jsx)(e.th,{children:"\u662f\u5426\u5fc5\u9700"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"NET_BIND_SERVICE"}),(0,d.jsx)(e.td,{children:"\u7ed1\u5b9a\u5c0f\u4e8e 1024 \u7aef\u53e3"}),(0,d.jsx)(e.td,{children:"\u901a\u5e38\u9700\u8981"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"CHOWN"}),(0,d.jsx)(e.td,{children:"\u66f4\u6539\u6587\u4ef6\u6240\u6709\u8005"}),(0,d.jsx)(e.td,{children:"\u5f88\u5c11\u9700\u8981"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"DAC_OVERRIDE"}),(0,d.jsx)(e.td,{children:"\u7ed5\u8fc7\u6743\u9650\u68c0\u67e5"}),(0,d.jsx)(e.td,{children:"\u907f\u514d\u4f7f\u7528"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"SETUID/SETGID"}),(0,d.jsx)(e.td,{children:"\u66f4\u6539\u7528\u6237/\u7ec4 ID"}),(0,d.jsx)(e.td,{children:"\u907f\u514d\u4f7f\u7528"})]})]})]}),"\n",(0,d.jsx)(e.h3,{id:"\u7981\u7528\u7279\u6743\u6a21\u5f0f",children:"\u7981\u7528\u7279\u6743\u6a21\u5f0f"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u274c \u7edd\u5bf9\u907f\u514d\u5728\u751f\u4ea7\u73af\u5883\u4f7f\u7528\ndocker run --privileged nginx\n\n# \u2705 \u6b63\u786e\u505a\u6cd5\uff1a\u4ec5\u6388\u4e88\u5fc5\u9700\u6743\u9650\ndocker run --cap-drop=ALL --cap-add=NET_BIND_SERVICE nginx\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u5b89\u5168\u9009\u9879",children:"\u5b89\u5168\u9009\u9879"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"docker run \\\n  --security-opt=no-new-privileges \\  # \u7981\u6b62\u63d0\u6743\n  --security-opt=seccomp=default \\    # \u7cfb\u7edf\u8c03\u7528\u8fc7\u6ee4\n  --security-opt=apparmor=docker-default \\  # AppArmor\n  nginx\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u7f51\u7edc\u5b89\u5168",children:"\u7f51\u7edc\u5b89\u5168"}),"\n",(0,d.jsx)(e.h3,{id:"\u9694\u79bb\u654f\u611f\u7f51\u7edc",children:"\u9694\u79bb\u654f\u611f\u7f51\u7edc"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-yaml",children:"# docker-compose.yml\nservices:\n  frontend:\n    networks:\n      - frontend\n\n  backend:\n    networks:\n      - frontend\n      - backend\n\n  database:\n    networks:\n      - backend\n\nnetworks:\n  frontend:\n  backend:\n    internal: true # \u65e0\u6cd5\u8bbf\u95ee\u5916\u90e8\u7f51\u7edc\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u9650\u5236\u5bb9\u5668\u95f4\u901a\u4fe1",children:"\u9650\u5236\u5bb9\u5668\u95f4\u901a\u4fe1"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:'# \u7981\u7528\u9ed8\u8ba4 bridge \u7f51\u7edc\u7684 ICC\n# /etc/docker/daemon.json\n{\n  "icc": false\n}\n'})}),"\n",(0,d.jsx)(e.h3,{id:"\u4f7f\u7528-tls",children:"\u4f7f\u7528 TLS"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u914d\u7f6e Docker \u5b88\u62a4\u8fdb\u7a0b TLS\ndockerd \\\n  --tlsverify \\\n  --tlscacert=/certs/ca.pem \\\n  --tlscert=/certs/server-cert.pem \\\n  --tlskey=/certs/server-key.pem \\\n  -H=0.0.0.0:2376\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u654f\u611f\u6570\u636e\u7ba1\u7406",children:"\u654f\u611f\u6570\u636e\u7ba1\u7406"}),"\n",(0,d.jsx)(e.h3,{id:"docker-secretsswarm-\u6a21\u5f0f",children:"Docker Secrets\uff08Swarm \u6a21\u5f0f\uff09"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:'# \u521b\u5efa secret\necho "mypassword" | docker secret create db_password -\n\n# \u4f7f\u7528 secret\ndocker service create \\\n  --name myapp \\\n  --secret db_password \\\n  myimage\n'})}),"\n",(0,d.jsx)(e.p,{children:"\u5bb9\u5668\u5185\u8bbf\u95ee\uff1a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"cat /run/secrets/db_password\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u73af\u5883\u53d8\u91cf\u5b89\u5168",children:"\u73af\u5883\u53d8\u91cf\u5b89\u5168"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-yaml",children:"# \u274c \u4e0d\u5b89\u5168\uff1a\u660e\u6587\u5bc6\u7801\nservices:\n  db:\n    environment:\n      MYSQL_PASSWORD: secret123\n\n# \u2705 \u4f7f\u7528 secrets\nservices:\n  db:\n    secrets:\n      - db_password\n    environment:\n      MYSQL_PASSWORD_FILE: /run/secrets/db_password\n\nsecrets:\n  db_password:\n    file: ./secrets/db_password.txt\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u6784\u5efa\u65f6\u654f\u611f\u4fe1\u606f",children:"\u6784\u5efa\u65f6\u654f\u611f\u4fe1\u606f"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-dockerfile",children:'# \u274c \u9519\u8bef\uff1a\u5bc6\u7801\u4f1a\u4fdd\u7559\u5728\u955c\u50cf\u5c42\nRUN echo "password" > /secret && rm /secret\n\n# \u2705 \u6b63\u786e\uff1a\u4f7f\u7528 BuildKit secrets\n# syntax=docker/dockerfile:1.4\nRUN --mount=type=secret,id=npmrc,target=/root/.npmrc npm ci\n'})}),"\n",(0,d.jsx)(e.p,{children:"\u6784\u5efa\u547d\u4ee4\uff1a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"DOCKER_BUILDKIT=1 docker build --secret id=npmrc,src=.npmrc .\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u955c\u50cf\u7b7e\u540d\u4e0e\u9a8c\u8bc1",children:"\u955c\u50cf\u7b7e\u540d\u4e0e\u9a8c\u8bc1"}),"\n",(0,d.jsx)(e.h3,{id:"docker-content-trust",children:"Docker Content Trust"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u542f\u7528\u5185\u5bb9\u4fe1\u4efb\nexport DOCKER_CONTENT_TRUST=1\n\n# \u7b7e\u540d\u5e76\u63a8\u9001\ndocker push myregistry/myimage:v1\n\n# \u62c9\u53d6\u65f6\u81ea\u52a8\u9a8c\u8bc1\ndocker pull myregistry/myimage:v1\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u914d\u7f6e\u4fe1\u4efb\u7b56\u7565",children:"\u914d\u7f6e\u4fe1\u4efb\u7b56\u7565"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-json",children:'// /etc/docker/daemon.json\n{\n  "content-trust": {\n    "trust-pinning": {\n      "official-library-images": true\n    }\n  }\n}\n'})}),"\n",(0,d.jsx)(e.h2,{id:"\u5ba1\u8ba1\u4e0e\u76d1\u63a7",children:"\u5ba1\u8ba1\u4e0e\u76d1\u63a7"}),"\n",(0,d.jsx)(e.h3,{id:"\u542f\u7528\u5ba1\u8ba1\u65e5\u5fd7",children:"\u542f\u7528\u5ba1\u8ba1\u65e5\u5fd7"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-json",children:'// /etc/docker/daemon.json\n{\n  "log-level": "info",\n  "log-driver": "json-file",\n  "log-opts": {\n    "max-size": "10m",\n    "max-file": "3"\n  }\n}\n'})}),"\n",(0,d.jsx)(e.h3,{id:"\u76d1\u63a7\u7cfb\u7edf\u8c03\u7528",children:"\u76d1\u63a7\u7cfb\u7edf\u8c03\u7528"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u4f7f\u7528 Falco \u76d1\u63a7\u5bb9\u5668\u5b89\u5168\u4e8b\u4ef6\ndocker run -d \\\n  --name falco \\\n  --privileged \\\n  -v /var/run/docker.sock:/var/run/docker.sock \\\n  falcosecurity/falco\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u5b89\u5168\u68c0\u67e5\u6e05\u5355",children:"\u5b89\u5168\u68c0\u67e5\u6e05\u5355"}),"\n",(0,d.jsx)(e.h3,{id:"dockerfile-\u68c0\u67e5",children:"Dockerfile \u68c0\u67e5"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"\u68c0\u67e5\u9879"}),(0,d.jsx)(e.th,{children:"\u72b6\u6001"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u4f7f\u7528\u5b98\u65b9\u57fa\u7840\u955c\u50cf"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u6307\u5b9a\u7cbe\u786e\u7248\u672c"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u4f7f\u7528\u975e root \u7528\u6237"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u4f7f\u7528\u591a\u9636\u6bb5\u6784\u5efa"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u6e05\u7406\u4e0d\u5fc5\u8981\u6587\u4ef6"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u4f7f\u7528 .dockerignore"}),(0,d.jsx)(e.td,{children:"\u2610"})]})]})]}),"\n",(0,d.jsx)(e.h3,{id:"\u8fd0\u884c\u65f6\u68c0\u67e5",children:"\u8fd0\u884c\u65f6\u68c0\u67e5"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"\u68c0\u67e5\u9879"}),(0,d.jsx)(e.th,{children:"\u72b6\u6001"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u8d44\u6e90\u9650\u5236\u5df2\u8bbe\u7f6e"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u53ea\u8bfb\u6587\u4ef6\u7cfb\u7edf"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u5220\u9664\u4e0d\u5fc5\u8981 capabilities"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u7981\u7528\u7279\u6743\u6a21\u5f0f"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u8bbe\u7f6e\u5b89\u5168\u9009\u9879"}),(0,d.jsx)(e.td,{children:"\u2610"})]})]})]}),"\n",(0,d.jsx)(e.h3,{id:"\u7f51\u7edc\u68c0\u67e5",children:"\u7f51\u7edc\u68c0\u67e5"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,d.jsxs)(e.table,{children:[(0,d.jsx)(e.thead,{children:(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.th,{children:"\u68c0\u67e5\u9879"}),(0,d.jsx)(e.th,{children:"\u72b6\u6001"})]})}),(0,d.jsxs)(e.tbody,{children:[(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u7f51\u7edc"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u654f\u611f\u670d\u52a1\u4f7f\u7528\u5185\u90e8\u7f51\u7edc"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u4ec5\u66b4\u9732\u5fc5\u8981\u7aef\u53e3"}),(0,d.jsx)(e.td,{children:"\u2610"})]}),(0,d.jsxs)(e.tr,{children:[(0,d.jsx)(e.td,{children:"\u542f\u7528 TLS\uff08\u5982\u9700\u8fdc\u7a0b\u8bbf\u95ee\uff09"}),(0,d.jsx)(e.td,{children:"\u2610"})]})]})]}),"\n",(0,d.jsx)(e.h2,{id:"\u5b89\u5168\u914d\u7f6e\u793a\u4f8b",children:"\u5b89\u5168\u914d\u7f6e\u793a\u4f8b"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-yaml",children:'# docker-compose.yml\nversion: "3.8"\n\nservices:\n  app:\n    image: myapp:v1.0.0\n    read_only: true\n    user: "1000:1000"\n    security_opt:\n      - no-new-privileges:true\n    cap_drop:\n      - ALL\n    cap_add:\n      - NET_BIND_SERVICE\n    deploy:\n      resources:\n        limits:\n          cpus: "1.0"\n          memory: 512M\n          pids: 100\n    tmpfs:\n      - /tmp\n    networks:\n      - frontend\n    secrets:\n      - app_secret\n\n  db:\n    image: postgres:15\n    read_only: true\n    user: "999:999"\n    security_opt:\n      - no-new-privileges:true\n    cap_drop:\n      - ALL\n    volumes:\n      - db-data:/var/lib/postgresql/data\n    networks:\n      - backend\n    secrets:\n      - db_password\n\nnetworks:\n  frontend:\n  backend:\n    internal: true\n\nsecrets:\n  app_secret:\n    file: ./secrets/app.txt\n  db_password:\n    file: ./secrets/db.txt\n\nvolumes:\n  db-data:\n'})})]})}function h(n={}){const{wrapper:e}={...(0,c.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(o,{...n})}):o(n)}}}]);