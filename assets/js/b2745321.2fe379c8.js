"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[44045],{23888:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>x,frontMatter:()=>r,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"networking/websocket","title":"WebSocket \u534f\u8bae","description":"WebSocket\u534f\u8bae\u8be6\u89e3\uff0c\u5305\u62ec\u63e1\u624b\u6d41\u7a0b\u3001\u6570\u636e\u5e27\u683c\u5f0f\u3001\u5e94\u7528\u573a\u666f","source":"@site/docs/networking/websocket.md","sourceDirName":"networking","slug":"/networking/websocket","permalink":"/docs/networking/websocket","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/networking/websocket.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9,"title":"WebSocket \u534f\u8bae","description":"WebSocket\u534f\u8bae\u8be6\u89e3\uff0c\u5305\u62ec\u63e1\u624b\u6d41\u7a0b\u3001\u6570\u636e\u5e27\u683c\u5f0f\u3001\u5e94\u7528\u573a\u666f","keywords":["WebSocket","\u5168\u53cc\u5de5","\u5b9e\u65f6\u901a\u4fe1","\u63e1\u624b","ws","wss"]},"sidebar":"networking","previous":{"title":"DNS \u57df\u540d\u89e3\u6790","permalink":"/docs/networking/dns"},"next":{"title":"TLS/SSL \u5b89\u5168\u534f\u8bae","permalink":"/docs/networking/tls-ssl"}}');var d=s(22714),i=s(48885);const r={sidebar_position:9,title:"WebSocket \u534f\u8bae",description:"WebSocket\u534f\u8bae\u8be6\u89e3\uff0c\u5305\u62ec\u63e1\u624b\u6d41\u7a0b\u3001\u6570\u636e\u5e27\u683c\u5f0f\u3001\u5e94\u7528\u573a\u666f",keywords:["WebSocket","\u5168\u53cc\u5de5","\u5b9e\u65f6\u901a\u4fe1","\u63e1\u624b","ws","wss"]},l="WebSocket \u534f\u8bae",c={},h=[{value:"\u4e3a\u4ec0\u4e48\u9700\u8981 WebSocket\uff1f",id:"\u4e3a\u4ec0\u4e48\u9700\u8981-websocket",level:2},{value:"HTTP \u7684\u5c40\u9650\u6027",id:"http-\u7684\u5c40\u9650\u6027",level:3},{value:"WebSocket \u4f18\u52bf",id:"websocket-\u4f18\u52bf",level:3},{value:"\u63e1\u624b\u8fc7\u7a0b",id:"\u63e1\u624b\u8fc7\u7a0b",level:2},{value:"\u5ba2\u6237\u7aef\u8bf7\u6c42",id:"\u5ba2\u6237\u7aef\u8bf7\u6c42",level:3},{value:"\u670d\u52a1\u7aef\u54cd\u5e94",id:"\u670d\u52a1\u7aef\u54cd\u5e94",level:3},{value:"\u5bc6\u94a5\u8ba1\u7b97",id:"\u5bc6\u94a5\u8ba1\u7b97",level:3},{value:"\u6570\u636e\u5e27\u683c\u5f0f",id:"\u6570\u636e\u5e27\u683c\u5f0f",level:2},{value:"\u5173\u952e\u5b57\u6bb5",id:"\u5173\u952e\u5b57\u6bb5",level:3},{value:"Opcode \u7c7b\u578b",id:"opcode-\u7c7b\u578b",level:3},{value:"\u5fc3\u8df3\u673a\u5236",id:"\u5fc3\u8df3\u673a\u5236",level:2},{value:"\u5e94\u7528\u573a\u666f",id:"\u5e94\u7528\u573a\u666f",level:2},{value:"\u4ee3\u7801\u793a\u4f8b",id:"\u4ee3\u7801\u793a\u4f8b",level:2},{value:"JavaScript \u5ba2\u6237\u7aef",id:"javascript-\u5ba2\u6237\u7aef",level:3},{value:"Java \u670d\u52a1\u7aef (Spring)",id:"java-\u670d\u52a1\u7aef-spring",level:3},{value:"Netty \u670d\u52a1\u7aef",id:"netty-\u670d\u52a1\u7aef",level:3},{value:"\u5173\u95ed\u7801",id:"\u5173\u95ed\u7801",level:2},{value:"WebSocket vs \u5176\u4ed6\u65b9\u6848",id:"websocket-vs-\u5176\u4ed6\u65b9\u6848",level:2},{value:"\u5b89\u5168\u8003\u8651",id:"\u5b89\u5168\u8003\u8651",level:2},{value:"wss:// \u52a0\u5bc6",id:"wss-\u52a0\u5bc6",level:3},{value:"\u8de8\u57df\u9650\u5236",id:"\u8de8\u57df\u9650\u5236",level:3},{value:"\u8ba4\u8bc1",id:"\u8ba4\u8bc1",level:3},{value:"\u4e0b\u4e00\u6b65",id:"\u4e0b\u4e00\u6b65",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"websocket-\u534f\u8bae",children:"WebSocket \u534f\u8bae"})}),"\n",(0,d.jsx)(n.p,{children:"WebSocket \u662f\u4e00\u79cd\u5728\u5355\u4e2a TCP \u8fde\u63a5\u4e0a\u8fdb\u884c\u5168\u53cc\u5de5\u901a\u4fe1\u7684\u534f\u8bae\uff0c\u5b9e\u73b0\u4e86\u670d\u52a1\u5668\u4e0e\u5ba2\u6237\u7aef\u4e4b\u95f4\u7684\u5b9e\u65f6\u53cc\u5411\u901a\u4fe1\u3002"}),"\n",(0,d.jsx)(n.h2,{id:"\u4e3a\u4ec0\u4e48\u9700\u8981-websocket",children:"\u4e3a\u4ec0\u4e48\u9700\u8981 WebSocket\uff1f"}),"\n",(0,d.jsx)(n.h3,{id:"http-\u7684\u5c40\u9650\u6027",children:"HTTP \u7684\u5c40\u9650\u6027"}),"\n",(0,d.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant C as \u5ba2\u6237\u7aef\n    participant S as \u670d\u52a1\u5668\n\n    Note over C,S: HTTP - \u5355\u5411\u901a\u4fe1\n    C->>S: \u8bf7\u6c42\n    S--\x3e>C: \u54cd\u5e94\n    C->>S: \u8bf7\u6c42\n    S--\x3e>C: \u54cd\u5e94\n    Note over C,S: \u670d\u52a1\u5668\u65e0\u6cd5\u4e3b\u52a8\u63a8\u9001"}),"\n",(0,d.jsx)(n.h3,{id:"websocket-\u4f18\u52bf",children:"WebSocket \u4f18\u52bf"}),"\n",(0,d.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant C as \u5ba2\u6237\u7aef\n    participant S as \u670d\u52a1\u5668\n\n    Note over C,S: WebSocket - \u53cc\u5411\u901a\u4fe1\n    C->>S: \u63e1\u624b\u8bf7\u6c42\n    S--\x3e>C: \u63e1\u624b\u54cd\u5e94\n    Note over C,S: \u8fde\u63a5\u5efa\u7acb\n    C->>S: \u6d88\u606f\n    S->>C: \u6d88\u606f\n    S->>C: \u4e3b\u52a8\u63a8\u9001\n    C->>S: \u6d88\u606f"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u5bf9\u6bd4\u9879"}),(0,d.jsx)(n.th,{children:"HTTP"}),(0,d.jsx)(n.th,{children:"WebSocket"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u901a\u4fe1\u65b9\u5f0f"}),(0,d.jsx)(n.td,{children:"\u8bf7\u6c42-\u54cd\u5e94"}),(0,d.jsx)(n.td,{children:"\u5168\u53cc\u5de5"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u8fde\u63a5"}),(0,d.jsx)(n.td,{children:"\u77ed\u8fde\u63a5/\u957f\u8fde\u63a5"}),(0,d.jsx)(n.td,{children:"\u6301\u4e45\u8fde\u63a5"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u5f00\u9500"}),(0,d.jsx)(n.td,{children:"\u6bcf\u6b21\u8bf7\u6c42\u90fd\u6709\u5934\u90e8"}),(0,d.jsx)(n.td,{children:"\u63e1\u624b\u540e\u5f00\u9500\u5c0f"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u5b9e\u65f6\u6027"}),(0,d.jsx)(n.td,{children:"\u8f6e\u8be2/\u957f\u8f6e\u8be2"}),(0,d.jsx)(n.td,{children:"\u5b9e\u65f6\u63a8\u9001"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u534f\u8bae"}),(0,d.jsx)(n.td,{children:"http:// / https://"}),(0,d.jsx)(n.td,{children:"ws:// / wss://"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u63e1\u624b\u8fc7\u7a0b",children:"\u63e1\u624b\u8fc7\u7a0b"}),"\n",(0,d.jsx)(n.p,{children:"WebSocket \u901a\u8fc7 HTTP Upgrade \u673a\u5236\u5efa\u7acb\u8fde\u63a5\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u5ba2\u6237\u7aef\u8bf7\u6c42",children:"\u5ba2\u6237\u7aef\u8bf7\u6c42"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-http",children:"GET /chat HTTP/1.1\nHost: server.example.com\nUpgrade: websocket\nConnection: Upgrade\nSec-WebSocket-Key: dGhlIHNhbXBsZSBub25jZQ==\nSec-WebSocket-Version: 13\nOrigin: http://example.com\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u670d\u52a1\u7aef\u54cd\u5e94",children:"\u670d\u52a1\u7aef\u54cd\u5e94"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-http",children:"HTTP/1.1 101 Switching Protocols\nUpgrade: websocket\nConnection: Upgrade\nSec-WebSocket-Accept: s3pPLMBiTxaQ9kYGzzhZRbK+xOo=\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u5bc6\u94a5\u8ba1\u7b97",children:"\u5bc6\u94a5\u8ba1\u7b97"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:'Sec-WebSocket-Accept = Base64(SHA1(Sec-WebSocket-Key + GUID))\n\n\u5176\u4e2d GUID = "258EAFA5-E914-47DA-95CA-C5AB0DC85B11"\n'})}),"\n",(0,d.jsx)(n.h2,{id:"\u6570\u636e\u5e27\u683c\u5f0f",children:"\u6570\u636e\u5e27\u683c\u5f0f"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:" 0                   1                   2                   3\n 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n+-+-+-+-+-------+-+-------------+-------------------------------+\n|F|R|R|R| opcode|M| Payload len |    Extended payload length    |\n|I|S|S|S|  (4)  |A|     (7)     |             (16/64)           |\n|N|V|V|V|       |S|             |   (if payload len==126/127)   |\n| |1|2|3|       |K|             |                               |\n+-+-+-+-+-------+-+-------------+-------------------------------+\n|     Masking-key (if MASK set to 1)                            |\n+-------------------------------+-------------------------------+\n|                     Payload Data                              |\n+---------------------------------------------------------------+\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u5173\u952e\u5b57\u6bb5",children:"\u5173\u952e\u5b57\u6bb5"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u5b57\u6bb5"}),(0,d.jsx)(n.th,{children:"\u5927\u5c0f"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"FIN"}),(0,d.jsx)(n.td,{children:"1 bit"}),(0,d.jsx)(n.td,{children:"\u662f\u5426\u4e3a\u6d88\u606f\u7684\u6700\u540e\u4e00\u5e27"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"opcode"}),(0,d.jsx)(n.td,{children:"4 bit"}),(0,d.jsx)(n.td,{children:"\u5e27\u7c7b\u578b"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"MASK"}),(0,d.jsx)(n.td,{children:"1 bit"}),(0,d.jsx)(n.td,{children:"\u662f\u5426\u63a9\u7801\uff08\u5ba2\u6237\u7aef\u5fc5\u987b\u4e3a 1\uff09"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Payload len"}),(0,d.jsx)(n.td,{children:"7 bit"}),(0,d.jsx)(n.td,{children:"\u6570\u636e\u957f\u5ea6"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Masking-key"}),(0,d.jsx)(n.td,{children:"32 bit"}),(0,d.jsx)(n.td,{children:"\u63a9\u7801\u5bc6\u94a5\uff08\u5982\u679c MASK=1\uff09"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"opcode-\u7c7b\u578b",children:"Opcode \u7c7b\u578b"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Opcode"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0x0"}),(0,d.jsx)(n.td,{children:"\u7ee7\u7eed\u5e27"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0x1"}),(0,d.jsx)(n.td,{children:"\u6587\u672c\u5e27"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0x2"}),(0,d.jsx)(n.td,{children:"\u4e8c\u8fdb\u5236\u5e27"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0x8"}),(0,d.jsx)(n.td,{children:"\u5173\u95ed\u8fde\u63a5"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0x9"}),(0,d.jsx)(n.td,{children:"Ping"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"0xA"}),(0,d.jsx)(n.td,{children:"Pong"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u5fc3\u8df3\u673a\u5236",children:"\u5fc3\u8df3\u673a\u5236"}),"\n",(0,d.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant C as \u5ba2\u6237\u7aef\n    participant S as \u670d\u52a1\u5668\n\n    Note over C,S: \u4fdd\u6301\u8fde\u63a5\u6d3b\u8dc3\n    S->>C: Ping\n    C->>S: Pong\n\n    Note over C,S: 30\u79d2\u540e\n    S->>C: Ping\n    C->>S: Pong"}),"\n",(0,d.jsx)(n.h2,{id:"\u5e94\u7528\u573a\u666f",children:"\u5e94\u7528\u573a\u666f"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u573a\u666f"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u5373\u65f6\u901a\u8baf"}),(0,d.jsx)(n.td,{children:"\u804a\u5929\u5e94\u7528\u3001\u5ba2\u670d\u7cfb\u7edf"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u5b9e\u65f6\u6570\u636e"}),(0,d.jsx)(n.td,{children:"\u80a1\u7968\u884c\u60c5\u3001\u4f53\u80b2\u6bd4\u5206"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u534f\u4f5c\u7f16\u8f91"}),(0,d.jsx)(n.td,{children:"\u5728\u7ebf\u6587\u6863\u3001\u767d\u677f"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u6e38\u620f"}),(0,d.jsx)(n.td,{children:"\u591a\u4eba\u5728\u7ebf\u6e38\u620f"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u63a8\u9001\u901a\u77e5"}),(0,d.jsx)(n.td,{children:"\u7cfb\u7edf\u6d88\u606f\u3001\u8ba2\u5355\u72b6\u6001"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u76f4\u64ad\u4e92\u52a8"}),(0,d.jsx)(n.td,{children:"\u5f39\u5e55\u3001\u793c\u7269\u3001\u70b9\u8d5e"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u4ee3\u7801\u793a\u4f8b",children:"\u4ee3\u7801\u793a\u4f8b"}),"\n",(0,d.jsx)(n.h3,{id:"javascript-\u5ba2\u6237\u7aef",children:"JavaScript \u5ba2\u6237\u7aef"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-javascript",children:'// \u521b\u5efa\u8fde\u63a5\nconst ws = new WebSocket("wss://example.com/socket");\n\n// \u8fde\u63a5\u6253\u5f00\nws.onopen = function (event) {\n  console.log("\u8fde\u63a5\u5df2\u5efa\u7acb");\n  ws.send("Hello Server!");\n};\n\n// \u6536\u5230\u6d88\u606f\nws.onmessage = function (event) {\n  console.log("\u6536\u5230\u6d88\u606f:", event.data);\n};\n\n// \u8fde\u63a5\u5173\u95ed\nws.onclose = function (event) {\n  console.log("\u8fde\u63a5\u5df2\u5173\u95ed", event.code, event.reason);\n};\n\n// \u53d1\u751f\u9519\u8bef\nws.onerror = function (error) {\n  console.error("WebSocket \u9519\u8bef:", error);\n};\n\n// \u53d1\u9001\u6d88\u606f\nws.send("Hello!");\nws.send(JSON.stringify({ type: "message", content: "Hi" }));\n\n// \u5173\u95ed\u8fde\u63a5\nws.close(1000, "Normal closure");\n'})}),"\n",(0,d.jsx)(n.h3,{id:"java-\u670d\u52a1\u7aef-spring",children:"Java \u670d\u52a1\u7aef (Spring)"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:'@Configuration\n@EnableWebSocket\npublic class WebSocketConfig implements WebSocketConfigurer {\n\n    @Override\n    public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {\n        registry.addHandler(new MyWebSocketHandler(), "/ws")\n                .setAllowedOrigins("*");\n    }\n}\n\npublic class MyWebSocketHandler extends TextWebSocketHandler {\n\n    private final Set<WebSocketSession> sessions =\n        Collections.synchronizedSet(new HashSet<>());\n\n    @Override\n    public void afterConnectionEstablished(WebSocketSession session) {\n        sessions.add(session);\n        System.out.println("\u8fde\u63a5\u5efa\u7acb: " + session.getId());\n    }\n\n    @Override\n    protected void handleTextMessage(WebSocketSession session,\n                                     TextMessage message) throws Exception {\n        String payload = message.getPayload();\n        System.out.println("\u6536\u5230\u6d88\u606f: " + payload);\n\n        // \u5e7f\u64ad\u7ed9\u6240\u6709\u5ba2\u6237\u7aef\n        for (WebSocketSession s : sessions) {\n            if (s.isOpen()) {\n                s.sendMessage(new TextMessage("Echo: " + payload));\n            }\n        }\n    }\n\n    @Override\n    public void afterConnectionClosed(WebSocketSession session,\n                                      CloseStatus status) {\n        sessions.remove(session);\n        System.out.println("\u8fde\u63a5\u5173\u95ed: " + session.getId());\n    }\n}\n'})}),"\n",(0,d.jsx)(n.h3,{id:"netty-\u670d\u52a1\u7aef",children:"Netty \u670d\u52a1\u7aef"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:'public class WebSocketServerInitializer extends ChannelInitializer<SocketChannel> {\n\n    @Override\n    protected void initChannel(SocketChannel ch) {\n        ChannelPipeline pipeline = ch.pipeline();\n        pipeline.addLast(new HttpServerCodec());\n        pipeline.addLast(new HttpObjectAggregator(65536));\n        pipeline.addLast(new WebSocketServerProtocolHandler("/ws"));\n        pipeline.addLast(new TextWebSocketFrameHandler());\n    }\n}\n\npublic class TextWebSocketFrameHandler\n    extends SimpleChannelInboundHandler<TextWebSocketFrame> {\n\n    @Override\n    protected void channelRead0(ChannelHandlerContext ctx,\n                                TextWebSocketFrame frame) {\n        String text = frame.text();\n        System.out.println("\u6536\u5230: " + text);\n        ctx.channel().writeAndFlush(new TextWebSocketFrame("Echo: " + text));\n    }\n}\n'})}),"\n",(0,d.jsx)(n.h2,{id:"\u5173\u95ed\u7801",children:"\u5173\u95ed\u7801"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u72b6\u6001\u7801"}),(0,d.jsx)(n.th,{children:"\u63cf\u8ff0"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1000"}),(0,d.jsx)(n.td,{children:"\u6b63\u5e38\u5173\u95ed"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1001"}),(0,d.jsx)(n.td,{children:"\u7aef\u70b9\u79bb\u5f00"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1002"}),(0,d.jsx)(n.td,{children:"\u534f\u8bae\u9519\u8bef"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1003"}),(0,d.jsx)(n.td,{children:"\u4e0d\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1006"}),(0,d.jsx)(n.td,{children:"\u5f02\u5e38\u5173\u95ed"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1007"}),(0,d.jsx)(n.td,{children:"\u65e0\u6548\u7684\u6570\u636e"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1008"}),(0,d.jsx)(n.td,{children:"\u7b56\u7565\u8fdd\u89c4"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1009"}),(0,d.jsx)(n.td,{children:"\u6d88\u606f\u8fc7\u5927"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"1011"}),(0,d.jsx)(n.td,{children:"\u670d\u52a1\u5668\u9519\u8bef"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"websocket-vs-\u5176\u4ed6\u65b9\u6848",children:"WebSocket vs \u5176\u4ed6\u65b9\u6848"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u65b9\u6848"}),(0,d.jsx)(n.th,{children:"\u5b9e\u65f6\u6027"}),(0,d.jsx)(n.th,{children:"\u53cc\u5411"}),(0,d.jsx)(n.th,{children:"\u5f00\u9500"}),(0,d.jsx)(n.th,{children:"\u517c\u5bb9\u6027"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u8f6e\u8be2"}),(0,d.jsx)(n.td,{children:"\u4f4e"}),(0,d.jsx)(n.td,{children:"\u5355\u5411"}),(0,d.jsx)(n.td,{children:"\u9ad8"}),(0,d.jsx)(n.td,{children:"\u597d"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"\u957f\u8f6e\u8be2"}),(0,d.jsx)(n.td,{children:"\u4e2d"}),(0,d.jsx)(n.td,{children:"\u5355\u5411"}),(0,d.jsx)(n.td,{children:"\u4e2d"}),(0,d.jsx)(n.td,{children:"\u597d"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"SSE"}),(0,d.jsx)(n.td,{children:"\u9ad8"}),(0,d.jsx)(n.td,{children:"\u5355\u5411"}),(0,d.jsx)(n.td,{children:"\u4f4e"}),(0,d.jsx)(n.td,{children:"\u8f83\u597d"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"WebSocket"}),(0,d.jsx)(n.td,{children:"\u9ad8"}),(0,d.jsx)(n.td,{children:"\u53cc\u5411"}),(0,d.jsx)(n.td,{children:"\u4f4e"}),(0,d.jsx)(n.td,{children:"\u597d"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u5b89\u5168\u8003\u8651",children:"\u5b89\u5168\u8003\u8651"}),"\n",(0,d.jsx)(n.h3,{id:"wss-\u52a0\u5bc6",children:"wss:// \u52a0\u5bc6"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-javascript",children:'// \u4e0d\u5b89\u5168\nconst ws = new WebSocket("ws://example.com/socket");\n\n// \u5b89\u5168\uff08\u63a8\u8350\uff09\nconst wss = new WebSocket("wss://example.com/socket");\n'})}),"\n",(0,d.jsx)(n.h3,{id:"\u8de8\u57df\u9650\u5236",children:"\u8de8\u57df\u9650\u5236"}),"\n",(0,d.jsx)(n.p,{children:"WebSocket \u4e0d\u53d7\u540c\u6e90\u7b56\u7565\u9650\u5236\uff0c\u9700\u8981\u670d\u52a1\u7aef\u9a8c\u8bc1 Origin \u5934\u90e8\u3002"}),"\n",(0,d.jsx)(n.h3,{id:"\u8ba4\u8bc1",children:"\u8ba4\u8bc1"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-javascript",children:'// \u65b9\u5f0f1: URL \u53c2\u6570\nconst ws = new WebSocket("wss://example.com/socket?token=xxx");\n\n// \u65b9\u5f0f2: \u9996\u6761\u6d88\u606f\u8ba4\u8bc1\nws.onopen = function () {\n  ws.send(JSON.stringify({ type: "auth", token: "xxx" }));\n};\n'})}),"\n",(0,d.jsx)(n.h2,{id:"\u4e0b\u4e00\u6b65",children:"\u4e0b\u4e00\u6b65"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["\u5b66\u4e60 ",(0,d.jsx)(n.a,{href:"./socket-programming",children:"Socket \u7f16\u7a0b"})]}),"\n",(0,d.jsxs)(n.li,{children:["\u4e86\u89e3 ",(0,d.jsx)(n.a,{href:"/docs/netty/websocket",children:"Netty \u6846\u67b6"})]}),"\n"]})]})}function x(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(o,{...e})}):o(e)}},48885:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>l});var t=s(99378);const d={},i=t.createContext(d);function r(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);