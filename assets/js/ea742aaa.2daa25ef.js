"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[45549],{48885:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>d});var i=r(99378);const s={},t=i.createContext(s);function a(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(t.Provider,{value:n},e.children)}},87862:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"spring/spring-data","title":"Spring Data","description":"[!IMPORTANT] > Spring Data \u6838\u5fc3: Spring Data \u7b80\u5316\u4e86\u6570\u636e\u8bbf\u95ee\u5c42\u7684\u5f00\u53d1\uff0c\u901a\u8fc7 Repository \u63a5\u53e3\u81ea\u52a8\u751f\u6210\u5b9e\u73b0\u3002\u638c\u63e1\u67e5\u8be2\u65b9\u6cd5\u547d\u540d\u89c4\u5219\u548c\u81ea\u5b9a\u4e49\u67e5\u8be2\u662f\u5173\u952e\u3002","source":"@site/docs/spring/spring-data.md","sourceDirName":"spring","slug":"/spring/spring-data","permalink":"/docs/spring/spring-data","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/spring/spring-data.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"id":"spring-data","title":"Spring Data","sidebar_label":"Spring Data","sidebar_position":8},"sidebar":"spring","previous":{"title":"Spring MVC","permalink":"/docs/spring/spring-mvc"},"next":{"title":"\u5b89\u5168\u57fa\u7840","permalink":"/docs/spring/security-basics"}}');var s=r(22714),t=r(48885);const a={id:"spring-data",title:"Spring Data",sidebar_label:"Spring Data",sidebar_position:8},d="Spring Data",l={},c=[{value:"1. Spring Data \u6982\u8ff0",id:"1-spring-data-\u6982\u8ff0",level:2},{value:"1.1 \u4e3b\u8981\u6a21\u5757",id:"11-\u4e3b\u8981\u6a21\u5757",level:3},{value:"1.2 \u6838\u5fc3\u7279\u6027",id:"12-\u6838\u5fc3\u7279\u6027",level:3},{value:"2. Repository \u63a5\u53e3",id:"2-repository-\u63a5\u53e3",level:2},{value:"2.1 Repository \u5c42\u6b21\u7ed3\u6784",id:"21-repository-\u5c42\u6b21\u7ed3\u6784",level:3},{value:"2.2 CrudRepository",id:"22-crudrepository",level:3},{value:"2.3 JpaRepository",id:"23-jparepository",level:3},{value:"3. \u67e5\u8be2\u65b9\u6cd5\u547d\u540d\u89c4\u5219",id:"3-\u67e5\u8be2\u65b9\u6cd5\u547d\u540d\u89c4\u5219",level:2},{value:"3.1 \u57fa\u672c\u89c4\u5219",id:"31-\u57fa\u672c\u89c4\u5219",level:3},{value:"3.2 \u5173\u952e\u5b57\u5bf9\u7167\u8868",id:"32-\u5173\u952e\u5b57\u5bf9\u7167\u8868",level:3},{value:"4. \u81ea\u5b9a\u4e49\u67e5\u8be2",id:"4-\u81ea\u5b9a\u4e49\u67e5\u8be2",level:2},{value:"4.1 \u4f7f\u7528 @Query",id:"41-\u4f7f\u7528-query",level:3},{value:"4.2 @Modifying \u6ce8\u610f\u4e8b\u9879",id:"42-modifying-\u6ce8\u610f\u4e8b\u9879",level:3},{value:"5. \u5206\u9875\u548c\u6392\u5e8f",id:"5-\u5206\u9875\u548c\u6392\u5e8f",level:2},{value:"5.1 \u57fa\u672c\u5206\u9875",id:"51-\u57fa\u672c\u5206\u9875",level:3},{value:"5.2 \u6392\u5e8f",id:"52-\u6392\u5e8f",level:3},{value:"6. \u5b9e\u4f53\u5173\u7cfb\u6620\u5c04",id:"6-\u5b9e\u4f53\u5173\u7cfb\u6620\u5c04",level:2},{value:"6.1 \u4e00\u5bf9\u4e00\u5173\u7cfb",id:"61-\u4e00\u5bf9\u4e00\u5173\u7cfb",level:3},{value:"6.2 \u4e00\u5bf9\u591a\u5173\u7cfb",id:"62-\u4e00\u5bf9\u591a\u5173\u7cfb",level:3},{value:"6.3 \u591a\u5bf9\u591a\u5173\u7cfb",id:"63-\u591a\u5bf9\u591a\u5173\u7cfb",level:3},{value:"7. \u5ba1\u8ba1\u529f\u80fd",id:"7-\u5ba1\u8ba1\u529f\u80fd",level:2},{value:"7.1 \u542f\u7528\u5ba1\u8ba1",id:"71-\u542f\u7528\u5ba1\u8ba1",level:3},{value:"7.2 \u5ba1\u8ba1\u5b9e\u4f53",id:"72-\u5ba1\u8ba1\u5b9e\u4f53",level:3},{value:"7.3 \u4f7f\u7528\u5ba1\u8ba1\u57fa\u7c7b",id:"73-\u4f7f\u7528\u5ba1\u8ba1\u57fa\u7c7b",level:3},{value:"8. \u6700\u4f73\u5b9e\u8df5",id:"8-\u6700\u4f73\u5b9e\u8df5",level:2},{value:"8.1 \u4f18\u5148\u4f7f\u7528\u67e5\u8be2\u65b9\u6cd5",id:"81-\u4f18\u5148\u4f7f\u7528\u67e5\u8be2\u65b9\u6cd5",level:3},{value:"8.2 \u590d\u6742\u67e5\u8be2\u4f7f\u7528 @Query",id:"82-\u590d\u6742\u67e5\u8be2\u4f7f\u7528-query",level:3},{value:"8.3 \u907f\u514d N+1 \u67e5\u8be2\u95ee\u9898",id:"83-\u907f\u514d-n1-\u67e5\u8be2\u95ee\u9898",level:3},{value:"8.4 \u4f7f\u7528 DTO \u6295\u5f71",id:"84-\u4f7f\u7528-dto-\u6295\u5f71",level:3},{value:"9. \u603b\u7ed3",id:"9-\u603b\u7ed3",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"spring-data",children:"Spring Data"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["[!IMPORTANT] > ",(0,s.jsx)(n.strong,{children:"Spring Data \u6838\u5fc3"}),": Spring Data \u7b80\u5316\u4e86\u6570\u636e\u8bbf\u95ee\u5c42\u7684\u5f00\u53d1\uff0c\u901a\u8fc7 Repository \u63a5\u53e3\u81ea\u52a8\u751f\u6210\u5b9e\u73b0\u3002\u638c\u63e1\u67e5\u8be2\u65b9\u6cd5\u547d\u540d\u89c4\u5219\u548c\u81ea\u5b9a\u4e49\u67e5\u8be2\u662f\u5173\u952e\u3002"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"1-spring-data-\u6982\u8ff0",children:"1. Spring Data \u6982\u8ff0"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Spring Data"})," \u662f\u4e00\u4e2a\u7528\u4e8e\u7b80\u5316\u6570\u636e\u8bbf\u95ee\u7684\u9879\u76ee\u96c6\u5408\uff0c\u652f\u6301\u5173\u7cfb\u578b\u548c\u975e\u5173\u7cfb\u578b\u6570\u636e\u5e93\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"11-\u4e3b\u8981\u6a21\u5757",children:"1.1 \u4e3b\u8981\u6a21\u5757"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u6a21\u5757"}),(0,s.jsx)(n.th,{children:"\u8bf4\u660e"}),(0,s.jsx)(n.th,{children:"\u5e94\u7528\u573a\u666f"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Spring Data JPA"})}),(0,s.jsx)(n.td,{children:"\u57fa\u4e8e JPA \u7684\u6570\u636e\u8bbf\u95ee"}),(0,s.jsx)(n.td,{children:"\u5173\u7cfb\u578b\u6570\u636e\u5e93"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Spring Data MongoDB"})}),(0,s.jsx)(n.td,{children:"MongoDB \u6570\u636e\u8bbf\u95ee"}),(0,s.jsx)(n.td,{children:"\u6587\u6863\u578b\u6570\u636e\u5e93"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Spring Data Redis"})}),(0,s.jsx)(n.td,{children:"Redis \u6570\u636e\u8bbf\u95ee"}),(0,s.jsx)(n.td,{children:"\u7f13\u5b58\u3001\u4f1a\u8bdd\u5b58\u50a8"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Spring Data JDBC"})}),(0,s.jsx)(n.td,{children:"\u8f7b\u91cf\u7ea7 JDBC \u5c01\u88c5"}),(0,s.jsx)(n.td,{children:"\u7b80\u5355\u7684\u5173\u7cfb\u578b\u6570\u636e\u8bbf\u95ee"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"12-\u6838\u5fc3\u7279\u6027",children:"1.2 \u6838\u5fc3\u7279\u6027"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Repository \u62bd\u8c61"})," - \u7edf\u4e00\u7684\u6570\u636e\u8bbf\u95ee\u63a5\u53e3"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u67e5\u8be2\u65b9\u6cd5"})," - \u901a\u8fc7\u65b9\u6cd5\u540d\u81ea\u52a8\u751f\u6210\u67e5\u8be2"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u81ea\u5b9a\u4e49\u67e5\u8be2"})," - \u4f7f\u7528 @Query \u6ce8\u89e3"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5206\u9875\u548c\u6392\u5e8f"})," - \u5185\u7f6e\u5206\u9875\u652f\u6301"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u5ba1\u8ba1\u529f\u80fd"})," - \u81ea\u52a8\u8bb0\u5f55\u521b\u5efa\u548c\u4fee\u6539\u65f6\u95f4"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"2-repository-\u63a5\u53e3",children:"2. Repository \u63a5\u53e3"}),"\n",(0,s.jsx)(n.h3,{id:"21-repository-\u5c42\u6b21\u7ed3\u6784",children:"2.1 Repository \u5c42\u6b21\u7ed3\u6784"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"Repository                     // \u6807\u8bb0\u63a5\u53e3\n    \u251c\u2500\u2500 CrudRepository        // \u57fa\u672c CRUD \u64cd\u4f5c\n    \u251c\u2500\u2500 PagingAndSortingRepository  // \u5206\u9875\u548c\u6392\u5e8f\n    \u2514\u2500\u2500 JpaRepository         // JPA \u7279\u5b9a\u529f\u80fd\n"})}),"\n",(0,s.jsx)(n.h3,{id:"22-crudrepository",children:"2.2 CrudRepository"}),"\n",(0,s.jsx)(n.p,{children:"\u63d0\u4f9b\u57fa\u672c\u7684 CRUD \u64cd\u4f5c\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public interface UserRepository extends CrudRepository<User, Long> {\n    // \u7ee7\u627f\u7684\u65b9\u6cd5\uff1a\n    // save(S entity)\n    // saveAll(Iterable<S> entities)\n    // findById(ID id)\n    // existsById(ID id)\n    // findAll()\n    // findAllById(Iterable<ID> ids)\n    // count()\n    // deleteById(ID id)\n    // delete(T entity)\n    // deleteAll()\n}\n\n// \u4f7f\u7528\u793a\u4f8b\n@Service\npublic class UserService {\n    @Autowired\n    private UserRepository userRepository;\n\n    public void example() {\n        // \u4fdd\u5b58\n        User user = new User("John", "john@example.com");\n        userRepository.save(user);\n\n        // \u67e5\u8be2\n        Optional<User> found = userRepository.findById(1L);\n\n        // \u5220\u9664\n        userRepository.deleteById(1L);\n\n        // \u7edf\u8ba1\n        long count = userRepository.count();\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"23-jparepository",children:"2.3 JpaRepository"}),"\n",(0,s.jsx)(n.p,{children:"\u6269\u5c55\u4e86 CrudRepository\uff0c\u63d0\u4f9b JPA \u7279\u5b9a\u529f\u80fd\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public interface UserRepository extends JpaRepository<User, Long> {\n    // \u7ee7\u627f\u7684\u989d\u5916\u65b9\u6cd5\uff1a\n    // flush()\n    // saveAndFlush(S entity)\n    // deleteInBatch(Iterable<T> entities)\n    // deleteAllInBatch()\n    // getOne(ID id)  // \u8fd4\u56de\u5f15\u7528\uff0c\u5ef6\u8fdf\u52a0\u8f7d\n}\n\n// \u4f7f\u7528\u793a\u4f8b\n@Service\npublic class UserService {\n    @Autowired\n    private UserRepository userRepository;\n\n    public void batchOperations() {\n        // \u6279\u91cf\u5220\u9664\uff08\u66f4\u9ad8\u6548\uff09\n        List<User> users = userRepository.findAll();\n        userRepository.deleteInBatch(users);\n\n        // \u4fdd\u5b58\u5e76\u7acb\u5373\u5237\u65b0\u5230\u6570\u636e\u5e93\n        User user = new User("Jane", "jane@example.com");\n        userRepository.saveAndFlush(user);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"3-\u67e5\u8be2\u65b9\u6cd5\u547d\u540d\u89c4\u5219",children:"3. \u67e5\u8be2\u65b9\u6cd5\u547d\u540d\u89c4\u5219"}),"\n",(0,s.jsx)(n.h3,{id:"31-\u57fa\u672c\u89c4\u5219",children:"3.1 \u57fa\u672c\u89c4\u5219"}),"\n",(0,s.jsx)(n.p,{children:"Spring Data \u6839\u636e\u65b9\u6cd5\u540d\u81ea\u52a8\u751f\u6210\u67e5\u8be2\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"public interface UserRepository extends JpaRepository<User, Long> {\n\n    // \u6839\u636e\u5355\u4e2a\u5c5e\u6027\u67e5\u8be2\n    User findByName(String name);\n    User findByEmail(String email);\n\n    // \u591a\u4e2a\u6761\u4ef6 - AND\n    User findByNameAndEmail(String name, String email);\n\n    // \u591a\u4e2a\u6761\u4ef6 - OR\n    List<User> findByNameOrEmail(String name, String email);\n\n    // \u6a21\u7cca\u67e5\u8be2\n    List<User> findByNameContaining(String keyword);\n    List<User> findByNameStartingWith(String prefix);\n    List<User> findByNameEndingWith(String suffix);\n\n    // \u8303\u56f4\u67e5\u8be2\n    List<User> findByAgeGreaterThan(int age);\n    List<User> findByAgeLessThan(int age);\n    List<User> findByAgeBetween(int start, int end);\n\n    // NULL \u5224\u65ad\n    List<User> findByEmailIsNull();\n    List<User> findByEmailIsNotNull();\n\n    // \u96c6\u5408\u67e5\u8be2\n    List<User> findByNameIn(Collection<String> names);\n    List<User> findByNameNotIn(Collection<String> names);\n\n    // \u6392\u5e8f\n    List<User> findByAgeOrderByNameAsc(int age);\n    List<User> findByAgeOrderByNameDesc(int age);\n\n    // \u9650\u5236\u7ed3\u679c\u6570\u91cf\n    User findFirstByOrderByNameAsc();\n    List<User> findTop3ByOrderByAgeDesc();\n\n    // \u53bb\u91cd\n    List<User> findDistinctByName(String name);\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"32-\u5173\u952e\u5b57\u5bf9\u7167\u8868",children:"3.2 \u5173\u952e\u5b57\u5bf9\u7167\u8868"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u5173\u952e\u5b57"}),(0,s.jsx)(n.th,{children:"\u793a\u4f8b"}),(0,s.jsx)(n.th,{children:"JPQL"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"And"}),(0,s.jsx)(n.td,{children:"findByNameAndEmail"}),(0,s.jsx)(n.td,{children:"where name = ? and email = ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Or"}),(0,s.jsx)(n.td,{children:"findByNameOrEmail"}),(0,s.jsx)(n.td,{children:"where name = ? or email = ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Is, Equals"}),(0,s.jsx)(n.td,{children:"findByName"}),(0,s.jsx)(n.td,{children:"where name = ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Between"}),(0,s.jsx)(n.td,{children:"findByAgeBetween"}),(0,s.jsx)(n.td,{children:"where age between ? and ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"LessThan"}),(0,s.jsx)(n.td,{children:"findByAgeLessThan"}),(0,s.jsx)(n.td,{children:"where age < ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"LessThanEqual"}),(0,s.jsx)(n.td,{children:"findByAgeLessThanEqual"}),(0,s.jsx)(n.td,{children:"where age <= ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"GreaterThan"}),(0,s.jsx)(n.td,{children:"findByAgeGreaterThan"}),(0,s.jsx)(n.td,{children:"where age > ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"GreaterThanEqual"}),(0,s.jsx)(n.td,{children:"findByAgeGreaterThanEqual"}),(0,s.jsx)(n.td,{children:"where age >= ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"After"}),(0,s.jsx)(n.td,{children:"findByDateAfter"}),(0,s.jsx)(n.td,{children:"where date > ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Before"}),(0,s.jsx)(n.td,{children:"findByDateBefore"}),(0,s.jsx)(n.td,{children:"where date < ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"IsNull"}),(0,s.jsx)(n.td,{children:"findByEmailIsNull"}),(0,s.jsx)(n.td,{children:"where email is null"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"IsNotNull"}),(0,s.jsx)(n.td,{children:"findByEmailIsNotNull"}),(0,s.jsx)(n.td,{children:"where email is not null"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Like"}),(0,s.jsx)(n.td,{children:"findByNameLike"}),(0,s.jsx)(n.td,{children:"where name like ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"NotLike"}),(0,s.jsx)(n.td,{children:"findByNameNotLike"}),(0,s.jsx)(n.td,{children:"where name not like ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"StartingWith"}),(0,s.jsx)(n.td,{children:"findByNameStartingWith"}),(0,s.jsx)(n.td,{children:"where name like '?%'"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"EndingWith"}),(0,s.jsx)(n.td,{children:"findByNameEndingWith"}),(0,s.jsx)(n.td,{children:"where name like '%?'"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Containing"}),(0,s.jsx)(n.td,{children:"findByNameContaining"}),(0,s.jsx)(n.td,{children:"where name like '%?%'"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"OrderBy"}),(0,s.jsx)(n.td,{children:"findByAgeOrderByNameDesc"}),(0,s.jsx)(n.td,{children:"order by name desc"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Not"}),(0,s.jsx)(n.td,{children:"findByNameNot"}),(0,s.jsx)(n.td,{children:"where name <> ?"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"In"}),(0,s.jsx)(n.td,{children:"findByAgeIn"}),(0,s.jsx)(n.td,{children:"where age in (?)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"NotIn"}),(0,s.jsx)(n.td,{children:"findByAgeNotIn"}),(0,s.jsx)(n.td,{children:"where age not in (?)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"True"}),(0,s.jsx)(n.td,{children:"findByActiveTrue"}),(0,s.jsx)(n.td,{children:"where active = true"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"False"}),(0,s.jsx)(n.td,{children:"findByActiveFalse"}),(0,s.jsx)(n.td,{children:"where active = false"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"4-\u81ea\u5b9a\u4e49\u67e5\u8be2",children:"4. \u81ea\u5b9a\u4e49\u67e5\u8be2"}),"\n",(0,s.jsx)(n.h3,{id:"41-\u4f7f\u7528-query",children:"4.1 \u4f7f\u7528 @Query"}),"\n",(0,s.jsx)(n.p,{children:"\u5f53\u67e5\u8be2\u65b9\u6cd5\u540d\u8fc7\u4e8e\u590d\u6742\u65f6\uff0c\u4f7f\u7528 @Query \u6ce8\u89e3\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public interface UserRepository extends JpaRepository<User, Long> {\n\n    // JPQL \u67e5\u8be2\n    @Query("SELECT u FROM User u WHERE u.email = ?1")\n    User findByEmailAddress(String email);\n\n    // \u547d\u540d\u53c2\u6570\n    @Query("SELECT u FROM User u WHERE u.name = :name AND u.age > :age")\n    List<User> findByNameAndAgeGreaterThan(\n        @Param("name") String name,\n        @Param("age") int age\n    );\n\n    // \u539f\u751f SQL \u67e5\u8be2\n    @Query(value = "SELECT * FROM users WHERE email = ?1", nativeQuery = true)\n    User findByEmailNative(String email);\n\n    // \u66f4\u65b0\u67e5\u8be2\n    @Modifying\n    @Query("UPDATE User u SET u.status = :status WHERE u.id = :id")\n    int updateUserStatus(@Param("id") Long id, @Param("status") String status);\n\n    // \u5220\u9664\u67e5\u8be2\n    @Modifying\n    @Query("DELETE FROM User u WHERE u.status = :status")\n    int deleteByStatus(@Param("status") String status);\n\n    // \u805a\u5408\u67e5\u8be2\n    @Query("SELECT COUNT(u) FROM User u WHERE u.age > :age")\n    long countByAgeGreaterThan(@Param("age") int age);\n\n    // \u6295\u5f71\u67e5\u8be2\uff08\u53ea\u67e5\u8be2\u90e8\u5206\u5b57\u6bb5\uff09\n    @Query("SELECT u.name, u.email FROM User u WHERE u.id = :id")\n    Object[] findNameAndEmailById(@Param("id") Long id);\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"42-modifying-\u6ce8\u610f\u4e8b\u9879",children:"4.2 @Modifying \u6ce8\u610f\u4e8b\u9879"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"@Service\npublic class UserService {\n    @Autowired\n    private UserRepository userRepository;\n\n    @Transactional  // \u5fc5\u987b\u5728\u4e8b\u52a1\u4e2d\n    public int updateStatus(Long id, String status) {\n        return userRepository.updateUserStatus(id, status);\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"5-\u5206\u9875\u548c\u6392\u5e8f",children:"5. \u5206\u9875\u548c\u6392\u5e8f"}),"\n",(0,s.jsx)(n.h3,{id:"51-\u57fa\u672c\u5206\u9875",children:"5.1 \u57fa\u672c\u5206\u9875"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'public interface UserRepository extends JpaRepository<User, Long> {\n    Page<User> findByAge(int age, Pageable pageable);\n}\n\n@Service\npublic class UserService {\n    @Autowired\n    private UserRepository userRepository;\n\n    public Page<User> getUsersByAge(int age, int page, int size) {\n        // \u521b\u5efa\u5206\u9875\u8bf7\u6c42\n        Pageable pageable = PageRequest.of(page, size);\n        return userRepository.findByAge(age, pageable);\n    }\n\n    public void printPageInfo(Page<User> page) {\n        System.out.println("\u603b\u9875\u6570: " + page.getTotalPages());\n        System.out.println("\u603b\u8bb0\u5f55\u6570: " + page.getTotalElements());\n        System.out.println("\u5f53\u524d\u9875: " + page.getNumber());\n        System.out.println("\u6bcf\u9875\u5927\u5c0f: " + page.getSize());\n        System.out.println("\u5f53\u524d\u9875\u8bb0\u5f55\u6570: " + page.getNumberOfElements());\n        System.out.println("\u662f\u5426\u7b2c\u4e00\u9875: " + page.isFirst());\n        System.out.println("\u662f\u5426\u6700\u540e\u4e00\u9875: " + page.isLast());\n\n        List<User> users = page.getContent();\n        users.forEach(System.out::println);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"52-\u6392\u5e8f",children:"5.2 \u6392\u5e8f"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Service\npublic class UserService {\n    @Autowired\n    private UserRepository userRepository;\n\n    public List<User> getUsersSorted() {\n        // \u5355\u5b57\u6bb5\u6392\u5e8f\n        Sort sort = Sort.by(Sort.Direction.DESC, "age");\n        return userRepository.findAll(sort);\n    }\n\n    public List<User> getUsersMultiSort() {\n        // \u591a\u5b57\u6bb5\u6392\u5e8f\n        Sort sort = Sort.by(\n            Sort.Order.desc("age"),\n            Sort.Order.asc("name")\n        );\n        return userRepository.findAll(sort);\n    }\n\n    public Page<User> getUsersPagedAndSorted(int page, int size) {\n        // \u5206\u9875 + \u6392\u5e8f\n        Sort sort = Sort.by(Sort.Direction.DESC, "age");\n        Pageable pageable = PageRequest.of(page, size, sort);\n        return userRepository.findAll(pageable);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"6-\u5b9e\u4f53\u5173\u7cfb\u6620\u5c04",children:"6. \u5b9e\u4f53\u5173\u7cfb\u6620\u5c04"}),"\n",(0,s.jsx)(n.h3,{id:"61-\u4e00\u5bf9\u4e00\u5173\u7cfb",children:"6.1 \u4e00\u5bf9\u4e00\u5173\u7cfb"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Entity\npublic class User {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    private String name;\n\n    @OneToOne(cascade = CascadeType.ALL)\n    @JoinColumn(name = "profile_id")\n    private UserProfile profile;\n}\n\n@Entity\npublic class UserProfile {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    private String bio;\n    private String avatar;\n\n    @OneToOne(mappedBy = "profile")\n    private User user;\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"62-\u4e00\u5bf9\u591a\u5173\u7cfb",children:"6.2 \u4e00\u5bf9\u591a\u5173\u7cfb"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Entity\npublic class User {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    private String name;\n\n    @OneToMany(mappedBy = "user", cascade = CascadeType.ALL)\n    private List<Order> orders = new ArrayList<>();\n}\n\n@Entity\npublic class Order {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    private String orderNumber;\n\n    @ManyToOne\n    @JoinColumn(name = "user_id")\n    private User user;\n}\n\n// Repository \u67e5\u8be2\npublic interface UserRepository extends JpaRepository<User, Long> {\n    // \u67e5\u8be2\u6709\u8ba2\u5355\u7684\u7528\u6237\n    @Query("SELECT DISTINCT u FROM User u JOIN FETCH u.orders")\n    List<User> findUsersWithOrders();\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"63-\u591a\u5bf9\u591a\u5173\u7cfb",children:"6.3 \u591a\u5bf9\u591a\u5173\u7cfb"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Entity\npublic class Student {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    private String name;\n\n    @ManyToMany\n    @JoinTable(\n        name = "student_course",\n        joinColumns = @JoinColumn(name = "student_id"),\n        inverseJoinColumns = @JoinColumn(name = "course_id")\n    )\n    private Set<Course> courses = new HashSet<>();\n}\n\n@Entity\npublic class Course {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    private String name;\n\n    @ManyToMany(mappedBy = "courses")\n    private Set<Student> students = new HashSet<>();\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"7-\u5ba1\u8ba1\u529f\u80fd",children:"7. \u5ba1\u8ba1\u529f\u80fd"}),"\n",(0,s.jsx)(n.h3,{id:"71-\u542f\u7528\u5ba1\u8ba1",children:"7.1 \u542f\u7528\u5ba1\u8ba1"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Configuration\n@EnableJpaAuditing\npublic class JpaConfig {\n\n    @Bean\n    public AuditorAware<String> auditorProvider() {\n        return () -> Optional.of("system"); // \u5b9e\u9645\u9879\u76ee\u4e2d\u4ece\u5b89\u5168\u4e0a\u4e0b\u6587\u83b7\u53d6\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"72-\u5ba1\u8ba1\u5b9e\u4f53",children:"7.2 \u5ba1\u8ba1\u5b9e\u4f53"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"@Entity\n@EntityListeners(AuditingEntityListener.class)\npublic class User {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    private String name;\n\n    @CreatedDate\n    private LocalDateTime createdDate;\n\n    @LastModifiedDate\n    private LocalDateTime lastModifiedDate;\n\n    @CreatedBy\n    private String createdBy;\n\n    @LastModifiedBy\n    private String lastModifiedBy;\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"73-\u4f7f\u7528\u5ba1\u8ba1\u57fa\u7c7b",children:"7.3 \u4f7f\u7528\u5ba1\u8ba1\u57fa\u7c7b"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"@MappedSuperclass\n@EntityListeners(AuditingEntityListener.class)\npublic abstract class Auditable {\n\n    @CreatedDate\n    @Column(updatable = false)\n    private LocalDateTime createdDate;\n\n    @LastModifiedDate\n    private LocalDateTime lastModifiedDate;\n\n    @CreatedBy\n    @Column(updatable = false)\n    private String createdBy;\n\n    @LastModifiedBy\n    private String lastModifiedBy;\n}\n\n@Entity\npublic class User extends Auditable {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n\n    private String name;\n    private String email;\n\n    // \u81ea\u52a8\u7ee7\u627f\u5ba1\u8ba1\u5b57\u6bb5\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"8-\u6700\u4f73\u5b9e\u8df5",children:"8. \u6700\u4f73\u5b9e\u8df5"}),"\n",(0,s.jsx)(n.h3,{id:"81-\u4f18\u5148\u4f7f\u7528\u67e5\u8be2\u65b9\u6cd5",children:"8.1 \u4f18\u5148\u4f7f\u7528\u67e5\u8be2\u65b9\u6cd5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 \u63a8\u8350\uff1a\u7b80\u5355\u67e5\u8be2\u4f7f\u7528\u65b9\u6cd5\u540d\npublic interface UserRepository extends JpaRepository<User, Long> {\n    User findByEmail(String email);\n    List<User> findByAgeGreaterThan(int age);\n}\n\n// \u274c \u907f\u514d\uff1a\u7b80\u5355\u67e5\u8be2\u4e5f\u7528 @Query\npublic interface UserRepository extends JpaRepository<User, Long> {\n    @Query("SELECT u FROM User u WHERE u.email = :email")\n    User findByEmail(@Param("email") String email);\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"82-\u590d\u6742\u67e5\u8be2\u4f7f\u7528-query",children:"8.2 \u590d\u6742\u67e5\u8be2\u4f7f\u7528 @Query"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u2705 \u63a8\u8350\uff1a\u590d\u6742\u67e5\u8be2\u4f7f\u7528 @Query\npublic interface UserRepository extends JpaRepository<User, Long> {\n    @Query("SELECT u FROM User u WHERE " +\n           "(u.name LIKE %:keyword% OR u.email LIKE %:keyword%) " +\n           "AND u.age BETWEEN :minAge AND :maxAge " +\n           "AND u.status = :status")\n    List<User> searchUsers(\n        @Param("keyword") String keyword,\n        @Param("minAge") int minAge,\n        @Param("maxAge") int maxAge,\n        @Param("status") String status\n    );\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"83-\u907f\u514d-n1-\u67e5\u8be2\u95ee\u9898",children:"8.3 \u907f\u514d N+1 \u67e5\u8be2\u95ee\u9898"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u274c \u9519\u8bef\uff1a\u4f1a\u4ea7\u751f N+1 \u67e5\u8be2\n@Query("SELECT u FROM User u WHERE u.status = :status")\nList<User> findByStatus(@Param("status") String status);\n// \u8bbf\u95ee user.getOrders() \u4f1a\u89e6\u53d1\u989d\u5916\u67e5\u8be2\n\n// \u2705 \u6b63\u786e\uff1a\u4f7f\u7528 JOIN FETCH\n@Query("SELECT u FROM User u JOIN FETCH u.orders WHERE u.status = :status")\nList<User> findByStatusWithOrders(@Param("status") String status);\n'})}),"\n",(0,s.jsx)(n.h3,{id:"84-\u4f7f\u7528-dto-\u6295\u5f71",children:"8.4 \u4f7f\u7528 DTO \u6295\u5f71"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u5b9a\u4e49 DTO\npublic class UserDTO {\n    private String name;\n    private String email;\n\n    public UserDTO(String name, String email) {\n        this.name = name;\n        this.email = email;\n    }\n\n    // getters\n}\n\n// Repository\npublic interface UserRepository extends JpaRepository<User, Long> {\n    @Query("SELECT new com.example.dto.UserDTO(u.name, u.email) FROM User u")\n    List<UserDTO> findAllUserDTOs();\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"9-\u603b\u7ed3",children:"9. \u603b\u7ed3"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"\u6982\u5ff5"}),(0,s.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Repository"}),(0,s.jsx)(n.td,{children:"\u6570\u636e\u8bbf\u95ee\u63a5\u53e3"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"CrudRepository"}),(0,s.jsx)(n.td,{children:"\u57fa\u672c CRUD \u64cd\u4f5c"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"JpaRepository"}),(0,s.jsx)(n.td,{children:"JPA \u7279\u5b9a\u529f\u80fd"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u67e5\u8be2\u65b9\u6cd5"}),(0,s.jsx)(n.td,{children:"\u6839\u636e\u65b9\u6cd5\u540d\u751f\u6210\u67e5\u8be2"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"@Query"}),(0,s.jsx)(n.td,{children:"\u81ea\u5b9a\u4e49 JPQL/SQL \u67e5\u8be2"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Pageable"}),(0,s.jsx)(n.td,{children:"\u5206\u9875\u53c2\u6570"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Sort"}),(0,s.jsx)(n.td,{children:"\u6392\u5e8f\u53c2\u6570"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"\u5ba1\u8ba1"}),(0,s.jsx)(n.td,{children:"\u81ea\u52a8\u8bb0\u5f55\u521b\u5efa/\u4fee\u6539\u4fe1\u606f"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u5173\u952e\u8981\u70b9"}),"\uff1a"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u4f18\u5148\u4f7f\u7528\u67e5\u8be2\u65b9\u6cd5\u547d\u540d\u89c4\u5219"}),"\n",(0,s.jsx)(n.li,{children:"\u590d\u6742\u67e5\u8be2\u4f7f\u7528 @Query"}),"\n",(0,s.jsx)(n.li,{children:"\u6ce8\u610f\u907f\u514d N+1 \u67e5\u8be2\u95ee\u9898"}),"\n",(0,s.jsx)(n.li,{children:"\u5408\u7406\u4f7f\u7528\u5206\u9875\u548c\u6392\u5e8f"}),"\n",(0,s.jsx)(n.li,{children:"\u5229\u7528\u5ba1\u8ba1\u529f\u80fd\u8ffd\u8e2a\u53d8\u66f4"}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"\u4e0b\u4e00\u6b65"}),"\uff1a\u5b66\u4e60 ",(0,s.jsx)(n.a,{href:"/docs/spring/transactions",children:"Spring \u4e8b\u52a1\u7ba1\u7406"})]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}}}]);