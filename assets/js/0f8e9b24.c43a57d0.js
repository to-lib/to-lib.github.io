"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[28011],{21942:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"nginx/security","title":"\u5b89\u5168\u914d\u7f6e","description":"Nginx \u5b89\u5168\u52a0\u56fa\u4e0e\u9632\u62a4\u914d\u7f6e","source":"@site/docs/nginx/security.md","sourceDirName":"nginx","slug":"/nginx/security","permalink":"/docs/nginx/security","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/nginx/security.md","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"\u5b89\u5168\u914d\u7f6e","description":"Nginx \u5b89\u5168\u52a0\u56fa\u4e0e\u9632\u62a4\u914d\u7f6e"},"sidebar":"nginx","previous":{"title":"SSL/TLS \u914d\u7f6e","permalink":"/docs/nginx/ssl-tls"},"next":{"title":"\u6027\u80fd\u4f18\u5316","permalink":"/docs/nginx/performance"}}');var s=i(22714),r=i(48885);const l={sidebar_position:8,title:"\u5b89\u5168\u914d\u7f6e",description:"Nginx \u5b89\u5168\u52a0\u56fa\u4e0e\u9632\u62a4\u914d\u7f6e"},a="\u5b89\u5168\u914d\u7f6e",o={},c=[{value:"\u9690\u85cf\u7248\u672c\u4fe1\u606f",id:"\u9690\u85cf\u7248\u672c\u4fe1\u606f",level:2},{value:"\u8bbf\u95ee\u63a7\u5236",id:"\u8bbf\u95ee\u63a7\u5236",level:2},{value:"\u8bf7\u6c42\u9650\u5236",id:"\u8bf7\u6c42\u9650\u5236",level:2},{value:"\u9632\u6b62\u5e38\u89c1\u653b\u51fb",id:"\u9632\u6b62\u5e38\u89c1\u653b\u51fb",level:2},{value:"\u8bf7\u6c42\u4f53\u5927\u5c0f\u9650\u5236",id:"\u8bf7\u6c42\u4f53\u5927\u5c0f\u9650\u5236",level:2},{value:"\u8d85\u65f6\u8bbe\u7f6e",id:"\u8d85\u65f6\u8bbe\u7f6e",level:2},{value:"SSL \u5b89\u5168\u914d\u7f6e",id:"ssl-\u5b89\u5168\u914d\u7f6e",level:2}];function d(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"\u5b89\u5168\u914d\u7f6e",children:"\u5b89\u5168\u914d\u7f6e"})}),"\n",(0,s.jsx)(e.h2,{id:"\u9690\u85cf\u7248\u672c\u4fe1\u606f",children:"\u9690\u85cf\u7248\u672c\u4fe1\u606f"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:"http {\n    server_tokens off;\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u8bbf\u95ee\u63a7\u5236",children:"\u8bbf\u95ee\u63a7\u5236"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:'# IP \u9ed1\u767d\u540d\u5355\nlocation /admin/ {\n    allow 192.168.1.0/24;\n    allow 10.0.0.1;\n    deny all;\n}\n\n# \u57fa\u672c\u8ba4\u8bc1\nlocation /protected/ {\n    auth_basic "Restricted";\n    auth_basic_user_file /etc/nginx/.htpasswd;\n}\n'})}),"\n",(0,s.jsx)(e.p,{children:"\u751f\u6210\u5bc6\u7801\u6587\u4ef6\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"htpasswd -c /etc/nginx/.htpasswd username\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u8bf7\u6c42\u9650\u5236",children:"\u8bf7\u6c42\u9650\u5236"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:"# \u9650\u5236\u8bf7\u6c42\u9891\u7387\nhttp {\n    limit_req_zone $binary_remote_addr zone=req_limit:10m rate=10r/s;\n\n    server {\n        location /api/ {\n            limit_req zone=req_limit burst=20 nodelay;\n        }\n    }\n}\n\n# \u9650\u5236\u5e76\u53d1\u8fde\u63a5\nhttp {\n    limit_conn_zone $binary_remote_addr zone=conn_limit:10m;\n\n    server {\n        location / {\n            limit_conn conn_limit 10;\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u9632\u6b62\u5e38\u89c1\u653b\u51fb",children:"\u9632\u6b62\u5e38\u89c1\u653b\u51fb"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:'# \u9632\u6b62\u70b9\u51fb\u52ab\u6301\nadd_header X-Frame-Options "SAMEORIGIN" always;\n\n# \u9632\u6b62 XSS\nadd_header X-XSS-Protection "1; mode=block" always;\n\n# \u9632\u6b62 MIME \u7c7b\u578b\u55c5\u63a2\nadd_header X-Content-Type-Options "nosniff" always;\n\n# \u5185\u5bb9\u5b89\u5168\u7b56\u7565\nadd_header Content-Security-Policy "default-src \'self\'" always;\n\n# \u7981\u7528\u670d\u52a1\u5668\u65b9\u6cd5\nif ($request_method !~ ^(GET|POST|HEAD)$) {\n    return 405;\n}\n\n# \u7981\u6b62\u8bbf\u95ee\u9690\u85cf\u6587\u4ef6\nlocation ~ /\\. {\n    deny all;\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u8bf7\u6c42\u4f53\u5927\u5c0f\u9650\u5236",children:"\u8bf7\u6c42\u4f53\u5927\u5c0f\u9650\u5236"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:"client_max_body_size 10m;\nclient_body_buffer_size 128k;\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u8d85\u65f6\u8bbe\u7f6e",children:"\u8d85\u65f6\u8bbe\u7f6e"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:"client_body_timeout 10s;\nclient_header_timeout 10s;\nsend_timeout 10s;\nkeepalive_timeout 65s;\n"})}),"\n",(0,s.jsx)(e.h2,{id:"ssl-\u5b89\u5168\u914d\u7f6e",children:"SSL \u5b89\u5168\u914d\u7f6e"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-nginx",children:'ssl_protocols TLSv1.2 TLSv1.3;\nssl_prefer_server_ciphers on;\nssl_session_tickets off;\n\nadd_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;\n'})})]})}function h(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},48885:(n,e,i)=>{i.d(e,{R:()=>l,x:()=>a});var t=i(99378);const s={},r=t.createContext(s);function l(n){const e=t.useContext(r);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),t.createElement(r.Provider,{value:e},n.children)}}}]);