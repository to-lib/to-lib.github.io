"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[4022],{48885:(n,e,t)=>{t.d(e,{R:()=>l,x:()=>o});var r=t(99378);const s={},i=r.createContext(s);function l(n){const e=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),r.createElement(i.Provider,{value:e},n.children)}},91664:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"react/refs-dom","title":"Refs \u548c DOM","description":"[!TIP]","source":"@site/docs/react/refs-dom.md","sourceDirName":"react","slug":"/react/refs-dom","permalink":"/docs/react/refs-dom","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/react/refs-dom.md","tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"sidebar_position":16,"title":"Refs \u548c DOM"},"sidebar":"react","previous":{"title":"Context API","permalink":"/docs/react/context"},"next":{"title":"\u9519\u8bef\u8fb9\u754c","permalink":"/docs/react/error-boundaries"}}');var s=t(22714),i=t(48885);const l={sidebar_position:16,title:"Refs \u548c DOM"},o="Refs \u548c DOM \u64cd\u4f5c",c={},u=[{value:"\ud83d\udcda \u4ec0\u4e48\u662f Refs\uff1f",id:"-\u4ec0\u4e48\u662f-refs",level:2},{value:"\u4f55\u65f6\u4f7f\u7528 Refs",id:"\u4f55\u65f6\u4f7f\u7528-refs",level:3},{value:"\ud83c\udfaf useRef Hook",id:"-useref-hook",level:2},{value:"\u57fa\u7840\u7528\u6cd5",id:"\u57fa\u7840\u7528\u6cd5",level:3},{value:"Ref \u5bf9\u8c61\u7ed3\u6784",id:"ref-\u5bf9\u8c61\u7ed3\u6784",level:3},{value:"\ud83d\udd04 \u591a\u79cd Ref \u7c7b\u578b",id:"-\u591a\u79cd-ref-\u7c7b\u578b",level:2},{value:"1. DOM Refs",id:"1-dom-refs",level:3},{value:"2. \u4fdd\u5b58\u53ef\u53d8\u503c",id:"2-\u4fdd\u5b58\u53ef\u53d8\u503c",level:3},{value:"3. \u4fdd\u5b58\u524d\u4e00\u4e2a\u503c",id:"3-\u4fdd\u5b58\u524d\u4e00\u4e2a\u503c",level:3},{value:"\ud83d\udd17 forwardRef - \u8f6c\u53d1 Refs",id:"-forwardref---\u8f6c\u53d1-refs",level:2},{value:"\u57fa\u7840\u7528\u6cd5",id:"\u57fa\u7840\u7528\u6cd5-1",level:3},{value:"\u590d\u6742\u793a\u4f8b\uff1a\u81ea\u5b9a\u4e49\u7ec4\u4ef6\u5e93",id:"\u590d\u6742\u793a\u4f8b\u81ea\u5b9a\u4e49\u7ec4\u4ef6\u5e93",level:3},{value:"\ud83c\udfa8 useImperativeHandle",id:"-useimperativehandle",level:2},{value:"\u57fa\u7840\u7528\u6cd5",id:"\u57fa\u7840\u7528\u6cd5-2",level:3},{value:"\u89c6\u9891\u64ad\u653e\u5668\u793a\u4f8b",id:"\u89c6\u9891\u64ad\u653e\u5668\u793a\u4f8b",level:3},{value:"\ud83d\udccf \u6d4b\u91cf DOM \u5143\u7d20",id:"-\u6d4b\u91cf-dom-\u5143\u7d20",level:2},{value:"\u83b7\u53d6\u5143\u7d20\u5c3a\u5bf8",id:"\u83b7\u53d6\u5143\u7d20\u5c3a\u5bf8",level:3},{value:"ResizeObserver \u76d1\u542c\u5c3a\u5bf8\u53d8\u5316",id:"resizeobserver-\u76d1\u542c\u5c3a\u5bf8\u53d8\u5316",level:3},{value:"\ud83c\udfaf \u5b9e\u9645\u5e94\u7528\u573a\u666f",id:"-\u5b9e\u9645\u5e94\u7528\u573a\u666f",level:2},{value:"1. \u81ea\u52a8\u805a\u7126\u8f93\u5165\u6846",id:"1-\u81ea\u52a8\u805a\u7126\u8f93\u5165\u6846",level:3},{value:"2. \u6eda\u52a8\u5230\u89c6\u56fe",id:"2-\u6eda\u52a8\u5230\u89c6\u56fe",level:3},{value:"3. \u6587\u672c\u9009\u62e9",id:"3-\u6587\u672c\u9009\u62e9",level:3},{value:"4. \u96c6\u6210\u7b2c\u4e09\u65b9\u5e93\uff08Chart.js\uff09",id:"4-\u96c6\u6210\u7b2c\u4e09\u65b9\u5e93chartjs",level:3},{value:"5. \u8868\u5355\u9a8c\u8bc1",id:"5-\u8868\u5355\u9a8c\u8bc1",level:3},{value:"\ud83d\udca1 \u6700\u4f73\u5b9e\u8df5",id:"-\u6700\u4f73\u5b9e\u8df5",level:2},{value:"1. \u907f\u514d\u8fc7\u5ea6\u4f7f\u7528 Refs",id:"1-\u907f\u514d\u8fc7\u5ea6\u4f7f\u7528-refs",level:3},{value:"2. Ref \u4e0d\u89e6\u53d1\u91cd\u65b0\u6e32\u67d3",id:"2-ref-\u4e0d\u89e6\u53d1\u91cd\u65b0\u6e32\u67d3",level:3},{value:"3. Callback Refs",id:"3-callback-refs",level:3},{value:"4. \u591a\u4e2a Refs",id:"4-\u591a\u4e2a-refs",level:3},{value:"\ud83d\udea8 \u5e38\u89c1\u9519\u8bef",id:"-\u5e38\u89c1\u9519\u8bef",level:2},{value:"1. \u5728\u6e32\u67d3\u671f\u95f4\u8bbf\u95ee Ref",id:"1-\u5728\u6e32\u67d3\u671f\u95f4\u8bbf\u95ee-ref",level:3},{value:"2. Ref \u4e3a null",id:"2-ref-\u4e3a-null",level:3}];function a(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"refs-\u548c-dom-\u64cd\u4f5c",children:"Refs \u548c DOM \u64cd\u4f5c"})}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsx)(e.p,{children:"[!TIP]\nRefs \u63d0\u4f9b\u4e86\u8bbf\u95ee DOM \u8282\u70b9\u6216 React \u5143\u7d20\u7684\u65b9\u5f0f\u3002\u7406\u89e3 Refs \u5bf9\u4e8e\u96c6\u6210\u7b2c\u4e09\u65b9\u5e93\u3001\u805a\u7126\u8f93\u5165\u6846\u3001\u89e6\u53d1\u52a8\u753b\u7b49\u573a\u666f\u81f3\u5173\u91cd\u8981\u3002"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"-\u4ec0\u4e48\u662f-refs",children:"\ud83d\udcda \u4ec0\u4e48\u662f Refs\uff1f"}),"\n",(0,s.jsx)(e.p,{children:"Refs \u662f React \u63d0\u4f9b\u7684\u4e00\u79cd\u8bbf\u95ee DOM \u8282\u70b9\u6216\u7ec4\u4ef6\u5b9e\u4f8b\u7684\u65b9\u5f0f\uff0c\u7ed5\u8fc7\u4e86\u58f0\u660e\u5f0f\u7684\u6570\u636e\u6d41\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"\u4f55\u65f6\u4f7f\u7528-refs",children:"\u4f55\u65f6\u4f7f\u7528 Refs"}),"\n",(0,s.jsxs)(e.p,{children:["\u2705 ",(0,s.jsx)(e.strong,{children:"\u9002\u5408\u4f7f\u7528\u7684\u573a\u666f\uff1a"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u7ba1\u7406\u7126\u70b9\u3001\u6587\u672c\u9009\u62e9\u6216\u5a92\u4f53\u64ad\u653e"}),"\n",(0,s.jsx)(e.li,{children:"\u89e6\u53d1\u5f3a\u5236\u52a8\u753b"}),"\n",(0,s.jsx)(e.li,{children:"\u96c6\u6210\u7b2c\u4e09\u65b9 DOM \u5e93"}),"\n",(0,s.jsx)(e.li,{children:"\u6d4b\u91cf DOM \u5143\u7d20\u5c3a\u5bf8"}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["\u274c ",(0,s.jsx)(e.strong,{children:"\u907f\u514d\u4f7f\u7528\u7684\u573a\u666f\uff1a"})]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u4efb\u4f55\u53ef\u4ee5\u58f0\u660e\u5f0f\u5b8c\u6210\u7684\u4e8b\u60c5"}),"\n",(0,s.jsx)(e.li,{children:"\u4e0d\u8981\u8fc7\u5ea6\u4f7f\u7528 Refs"}),"\n"]}),"\n",(0,s.jsx)(e.h2,{id:"-useref-hook",children:"\ud83c\udfaf useRef Hook"}),"\n",(0,s.jsx)(e.h3,{id:"\u57fa\u7840\u7528\u6cd5",children:"\u57fa\u7840\u7528\u6cd5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'import { useRef } from "react";\n\nfunction TextInput() {\n  const inputRef = useRef(null);\n\n  const focusInput = () => {\n    // \u8bbf\u95ee DOM \u8282\u70b9\n    inputRef.current.focus();\n  };\n\n  return (\n    <div>\n      <input ref={inputRef} type="text" />\n      <button onClick={focusInput}>\u805a\u7126\u8f93\u5165\u6846</button>\n    </div>\n  );\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"ref-\u5bf9\u8c61\u7ed3\u6784",children:"Ref \u5bf9\u8c61\u7ed3\u6784"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:"const myRef = useRef(initialValue);\n\nconsole.log(myRef);\n// { current: initialValue }\n\nmyRef.current = newValue; // \u53ef\u4ee5\u4fee\u6539\n"})}),"\n",(0,s.jsx)(e.h2,{id:"-\u591a\u79cd-ref-\u7c7b\u578b",children:"\ud83d\udd04 \u591a\u79cd Ref \u7c7b\u578b"}),"\n",(0,s.jsx)(e.h3,{id:"1-dom-refs",children:"1. DOM Refs"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'function MediaPlayer() {\n  const videoRef = useRef(null);\n\n  const play = () => videoRef.current.play();\n  const pause = () => videoRef.current.pause();\n  const mute = () => {\n    videoRef.current.muted = !videoRef.current.muted;\n  };\n\n  return (\n    <div>\n      <video ref={videoRef} src="video.mp4" />\n      <button onClick={play}>\u64ad\u653e</button>\n      <button onClick={pause}>\u6682\u505c</button>\n      <button onClick={mute}>\u9759\u97f3/\u53d6\u6d88\u9759\u97f3</button>\n    </div>\n  );\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"2-\u4fdd\u5b58\u53ef\u53d8\u503c",children:"2. \u4fdd\u5b58\u53ef\u53d8\u503c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:"function Timer() {\n  const [seconds, setSeconds] = useState(0);\n  const [isRunning, setIsRunning] = useState(false);\n  const intervalRef = useRef(null);\n\n  const start = () => {\n    if (intervalRef.current) return; // \u5df2\u5728\u8fd0\u884c\n\n    setIsRunning(true);\n    intervalRef.current = setInterval(() => {\n      setSeconds((s) => s + 1);\n    }, 1000);\n  };\n\n  const stop = () => {\n    setIsRunning(false);\n    clearInterval(intervalRef.current);\n    intervalRef.current = null;\n  };\n\n  const reset = () => {\n    stop();\n    setSeconds(0);\n  };\n\n  // \u7ec4\u4ef6\u5378\u8f7d\u65f6\u6e05\u7406\n  useEffect(() => {\n    return () => {\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, []);\n\n  return (\n    <div>\n      <h2>\u65f6\u95f4: {seconds}\u79d2</h2>\n      <button onClick={start} disabled={isRunning}>\n        \u5f00\u59cb\n      </button>\n      <button onClick={stop} disabled={!isRunning}>\n        \u505c\u6b62\n      </button>\n      <button onClick={reset}>\u91cd\u7f6e</button>\n    </div>\n  );\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"3-\u4fdd\u5b58\u524d\u4e00\u4e2a\u503c",children:"3. \u4fdd\u5b58\u524d\u4e00\u4e2a\u503c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:"function usePrevious(value) {\n  const ref = useRef();\n\n  useEffect(() => {\n    ref.current = value;\n  }, [value]);\n\n  return ref.current;\n}\n\n// \u4f7f\u7528\nfunction Counter() {\n  const [count, setCount] = useState(0);\n  const prevCount = usePrevious(count);\n\n  return (\n    <div>\n      <p>\u5f53\u524d: {count}</p>\n      <p>\u4e4b\u524d: {prevCount}</p>\n      <button onClick={() => setCount(count + 1)}>+1</button>\n    </div>\n  );\n}\n"})}),"\n",(0,s.jsx)(e.h2,{id:"-forwardref---\u8f6c\u53d1-refs",children:"\ud83d\udd17 forwardRef - \u8f6c\u53d1 Refs"}),"\n",(0,s.jsx)(e.p,{children:"\u7236\u7ec4\u4ef6\u53ef\u80fd\u9700\u8981\u8bbf\u95ee\u5b50\u7ec4\u4ef6\u7684 DOM \u8282\u70b9\uff1a"}),"\n",(0,s.jsx)(e.h3,{id:"\u57fa\u7840\u7528\u6cd5-1",children:"\u57fa\u7840\u7528\u6cd5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'import { forwardRef, useRef } from "react";\n\n// \u5b50\u7ec4\u4ef6\u4f7f\u7528 forwardRef \u5305\u88f9\nconst CustomInput = forwardRef((props, ref) => {\n  return <input ref={ref} {...props} />;\n});\n\n// \u7236\u7ec4\u4ef6\u4f7f\u7528\nfunction App() {\n  const inputRef = useRef(null);\n\n  const focusInput = () => {\n    inputRef.current.focus();\n  };\n\n  return (\n    <div>\n      <CustomInput ref={inputRef} placeholder="\u8f93\u5165\u6587\u672c" />\n      <button onClick={focusInput}>\u805a\u7126</button>\n    </div>\n  );\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u590d\u6742\u793a\u4f8b\u81ea\u5b9a\u4e49\u7ec4\u4ef6\u5e93",children:"\u590d\u6742\u793a\u4f8b\uff1a\u81ea\u5b9a\u4e49\u7ec4\u4ef6\u5e93"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'const FancyButton = forwardRef((props, ref) => {\n  const { children, variant = "primary", ...rest } = props;\n\n  return (\n    <button ref={ref} className={`btn btn-${variant}`} {...rest}>\n      {children}\n    </button>\n  );\n});\n\n// \u4f7f\u7528\nfunction App() {\n  const buttonRef = useRef(null);\n\n  useEffect(() => {\n    // \u81ea\u52a8\u805a\u7126\u6309\u94ae\n    buttonRef.current.focus();\n  }, []);\n\n  return <FancyButton ref={buttonRef}>\u70b9\u51fb\u6211</FancyButton>;\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"-useimperativehandle",children:"\ud83c\udfa8 useImperativeHandle"}),"\n",(0,s.jsx)(e.p,{children:"\u81ea\u5b9a\u4e49\u66b4\u9732\u7ed9\u7236\u7ec4\u4ef6\u7684\u5b9e\u4f8b\u503c\uff1a"}),"\n",(0,s.jsx)(e.h3,{id:"\u57fa\u7840\u7528\u6cd5-2",children:"\u57fa\u7840\u7528\u6cd5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'import { forwardRef, useRef, useImperativeHandle } from "react";\n\nconst FancyInput = forwardRef((props, ref) => {\n  const inputRef = useRef(null);\n\n  // \u81ea\u5b9a\u4e49\u66b4\u9732\u7684\u65b9\u6cd5\n  useImperativeHandle(ref, () => ({\n    focus: () => {\n      inputRef.current.focus();\n    },\n    clear: () => {\n      inputRef.current.value = "";\n    },\n    setValue: (value) => {\n      inputRef.current.value = value;\n    },\n  }));\n\n  return <input ref={inputRef} {...props} />;\n});\n\n// \u7236\u7ec4\u4ef6\u4f7f\u7528\nfunction App() {\n  const inputRef = useRef(null);\n\n  const handleClear = () => {\n    inputRef.current.clear();\n  };\n\n  const handleSetValue = () => {\n    inputRef.current.setValue("Hello World");\n  };\n\n  return (\n    <div>\n      <FancyInput ref={inputRef} />\n      <button onClick={() => inputRef.current.focus()}>\u805a\u7126</button>\n      <button onClick={handleClear}>\u6e05\u7a7a</button>\n      <button onClick={handleSetValue}>\u8bbe\u7f6e\u503c</button>\n    </div>\n  );\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u89c6\u9891\u64ad\u653e\u5668\u793a\u4f8b",children:"\u89c6\u9891\u64ad\u653e\u5668\u793a\u4f8b"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'const VideoPlayer = forwardRef((props, ref) => {\n  const videoRef = useRef(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n\n  useImperativeHandle(ref, () => ({\n    play() {\n      videoRef.current.play();\n      setIsPlaying(true);\n    },\n    pause() {\n      videoRef.current.pause();\n      setIsPlaying(false);\n    },\n    getCurrentTime() {\n      return videoRef.current.currentTime;\n    },\n    setCurrentTime(time) {\n      videoRef.current.currentTime = time;\n    },\n    getIsPlaying() {\n      return isPlaying;\n    },\n  }));\n\n  return (\n    <video\n      ref={videoRef}\n      src={props.src}\n      onPlay={() => setIsPlaying(true)}\n      onPause={() => setIsPlaying(false)}\n    />\n  );\n});\n\n// \u4f7f\u7528\nfunction App() {\n  const playerRef = useRef(null);\n\n  return (\n    <div>\n      <VideoPlayer ref={playerRef} src="video.mp4" />\n      <button onClick={() => playerRef.current.play()}>\u64ad\u653e</button>\n      <button onClick={() => playerRef.current.pause()}>\u6682\u505c</button>\n      <button\n        onClick={() => {\n          const time = playerRef.current.getCurrentTime();\n          alert(`\u5f53\u524d\u65f6\u95f4: ${time}\u79d2`);\n        }}\n      >\n        \u83b7\u53d6\u65f6\u95f4\n      </button>\n    </div>\n  );\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"-\u6d4b\u91cf-dom-\u5143\u7d20",children:"\ud83d\udccf \u6d4b\u91cf DOM \u5143\u7d20"}),"\n",(0,s.jsx)(e.h3,{id:"\u83b7\u53d6\u5143\u7d20\u5c3a\u5bf8",children:"\u83b7\u53d6\u5143\u7d20\u5c3a\u5bf8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'function MeasureElement() {\n  const divRef = useRef(null);\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n\n  useEffect(() => {\n    if (divRef.current) {\n      const { width, height } = divRef.current.getBoundingClientRect();\n      setDimensions({ width, height });\n    }\n  }, []);\n\n  return (\n    <div>\n      <div\n        ref={divRef}\n        style={{ width: 200, height: 100, background: "lightblue" }}\n      >\n        \u6d4b\u91cf\u6211\n      </div>\n      <p>\u5bbd\u5ea6: {dimensions.width}px</p>\n      <p>\u9ad8\u5ea6: {dimensions.height}px</p>\n    </div>\n  );\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"resizeobserver-\u76d1\u542c\u5c3a\u5bf8\u53d8\u5316",children:"ResizeObserver \u76d1\u542c\u5c3a\u5bf8\u53d8\u5316"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'function useElementSize(ref) {\n  const [size, setSize] = useState({ width: 0, height: 0 });\n\n  useEffect(() => {\n    if (!ref.current) return;\n\n    const observer = new ResizeObserver((entries) => {\n      const { width, height } = entries[0].contentRect;\n      setSize({ width, height });\n    });\n\n    observer.observe(ref.current);\n\n    return () => observer.disconnect();\n  }, [ref]);\n\n  return size;\n}\n\n// \u4f7f\u7528\nfunction ResizableBox() {\n  const boxRef = useRef(null);\n  const size = useElementSize(boxRef);\n\n  return (\n    <div>\n      <div\n        ref={boxRef}\n        style={{\n          resize: "both",\n          overflow: "auto",\n          width: 200,\n          height: 100,\n          border: "1px solid black",\n        }}\n      >\n        \u62d6\u52a8\u8c03\u6574\u5927\u5c0f\n      </div>\n      <p>\u5bbd\u5ea6: {Math.round(size.width)}px</p>\n      <p>\u9ad8\u5ea6: {Math.round(size.height)}px</p>\n    </div>\n  );\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"-\u5b9e\u9645\u5e94\u7528\u573a\u666f",children:"\ud83c\udfaf \u5b9e\u9645\u5e94\u7528\u573a\u666f"}),"\n",(0,s.jsx)(e.h3,{id:"1-\u81ea\u52a8\u805a\u7126\u8f93\u5165\u6846",children:"1. \u81ea\u52a8\u805a\u7126\u8f93\u5165\u6846"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'function SearchBar() {\n  const inputRef = useRef(null);\n\n  useEffect(() => {\n    // \u9875\u9762\u52a0\u8f7d\u65f6\u81ea\u52a8\u805a\u7126\n    inputRef.current.focus();\n  }, []);\n\n  return <input ref={inputRef} type="search" placeholder="\u641c\u7d22..." />;\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"2-\u6eda\u52a8\u5230\u89c6\u56fe",children:"2. \u6eda\u52a8\u5230\u89c6\u56fe"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'function TodoList({ todos }) {\n  const bottomRef = useRef(null);\n\n  const scrollToBottom = () => {\n    bottomRef.current?.scrollIntoView({ behavior: "smooth" });\n  };\n\n  useEffect(() => {\n    // \u65b0\u589e todo \u65f6\u6eda\u52a8\u5230\u5e95\u90e8\n    scrollToBottom();\n  }, [todos.length]);\n\n  return (\n    <div>\n      <ul>\n        {todos.map((todo) => (\n          <li key={todo.id}>{todo.text}</li>\n        ))}\n        <li ref={bottomRef} />\n      </ul>\n    </div>\n  );\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"3-\u6587\u672c\u9009\u62e9",children:"3. \u6587\u672c\u9009\u62e9"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:"function TextSelector() {\n  const textRef = useRef(null);\n\n  const selectAll = () => {\n    const selection = window.getSelection();\n    const range = document.createRange();\n    range.selectNodeContents(textRef.current);\n    selection.removeAllRanges();\n    selection.addRange(range);\n  };\n\n  return (\n    <div>\n      <p ref={textRef}>\u8fd9\u662f\u4e00\u6bb5\u53ef\u4ee5\u88ab\u9009\u4e2d\u7684\u6587\u672c\u3002\u70b9\u51fb\u6309\u94ae\u9009\u4e2d\u5168\u90e8\u3002</p>\n      <button onClick={selectAll}>\u5168\u9009</button>\n    </div>\n  );\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"4-\u96c6\u6210\u7b2c\u4e09\u65b9\u5e93chartjs",children:"4. \u96c6\u6210\u7b2c\u4e09\u65b9\u5e93\uff08Chart.js\uff09"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'import { useEffect, useRef } from "react";\nimport Chart from "chart.js/auto";\n\nfunction ChartComponent({ data }) {\n  const canvasRef = useRef(null);\n  const chartRef = useRef(null);\n\n  useEffect(() => {\n    const ctx = canvasRef.current.getContext("2d");\n\n    // \u9500\u6bc1\u65e7\u56fe\u8868\n    if (chartRef.current) {\n      chartRef.current.destroy();\n    }\n\n    // \u521b\u5efa\u65b0\u56fe\u8868\n    chartRef.current = new Chart(ctx, {\n      type: "bar",\n      data: data,\n      options: {\n        responsive: true,\n      },\n    });\n\n    // \u6e05\u7406\n    return () => {\n      if (chartRef.current) {\n        chartRef.current.destroy();\n      }\n    };\n  }, [data]);\n\n  return <canvas ref={canvasRef} />;\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"5-\u8868\u5355\u9a8c\u8bc1",children:"5. \u8868\u5355\u9a8c\u8bc1"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'function LoginForm() {\n  const usernameRef = useRef(null);\n  const passwordRef = useRef(null);\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    const username = usernameRef.current.value;\n    const password = passwordRef.current.value;\n\n    if (!username) {\n      usernameRef.current.focus();\n      alert("\u8bf7\u8f93\u5165\u7528\u6237\u540d");\n      return;\n    }\n\n    if (password.length < 6) {\n      passwordRef.current.focus();\n      alert("\u5bc6\u7801\u81f3\u5c11 6 \u4f4d");\n      return;\n    }\n\n    console.log("\u767b\u5f55:", { username, password });\n  };\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <input ref={usernameRef} type="text" placeholder="\u7528\u6237\u540d" />\n      <input ref={passwordRef} type="password" placeholder="\u5bc6\u7801" />\n      <button type="submit">\u767b\u5f55</button>\n    </form>\n  );\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"-\u6700\u4f73\u5b9e\u8df5",children:"\ud83d\udca1 \u6700\u4f73\u5b9e\u8df5"}),"\n",(0,s.jsx)(e.h3,{id:"1-\u907f\u514d\u8fc7\u5ea6\u4f7f\u7528-refs",children:"1. \u907f\u514d\u8fc7\u5ea6\u4f7f\u7528 Refs"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:"// \u2717 \u4e0d\u597d\uff1a\u7528 Ref \u7ba1\u7406\u53ef\u53d8\u72b6\u6001\nfunction Counter() {\n  const countRef = useRef(0);\n\n  const increment = () => {\n    countRef.current++;\n    // \u7ec4\u4ef6\u4e0d\u4f1a\u91cd\u65b0\u6e32\u67d3\uff01\n  };\n\n  return <div>{countRef.current}</div>;\n}\n\n// \u2713 \u597d\uff1a\u7528 State \u7ba1\u7406 UI \u72b6\u6001\nfunction Counter() {\n  const [count, setCount] = useState(0);\n\n  return (\n    <div>\n      {count}\n      <button onClick={() => setCount(count + 1)}>+</button>\n    </div>\n  );\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"2-ref-\u4e0d\u89e6\u53d1\u91cd\u65b0\u6e32\u67d3",children:"2. Ref \u4e0d\u89e6\u53d1\u91cd\u65b0\u6e32\u67d3"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:"function Example() {\n  const countRef = useRef(0);\n  const [, forceUpdate] = useState();\n\n  const increment = () => {\n    countRef.current++;\n    forceUpdate({}); // \u5f3a\u5236\u91cd\u65b0\u6e32\u67d3\uff08\u4e0d\u63a8\u8350\uff09\n  };\n\n  return <div>{countRef.current}</div>;\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"3-callback-refs",children:"3. Callback Refs"}),"\n",(0,s.jsx)(e.p,{children:"\u5f53\u9700\u8981\u5728 ref \u8bbe\u7f6e\u65f6\u6267\u884c\u4ee3\u7801\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:"function MeasureExample() {\n  const [height, setHeight] = useState(0);\n\n  // Callback ref\n  const measureRef = (node) => {\n    if (node !== null) {\n      setHeight(node.getBoundingClientRect().height);\n    }\n  };\n\n  return (\n    <div>\n      <div ref={measureRef}>\u6211\u4f1a\u88ab\u6d4b\u91cf</div>\n      <p>\u9ad8\u5ea6\uff1a{height}px</p>\n    </div>\n  );\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"4-\u591a\u4e2a-refs",children:"4. \u591a\u4e2a Refs"}),"\n",(0,s.jsx)(e.p,{children:"\u4f7f\u7528\u6570\u7ec4\u6216 Map \u5b58\u50a8\u591a\u4e2a refs\uff1a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:'function ItemList({ items }) {\n  const itemRefs = useRef(new Map());\n\n  const scrollToItem = (id) => {\n    const node = itemRefs.current.get(id);\n    node?.scrollIntoView({ behavior: "smooth", block: "nearest" });\n  };\n\n  return (\n    <ul>\n      {items.map((item) => (\n        <li\n          key={item.id}\n          ref={(node) => {\n            if (node) {\n              itemRefs.current.set(item.id, node);\n            } else {\n              itemRefs.current.delete(item.id);\n            }\n          }}\n        >\n          {item.name}\n          <button onClick={() => scrollToItem(item.id)}>\u6eda\u52a8\u5230\u6b64</button>\n        </li>\n      ))}\n    </ul>\n  );\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"-\u5e38\u89c1\u9519\u8bef",children:"\ud83d\udea8 \u5e38\u89c1\u9519\u8bef"}),"\n",(0,s.jsx)(e.h3,{id:"1-\u5728\u6e32\u67d3\u671f\u95f4\u8bbf\u95ee-ref",children:"1. \u5728\u6e32\u67d3\u671f\u95f4\u8bbf\u95ee Ref"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:"// \u2717 \u9519\u8bef\uff1a\u6e32\u67d3\u671f\u95f4\u8bfb\u53d6 ref\nfunction Example() {\n  const ref = useRef(0);\n\n  return <div>{ref.current}</div>; // \u4e0d\u4f1a\u66f4\u65b0\n}\n\n// \u2713 \u6b63\u786e\uff1a\u5728\u4e8b\u4ef6\u5904\u7406\u5668\u4e2d\u8bfb\u53d6\nfunction Example() {\n  const ref = useRef(0);\n  const [display, setDisplay] = useState(0);\n\n  const handleClick = () => {\n    setDisplay(ref.current);\n  };\n\n  return (\n    <div>\n      {display}\n      <button onClick={handleClick}>\u663e\u793a</button>\n    </div>\n  );\n}\n"})}),"\n",(0,s.jsx)(e.h3,{id:"2-ref-\u4e3a-null",children:"2. Ref \u4e3a null"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-jsx",children:"// \u2717 \u9519\u8bef\uff1a\u53ef\u80fd\u4e3a null\nconst focusInput = () => {\n  inputRef.current.focus(); // \u53ef\u80fd\u62a5\u9519\n};\n\n// \u2713 \u6b63\u786e\uff1a\u5224\u7a7a\nconst focusInput = () => {\n  inputRef.current?.focus();\n  // \u6216\n  if (inputRef.current) {\n    inputRef.current.focus();\n  }\n};\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u4e0b\u4e00\u6b65"}),"\uff1a\u5b66\u4e60 ",(0,s.jsx)(e.a,{href:"./error-boundaries",children:"\u9519\u8bef\u8fb9\u754c"})," \u5904\u7406\u7ec4\u4ef6\u9519\u8bef\uff0c\u6216\u67e5\u770b ",(0,s.jsx)(e.a,{href:"./composition-patterns",children:"\u7ec4\u4ef6\u7ec4\u5408\u6a21\u5f0f"})," \u4e86\u89e3\u9ad8\u7ea7\u7ec4\u4ef6\u6a21\u5f0f\u3002"]})]})}function d(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(a,{...n})}):a(n)}}}]);