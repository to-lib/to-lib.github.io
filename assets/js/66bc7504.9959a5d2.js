"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[74646],{48885:(n,e,t)=>{t.d(e,{R:()=>l,x:()=>a});var r=t(99378);const s={},d=r.createContext(s);function l(n){const e=r.useContext(d);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),r.createElement(d.Provider,{value:e},n.children)}},75727:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>i,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"ml/adversarial-robustness","title":"\ud83d\udee1\ufe0f \u5bf9\u6297\u9c81\u68d2\u6027","description":"\u5bf9\u6297\u6837\u672c\u662f\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u8f93\u5165\u6270\u52a8\uff0c\u53ef\u5bfc\u81f4\u6a21\u578b\u4ea7\u751f\u9519\u8bef\u9884\u6d4b\u3002","source":"@site/docs/ml/adversarial-robustness.md","sourceDirName":"ml","slug":"/ml/adversarial-robustness","permalink":"/docs/ml/adversarial-robustness","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/adversarial-robustness.md","tags":[],"version":"current","sidebarPosition":36,"frontMatter":{"sidebar_position":36,"title":"\ud83d\udee1\ufe0f \u5bf9\u6297\u9c81\u68d2\u6027"},"sidebar":"ml","previous":{"title":"\ud83d\udce6 \u6a21\u578b\u538b\u7f29","permalink":"/docs/ml/model-compression"},"next":{"title":"\ud83d\udcd0 \u4e0d\u786e\u5b9a\u6027\u91cf\u5316","permalink":"/docs/ml/uncertainty-quantification"}}');var s=t(22714),d=t(48885);const l={sidebar_position:36,title:"\ud83d\udee1\ufe0f \u5bf9\u6297\u9c81\u68d2\u6027"},a="\u5bf9\u6297\u653b\u51fb\u4e0e\u9c81\u68d2\u6027",i={},o=[{value:"\u5bf9\u6297\u6837\u672c",id:"\u5bf9\u6297\u6837\u672c",level:2},{value:"\u653b\u51fb\u65b9\u6cd5",id:"\u653b\u51fb\u65b9\u6cd5",level:2},{value:"FGSM (\u5feb\u901f\u68af\u5ea6\u7b26\u53f7\u6cd5)",id:"fgsm-\u5feb\u901f\u68af\u5ea6\u7b26\u53f7\u6cd5",level:3},{value:"PGD (\u6295\u5f71\u68af\u5ea6\u4e0b\u964d)",id:"pgd-\u6295\u5f71\u68af\u5ea6\u4e0b\u964d",level:3},{value:"AutoAttack",id:"autoattack",level:3},{value:"\u9632\u5fa1\u65b9\u6cd5",id:"\u9632\u5fa1\u65b9\u6cd5",level:2},{value:"\u5bf9\u6297\u8bad\u7ec3",id:"\u5bf9\u6297\u8bad\u7ec3",level:3},{value:"\u8f93\u5165\u9884\u5904\u7406",id:"\u8f93\u5165\u9884\u5904\u7406",level:3},{value:"\u5bf9\u6297\u68c0\u6d4b",id:"\u5bf9\u6297\u68c0\u6d4b",level:3},{value:"\u8bc4\u4f30\u6307\u6807",id:"\u8bc4\u4f30\u6307\u6807",level:2},{value:"\u5e94\u7528\u573a\u666f",id:"\u5e94\u7528\u573a\u666f",level:2}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"\u5bf9\u6297\u653b\u51fb\u4e0e\u9c81\u68d2\u6027",children:"\u5bf9\u6297\u653b\u51fb\u4e0e\u9c81\u68d2\u6027"})}),"\n",(0,s.jsx)(e.p,{children:"\u5bf9\u6297\u6837\u672c\u662f\u7cbe\u5fc3\u8bbe\u8ba1\u7684\u8f93\u5165\u6270\u52a8\uff0c\u53ef\u5bfc\u81f4\u6a21\u578b\u4ea7\u751f\u9519\u8bef\u9884\u6d4b\u3002"}),"\n",(0,s.jsx)(e.h2,{id:"\u5bf9\u6297\u6837\u672c",children:"\u5bf9\u6297\u6837\u672c"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import torch\n\n# \u539f\u59cb\u56fe\u50cf + \u5fae\u5c0f\u6270\u52a8 = \u9519\u8bef\u9884\u6d4b\n# x_adv = x + perturbation\n# ||perturbation|| < epsilon\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u653b\u51fb\u65b9\u6cd5",children:"\u653b\u51fb\u65b9\u6cd5"}),"\n",(0,s.jsx)(e.h3,{id:"fgsm-\u5feb\u901f\u68af\u5ea6\u7b26\u53f7\u6cd5",children:"FGSM (\u5feb\u901f\u68af\u5ea6\u7b26\u53f7\u6cd5)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"def fgsm_attack(model, x, y, epsilon):\n    x.requires_grad = True\n    output = model(x)\n    loss = nn.functional.cross_entropy(output, y)\n    loss.backward()\n\n    # \u6cbf\u68af\u5ea6\u65b9\u5411\u6270\u52a8\n    perturbation = epsilon * x.grad.sign()\n    x_adv = x + perturbation\n    x_adv = torch.clamp(x_adv, 0, 1)\n\n    return x_adv\n"})}),"\n",(0,s.jsx)(e.h3,{id:"pgd-\u6295\u5f71\u68af\u5ea6\u4e0b\u964d",children:"PGD (\u6295\u5f71\u68af\u5ea6\u4e0b\u964d)"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"def pgd_attack(model, x, y, epsilon, alpha, num_iter):\n    x_adv = x.clone()\n\n    for _ in range(num_iter):\n        x_adv.requires_grad = True\n        output = model(x_adv)\n        loss = nn.functional.cross_entropy(output, y)\n        loss.backward()\n\n        # \u68af\u5ea6\u4e0a\u5347\n        x_adv = x_adv + alpha * x_adv.grad.sign()\n\n        # \u6295\u5f71\u5230 epsilon \u7403\u5185\n        perturbation = torch.clamp(x_adv - x, -epsilon, epsilon)\n        x_adv = torch.clamp(x + perturbation, 0, 1).detach()\n\n    return x_adv\n"})}),"\n",(0,s.jsx)(e.h3,{id:"autoattack",children:"AutoAttack"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"from autoattack import AutoAttack\n\nadversary = AutoAttack(model, norm='Linf', eps=8/255)\nx_adv = adversary.run_standard_evaluation(x, y)\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u9632\u5fa1\u65b9\u6cd5",children:"\u9632\u5fa1\u65b9\u6cd5"}),"\n",(0,s.jsx)(e.h3,{id:"\u5bf9\u6297\u8bad\u7ec3",children:"\u5bf9\u6297\u8bad\u7ec3"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"def adversarial_training(model, dataloader, epsilon, epochs):\n    for epoch in range(epochs):\n        for x, y in dataloader:\n            # \u751f\u6210\u5bf9\u6297\u6837\u672c\n            x_adv = pgd_attack(model, x, y, epsilon, alpha=2/255, num_iter=10)\n\n            # \u5728\u5bf9\u6297\u6837\u672c\u4e0a\u8bad\u7ec3\n            optimizer.zero_grad()\n            output = model(x_adv)\n            loss = nn.functional.cross_entropy(output, y)\n            loss.backward()\n            optimizer.step()\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u8f93\u5165\u9884\u5904\u7406",children:"\u8f93\u5165\u9884\u5904\u7406"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"def input_transformation(x):\n    # JPEG \u538b\u7f29\n    # \u968f\u673a\u7f29\u653e\n    # \u6dfb\u52a0\u566a\u58f0\n    return transformed_x\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u5bf9\u6297\u68c0\u6d4b",children:"\u5bf9\u6297\u68c0\u6d4b"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"class AdversarialDetector:\n    def __init__(self, model):\n        self.model = model\n\n    def detect(self, x):\n        # \u57fa\u4e8e\u9884\u6d4b\u4e0d\u4e00\u81f4\u6027\u68c0\u6d4b\n        output1 = self.model(x)\n        output2 = self.model(x + torch.randn_like(x) * 0.01)\n\n        inconsistency = (output1.argmax(1) != output2.argmax(1))\n        return inconsistency\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u8bc4\u4f30\u6307\u6807",children:"\u8bc4\u4f30\u6307\u6807"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u6307\u6807"}),(0,s.jsx)(e.th,{children:"\u63cf\u8ff0"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Clean Accuracy"}),(0,s.jsx)(e.td,{children:"\u5e72\u51c0\u6837\u672c\u51c6\u786e\u7387"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Robust Accuracy"}),(0,s.jsx)(e.td,{children:"\u5bf9\u6297\u6837\u672c\u51c6\u786e\u7387"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"Attack Success Rate"}),(0,s.jsx)(e.td,{children:"\u653b\u51fb\u6210\u529f\u7387"})]})]})]}),"\n",(0,s.jsx)(e.h2,{id:"\u5e94\u7528\u573a\u666f",children:"\u5e94\u7528\u573a\u666f"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u9886\u57df"}),(0,s.jsx)(e.th,{children:"\u98ce\u9669"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u81ea\u52a8\u9a7e\u9a76"}),(0,s.jsx)(e.td,{children:"\u4ea4\u901a\u6807\u5fd7\u8bef\u8bc6\u522b"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u4eba\u8138\u8bc6\u522b"}),(0,s.jsx)(e.td,{children:"\u8eab\u4efd\u4f2a\u9020"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u5783\u573e\u90ae\u4ef6"}),(0,s.jsx)(e.td,{children:"\u7ed5\u8fc7\u68c0\u6d4b"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u6076\u610f\u8f6f\u4ef6"}),(0,s.jsx)(e.td,{children:"\u9003\u907f\u68c0\u6d4b"})]})]})]})]})}function h(n={}){const{wrapper:e}={...(0,d.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(c,{...n})}):c(n)}}}]);