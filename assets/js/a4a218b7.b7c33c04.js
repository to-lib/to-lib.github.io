"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[56655],{1176:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>i,contentTitle:()=>d,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"kubernetes/basic-commands","title":"\u57fa\u7840\u547d\u4ee4","description":"kubectl \u5e38\u7528\u547d\u4ee4\u8be6\u89e3","source":"@site/docs/kubernetes/basic-commands.md","sourceDirName":"kubernetes","slug":"/kubernetes/basic-commands","permalink":"/docs/kubernetes/basic-commands","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/kubernetes/basic-commands.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"\u57fa\u7840\u547d\u4ee4","description":"kubectl \u5e38\u7528\u547d\u4ee4\u8be6\u89e3"},"sidebar":"kubernetes","previous":{"title":"\u5b89\u88c5\u914d\u7f6e","permalink":"/docs/kubernetes/installation"},"next":{"title":"Pod \u8be6\u89e3","permalink":"/docs/kubernetes/pods"}}');var c=l(22714),s=l(48885);const a={sidebar_position:3,title:"\u57fa\u7840\u547d\u4ee4",description:"kubectl \u5e38\u7528\u547d\u4ee4\u8be6\u89e3"},d="kubectl \u57fa\u7840\u547d\u4ee4",i={},o=[{value:"\u547d\u4ee4\u7ed3\u6784",id:"\u547d\u4ee4\u7ed3\u6784",level:2},{value:"\u96c6\u7fa4\u4fe1\u606f",id:"\u96c6\u7fa4\u4fe1\u606f",level:2},{value:"\u8d44\u6e90\u67e5\u770b (get)",id:"\u8d44\u6e90\u67e5\u770b-get",level:2},{value:"\u8d44\u6e90\u8be6\u60c5 (describe)",id:"\u8d44\u6e90\u8be6\u60c5-describe",level:2},{value:"\u521b\u5efa\u8d44\u6e90 (create/apply)",id:"\u521b\u5efa\u8d44\u6e90-createapply",level:2},{value:"\u66f4\u65b0\u8d44\u6e90",id:"\u66f4\u65b0\u8d44\u6e90",level:2},{value:"\u5220\u9664\u8d44\u6e90 (delete)",id:"\u5220\u9664\u8d44\u6e90-delete",level:2},{value:"\u6267\u884c\u547d\u4ee4 (exec)",id:"\u6267\u884c\u547d\u4ee4-exec",level:2},{value:"\u67e5\u770b\u65e5\u5fd7 (logs)",id:"\u67e5\u770b\u65e5\u5fd7-logs",level:2},{value:"\u7aef\u53e3\u8f6c\u53d1 (port-forward)",id:"\u7aef\u53e3\u8f6c\u53d1-port-forward",level:2},{value:"\u6587\u4ef6\u4f20\u8f93 (cp)",id:"\u6587\u4ef6\u4f20\u8f93-cp",level:2},{value:"\u6807\u7b7e\u7ba1\u7406 (label)",id:"\u6807\u7b7e\u7ba1\u7406-label",level:2},{value:"\u6ce8\u89e3\u7ba1\u7406 (annotate)",id:"\u6ce8\u89e3\u7ba1\u7406-annotate",level:2},{value:"\u8c03\u8bd5\u547d\u4ee4",id:"\u8c03\u8bd5\u547d\u4ee4",level:2},{value:"\u8f93\u51fa\u683c\u5f0f",id:"\u8f93\u51fa\u683c\u5f0f",level:2},{value:"\u5e38\u7528\u522b\u540d",id:"\u5e38\u7528\u522b\u540d",level:2}];function r(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"kubectl-\u57fa\u7840\u547d\u4ee4",children:"kubectl \u57fa\u7840\u547d\u4ee4"})}),"\n",(0,c.jsx)(n.h2,{id:"\u547d\u4ee4\u7ed3\u6784",children:"\u547d\u4ee4\u7ed3\u6784"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"kubectl [command] [TYPE] [NAME] [flags]\n"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"command"}),"\uff1a\u8981\u6267\u884c\u7684\u64cd\u4f5c\uff08get\u3001create\u3001delete \u7b49\uff09"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"TYPE"}),"\uff1a\u8d44\u6e90\u7c7b\u578b\uff08pod\u3001service\u3001deployment \u7b49\uff09"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"NAME"}),"\uff1a\u8d44\u6e90\u540d\u79f0"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"flags"}),"\uff1a\u53ef\u9009\u6807\u5fd7"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"\u96c6\u7fa4\u4fe1\u606f",children:"\u96c6\u7fa4\u4fe1\u606f"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u96c6\u7fa4\u4fe1\u606f\nkubectl cluster-info\n\n# \u67e5\u770b API \u7248\u672c\nkubectl api-versions\n\n# \u67e5\u770b API \u8d44\u6e90\nkubectl api-resources\n\n# \u67e5\u770b\u7ec4\u4ef6\u72b6\u6001\nkubectl get componentstatuses  # \u6216 kubectl get cs\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u8d44\u6e90\u67e5\u770b-get",children:"\u8d44\u6e90\u67e5\u770b (get)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b Pod\nkubectl get pods                      # \u5f53\u524d\u547d\u540d\u7a7a\u95f4\nkubectl get pods -A                   # \u6240\u6709\u547d\u540d\u7a7a\u95f4\nkubectl get pods -n kube-system       # \u6307\u5b9a\u547d\u540d\u7a7a\u95f4\nkubectl get pods -o wide              # \u663e\u793a\u66f4\u591a\u4fe1\u606f\nkubectl get pods -o yaml              # YAML \u683c\u5f0f\u8f93\u51fa\nkubectl get pods -o json              # JSON \u683c\u5f0f\u8f93\u51fa\nkubectl get pods --show-labels        # \u663e\u793a\u6807\u7b7e\nkubectl get pods -l app=nginx         # \u6309\u6807\u7b7e\u7b5b\u9009\nkubectl get pods --field-selector status.phase=Running  # \u6309\u5b57\u6bb5\u7b5b\u9009\n\n# \u67e5\u770b\u591a\u79cd\u8d44\u6e90\nkubectl get pods,services,deployments\nkubectl get all                       # \u67e5\u770b\u5e38\u7528\u8d44\u6e90\n\n# \u76d1\u89c6\u8d44\u6e90\u53d8\u5316\nkubectl get pods -w                   # watch \u6a21\u5f0f\n\n# \u81ea\u5b9a\u4e49\u8f93\u51fa\u5217\nkubectl get pods -o custom-columns=NAME:.metadata.name,STATUS:.status.phase\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u8d44\u6e90\u8be6\u60c5-describe",children:"\u8d44\u6e90\u8be6\u60c5 (describe)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b Pod \u8be6\u60c5\nkubectl describe pod <pod-name>\n\n# \u67e5\u770b\u8282\u70b9\u8be6\u60c5\nkubectl describe node <node-name>\n\n# \u67e5\u770b Service \u8be6\u60c5\nkubectl describe service <service-name>\n\n# \u67e5\u770b\u4e8b\u4ef6\nkubectl get events --sort-by='.lastTimestamp'\nkubectl get events -w\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u521b\u5efa\u8d44\u6e90-createapply",children:"\u521b\u5efa\u8d44\u6e90 (create/apply)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u4ece\u6587\u4ef6\u521b\u5efa\nkubectl create -f pod.yaml\nkubectl apply -f deployment.yaml      # \u63a8\u8350\uff1a\u652f\u6301\u66f4\u65b0\n\n# \u4ece\u76ee\u5f55\u521b\u5efa\nkubectl apply -f ./manifests/\n\n# \u4ece URL \u521b\u5efa\nkubectl apply -f https://example.com/manifest.yaml\n\n# \u5feb\u901f\u521b\u5efa\u8d44\u6e90\nkubectl create namespace dev\nkubectl create deployment nginx --image=nginx\nkubectl create service clusterip nginx --tcp=80:80\nkubectl create configmap my-config --from-literal=key=value\nkubectl create secret generic my-secret --from-literal=password=123456\n\n# \u8bd5\u8fd0\u884c\uff08\u4e0d\u5b9e\u9645\u521b\u5efa\uff09\nkubectl create deployment nginx --image=nginx --dry-run=client -o yaml\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u66f4\u65b0\u8d44\u6e90",children:"\u66f4\u65b0\u8d44\u6e90"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'# \u5e94\u7528\u66f4\u65b0\nkubectl apply -f deployment.yaml\n\n# \u7f16\u8f91\u8d44\u6e90\nkubectl edit deployment nginx\n\n# \u66ff\u6362\u8d44\u6e90\nkubectl replace -f deployment.yaml\n\n# \u6253\u8865\u4e01\nkubectl patch deployment nginx -p \'{"spec":{"replicas":3}}\'\nkubectl patch deployment nginx --type=\'json\' -p=\'[{"op":"replace","path":"/spec/replicas","value":5}]\'\n\n# \u66f4\u65b0\u955c\u50cf\nkubectl set image deployment/nginx nginx=nginx:1.25\n\n# \u6269\u7f29\u5bb9\nkubectl scale deployment nginx --replicas=5\n\n# \u81ea\u52a8\u6269\u7f29\u5bb9\nkubectl autoscale deployment nginx --min=2 --max=10 --cpu-percent=50\n'})}),"\n",(0,c.jsx)(n.h2,{id:"\u5220\u9664\u8d44\u6e90-delete",children:"\u5220\u9664\u8d44\u6e90 (delete)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u5220\u9664\u6307\u5b9a\u8d44\u6e90\nkubectl delete pod <pod-name>\nkubectl delete deployment nginx\n\n# \u4ece\u6587\u4ef6\u5220\u9664\nkubectl delete -f deployment.yaml\n\n# \u5220\u9664\u6240\u6709 Pod\nkubectl delete pods --all\n\n# \u6309\u6807\u7b7e\u5220\u9664\nkubectl delete pods -l app=nginx\n\n# \u5f3a\u5236\u5220\u9664\nkubectl delete pod <pod-name> --force --grace-period=0\n\n# \u5220\u9664\u547d\u540d\u7a7a\u95f4\uff08\u53ca\u5176\u6240\u6709\u8d44\u6e90\uff09\nkubectl delete namespace dev\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u6267\u884c\u547d\u4ee4-exec",children:"\u6267\u884c\u547d\u4ee4 (exec)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u8fdb\u5165\u5bb9\u5668\nkubectl exec -it <pod-name> -- /bin/bash\nkubectl exec -it <pod-name> -- /bin/sh\n\n# \u6267\u884c\u547d\u4ee4\nkubectl exec <pod-name> -- ls /app\nkubectl exec <pod-name> -- cat /etc/nginx/nginx.conf\n\n# \u591a\u5bb9\u5668 Pod \u6307\u5b9a\u5bb9\u5668\nkubectl exec -it <pod-name> -c <container-name> -- /bin/bash\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u67e5\u770b\u65e5\u5fd7-logs",children:"\u67e5\u770b\u65e5\u5fd7 (logs)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b Pod \u65e5\u5fd7\nkubectl logs <pod-name>\n\n# \u67e5\u770b\u6700\u8fd1 100 \u884c\nkubectl logs <pod-name> --tail=100\n\n# \u5b9e\u65f6\u67e5\u770b\nkubectl logs <pod-name> -f\n\n# \u67e5\u770b\u524d\u4e00\u4e2a\u5bb9\u5668\u7684\u65e5\u5fd7\nkubectl logs <pod-name> --previous\n\n# \u6307\u5b9a\u5bb9\u5668\nkubectl logs <pod-name> -c <container-name>\n\n# \u6309\u65f6\u95f4\u7b5b\u9009\nkubectl logs <pod-name> --since=1h\nkubectl logs <pod-name> --since-time=2024-01-01T00:00:00Z\n\n# \u67e5\u770b\u591a\u4e2a Pod \u65e5\u5fd7\nkubectl logs -l app=nginx\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u7aef\u53e3\u8f6c\u53d1-port-forward",children:"\u7aef\u53e3\u8f6c\u53d1 (port-forward)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u8f6c\u53d1 Pod \u7aef\u53e3\nkubectl port-forward pod/<pod-name> 8080:80\n\n# \u8f6c\u53d1 Service \u7aef\u53e3\nkubectl port-forward service/nginx 8080:80\n\n# \u8f6c\u53d1 Deployment \u7aef\u53e3\nkubectl port-forward deployment/nginx 8080:80\n\n# \u540e\u53f0\u8fd0\u884c\nkubectl port-forward pod/<pod-name> 8080:80 &\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u6587\u4ef6\u4f20\u8f93-cp",children:"\u6587\u4ef6\u4f20\u8f93 (cp)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u4ece\u672c\u5730\u590d\u5236\u5230\u5bb9\u5668\nkubectl cp ./local-file.txt <pod-name>:/path/in/container/\n\n# \u4ece\u5bb9\u5668\u590d\u5236\u5230\u672c\u5730\nkubectl cp <pod-name>:/path/in/container/file.txt ./local-file.txt\n\n# \u6307\u5b9a\u5bb9\u5668\nkubectl cp ./file.txt <pod-name>:/path/ -c <container-name>\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u6807\u7b7e\u7ba1\u7406-label",children:"\u6807\u7b7e\u7ba1\u7406 (label)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u6dfb\u52a0\u6807\u7b7e\nkubectl label pod <pod-name> env=production\n\n# \u66f4\u65b0\u6807\u7b7e\nkubectl label pod <pod-name> env=staging --overwrite\n\n# \u5220\u9664\u6807\u7b7e\nkubectl label pod <pod-name> env-\n\n# \u67e5\u770b\u6807\u7b7e\nkubectl get pods --show-labels\nkubectl get pods -L env,tier\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u6ce8\u89e3\u7ba1\u7406-annotate",children:"\u6ce8\u89e3\u7ba1\u7406 (annotate)"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'# \u6dfb\u52a0\u6ce8\u89e3\nkubectl annotate pod <pod-name> description="This is my pod"\n\n# \u66f4\u65b0\u6ce8\u89e3\nkubectl annotate pod <pod-name> description="Updated description" --overwrite\n\n# \u5220\u9664\u6ce8\u89e3\nkubectl annotate pod <pod-name> description-\n'})}),"\n",(0,c.jsx)(n.h2,{id:"\u8c03\u8bd5\u547d\u4ee4",children:"\u8c03\u8bd5\u547d\u4ee4"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b\u8d44\u6e90\u4f7f\u7528\nkubectl top nodes\nkubectl top pods\n\n# \u8fd0\u884c\u8c03\u8bd5\u5bb9\u5668\nkubectl run debug --image=busybox -it --rm -- /bin/sh\nkubectl run debug --image=nicolaka/netshoot -it --rm -- /bin/bash\n\n# \u8c03\u8bd5\u73b0\u6709 Pod\nkubectl debug <pod-name> -it --image=busybox\n\n# \u67e5\u770b Pod \u4e8b\u4ef6\nkubectl describe pod <pod-name> | grep -A 20 Events\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u8f93\u51fa\u683c\u5f0f",children:"\u8f93\u51fa\u683c\u5f0f"}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"\u683c\u5f0f"}),(0,c.jsx)(n.th,{children:"\u8bf4\u660e"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"-o wide"})}),(0,c.jsx)(n.td,{children:"\u663e\u793a\u66f4\u591a\u5217"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"-o yaml"})}),(0,c.jsx)(n.td,{children:"YAML \u683c\u5f0f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"-o json"})}),(0,c.jsx)(n.td,{children:"JSON \u683c\u5f0f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"-o name"})}),(0,c.jsx)(n.td,{children:"\u4ec5\u663e\u793a\u540d\u79f0"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"-o jsonpath"})}),(0,c.jsx)(n.td,{children:"JSONPath \u8868\u8fbe\u5f0f"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"-o custom-columns"})}),(0,c.jsx)(n.td,{children:"\u81ea\u5b9a\u4e49\u5217"})]})]})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# JSONPath \u793a\u4f8b\nkubectl get pods -o jsonpath='{.items[*].metadata.name}'\nkubectl get pods -o jsonpath='{range .items[*]}{.metadata.name}{\"\\n\"}{end}'\nkubectl get pod <pod-name> -o jsonpath='{.status.podIP}'\n\n# \u81ea\u5b9a\u4e49\u5217\nkubectl get pods -o custom-columns=\\\n'POD:metadata.name,NODE:spec.nodeName,IP:status.podIP'\n"})}),"\n",(0,c.jsx)(n.h2,{id:"\u5e38\u7528\u522b\u540d",children:"\u5e38\u7528\u522b\u540d"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"# \u6dfb\u52a0\u5230 ~/.bashrc \u6216 ~/.zshrc\nalias k='kubectl'\nalias kg='kubectl get'\nalias kd='kubectl describe'\nalias kl='kubectl logs'\nalias ke='kubectl exec -it'\nalias ka='kubectl apply -f'\nalias kdel='kubectl delete'\nalias kgp='kubectl get pods'\nalias kgs='kubectl get services'\nalias kgd='kubectl get deployments'\nalias kgn='kubectl get nodes'\n"})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(r,{...e})}):r(e)}},48885:(e,n,l)=>{l.d(n,{R:()=>a,x:()=>d});var t=l(99378);const c={},s=t.createContext(c);function a(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:a(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);