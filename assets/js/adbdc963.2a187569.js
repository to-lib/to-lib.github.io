"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[37535],{31416:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"java-design-patterns/flyweight-pattern","title":"\u4eab\u5143\u6a21\u5f0f (Flyweight Pattern)","description":"\u6a21\u5f0f\u5b9a\u4e49","source":"@site/docs/java-design-patterns/flyweight-pattern.md","sourceDirName":"java-design-patterns","slug":"/java-design-patterns/flyweight-pattern","permalink":"/docs/java-design-patterns/flyweight-pattern","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/java-design-patterns/flyweight-pattern.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12},"sidebar":"designPatterns","previous":{"title":"\u7ec4\u5408\u6a21\u5f0f (Composite Pattern)","permalink":"/docs/java-design-patterns/composite-pattern"},"next":{"title":"\u6865\u63a5\u6a21\u5f0f (Bridge Pattern)","permalink":"/docs/java-design-patterns/bridge-pattern"}}');var l=t(22714),r=t(48885);const s={sidebar_position:12},a="\u4eab\u5143\u6a21\u5f0f (Flyweight Pattern)",c={},o=[{value:"\u6a21\u5f0f\u5b9a\u4e49",id:"\u6a21\u5f0f\u5b9a\u4e49",level:2},{value:"\u95ee\u9898\u5206\u6790",id:"\u95ee\u9898\u5206\u6790",level:2},{value:"\u89e3\u51b3\u65b9\u6848",id:"\u89e3\u51b3\u65b9\u6848",level:2},{value:"\u4ee3\u7801\u5b9e\u73b0",id:"\u4ee3\u7801\u5b9e\u73b0",level:2},{value:"\u573a\u666f\uff1a\u6587\u5b57\u5904\u7406\u5668",id:"\u573a\u666f\u6587\u5b57\u5904\u7406\u5668",level:3},{value:"1. \u5b9a\u4e49\u4eab\u5143\u63a5\u53e3",id:"1-\u5b9a\u4e49\u4eab\u5143\u63a5\u53e3",level:4},{value:"2. \u5177\u4f53\u4eab\u5143\u7c7b",id:"2-\u5177\u4f53\u4eab\u5143\u7c7b",level:4},{value:"3. \u4eab\u5143\u5de5\u5382",id:"3-\u4eab\u5143\u5de5\u5382",level:4},{value:"4. \u5ba2\u6237\u7aef\u4f7f\u7528",id:"4-\u5ba2\u6237\u7aef\u4f7f\u7528",level:4},{value:"\u5b9e\u9645\u5e94\u7528\u793a\u4f8b",id:"\u5b9e\u9645\u5e94\u7528\u793a\u4f8b",level:2},{value:"\u793a\u4f8b 1\uff1a\u6e38\u620f\u4e2d\u7684\u7cbe\u7075/\u654c\u4eba",id:"\u793a\u4f8b-1\u6e38\u620f\u4e2d\u7684\u7cbe\u7075\u654c\u4eba",level:3},{value:"\u793a\u4f8b 2\uff1a\u6570\u636e\u5e93\u8fde\u63a5\u6c60",id:"\u793a\u4f8b-2\u6570\u636e\u5e93\u8fde\u63a5\u6c60",level:3},{value:"\u793a\u4f8b 3\uff1aString \u5e38\u91cf\u6c60",id:"\u793a\u4f8b-3string-\u5e38\u91cf\u6c60",level:3},{value:"\u4eab\u5143\u6a21\u5f0f vs \u5bf9\u8c61\u6c60",id:"\u4eab\u5143\u6a21\u5f0f-vs-\u5bf9\u8c61\u6c60",level:2},{value:"Java \u6807\u51c6\u5e93\u4e2d\u7684\u5e94\u7528",id:"java-\u6807\u51c6\u5e93\u4e2d\u7684\u5e94\u7528",level:2},{value:"1. String \u5e38\u91cf\u6c60",id:"1-string-\u5e38\u91cf\u6c60",level:3},{value:"2. Integer \u7f13\u5b58",id:"2-integer-\u7f13\u5b58",level:3},{value:"3. Apache Commons Pool",id:"3-apache-commons-pool",level:3},{value:"\u4f18\u7f3a\u70b9",id:"\u4f18\u7f3a\u70b9",level:2},{value:"\u4f18\u70b9",id:"\u4f18\u70b9",level:3},{value:"\u7f3a\u70b9",id:"\u7f3a\u70b9",level:3},{value:"\u9002\u7528\u573a\u666f",id:"\u9002\u7528\u573a\u666f",level:2},{value:"\u4f55\u65f6\u4f7f\u7528\u4eab\u5143\u6a21\u5f0f",id:"\u4f55\u65f6\u4f7f\u7528\u4eab\u5143\u6a21\u5f0f",level:3},{value:"\u5b9e\u9645\u5e94\u7528\u573a\u666f",id:"\u5b9e\u9645\u5e94\u7528\u573a\u666f",level:3},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2},{value:"1. \u4fdd\u6301\u4eab\u5143\u5bf9\u8c61\u4e0d\u53ef\u53d8",id:"1-\u4fdd\u6301\u4eab\u5143\u5bf9\u8c61\u4e0d\u53ef\u53d8",level:3},{value:"2. \u4f7f\u7528\u5de5\u5382\u7ba1\u7406\u4eab\u5143\u5bf9\u8c61",id:"2-\u4f7f\u7528\u5de5\u5382\u7ba1\u7406\u4eab\u5143\u5bf9\u8c61",level:3},{value:"3. \u8003\u8651\u4f7f\u7528 WeakHashMap",id:"3-\u8003\u8651\u4f7f\u7528-weakhashmap",level:3},{value:"4. \u63d0\u4f9b\u7edf\u8ba1\u548c\u76d1\u63a7",id:"4-\u63d0\u4f9b\u7edf\u8ba1\u548c\u76d1\u63a7",level:3},{value:"\u4e0e\u5176\u4ed6\u6a21\u5f0f\u7684\u5173\u7cfb",id:"\u4e0e\u5176\u4ed6\u6a21\u5f0f\u7684\u5173\u7cfb",level:2},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function h(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"\u4eab\u5143\u6a21\u5f0f-flyweight-pattern",children:"\u4eab\u5143\u6a21\u5f0f (Flyweight Pattern)"})}),"\n",(0,l.jsx)(e.h2,{id:"\u6a21\u5f0f\u5b9a\u4e49",children:"\u6a21\u5f0f\u5b9a\u4e49"}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u4eab\u5143\u6a21\u5f0f"}),"\u662f\u4e00\u79cd\u7ed3\u6784\u578b\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u5b83\u901a\u8fc7\u5171\u4eab\u6280\u672f\u6709\u6548\u5730\u652f\u6301\u5927\u91cf\u7ec6\u7c92\u5ea6\u7684\u5bf9\u8c61\uff0c\u51cf\u5c11\u5185\u5b58\u4f7f\u7528\u548c\u5bf9\u8c61\u521b\u5efa\u5f00\u9500\u3002"]}),"\n",(0,l.jsx)(e.mermaid,{value:'classDiagram\n    class Flyweight {\n        <<interface>>\n        +operation(extrinsicState)\n    }\n    class ConcreteFlyweight {\n        -intrinsicState\n        +operation(extrinsicState)\n    }\n    class FlyweightFactory {\n        -flyweights: Map\n        +getFlyweight(key) Flyweight\n    }\n    class Client {\n        -extrinsicState\n    }\n\n    Flyweight <|.. ConcreteFlyweight\n    FlyweightFactory --\x3e Flyweight : creates\n    Client --\x3e FlyweightFactory : requests\n    Client --\x3e Flyweight : uses\n\n    note for ConcreteFlyweight "\u5185\u5728\u72b6\u6001intrinsic\\n\u53ef\u5171\u4eab\u4e0d\u53d8"\n    note for Client "\u5916\u5728\u72b6\u6001extrinsic\\n\u4e0d\u53ef\u5171\u4eab\u53ef\u53d8"'}),"\n",(0,l.jsx)(e.h2,{id:"\u95ee\u9898\u5206\u6790",children:"\u95ee\u9898\u5206\u6790"}),"\n",(0,l.jsx)(e.p,{children:"\u5f53\u7cfb\u7edf\u4e2d\u9700\u8981\u521b\u5efa\u5927\u91cf\u76f8\u4f3c\u5bf9\u8c61\u65f6\uff0c\u4f1a\u5bfc\u81f4\u4e25\u91cd\u7684\u5185\u5b58\u95ee\u9898\uff1a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:"// \u274c \u4e0d\u597d\u7684\u505a\u6cd5\uff1a\u6bcf\u4e2a\u5b57\u7b26\u90fd\u662f\u72ec\u7acb\u5bf9\u8c61\npublic class TextEditor {\n    private List<Character> characters = new ArrayList<>();\n\n    public void addCharacter(char c, String font, int size, String color, int x, int y) {\n        // \u6bcf\u4e2a\u5b57\u7b26\u90fd\u521b\u5efa\u65b0\u5bf9\u8c61\uff0c\u5305\u542b\u6240\u6709\u5c5e\u6027\n        characters.add(new Character(c, font, size, color, x, y));\n    }\n}\n\n// \u5982\u679c\u6709 10,000 \u4e2a\u5b57\u7b26\uff0c\u5c31\u8981\u521b\u5efa 10,000 \u4e2a\u5bf9\u8c61\uff01\n// \u5185\u5b58\u5360\u7528 = 10,000 \xd7 (\u5b57\u7b26\u5bf9\u8c61\u5927\u5c0f)\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u95ee\u9898"}),"\uff1a"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u274c \u5185\u5b58\u5360\u7528\u8fc7\u9ad8\uff08\u53ef\u80fd\u5bfc\u81f4 OutOfMemoryError\uff09"}),"\n",(0,l.jsx)(e.li,{children:"\u274c \u5bf9\u8c61\u521b\u5efa\u5f00\u9500\u5927"}),"\n",(0,l.jsx)(e.li,{children:"\u274c \u5783\u573e\u56de\u6536\u538b\u529b\u5927"}),"\n",(0,l.jsx)(e.li,{children:"\u274c \u7cfb\u7edf\u6027\u80fd\u4e0b\u964d"}),"\n"]}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsxs)(e.p,{children:["[!WARNING] > ",(0,l.jsx)(e.strong,{children:"\u5185\u5b58\u7206\u70b8"}),"\uff1a\u5047\u8bbe\u6bcf\u4e2a\u5b57\u7b26\u5bf9\u8c61\u5360\u7528 100 \u5b57\u8282\uff0c10,000 \u4e2a\u5b57\u7b26\u5c31\u9700\u8981\u7ea6 1MB \u5185\u5b58\u3002\u5982\u679c\u6587\u6863\u6709 100 \u4e07\u4e2a\u5b57\u7b26\uff0c\u5c31\u9700\u8981 100MB\uff01\u800c\u5b9e\u9645\u4e0a\u5927\u90e8\u5206\u5b57\u7b26\u7684\u5b57\u4f53\u3001\u5927\u5c0f\u3001\u989c\u8272\u90fd\u662f\u76f8\u540c\u7684\u3002"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u89e3\u51b3\u65b9\u6848",children:"\u89e3\u51b3\u65b9\u6848"}),"\n",(0,l.jsx)(e.p,{children:"\u5c06\u5bf9\u8c61\u7684\u72b6\u6001\u5206\u4e3a\u4e24\u7c7b\uff1a"}),"\n",(0,l.jsx)(e.mermaid,{value:"graph LR\n    A[\u5bf9\u8c61\u72b6\u6001] --\x3e B[\u5185\u5728\u72b6\u6001Intrinsic]\n    A --\x3e C[\u5916\u5728\u72b6\u6001Extrinsic]\n\n    B --\x3e D[\u4e0d\u53d8\u7684<br/>\u53ef\u5171\u4eab<br/>\u5b58\u50a8\u5728\u4eab\u5143\u5bf9\u8c61\u4e2d]\n    C --\x3e E[\u53d8\u5316\u7684<br/>\u4e0d\u53ef\u5171\u4eab<br/>\u7531\u5ba2\u6237\u7aef\u4f20\u5165]\n\n    style B fill:#90EE90\n    style C fill:#FFB6C1"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u5185\u5728\u72b6\u6001\uff08Intrinsic State\uff09"}),"\uff1a\u4e0d\u53d8\u7684\u3001\u53ef\u4ee5\u5171\u4eab\u7684\u6570\u636e\uff08\u5982\u5b57\u4f53\u3001\u989c\u8272\uff09"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u5916\u5728\u72b6\u6001\uff08Extrinsic State\uff09"}),"\uff1a\u53d8\u5316\u7684\u3001\u4e0d\u53ef\u5171\u4eab\u7684\u6570\u636e\uff08\u5982\u4f4d\u7f6e\u5750\u6807\uff09"]}),"\n"]}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsxs)(e.p,{children:["[!IMPORTANT] > ",(0,l.jsx)(e.strong,{children:"\u4eab\u5143\u6a21\u5f0f\u7684\u5173\u952e"}),"\uff1a"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u8bc6\u522b\u54ea\u4e9b\u72b6\u6001\u53ef\u4ee5\u5171\u4eab\uff08\u5185\u5728\uff09"}),"\n",(0,l.jsx)(e.li,{children:"\u54ea\u4e9b\u72b6\u6001\u5fc5\u987b\u72ec\u7acb\uff08\u5916\u5728\uff09"}),"\n",(0,l.jsx)(e.li,{children:"\u901a\u8fc7\u5de5\u5382\u7ba1\u7406\u5171\u4eab\u5bf9\u8c61"}),"\n",(0,l.jsx)(e.li,{children:"\u5ba2\u6237\u7aef\u4f20\u5165\u5916\u5728\u72b6\u6001"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u4ee3\u7801\u5b9e\u73b0",children:"\u4ee3\u7801\u5b9e\u73b0"}),"\n",(0,l.jsx)(e.h3,{id:"\u573a\u666f\u6587\u5b57\u5904\u7406\u5668",children:"\u573a\u666f\uff1a\u6587\u5b57\u5904\u7406\u5668"}),"\n",(0,l.jsx)(e.p,{children:"\u6587\u5b57\u5904\u7406\u5668\u4e2d\u6709\u5927\u91cf\u5b57\u7b26\uff0c\u5b83\u4eec\u5171\u4eab\u76f8\u540c\u7684\u5b57\u4f53\u6837\u5f0f\u3002"}),"\n",(0,l.jsx)(e.h4,{id:"1-\u5b9a\u4e49\u4eab\u5143\u63a5\u53e3",children:"1. \u5b9a\u4e49\u4eab\u5143\u63a5\u53e3"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:"/**\n * \u5b57\u7b26\u5916\u89c2\u4eab\u5143\u63a5\u53e3\uff08Flyweight\uff09\n */\npublic interface CharacterStyle {\n    /**\n     * \u6e32\u67d3\u5b57\u7b26\n     * @param character \u5b57\u7b26\u5185\u5bb9\uff08\u5916\u5728\u72b6\u6001\uff09\n     * @param x \u6a2a\u5750\u6807\uff08\u5916\u5728\u72b6\u6001\uff09\n     * @param y \u7eb5\u5750\u6807\uff08\u5916\u5728\u72b6\u6001\uff09\n     */\n    void render(char character, int x, int y);\n}\n"})}),"\n",(0,l.jsx)(e.h4,{id:"2-\u5177\u4f53\u4eab\u5143\u7c7b",children:"2. \u5177\u4f53\u4eab\u5143\u7c7b"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:'/**\n * \u5177\u4f53\u5b57\u7b26\u6837\u5f0f\uff08ConcreteFlyweight\uff09\n * \u5185\u5728\u72b6\u6001\uff1a\u5b57\u4f53\u3001\u5927\u5c0f\u3001\u989c\u8272\n */\npublic class ConcreteCharacterStyle implements CharacterStyle {\n    // \u5185\u5728\u72b6\u6001\uff1a\u6240\u6709\u4f7f\u7528\u6b64\u6837\u5f0f\u7684\u5b57\u7b26\u5171\u4eab\u8fd9\u4e9b\u5c5e\u6027\n    private final String fontFamily;  // \u5b57\u4f53\n    private final int fontSize;       // \u5927\u5c0f\n    private final String color;       // \u989c\u8272\n\n    /**\n     * \u6784\u9020\u51fd\u6570\uff1a\u8bbe\u7f6e\u5185\u5728\u72b6\u6001\n     */\n    public ConcreteCharacterStyle(String fontFamily, int fontSize, String color) {\n        this.fontFamily = fontFamily;\n        this.fontSize = fontSize;\n        this.color = color;\n\n        // \u6a21\u62df\u52a0\u8f7d\u5b57\u4f53\u8d44\u6e90\u7684\u8017\u65f6\u64cd\u4f5c\n        System.out.println("\u521b\u5efa\u65b0\u6837\u5f0f\uff1a" + fontFamily + ", " + fontSize + "pt, " + color);\n    }\n\n    /**\n     * \u6e32\u67d3\u5b57\u7b26\n     * character, x, y \u662f\u5916\u5728\u72b6\u6001\uff0c\u7531\u5ba2\u6237\u7aef\u4f20\u5165\n     */\n    @Override\n    public void render(char character, int x, int y) {\n        System.out.println("\u6e32\u67d3\u5b57\u7b26 \'" + character + "\' at (" + x + "," + y + ") " +\n            "\u5b57\u4f53:" + fontFamily + " \u5927\u5c0f:" + fontSize + "pt \u989c\u8272:" + color);\n    }\n\n    @Override\n    public String toString() {\n        return fontFamily + "-" + fontSize + "-" + color;\n    }\n}\n'})}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsxs)(e.p,{children:["[!TIP] > ",(0,l.jsx)(e.strong,{children:"\u5185\u5728\u72b6\u6001 vs \u5916\u5728\u72b6\u6001"}),"\uff1a"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"\u5185\u5728\uff1a\u5b57\u4f53\u3001\u5927\u5c0f\u3001\u989c\u8272\uff08\u6210\u5343\u4e0a\u4e07\u4e2a\u5b57\u7b26\u5171\u4eab\uff09"}),"\n",(0,l.jsx)(e.li,{children:"\u5916\u5728\uff1a\u5b57\u7b26\u5185\u5bb9\u3001\u4f4d\u7f6e\u5750\u6807\uff08\u6bcf\u4e2a\u5b57\u7b26\u90fd\u4e0d\u540c\uff09"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(e.h4,{id:"3-\u4eab\u5143\u5de5\u5382",children:"3. \u4eab\u5143\u5de5\u5382"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:'import java.util.HashMap;\nimport java.util.Map;\n\n/**\n * \u5b57\u7b26\u6837\u5f0f\u5de5\u5382\uff08FlyweightFactory\uff09\n * \u7ba1\u7406\u4eab\u5143\u5bf9\u8c61\u6c60\n */\npublic class CharacterStyleFactory {\n    // \u5bf9\u8c61\u6c60\uff1a\u5b58\u50a8\u5df2\u521b\u5efa\u7684\u4eab\u5143\u5bf9\u8c61\n    private Map<String, CharacterStyle> stylePool = new HashMap<>();\n\n    /**\n     * \u83b7\u53d6\u5b57\u7b26\u6837\u5f0f\uff08\u4eab\u5143\u5bf9\u8c61\uff09\n     * \u5982\u679c\u5df2\u5b58\u5728\u5219\u590d\u7528\uff0c\u4e0d\u5b58\u5728\u5219\u521b\u5efa\n     */\n    public CharacterStyle getStyle(String fontFamily, int fontSize, String color) {\n        // \u751f\u6210\u552f\u4e00\u952e\n        String key = fontFamily + "-" + fontSize + "-" + color;\n\n        // \u67e5\u627e\u5bf9\u8c61\u6c60\n        CharacterStyle style = stylePool.get(key);\n\n        if (style == null) {\n            // \u5bf9\u8c61\u6c60\u4e2d\u6ca1\u6709\uff0c\u521b\u5efa\u65b0\u7684\u4eab\u5143\u5bf9\u8c61\n            style = new ConcreteCharacterStyle(fontFamily, fontSize, color);\n            stylePool.put(key, style);\n            System.out.println("  -> \u5bf9\u8c61\u6c60\u5927\u5c0f: " + stylePool.size());\n        } else {\n            System.out.println("  -> \u590d\u7528\u5df2\u6709\u6837\u5f0f: " + key);\n        }\n\n        return style;\n    }\n\n    /**\n     * \u83b7\u53d6\u5bf9\u8c61\u6c60\u5927\u5c0f\n     */\n    public int getPoolSize() {\n        return stylePool.size();\n    }\n\n    /**\n     * \u663e\u793a\u5bf9\u8c61\u6c60\u4fe1\u606f\n     */\n    public void showPool() {\n        System.out.println("\\n========== \u5bf9\u8c61\u6c60\u4fe1\u606f ==========");\n        System.out.println("\u6c60\u4e2d\u5bf9\u8c61\u6570: " + stylePool.size());\n        for (String key : stylePool.keySet()) {\n            System.out.println("  - " + key);\n        }\n        System.out.println("==============================\\n");\n    }\n}\n'})}),"\n",(0,l.jsx)(e.h4,{id:"4-\u5ba2\u6237\u7aef\u4f7f\u7528",children:"4. \u5ba2\u6237\u7aef\u4f7f\u7528"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:'/**\n * \u6587\u5b57\u5904\u7406\u5668\u6f14\u793a\n */\npublic class TextEditorDemo {\n    public static void main(String[] args) {\n        CharacterStyleFactory factory = new CharacterStyleFactory();\n\n        System.out.println("========== \u521b\u5efa\u6587\u6863 ==========\\n");\n\n        // \u7b2c1\u4e2a\u5b57\u7b26\uff1aArial, 12pt, black\n        CharacterStyle style1 = factory.getStyle("Arial", 12, "black");\n        style1.render(\'H\', 0, 0);\n\n        // \u7b2c2\u4e2a\u5b57\u7b26\uff1a\u76f8\u540c\u6837\u5f0f\uff0c\u590d\u7528\uff01\n        CharacterStyle style2 = factory.getStyle("Arial", 12, "black");\n        style2.render(\'e\', 10, 0);\n\n        // \u7b2c3\u4e2a\u5b57\u7b26\uff1a\u76f8\u540c\u6837\u5f0f\uff0c\u590d\u7528\uff01\n        CharacterStyle style3 = factory.getStyle("Arial", 12, "black");\n        style3.render(\'l\', 20, 0);\n\n        // \u7b2c4\u4e2a\u5b57\u7b26\uff1a\u4e0d\u540c\u6837\u5f0f\uff08\u6807\u9898\uff09\n        CharacterStyle style4 = factory.getStyle("Arial", 24, "blue");\n        style4.render(\'T\', 0, 50);\n\n        // \u7b2c5\u4e2a\u5b57\u7b26\uff1a\u56de\u5230\u6b63\u6587\u6837\u5f0f\uff0c\u590d\u7528\u7b2c1\u4e2a\u6837\u5f0f\uff01\n        CharacterStyle style5 = factory.getStyle("Arial", 12, "black");\n        style5.render(\'l\', 30, 0);\n\n        // \u663e\u793a\u5bf9\u8c61\u6c60\n        factory.showPool();\n\n        // \u9a8c\u8bc1\u5bf9\u8c61\u662f\u5426\u76f8\u540c\n        System.out.println("style1 == style2? " + (style1 == style2)); // true\n        System.out.println("style1 == style4? " + (style1 == style4)); // false\n\n        // \u6a21\u62df\u5927\u578b\u6587\u6863\n        System.out.println("\\n========== \u6027\u80fd\u6d4b\u8bd5 ==========\\n");\n        simulateLargeDocument(factory);\n    }\n\n    /**\n     * \u6a21\u62df\u5904\u7406\u5927\u578b\u6587\u6863\n     */\n    private static void simulateLargeDocument(CharacterStyleFactory factory) {\n        String[] fonts = {"Arial", "Times New Roman", "Courier"};\n        int[] sizes = {12, 14, 16};\n        String[] colors = {"black", "blue", "red"};\n\n        // \u6a21\u62df 10,000 \u4e2a\u5b57\u7b26\n        int charCount = 10000;\n        long startTime = System.currentTimeMillis();\n\n        for (int i = 0; i < charCount; i++) {\n            // \u968f\u673a\u9009\u62e9\u6837\u5f0f\uff08\u5b9e\u9645\u6587\u6863\u4e2d\u6837\u5f0f\u79cd\u7c7b\u6709\u9650\uff09\n            String font = fonts[i % fonts.length];\n            int size = sizes[i % sizes.length];\n            String color = colors[i % colors.length];\n\n            CharacterStyle style = factory.getStyle(font, size, color);\n            // style.render((char)(\'A\' + i % 26), i * 10, i / 100);\n        }\n\n        long endTime = System.currentTimeMillis();\n\n        System.out.println("\u5904\u7406 " + charCount + " \u4e2a\u5b57\u7b26");\n        System.out.println("\u521b\u5efa\u7684\u6837\u5f0f\u5bf9\u8c61\u6570: " + factory.getPoolSize());\n        System.out.println("\u8017\u65f6: " + (endTime - startTime) + "ms");\n        System.out.println("\\n\u8282\u7701\u7684\u5bf9\u8c61\u6570: " + (charCount - factory.getPoolSize()));\n        System.out.println("\u5185\u5b58\u8282\u7701\u7387: " +\n            String.format("%.2f%%", (1 - (double)factory.getPoolSize() / charCount) * 100));\n    }\n}\n'})}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u8f93\u51fa\uff1a"})}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"========== \u521b\u5efa\u6587\u6863 ==========\n\n\u521b\u5efa\u65b0\u6837\u5f0f\uff1aArial, 12pt, black\n  -> \u5bf9\u8c61\u6c60\u5927\u5c0f: 1\n\u6e32\u67d3\u5b57\u7b26 'H' at (0,0) \u5b57\u4f53:Arial \u5927\u5c0f:12pt \u989c\u8272:black\n  -> \u590d\u7528\u5df2\u6709\u6837\u5f0f: Arial-12-black\n\u6e32\u67d3\u5b57\u7b26 'e' at (10,0) \u5b57\u4f53:Arial \u5927\u5c0f:12pt \u989c\u8272:black\n  -> \u590d\u7528\u5df2\u6709\u6837\u5f0f: Arial-12-black\n\u6e32\u67d3\u5b57\u7b26 'l' at (20,0) \u5b57\u4f53:Arial \u5927\u5c0f:12pt \u989c\u8272:black\n\u521b\u5efa\u65b0\u6837\u5f0f\uff1aArial, 24pt, blue\n  -> \u5bf9\u8c61\u6c60\u5927\u5c0f: 2\n\u6e32\u67d3\u5b57\u7b26 'T' at (0,50) \u5b57\u4f53:Arial \u5927\u5c0f:24pt \u989c\u8272:blue\n  -> \u590d\u7528\u5df2\u6709\u6837\u5f0f: Arial-12-black\n\u6e32\u67d3\u5b57\u7b26 'l' at (30,0) \u5b57\u4f53:Arial \u5927\u5c0f:12pt \u989c\u8272:black\n\n========== \u5bf9\u8c61\u6c60\u4fe1\u606f ==========\n\u6c60\u4e2d\u5bf9\u8c61\u6570: 2\n  - Arial-12-black\n  - Arial-24-blue\n==============================\n\nstyle1 == style2? true\nstyle1 == style4? false\n\n========== \u6027\u80fd\u6d4b\u8bd5 ==========\n\n\u5904\u7406 10,000 \u4e2a\u5b57\u7b26\n\u521b\u5efa\u7684\u6837\u5f0f\u5bf9\u8c61\u6570: 9\n\u8017\u65f6: 5ms\n\n\u8282\u7701\u7684\u5bf9\u8c61\u6570: 9991\n\u5185\u5b58\u8282\u7701\u7387: 99.91%\n"})}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsxs)(e.p,{children:["[!NOTE] > ",(0,l.jsx)(e.strong,{children:"\u5185\u5b58\u4f18\u5316\u6548\u679c\u60ca\u4eba"}),"\uff1a10,000 \u4e2a\u5b57\u7b26\u53ea\u9700\u8981 9 \u4e2a\u6837\u5f0f\u5bf9\u8c61\uff0c\u8282\u7701\u4e86 99.91% \u7684\u5185\u5b58\uff01"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u5b9e\u9645\u5e94\u7528\u793a\u4f8b",children:"\u5b9e\u9645\u5e94\u7528\u793a\u4f8b"}),"\n",(0,l.jsx)(e.h3,{id:"\u793a\u4f8b-1\u6e38\u620f\u4e2d\u7684\u7cbe\u7075\u654c\u4eba",children:"\u793a\u4f8b 1\uff1a\u6e38\u620f\u4e2d\u7684\u7cbe\u7075/\u654c\u4eba"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:'/**\n * \u6e38\u620f\u7cbe\u7075\uff08\u4eab\u5143\uff09\n * \u5185\u5728\u72b6\u6001\uff1a\u56fe\u7247\u3001\u5c3a\u5bf8\n */\npublic class Sprite {\n    // \u5185\u5728\u72b6\u6001\uff1a\u6240\u6709\u76f8\u540c\u7c7b\u578b\u7684\u654c\u4eba\u5171\u4eab\n    private final String imagePath;\n    private final int width;\n    private final int height;\n    private final byte[] imageData;  // \u56fe\u7247\u6570\u636e\uff08\u53ef\u80fd\u5f88\u5927\uff09\n\n    public Sprite(String imagePath, int width, int height) {\n        this.imagePath = imagePath;\n        this.width = width;\n        this.height = height;\n        // \u6a21\u62df\u52a0\u8f7d\u56fe\u7247\u8d44\u6e90\n        this.imageData = loadImage(imagePath);\n        System.out.println("\ud83d\udce6 \u52a0\u8f7d\u8d44\u6e90: " + imagePath + " (" + width + "x" + height + ")");\n    }\n\n    /**\n     * \u6e32\u67d3\u7cbe\u7075\n     * x, y, health \u662f\u5916\u5728\u72b6\u6001\n     */\n    public void render(int x, int y, int health) {\n        System.out.println("\ud83c\udfae \u6e32\u67d3\u7cbe\u7075 at (" + x + "," + y + ") HP:" + health);\n    }\n\n    private byte[] loadImage(String path) {\n        // \u6a21\u62df\u52a0\u8f7d\u56fe\u7247\n        return new byte[1024 * 100];  // 100KB\n    }\n}\n\n/**\n * \u7cbe\u7075\u5de5\u5382\n */\npublic class SpriteFactory {\n    private Map<String, Sprite> spriteCache = new HashMap<>();\n\n    public Sprite getSprite(String type) {\n        if (!spriteCache.containsKey(type)) {\n            // \u6839\u636e\u7c7b\u578b\u521b\u5efa\u7cbe\u7075\n            switch (type) {\n                case "zombie":\n                    spriteCache.put(type, new Sprite("zombie.png", 32, 32));\n                    break;\n                case "skeleton":\n                    spriteCache.put(type, new Sprite("skeleton.png", 32, 32));\n                    break;\n                case "boss":\n                    spriteCache.put(type, new Sprite("boss.png", 64, 64));\n                    break;\n            }\n        } else {\n            System.out.println("\u267b\ufe0f  \u590d\u7528\u7cbe\u7075: " + type);\n        }\n        return spriteCache.get(type);\n    }\n}\n\n// \u4f7f\u7528\u793a\u4f8b\uff1a\u521b\u5efa\u5927\u91cf\u654c\u4eba\nclass Game Demo {\n    public static void main(String[] args) {\n        SpriteFactory factory = new SpriteFactory();\n\n        System.out.println("========== \u751f\u6210\u654c\u4eba ==========\\n");\n\n        // \u521b\u5efa 1000 \u4e2a\u50f5\u5c38\uff0c\u4f46\u53ea\u52a0\u8f7d\u4e00\u6b21\u56fe\u7247\u8d44\u6e90\uff01\n        for (int i = 0; i < 1000; i++) {\n            Sprite zombie = factory.getSprite("zombie");\n            zombie.render(i * 10, i * 5, 100);  // \u5916\u5728\u72b6\u6001\uff1a\u4f4d\u7f6e\u3001\u8840\u91cf\n        }\n\n        // \u521b\u5efa 500 \u4e2a\u9ab7\u9ac5\n        for (int i = 0; i < 500; i++) {\n            Sprite skeleton = factory.getSprite("skeleton");\n            skeleton.render(i * 15, i * 8, 50);\n        }\n\n        // \u521b\u5efa 10 \u4e2a Boss\n        for (int i = 0; i < 10; i++) {\n            Sprite boss = factory.getSprite("boss");\n            boss.render(i * 100, i * 100, 1000);\n        }\n\n        System.out.println("\\n========== \u7edf\u8ba1 ==========");\n        System.out.println("\u603b\u654c\u4eba\u6570: 1510");\n        System.out.println("\u52a0\u8f7d\u7684\u7cbe\u7075\u8d44\u6e90\u6570: 3");\n        System.out.println("\u8282\u7701\u5185\u5b58: " + (1510 - 3) + " \u4e2a\u5bf9\u8c61");\n    }\n}\n'})}),"\n",(0,l.jsx)(e.h3,{id:"\u793a\u4f8b-2\u6570\u636e\u5e93\u8fde\u63a5\u6c60",children:"\u793a\u4f8b 2\uff1a\u6570\u636e\u5e93\u8fde\u63a5\u6c60"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:'/**\n * \u6570\u636e\u5e93\u8fde\u63a5\uff08\u4eab\u5143\uff09\n */\npublic class DatabaseConnection {\n    private final String connectionId;\n    private final String url;\n    private boolean inUse;\n\n    public DatabaseConnection(String url) {\n        this.connectionId = "CONN_" + System.currentTimeMillis();\n        this.url = url;\n        this.inUse = false;\n\n        // \u6a21\u62df\u5efa\u7acb\u8fde\u63a5\uff08\u8017\u65f6\u64cd\u4f5c\uff09\n        System.out.println("\ud83d\udd17 \u5efa\u7acb\u6570\u636e\u5e93\u8fde\u63a5: " + connectionId);\n        try {\n            Thread.sleep(100);  // \u6a21\u62df\u8fde\u63a5\u8017\u65f6\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n    }\n\n    public void setInUse(boolean inUse) {\n        this.inUse = inUse;\n    }\n\n    public boolean isInUse() {\n        return inUse;\n    }\n\n    public void execute(String sql) {\n        System.out.println("[" + connectionId + "] \u6267\u884c: " + sql);\n    }\n}\n\n/**\n * \u8fde\u63a5\u6c60\uff08\u4eab\u5143\u5de5\u5382\uff09\n */\npublic class ConnectionPool {\n    private List<DatabaseConnection> connections = new ArrayList<>();\n    private static final int MAX_CONNECTIONS = 10;\n    private String url;\n\n    public ConnectionPool(String url) {\n        this.url = url;\n    }\n\n    /**\n     * \u83b7\u53d6\u8fde\u63a5\uff08\u4eab\u5143\u5bf9\u8c61\uff09\n     */\n    public synchronized DatabaseConnection getConnection() {\n        // 1. \u5148\u67e5\u627e\u7a7a\u95f2\u8fde\u63a5\n        for (DatabaseConnection conn : connections) {\n            if (!conn.isInUse()) {\n                conn.setInUse(true);\n                System.out.println("\u267b\ufe0f  \u590d\u7528\u8fde\u63a5");\n                return conn;\n            }\n        }\n\n        // 2. \u6ca1\u6709\u7a7a\u95f2\u8fde\u63a5\uff0c\u521b\u5efa\u65b0\u8fde\u63a5\n        if (connections.size() < MAX_CONNECTIONS) {\n            DatabaseConnection conn = new DatabaseConnection(url);\n            conn.setInUse(true);\n            connections.add(conn);\n            System.out.println("  -> \u8fde\u63a5\u6c60\u5927\u5c0f: " + connections.size());\n            return conn;\n        }\n\n        // 3. \u8fde\u63a5\u6c60\u5df2\u6ee1\n        throw new RuntimeException("\u8fde\u63a5\u6c60\u5df2\u6ee1\uff01");\n    }\n\n    /**\n     * \u91ca\u653e\u8fde\u63a5\n     */\n    public synchronized void releaseConnection(DatabaseConnection conn) {\n        conn.setInUse(false);\n        System.out.println("\ud83d\udd13 \u91ca\u653e\u8fde\u63a5");\n    }\n}\n\n// \u4f7f\u7528\u793a\u4f8b\nclass ConnectionPoolDemo {\n    public static void main(String[] args) {\n        ConnectionPool pool = new ConnectionPool("jdbc:mysql://localhost:3306/mydb");\n\n        System.out.println("========== \u6570\u636e\u5e93\u64cd\u4f5c ==========\\n");\n\n        // \u83b7\u53d6\u8fde\u63a51\n        DatabaseConnection conn1 = pool.getConnection();\n        conn1.execute("SELECT * FROM users");\n\n        // \u83b7\u53d6\u8fde\u63a52\n        DatabaseConnection conn2 = pool.getConnection();\n        conn2.execute("SELECT * FROM orders");\n\n        // \u91ca\u653e\u8fde\u63a51\n        pool.releaseConnection(conn1);\n\n        // \u518d\u6b21\u83b7\u53d6\u8fde\u63a5\uff0c\u590d\u7528 conn1\n        DatabaseConnection conn3 = pool.getConnection();\n        conn3.execute("SELECT * FROM products");\n    }\n}\n'})}),"\n",(0,l.jsx)(e.h3,{id:"\u793a\u4f8b-3string-\u5e38\u91cf\u6c60",children:"\u793a\u4f8b 3\uff1aString \u5e38\u91cf\u6c60"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:'/**\n * Java String \u662f\u4eab\u5143\u6a21\u5f0f\u7684\u5178\u578b\u5e94\u7528\n */\npublic class StringPoolDemo {\n    public static void main(String[] args) {\n        // \u5b57\u7b26\u4e32\u5b57\u9762\u91cf\u81ea\u52a8\u8fdb\u5165\u5e38\u91cf\u6c60\n        String s1 = "Hello";\n        String s2 = "Hello";\n\n        // s1 \u548c s2 \u6307\u5411\u540c\u4e00\u4e2a\u5bf9\u8c61\uff08\u4eab\u5143\uff09\n        System.out.println("s1 == s2: " + (s1 == s2));  // true\n\n        // new String() \u521b\u5efa\u65b0\u5bf9\u8c61\uff0c\u4e0d\u662f\u4eab\u5143\n        String s3 = new String("Hello");\n        System.out.println("s1 == s3: " + (s1 == s3));  // false\n\n        // intern() \u65b9\u6cd5\u5c06\u5b57\u7b26\u4e32\u52a0\u5165\u5e38\u91cf\u6c60\n        String s4 = s3.intern();\n        System.out.println("s1 == s4: " + (s1 == s4));  // true\n    }\n}\n'})}),"\n",(0,l.jsx)(e.h2,{id:"\u4eab\u5143\u6a21\u5f0f-vs-\u5bf9\u8c61\u6c60",children:"\u4eab\u5143\u6a21\u5f0f vs \u5bf9\u8c61\u6c60"}),"\n",(0,l.jsx)(e.mermaid,{value:"graph TB\n    subgraph \u4eab\u5143\u6a21\u5f0f\n    A1[\u4eab\u5143\u5de5\u5382] --\x3e B1[\u4eab\u5143\u5bf9\u8c611<br/>\u5185\u5728\u72b6\u6001]\n    A1 --\x3e C1[\u4eab\u5143\u5bf9\u8c612<br/>\u5185\u5728\u72b6\u6001]\n    D1[\u5ba2\u6237\u7aef] --\x3e A1\n    D1 -.\u4f20\u5165.-> E1[\u5916\u5728\u72b6\u6001]\n    end\n\n    subgraph \u5bf9\u8c61\u6c60\n    A2[\u5bf9\u8c61\u6c60] --\x3e B2[\u5bf9\u8c611]\n    A2 --\x3e C2[\u5bf9\u8c612]\n    D2[\u5ba2\u6237\u7aef] --\x3e A2\n    D2 -.\u4f7f\u7528\u5b8c.-> A2\n    end"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"\u7279\u6027"}),(0,l.jsx)(e.th,{children:"\u4eab\u5143\u6a21\u5f0f"}),(0,l.jsx)(e.th,{children:"\u5bf9\u8c61\u6c60"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"\u76ee\u7684"})}),(0,l.jsx)(e.td,{children:"\u51cf\u5c11\u5185\u5b58\u5360\u7528"}),(0,l.jsx)(e.td,{children:"\u907f\u514d\u91cd\u590d\u521b\u5efa"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"\u5171\u4eab\u5185\u5bb9"})}),(0,l.jsx)(e.td,{children:"\u5185\u5728\u72b6\u6001"}),(0,l.jsx)(e.td,{children:"\u6574\u4e2a\u5bf9\u8c61"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"\u5bf9\u8c61\u72b6\u6001"})}),(0,l.jsx)(e.td,{children:"\u5185\u5728+\u5916\u5728"}),(0,l.jsx)(e.td,{children:"\u5b8c\u6574\u5bf9\u8c61"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"\u9002\u7528\u573a\u666f"})}),(0,l.jsx)(e.td,{children:"\u5927\u91cf\u76f8\u4f3c\u5bf9\u8c61"}),(0,l.jsx)(e.td,{children:"\u521b\u5efa\u6210\u672c\u9ad8"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"\u5178\u578b\u5e94\u7528"})}),(0,l.jsx)(e.td,{children:"String \u6c60\u3001\u56fe\u7247\u7f13\u5b58"}),(0,l.jsx)(e.td,{children:"\u8fde\u63a5\u6c60\u3001\u7ebf\u7a0b\u6c60"})]})]})]}),"\n",(0,l.jsx)(e.h2,{id:"java-\u6807\u51c6\u5e93\u4e2d\u7684\u5e94\u7528",children:"Java \u6807\u51c6\u5e93\u4e2d\u7684\u5e94\u7528"}),"\n",(0,l.jsx)(e.h3,{id:"1-string-\u5e38\u91cf\u6c60",children:"1. String \u5e38\u91cf\u6c60"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:'/**\n * String \u5e38\u91cf\u6c60\u662f\u4eab\u5143\u6a21\u5f0f\n */\nString s1 = "hello";  // \u8fdb\u5165\u5e38\u91cf\u6c60\nString s2 = "hello";  // \u590d\u7528\u5e38\u91cf\u6c60\u4e2d\u7684\u5bf9\u8c61\nSystem.out.println(s1 == s2);  // true\n'})}),"\n",(0,l.jsx)(e.h3,{id:"2-integer-\u7f13\u5b58",children:"2. Integer \u7f13\u5b58"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:"/**\n * Integer \u7f13\u5b58 -128 \u5230 127 \u4e4b\u95f4\u7684\u503c\n */\nInteger i1 = 100;  // \u4f7f\u7528\u7f13\u5b58\nInteger i2 = 100;  // \u590d\u7528\u7f13\u5b58\nSystem.out.println(i1 == i2);  // true\n\nInteger i3 = 200;  // \u8d85\u51fa\u7f13\u5b58\u8303\u56f4\nInteger i4 = 200;  // \u65b0\u5efa\u5bf9\u8c61\nSystem.out.println(i3 == i4);  // false\n"})}),"\n",(0,l.jsx)(e.h3,{id:"3-apache-commons-pool",children:"3. Apache Commons Pool"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:"/**\n * Apache Commons Pool \u63d0\u4f9b\u4e86\u901a\u7528\u7684\u5bf9\u8c61\u6c60\n */\nGenericObjectPool<MyObject> pool = new GenericObjectPool<>(factory);\nMyObject obj = pool.borrowObject();\n// \u4f7f\u7528\u5bf9\u8c61...\npool.returnObject(obj);\n"})}),"\n",(0,l.jsx)(e.h2,{id:"\u4f18\u7f3a\u70b9",children:"\u4f18\u7f3a\u70b9"}),"\n",(0,l.jsx)(e.h3,{id:"\u4f18\u70b9",children:"\u4f18\u70b9"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\u2705 ",(0,l.jsx)(e.strong,{children:"\u5927\u5e45\u51cf\u5c11\u5bf9\u8c61\u6570\u91cf"})," - \u8282\u7701\u5185\u5b58"]}),"\n",(0,l.jsxs)(e.li,{children:["\u2705 ",(0,l.jsx)(e.strong,{children:"\u63d0\u9ad8\u6027\u80fd"})," - \u51cf\u5c11\u5bf9\u8c61\u521b\u5efa\u548c\u5783\u573e\u56de\u6536"]}),"\n",(0,l.jsxs)(e.li,{children:["\u2705 ",(0,l.jsx)(e.strong,{children:"\u96c6\u4e2d\u7ba1\u7406"})," - \u901a\u8fc7\u5de5\u5382\u7edf\u4e00\u7ba1\u7406\u5171\u4eab\u5bf9\u8c61"]}),"\n",(0,l.jsxs)(e.li,{children:["\u2705 ",(0,l.jsx)(e.strong,{children:"\u9002\u5408\u5927\u89c4\u6a21\u573a\u666f"})," - \u5904\u7406\u6210\u5343\u4e0a\u4e07\u4e2a\u5bf9\u8c61"]}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"\u7f3a\u70b9",children:"\u7f3a\u70b9"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\u274c ",(0,l.jsx)(e.strong,{children:"\u589e\u52a0\u590d\u6742\u5ea6"})," - \u9700\u8981\u5206\u79bb\u5185\u5728\u548c\u5916\u5728\u72b6\u6001"]}),"\n",(0,l.jsxs)(e.li,{children:["\u274c ",(0,l.jsx)(e.strong,{children:"\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898"})," - \u9700\u8981\u8003\u8651\u5e76\u53d1\u8bbf\u95ee"]}),"\n",(0,l.jsxs)(e.li,{children:["\u274c ",(0,l.jsx)(e.strong,{children:"\u5916\u5728\u72b6\u6001\u7ba1\u7406"})," - \u5ba2\u6237\u7aef\u9700\u8981\u7ef4\u62a4\u5916\u5728\u72b6\u6001"]}),"\n",(0,l.jsxs)(e.li,{children:["\u274c ",(0,l.jsx)(e.strong,{children:"\u4e0d\u9002\u5408\u5c0f\u578b\u5e94\u7528"})," - \u5bf9\u8c61\u6570\u91cf\u5c11\u65f6\u6536\u76ca\u4e0d\u660e\u663e"]}),"\n"]}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsxs)(e.p,{children:["[!WARNING] > ",(0,l.jsx)(e.strong,{children:"\u7ebf\u7a0b\u5b89\u5168"}),"\uff1a\u5982\u679c\u591a\u4e2a\u7ebf\u7a0b\u5171\u4eab\u4eab\u5143\u5bf9\u8c61\uff0c\u5fc5\u987b\u786e\u4fdd\u7ebf\u7a0b\u5b89\u5168\u3002\u901a\u5e38\u4eab\u5143\u5bf9\u8c61\u5e94\u8be5\u662f\u4e0d\u53ef\u53d8\u7684\uff08immutable\uff09\u3002"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u9002\u7528\u573a\u666f",children:"\u9002\u7528\u573a\u666f"}),"\n",(0,l.jsx)(e.h3,{id:"\u4f55\u65f6\u4f7f\u7528\u4eab\u5143\u6a21\u5f0f",children:"\u4f55\u65f6\u4f7f\u7528\u4eab\u5143\u6a21\u5f0f"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\u2713 ",(0,l.jsx)(e.strong,{children:"\u5927\u91cf\u76f8\u4f3c\u5bf9\u8c61"})," - \u7cfb\u7edf\u4e2d\u6709\u5927\u91cf\u7ec6\u7c92\u5ea6\u5bf9\u8c61"]}),"\n",(0,l.jsxs)(e.li,{children:["\u2713 ",(0,l.jsx)(e.strong,{children:"\u5185\u5b58\u538b\u529b\u5927"})," - \u5bf9\u8c61\u5360\u7528\u5185\u5b58\u8fc7\u591a"]}),"\n",(0,l.jsxs)(e.li,{children:["\u2713 ",(0,l.jsx)(e.strong,{children:"\u5bf9\u8c61\u72b6\u6001\u53ef\u5206\u79bb"})," - \u53ef\u4ee5\u533a\u5206\u5185\u5728\u548c\u5916\u5728\u72b6\u6001"]}),"\n",(0,l.jsxs)(e.li,{children:["\u2713 ",(0,l.jsx)(e.strong,{children:"\u5916\u5728\u72b6\u6001\u8f83\u5c11"})," - \u5916\u5728\u72b6\u6001\u4e0d\u4f1a\u8fc7\u5ea6\u589e\u52a0\u590d\u6742\u5ea6"]}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"\u5b9e\u9645\u5e94\u7528\u573a\u666f",children:"\u5b9e\u9645\u5e94\u7528\u573a\u666f"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:["\ud83d\udcdd ",(0,l.jsx)(e.strong,{children:"\u6587\u5b57\u5904\u7406"})," - \u5b57\u7b26\u6837\u5f0f\u3001\u5b57\u4f53"]}),"\n",(0,l.jsxs)(e.li,{children:["\ud83c\udfae ",(0,l.jsx)(e.strong,{children:"\u6e38\u620f\u5f00\u53d1"})," - \u7cbe\u7075\u3001\u5730\u56fe\u7816\u5757\u3001\u7c92\u5b50\u6548\u679c"]}),"\n",(0,l.jsxs)(e.li,{children:["\ud83c\udf10 ",(0,l.jsx)(e.strong,{children:"Web \u5e94\u7528"})," - \u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3001\u7ebf\u7a0b\u6c60"]}),"\n",(0,l.jsxs)(e.li,{children:["\ud83d\uddbc\ufe0f ",(0,l.jsx)(e.strong,{children:"\u56fe\u5f62\u7cfb\u7edf"})," - \u56fe\u7247\u7f13\u5b58\u3001\u56fe\u6807\u5e93"]}),"\n",(0,l.jsxs)(e.li,{children:["\ud83d\udcca ",(0,l.jsx)(e.strong,{children:"\u6570\u636e\u53ef\u89c6\u5316"})," - \u56fe\u8868\u5143\u7d20\u3001\u6807\u8bb0"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,l.jsx)(e.h3,{id:"1-\u4fdd\u6301\u4eab\u5143\u5bf9\u8c61\u4e0d\u53ef\u53d8",children:"1. \u4fdd\u6301\u4eab\u5143\u5bf9\u8c61\u4e0d\u53ef\u53d8"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:"/**\n * \u2705 \u597d\u7684\u4eab\u5143\uff1a\u4e0d\u53ef\u53d8\u5bf9\u8c61\n */\npublic final class ImmutableFlyweight {\n    private final String state;\n\n    public ImmutableFlyweight(String state) {\n        this.state = state;\n    }\n\n    public String getState() {\n        return state;\n    }\n\n    // \u6ca1\u6709setter\u65b9\u6cd5\uff0c\u4fdd\u8bc1\u4e0d\u53ef\u53d8\n}\n"})}),"\n",(0,l.jsx)(e.h3,{id:"2-\u4f7f\u7528\u5de5\u5382\u7ba1\u7406\u4eab\u5143\u5bf9\u8c61",children:"2. \u4f7f\u7528\u5de5\u5382\u7ba1\u7406\u4eab\u5143\u5bf9\u8c61"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:"/**\n * \u5de5\u5382\u6a21\u5f0f + \u5355\u4f8b\u6a21\u5f0f\n */\npublic class FlyweightFactory {\n    private static final FlyweightFactory INSTANCE = new FlyweightFactory();\n    private Map<String, Flyweight> pool = new ConcurrentHashMap<>();\n\n    private FlyweightFactory() {}\n\n    public static FlyweightFactory getInstance() {\n        return INSTANCE;\n    }\n\n    public Flyweight getFlyweight(String key) {\n        return pool.computeIfAbsent(key, k -> new ConcreteFlyweight(k));\n    }\n}\n"})}),"\n",(0,l.jsx)(e.h3,{id:"3-\u8003\u8651\u4f7f\u7528-weakhashmap",children:"3. \u8003\u8651\u4f7f\u7528 WeakHashMap"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:"/**\n * \u4f7f\u7528 WeakHashMap \u81ea\u52a8\u6e05\u7406\u4e0d\u518d\u4f7f\u7528\u7684\u4eab\u5143\n */\npublic class SmartFlyweightFactory {\n    private Map<String, Flyweight> pool = new WeakHashMap<>();\n\n    public Flyweight getFlyweight(String key) {\n        return pool.computeIfAbsent(key, k -> new ConcreteFlyweight(k));\n    }\n}\n"})}),"\n",(0,l.jsx)(e.h3,{id:"4-\u63d0\u4f9b\u7edf\u8ba1\u548c\u76d1\u63a7",children:"4. \u63d0\u4f9b\u7edf\u8ba1\u548c\u76d1\u63a7"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-java",children:'/**\n * \u6dfb\u52a0\u76d1\u63a7\u529f\u80fd\n */\npublic class MonitoredFactory {\n    private Map<String, Flyweight> pool = new HashMap<>();\n    private int hitCount = 0;\n    private int missCount = 0;\n\n    public Flyweight getFlyweight(String key) {\n        Flyweight fw = pool.get(key);\n        if (fw != null) {\n            hitCount++;\n        } else {\n            missCount++;\n            fw = new ConcreteFlyweight(key);\n            pool.put(key, fw);\n        }\n        return fw;\n    }\n\n    public void printStatistics() {\n        System.out.println("\u7f13\u5b58\u547d\u4e2d\u7387: " +\n            String.format("%.2f%%", (double)hitCount / (hitCount + missCount) * 100));\n    }\n}\n'})}),"\n",(0,l.jsx)(e.h2,{id:"\u4e0e\u5176\u4ed6\u6a21\u5f0f\u7684\u5173\u7cfb",children:"\u4e0e\u5176\u4ed6\u6a21\u5f0f\u7684\u5173\u7cfb"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u4eab\u5143 + \u5de5\u5382"})," - \u901a\u5e38\u4f7f\u7528\u5de5\u5382\u7ba1\u7406\u4eab\u5143\u5bf9\u8c61"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u4eab\u5143 + \u5355\u4f8b"})," - \u4eab\u5143\u5de5\u5382\u901a\u5e38\u662f\u5355\u4f8b"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u4eab\u5143 + \u7ec4\u5408"})," - \u7ec4\u5408\u6a21\u5f0f\u7684\u53f6\u5b50\u8282\u70b9\u53ef\u4ee5\u662f\u4eab\u5143"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u4eab\u5143 + \u72b6\u6001"})," - \u5916\u5728\u72b6\u6001\u53ef\u4ee5\u7528\u72b6\u6001\u6a21\u5f0f\u7ba1\u7406"]}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,l.jsx)(e.p,{children:"\u4eab\u5143\u6a21\u5f0f\u662f\u5185\u5b58\u4f18\u5316\u7684\u5229\u5668\uff1a"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u6838\u5fc3\u601d\u60f3"})," - \u5171\u4eab\u5185\u5728\u72b6\u6001\uff0c\u5206\u79bb\u5916\u5728\u72b6\u6001"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u5173\u952e\u6280\u672f"})," - \u5bf9\u8c61\u6c60 + \u72b6\u6001\u5206\u79bb"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u4e3b\u8981\u4f18\u52bf"})," - \u5927\u5e45\u51cf\u5c11\u5185\u5b58\u5360\u7528\u548c\u5bf9\u8c61\u521b\u5efa"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u7ecf\u5178\u5e94\u7528"})," - String \u6c60\u3001Integer \u7f13\u5b58\u3001\u8fde\u63a5\u6c60"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u4f7f\u7528\u573a\u666f"})," - \u5927\u91cf\u76f8\u4f3c\u5bf9\u8c61\u5bfc\u81f4\u5185\u5b58\u538b\u529b"]}),"\n"]}),"\n",(0,l.jsxs)(e.blockquote,{children:["\n",(0,l.jsxs)(e.p,{children:["[!TIP] > ",(0,l.jsx)(e.strong,{children:"\u4eab\u5143\u6a21\u5f0f\u7684\u7cbe\u9ad3"}),"\uff1a"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u8bc6\u522b"}),"\u53ef\u5171\u4eab\u7684\u5185\u5728\u72b6\u6001"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u5206\u79bb"}),"\u4e0d\u53ef\u5171\u4eab\u7684\u5916\u5728\u72b6\u6001"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u96c6\u4e2d\u7ba1\u7406"}),"\u4eab\u5143\u5bf9\u8c61"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.strong,{children:"\u6743\u8861"}),"\u590d\u6742\u5ea6\u4e0e\u6027\u80fd\u6536\u76ca"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"\u5df2\u5b8c\u6210\uff1a11 \u4e2a\u6587\u6863"}),"\uff08\u521b\u5efa\u578b 5 + \u7ed3\u6784\u578b 6\uff09"]}),"\n",(0,l.jsx)(e.p,{children:"\u7ee7\u7eed\u4f18\u5316\u6700\u540e\u4e00\u4e2a\u7ed3\u6784\u578b\u6a21\u5f0f..."})]})}function d(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(h,{...n})}):h(n)}},48885:(n,e,t)=>{t.d(e,{R:()=>s,x:()=>a});var i=t(99378);const l={},r=i.createContext(l);function s(n){const e=i.useContext(r);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:s(n.components),i.createElement(r.Provider,{value:e},n.children)}}}]);