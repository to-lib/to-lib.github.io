"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[72316],{1572:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>o,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"mybatis/best-practices","title":"MyBatis \u6700\u4f73\u5b9e\u8df5","description":"\u672c\u7ae0\u603b\u7ed3 MyBatis \u5f00\u53d1\u4e2d\u7684\u6700\u4f73\u5b9e\u8df5\uff0c\u5305\u62ec Mapper \u8bbe\u8ba1\u89c4\u8303\u3001SQL \u7f16\u5199\u89c4\u8303\u3001\u6027\u80fd\u4f18\u5316\u548c\u9879\u76ee\u7ed3\u6784\u5efa\u8bae\u3002","source":"@site/docs/mybatis/best-practices.md","sourceDirName":"mybatis","slug":"/mybatis/best-practices","permalink":"/docs/mybatis/best-practices","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/mybatis/best-practices.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10,"title":"MyBatis \u6700\u4f73\u5b9e\u8df5"},"sidebar":"mybatis","previous":{"title":"MyBatis \u63d2\u4ef6\u673a\u5236","permalink":"/docs/mybatis/plugins"},"next":{"title":"MyBatis \u5feb\u901f\u53c2\u8003","permalink":"/docs/mybatis/quick-reference"}}');var a=s(22714),r=s(48885);const l={sidebar_position:10,title:"MyBatis \u6700\u4f73\u5b9e\u8df5"},t="MyBatis \u6700\u4f73\u5b9e\u8df5",c={},d=[{value:"Mapper \u63a5\u53e3\u8bbe\u8ba1\u89c4\u8303",id:"mapper-\u63a5\u53e3\u8bbe\u8ba1\u89c4\u8303",level:2},{value:"\u547d\u540d\u89c4\u8303",id:"\u547d\u540d\u89c4\u8303",level:3},{value:"\u65b9\u6cd5\u547d\u540d",id:"\u65b9\u6cd5\u547d\u540d",level:3},{value:"\u53c2\u6570\u8bbe\u8ba1",id:"\u53c2\u6570\u8bbe\u8ba1",level:3},{value:"\u67e5\u8be2\u5bf9\u8c61\u8bbe\u8ba1",id:"\u67e5\u8be2\u5bf9\u8c61\u8bbe\u8ba1",level:3},{value:"SQL \u7f16\u5199\u89c4\u8303",id:"sql-\u7f16\u5199\u89c4\u8303",level:2},{value:"\u57fa\u672c\u89c4\u8303",id:"\u57fa\u672c\u89c4\u8303",level:3},{value:"SQL \u7247\u6bb5\u590d\u7528",id:"sql-\u7247\u6bb5\u590d\u7528",level:3},{value:"\u9632\u6b62 SQL \u6ce8\u5165",id:"\u9632\u6b62-sql-\u6ce8\u5165",level:3},{value:"\u6279\u91cf\u64cd\u4f5c\u4f18\u5316",id:"\u6279\u91cf\u64cd\u4f5c\u4f18\u5316",level:3},{value:"\u5206\u9875\u67e5\u8be2",id:"\u5206\u9875\u67e5\u8be2",level:3},{value:"\u6027\u80fd\u4f18\u5316",id:"\u6027\u80fd\u4f18\u5316",level:2},{value:"1. \u907f\u514d N+1 \u67e5\u8be2",id:"1-\u907f\u514d-n1-\u67e5\u8be2",level:3},{value:"2. \u5408\u7406\u4f7f\u7528\u7f13\u5b58",id:"2-\u5408\u7406\u4f7f\u7528\u7f13\u5b58",level:3},{value:"3. \u5ef6\u8fdf\u52a0\u8f7d",id:"3-\u5ef6\u8fdf\u52a0\u8f7d",level:3},{value:"4. \u6279\u91cf\u6267\u884c",id:"4-\u6279\u91cf\u6267\u884c",level:3},{value:"5. \u6d41\u5f0f\u67e5\u8be2",id:"5-\u6d41\u5f0f\u67e5\u8be2",level:3},{value:"6. \u7d22\u5f15\u4f18\u5316",id:"6-\u7d22\u5f15\u4f18\u5316",level:3},{value:"\u9879\u76ee\u7ed3\u6784\u5efa\u8bae",id:"\u9879\u76ee\u7ed3\u6784\u5efa\u8bae",level:2},{value:"\u6807\u51c6\u9879\u76ee\u7ed3\u6784",id:"\u6807\u51c6\u9879\u76ee\u7ed3\u6784",level:3},{value:"\u591a\u6a21\u5757\u9879\u76ee\u7ed3\u6784",id:"\u591a\u6a21\u5757\u9879\u76ee\u7ed3\u6784",level:3},{value:"Mapper XML \u4e0e\u63a5\u53e3\u540c\u5305",id:"mapper-xml-\u4e0e\u63a5\u53e3\u540c\u5305",level:3},{value:"\u5e38\u89c1\u95ee\u9898\u5904\u7406",id:"\u5e38\u89c1\u95ee\u9898\u5904\u7406",level:2},{value:"1. \u9a7c\u5cf0\u547d\u540d\u6620\u5c04",id:"1-\u9a7c\u5cf0\u547d\u540d\u6620\u5c04",level:3},{value:"2. \u7a7a\u503c\u5904\u7406",id:"2-\u7a7a\u503c\u5904\u7406",level:3},{value:"3. \u679a\u4e3e\u5904\u7406",id:"3-\u679a\u4e3e\u5904\u7406",level:3},{value:"4. \u65e5\u671f\u5904\u7406",id:"4-\u65e5\u671f\u5904\u7406",level:3},{value:"5. JSON \u5b57\u6bb5\u5904\u7406",id:"5-json-\u5b57\u6bb5\u5904\u7406",level:3},{value:"\u4ee3\u7801\u89c4\u8303\u68c0\u67e5\u6e05\u5355",id:"\u4ee3\u7801\u89c4\u8303\u68c0\u67e5\u6e05\u5355",level:2},{value:"Mapper \u63a5\u53e3",id:"mapper-\u63a5\u53e3",level:3},{value:"Mapper XML",id:"mapper-xml",level:3},{value:"\u6027\u80fd",id:"\u6027\u80fd",level:3},{value:"\u4e8b\u52a1",id:"\u4e8b\u52a1",level:3},{value:"\u76f8\u5173\u94fe\u63a5",id:"\u76f8\u5173\u94fe\u63a5",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"mybatis-\u6700\u4f73\u5b9e\u8df5",children:"MyBatis \u6700\u4f73\u5b9e\u8df5"})}),"\n",(0,a.jsx)(n.p,{children:"\u672c\u7ae0\u603b\u7ed3 MyBatis \u5f00\u53d1\u4e2d\u7684\u6700\u4f73\u5b9e\u8df5\uff0c\u5305\u62ec Mapper \u8bbe\u8ba1\u89c4\u8303\u3001SQL \u7f16\u5199\u89c4\u8303\u3001\u6027\u80fd\u4f18\u5316\u548c\u9879\u76ee\u7ed3\u6784\u5efa\u8bae\u3002"}),"\n",(0,a.jsx)(n.h2,{id:"mapper-\u63a5\u53e3\u8bbe\u8ba1\u89c4\u8303",children:"Mapper \u63a5\u53e3\u8bbe\u8ba1\u89c4\u8303"}),"\n",(0,a.jsx)(n.h3,{id:"\u547d\u540d\u89c4\u8303",children:"\u547d\u540d\u89c4\u8303"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"// \u2705 \u63a8\u8350\uff1a\u4f7f\u7528 Mapper \u540e\u7f00\npublic interface UserMapper {}\npublic interface OrderMapper {}\n\n// \u274c \u4e0d\u63a8\u8350\npublic interface UserDao {}\npublic interface UserRepository {}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u65b9\u6cd5\u547d\u540d",children:"\u65b9\u6cd5\u547d\u540d"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"public interface UserMapper {\n    \n    // \u67e5\u8be2\u5355\u6761\n    User selectById(Long id);\n    User selectByUsername(String username);\n    \n    // \u67e5\u8be2\u5217\u8868\n    List<User> selectAll();\n    List<User> selectByStatus(Integer status);\n    List<User> selectByCondition(UserQuery query);\n    \n    // \u67e5\u8be2\u6570\u91cf\n    int countByStatus(Integer status);\n    long countAll();\n    \n    // \u63d2\u5165\n    int insert(User user);\n    int insertSelective(User user);\n    int batchInsert(List<User> users);\n    \n    // \u66f4\u65b0\n    int update(User user);\n    int updateSelective(User user);\n    int updateStatus(Long id, Integer status);\n    \n    // \u5220\u9664\n    int deleteById(Long id);\n    int deleteByIds(List<Long> ids);\n    int deleteByCondition(UserQuery query);\n    \n    // \u5b58\u5728\u6027\u68c0\u67e5\n    boolean existsById(Long id);\n    boolean existsByUsername(String username);\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u53c2\u6570\u8bbe\u8ba1",children:"\u53c2\u6570\u8bbe\u8ba1"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'// \u2705 \u5355\u53c2\u6570\uff1a\u76f4\u63a5\u4f7f\u7528\nUser selectById(Long id);\n\n// \u2705 \u591a\u53c2\u6570\uff1a\u4f7f\u7528 @Param\nUser selectByNameAndAge(@Param("name") String name, @Param("age") Integer age);\n\n// \u2705 \u590d\u6742\u67e5\u8be2\uff1a\u4f7f\u7528\u67e5\u8be2\u5bf9\u8c61\nList<User> selectByCondition(UserQuery query);\n\n// \u2705 \u5206\u9875\u67e5\u8be2\uff1a\u4f7f\u7528\u5206\u9875\u5bf9\u8c61\nList<User> selectPage(@Param("query") UserQuery query, @Param("page") PageParam page);\n\n// \u274c \u907f\u514d\uff1a\u8fc7\u591a\u53c2\u6570\nUser select(String name, Integer age, String email, Integer status, Date startTime);\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u67e5\u8be2\u5bf9\u8c61\u8bbe\u8ba1",children:"\u67e5\u8be2\u5bf9\u8c61\u8bbe\u8ba1"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"@Data\npublic class UserQuery {\n    private String name;\n    private String email;\n    private Integer status;\n    private Integer minAge;\n    private Integer maxAge;\n    private Date startTime;\n    private Date endTime;\n    private List<Long> ids;\n    \n    // \u6392\u5e8f\n    private String orderBy;\n    private String orderDir;\n}\n\n@Data\npublic class PageParam {\n    private Integer pageNum = 1;\n    private Integer pageSize = 10;\n    \n    public Integer getOffset() {\n        return (pageNum - 1) * pageSize;\n    }\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"sql-\u7f16\u5199\u89c4\u8303",children:"SQL \u7f16\u5199\u89c4\u8303"}),"\n",(0,a.jsx)(n.h3,{id:"\u57fa\u672c\u89c4\u8303",children:"\u57fa\u672c\u89c4\u8303"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u2705 \u63a8\u8350\uff1a\u4f7f\u7528\u522b\u540d\uff0c\u5b57\u6bb5\u660e\u786e --\x3e\n<select id="selectById" resultType="User">\n    SELECT \n        u.id,\n        u.name,\n        u.email,\n        u.age,\n        u.create_time\n    FROM user u\n    WHERE u.id = #{id}\n</select>\n\n\x3c!-- \u274c \u907f\u514d\uff1aSELECT * --\x3e\n<select id="selectById" resultType="User">\n    SELECT * FROM user WHERE id = #{id}\n</select>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"sql-\u7247\u6bb5\u590d\u7528",children:"SQL \u7247\u6bb5\u590d\u7528"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u5b9a\u4e49\u901a\u7528\u5b57\u6bb5 --\x3e\n<sql id="baseColumns">\n    id, name, email, age, status, create_time, update_time\n</sql>\n\n\x3c!-- \u5b9a\u4e49\u901a\u7528\u6761\u4ef6 --\x3e\n<sql id="whereCondition">\n    <where>\n        <if test="name != null and name != \'\'">\n            AND name LIKE CONCAT(\'%\', #{name}, \'%\')\n        </if>\n        <if test="status != null">\n            AND status = #{status}\n        </if>\n        <if test="minAge != null">\n            AND age >= #{minAge}\n        </if>\n        <if test="maxAge != null">\n            AND age &lt;= #{maxAge}\n        </if>\n    </where>\n</sql>\n\n\x3c!-- \u590d\u7528 --\x3e\n<select id="selectByCondition" resultType="User">\n    SELECT <include refid="baseColumns"/>\n    FROM user\n    <include refid="whereCondition"/>\n    ORDER BY create_time DESC\n</select>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u9632\u6b62-sql-\u6ce8\u5165",children:"\u9632\u6b62 SQL \u6ce8\u5165"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u2705 \u4f7f\u7528 #{} \u9884\u7f16\u8bd1\u53c2\u6570 --\x3e\n<select id="selectByName" resultType="User">\n    SELECT * FROM user WHERE name = #{name}\n</select>\n\n\x3c!-- \u26a0\ufe0f ${} \u53ea\u7528\u4e8e\u8868\u540d\u3001\u5217\u540d\u7b49\uff0c\u9700\u8981\u767d\u540d\u5355\u6821\u9a8c --\x3e\n<select id="selectWithSort" resultType="User">\n    SELECT * FROM user\n    ORDER BY\n    <choose>\n        <when test="orderBy == \'name\'">name</when>\n        <when test="orderBy == \'age\'">age</when>\n        <otherwise>id</otherwise>\n    </choose>\n    <choose>\n        <when test="orderDir == \'asc\'">ASC</when>\n        <otherwise>DESC</otherwise>\n    </choose>\n</select>\n\n\x3c!-- \u274c \u5371\u9669\uff1a\u76f4\u63a5\u62fc\u63a5\u7528\u6237\u8f93\u5165 --\x3e\n<select id="selectByName" resultType="User">\n    SELECT * FROM user WHERE name = \'${name}\'\n</select>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u6279\u91cf\u64cd\u4f5c\u4f18\u5316",children:"\u6279\u91cf\u64cd\u4f5c\u4f18\u5316"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u2705 \u6279\u91cf\u63d2\u5165 --\x3e\n<insert id="batchInsert">\n    INSERT INTO user (name, email, age)\n    VALUES\n    <foreach collection="list" item="user" separator=",">\n        (#{user.name}, #{user.email}, #{user.age})\n    </foreach>\n</insert>\n\n\x3c!-- \u2705 \u6279\u91cf\u66f4\u65b0\uff08CASE WHEN\uff09 --\x3e\n<update id="batchUpdate">\n    UPDATE user\n    SET name = CASE id\n        <foreach collection="list" item="user">\n            WHEN #{user.id} THEN #{user.name}\n        </foreach>\n        END,\n        email = CASE id\n        <foreach collection="list" item="user">\n            WHEN #{user.id} THEN #{user.email}\n        </foreach>\n        END\n    WHERE id IN\n    <foreach collection="list" item="user" open="(" separator="," close=")">\n        #{user.id}\n    </foreach>\n</update>\n\n\x3c!-- \u26a0\ufe0f \u63a7\u5236\u6279\u91cf\u5927\u5c0f\uff0c\u907f\u514d SQL \u8fc7\u957f --\x3e\n'})}),"\n",(0,a.jsx)(n.h3,{id:"\u5206\u9875\u67e5\u8be2",children:"\u5206\u9875\u67e5\u8be2"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'\x3c!-- MySQL \u5206\u9875 --\x3e\n<select id="selectPage" resultType="User">\n    SELECT <include refid="baseColumns"/>\n    FROM user\n    <include refid="whereCondition"/>\n    ORDER BY create_time DESC\n    LIMIT #{page.offset}, #{page.pageSize}\n</select>\n\n\x3c!-- \u63a8\u8350\uff1a\u4f7f\u7528 PageHelper \u63d2\u4ef6 --\x3e\n'})}),"\n",(0,a.jsx)(n.h2,{id:"\u6027\u80fd\u4f18\u5316",children:"\u6027\u80fd\u4f18\u5316"}),"\n",(0,a.jsx)(n.h3,{id:"1-\u907f\u514d-n1-\u67e5\u8be2",children:"1. \u907f\u514d N+1 \u67e5\u8be2"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u274c N+1 \u95ee\u9898\uff1a\u5d4c\u5957\u67e5\u8be2 --\x3e\n<resultMap id="userWithOrders" type="User">\n    <id property="id" column="id"/>\n    <collection property="orders" column="id"\n                select="com.example.mapper.OrderMapper.selectByUserId"/>\n</resultMap>\n\n\x3c!-- \u2705 \u63a8\u8350\uff1a\u8054\u8868\u67e5\u8be2 --\x3e\n<resultMap id="userWithOrders" type="User">\n    <id property="id" column="id"/>\n    <result property="name" column="name"/>\n    <collection property="orders" ofType="Order">\n        <id property="id" column="order_id"/>\n        <result property="orderNo" column="order_no"/>\n    </collection>\n</resultMap>\n\n<select id="selectWithOrders" resultMap="userWithOrders">\n    SELECT u.id, u.name, o.id as order_id, o.order_no\n    FROM user u\n    LEFT JOIN orders o ON u.id = o.user_id\n    WHERE u.id = #{id}\n</select>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"2-\u5408\u7406\u4f7f\u7528\u7f13\u5b58",children:"2. \u5408\u7406\u4f7f\u7528\u7f13\u5b58"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u9002\u5408\u7f13\u5b58\uff1a\u67e5\u8be2\u9891\u7e41\u3001\u6570\u636e\u53d8\u5316\u5c11 --\x3e\n<cache eviction="LRU" flushInterval="300000" size="1024"/>\n\n\x3c!-- \u4e0d\u9002\u5408\u7f13\u5b58\u7684\u67e5\u8be2 --\x3e\n<select id="selectRealtime" useCache="false" flushCache="true">\n    SELECT balance FROM account WHERE id = #{id}\n</select>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"3-\u5ef6\u8fdf\u52a0\u8f7d",children:"3. \u5ef6\u8fdf\u52a0\u8f7d"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u5168\u5c40\u914d\u7f6e --\x3e\n<settings>\n    <setting name="lazyLoadingEnabled" value="true"/>\n    <setting name="aggressiveLazyLoading" value="false"/>\n</settings>\n\n\x3c!-- \u5355\u72ec\u914d\u7f6e --\x3e\n<association property="user" fetchType="lazy" .../>\n<collection property="orders" fetchType="lazy" .../>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"4-\u6279\u91cf\u6267\u884c",children:"4. \u6279\u91cf\u6267\u884c"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"// \u4f7f\u7528 BATCH \u6267\u884c\u5668\ntry (SqlSession session = sqlSessionFactory.openSession(ExecutorType.BATCH)) {\n    UserMapper mapper = session.getMapper(UserMapper.class);\n    \n    for (int i = 0; i < users.size(); i++) {\n        mapper.insert(users.get(i));\n        \n        // \u6bcf 500 \u6761\u5237\u65b0\u4e00\u6b21\n        if (i % 500 == 0) {\n            session.flushStatements();\n        }\n    }\n    \n    session.flushStatements();\n    session.commit();\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"5-\u6d41\u5f0f\u67e5\u8be2",children:"5. \u6d41\u5f0f\u67e5\u8be2"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:'// \u5927\u6570\u636e\u91cf\u67e5\u8be2\uff0c\u907f\u514d\u5185\u5b58\u6ea2\u51fa\n@Select("SELECT * FROM user")\n@Options(resultSetType = ResultSetType.FORWARD_ONLY, fetchSize = 1000)\nvoid selectLargeData(ResultHandler<User> handler);\n\n// \u4f7f\u7528\nuserMapper.selectLargeData(context -> {\n    User user = context.getResultObject();\n    // \u5904\u7406\u6bcf\u6761\u8bb0\u5f55\n    processUser(user);\n});\n'})}),"\n",(0,a.jsx)(n.h3,{id:"6-\u7d22\u5f15\u4f18\u5316",children:"6. \u7d22\u5f15\u4f18\u5316"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sql",children:"-- \u4e3a\u5e38\u7528\u67e5\u8be2\u6761\u4ef6\u521b\u5efa\u7d22\u5f15\nCREATE INDEX idx_user_name ON user(name);\nCREATE INDEX idx_user_status_create_time ON user(status, create_time);\n\n-- \u907f\u514d\u7d22\u5f15\u5931\u6548\n-- \u274c \u51fd\u6570\u64cd\u4f5c\nWHERE DATE(create_time) = '2024-01-01'\n-- \u2705 \u8303\u56f4\u67e5\u8be2\nWHERE create_time >= '2024-01-01' AND create_time < '2024-01-02'\n\n-- \u274c \u524d\u7f00\u6a21\u7cca\nWHERE name LIKE '%\u5f20'\n-- \u2705 \u540e\u7f00\u6a21\u7cca\nWHERE name LIKE '\u5f20%'\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u9879\u76ee\u7ed3\u6784\u5efa\u8bae",children:"\u9879\u76ee\u7ed3\u6784\u5efa\u8bae"}),"\n",(0,a.jsx)(n.h3,{id:"\u6807\u51c6\u9879\u76ee\u7ed3\u6784",children:"\u6807\u51c6\u9879\u76ee\u7ed3\u6784"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"src/main/java\n\u251c\u2500\u2500 com.example\n\u2502   \u251c\u2500\u2500 config\n\u2502   \u2502   \u2514\u2500\u2500 MyBatisConfig.java\n\u2502   \u251c\u2500\u2500 entity\n\u2502   \u2502   \u251c\u2500\u2500 User.java\n\u2502   \u2502   \u2514\u2500\u2500 Order.java\n\u2502   \u251c\u2500\u2500 mapper\n\u2502   \u2502   \u251c\u2500\u2500 UserMapper.java\n\u2502   \u2502   \u2514\u2500\u2500 OrderMapper.java\n\u2502   \u251c\u2500\u2500 service\n\u2502   \u2502   \u251c\u2500\u2500 UserService.java\n\u2502   \u2502   \u2514\u2500\u2500 impl\n\u2502   \u2502       \u2514\u2500\u2500 UserServiceImpl.java\n\u2502   \u251c\u2500\u2500 controller\n\u2502   \u2502   \u2514\u2500\u2500 UserController.java\n\u2502   \u2514\u2500\u2500 dto\n\u2502       \u251c\u2500\u2500 UserQuery.java\n\u2502       \u2514\u2500\u2500 UserDTO.java\n\u2502\nsrc/main/resources\n\u251c\u2500\u2500 application.yml\n\u251c\u2500\u2500 mapper\n\u2502   \u251c\u2500\u2500 UserMapper.xml\n\u2502   \u2514\u2500\u2500 OrderMapper.xml\n\u2514\u2500\u2500 mybatis-config.xml (\u53ef\u9009)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u591a\u6a21\u5757\u9879\u76ee\u7ed3\u6784",children:"\u591a\u6a21\u5757\u9879\u76ee\u7ed3\u6784"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"project\n\u251c\u2500\u2500 project-common          # \u516c\u5171\u6a21\u5757\n\u2502   \u2514\u2500\u2500 src/main/java\n\u2502       \u2514\u2500\u2500 com.example.common\n\u2502           \u251c\u2500\u2500 entity      # \u5b9e\u4f53\u7c7b\n\u2502           \u2514\u2500\u2500 dto         # \u6570\u636e\u4f20\u8f93\u5bf9\u8c61\n\u2502\n\u251c\u2500\u2500 project-dao             # \u6570\u636e\u8bbf\u95ee\u6a21\u5757\n\u2502   \u2514\u2500\u2500 src/main\n\u2502       \u251c\u2500\u2500 java\n\u2502       \u2502   \u2514\u2500\u2500 com.example.dao\n\u2502       \u2502       \u2514\u2500\u2500 mapper  # Mapper \u63a5\u53e3\n\u2502       \u2514\u2500\u2500 resources\n\u2502           \u2514\u2500\u2500 mapper      # Mapper XML\n\u2502\n\u251c\u2500\u2500 project-service         # \u4e1a\u52a1\u903b\u8f91\u6a21\u5757\n\u2502   \u2514\u2500\u2500 src/main/java\n\u2502       \u2514\u2500\u2500 com.example.service\n\u2502\n\u2514\u2500\u2500 project-web             # Web \u6a21\u5757\n    \u2514\u2500\u2500 src/main/java\n        \u2514\u2500\u2500 com.example.web\n            \u2514\u2500\u2500 controller\n"})}),"\n",(0,a.jsx)(n.h3,{id:"mapper-xml-\u4e0e\u63a5\u53e3\u540c\u5305",children:"Mapper XML \u4e0e\u63a5\u53e3\u540c\u5305"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"src/main\n\u251c\u2500\u2500 java\n\u2502   \u2514\u2500\u2500 com.example.mapper\n\u2502       \u2514\u2500\u2500 UserMapper.java\n\u2514\u2500\u2500 resources\n    \u2514\u2500\u2500 com/example/mapper    # \u4e0e\u63a5\u53e3\u540c\u5305\u8def\u5f84\n        \u2514\u2500\u2500 UserMapper.xml\n"})}),"\n",(0,a.jsx)(n.p,{children:"\u914d\u7f6e\uff1a"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"mybatis:\n  mapper-locations: classpath*:com/example/mapper/*.xml\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u5e38\u89c1\u95ee\u9898\u5904\u7406",children:"\u5e38\u89c1\u95ee\u9898\u5904\u7406"}),"\n",(0,a.jsx)(n.h3,{id:"1-\u9a7c\u5cf0\u547d\u540d\u6620\u5c04",children:"1. \u9a7c\u5cf0\u547d\u540d\u6620\u5c04"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-yaml",children:"mybatis:\n  configuration:\n    map-underscore-to-camel-case: true\n"})}),"\n",(0,a.jsx)(n.h3,{id:"2-\u7a7a\u503c\u5904\u7406",children:"2. \u7a7a\u503c\u5904\u7406"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-xml",children:'\x3c!-- \u63d2\u5165\u65f6\u5904\u7406 null --\x3e\n<insert id="insert">\n    INSERT INTO user (name, email)\n    VALUES (#{name, jdbcType=VARCHAR}, #{email, jdbcType=VARCHAR})\n</insert>\n\n\x3c!-- \u914d\u7f6e\u7a7a\u503c\u8c03\u7528 setter --\x3e\n<settings>\n    <setting name="callSettersOnNulls" value="true"/>\n</settings>\n'})}),"\n",(0,a.jsx)(n.h3,{id:"3-\u679a\u4e3e\u5904\u7406",children:"3. \u679a\u4e3e\u5904\u7406"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"// \u65b9\u5f0f\u4e00\uff1a\u4f7f\u7528\u679a\u4e3e\u540d\u79f0\npublic enum Status {\n    ACTIVE, INACTIVE\n}\n\n// \u65b9\u5f0f\u4e8c\uff1a\u4f7f\u7528\u679a\u4e3e\u503c\npublic enum Status {\n    ACTIVE(1), INACTIVE(0);\n    \n    private final int value;\n    \n    @EnumValue  // MyBatis-Plus\n    public int getValue() {\n        return value;\n    }\n}\n\n// \u81ea\u5b9a\u4e49\u7c7b\u578b\u5904\u7406\u5668\n@MappedTypes(Status.class)\npublic class StatusTypeHandler extends BaseTypeHandler<Status> {\n    // ...\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"4-\u65e5\u671f\u5904\u7406",children:"4. \u65e5\u671f\u5904\u7406"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"// \u4f7f\u7528 Java 8 \u65e5\u671f\u7c7b\u578b\nprivate LocalDateTime createTime;\nprivate LocalDate birthDate;\n\n// MyBatis 3.4.5+ \u81ea\u52a8\u652f\u6301\n"})}),"\n",(0,a.jsx)(n.h3,{id:"5-json-\u5b57\u6bb5\u5904\u7406",children:"5. JSON \u5b57\u6bb5\u5904\u7406"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-java",children:"// \u81ea\u5b9a\u4e49\u7c7b\u578b\u5904\u7406\u5668\n@MappedTypes(JsonObject.class)\npublic class JsonTypeHandler extends BaseTypeHandler<JsonObject> {\n    private final ObjectMapper mapper = new ObjectMapper();\n    \n    @Override\n    public void setNonNullParameter(PreparedStatement ps, int i, \n            JsonObject parameter, JdbcType jdbcType) throws SQLException {\n        ps.setString(i, mapper.writeValueAsString(parameter));\n    }\n    \n    @Override\n    public JsonObject getNullableResult(ResultSet rs, String columnName) \n            throws SQLException {\n        String json = rs.getString(columnName);\n        return json == null ? null : mapper.readValue(json, JsonObject.class);\n    }\n    // ...\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"\u4ee3\u7801\u89c4\u8303\u68c0\u67e5\u6e05\u5355",children:"\u4ee3\u7801\u89c4\u8303\u68c0\u67e5\u6e05\u5355"}),"\n",(0,a.jsx)(n.h3,{id:"mapper-\u63a5\u53e3",children:"Mapper \u63a5\u53e3"}),"\n",(0,a.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u4f7f\u7528 ",(0,a.jsx)(n.code,{children:"@Mapper"})," \u6216 ",(0,a.jsx)(n.code,{children:"@MapperScan"})," \u6ce8\u89e3"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u65b9\u6cd5\u547d\u540d\u6e05\u6670\uff0c\u9075\u5faa\u547d\u540d\u89c4\u8303"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u591a\u53c2\u6570\u4f7f\u7528 ",(0,a.jsx)(n.code,{children:"@Param"})," \u6ce8\u89e3"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u590d\u6742\u67e5\u8be2\u4f7f\u7528\u67e5\u8be2\u5bf9\u8c61"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"mapper-xml",children:"Mapper XML"}),"\n",(0,a.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," namespace \u4e0e\u63a5\u53e3\u5168\u9650\u5b9a\u540d\u4e00\u81f4"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u907f\u514d\u4f7f\u7528 ",(0,a.jsx)(n.code,{children:"SELECT *"})]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u4f7f\u7528 ",(0,a.jsx)(n.code,{children:"#{}"})," \u9632\u6b62 SQL \u6ce8\u5165"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u590d\u7528 SQL \u7247\u6bb5"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u52a8\u6001 SQL \u6761\u4ef6\u5b8c\u6574"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"\u6027\u80fd",children:"\u6027\u80fd"}),"\n",(0,a.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u907f\u514d N+1 \u67e5\u8be2"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u5408\u7406\u4f7f\u7528\u7f13\u5b58"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u6279\u91cf\u64cd\u4f5c\u63a7\u5236\u5927\u5c0f"]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u5927\u6570\u636e\u91cf\u4f7f\u7528\u6d41\u5f0f\u67e5\u8be2"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"\u4e8b\u52a1",children:"\u4e8b\u52a1"}),"\n",(0,a.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," Service \u5c42\u4f7f\u7528 ",(0,a.jsx)(n.code,{children:"@Transactional"})]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u53ea\u8bfb\u64cd\u4f5c\u4f7f\u7528 ",(0,a.jsx)(n.code,{children:"readOnly = true"})]}),"\n",(0,a.jsxs)(n.li,{className:"task-list-item",children:[(0,a.jsx)(n.input,{type:"checkbox",disabled:!0})," \u6307\u5b9a\u56de\u6eda\u5f02\u5e38\u7c7b\u578b"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"\u76f8\u5173\u94fe\u63a5",children:"\u76f8\u5173\u94fe\u63a5"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"/docs/mybatis/configuration",children:"\u914d\u7f6e\u8be6\u89e3"})," - MyBatis \u914d\u7f6e"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"/docs/mybatis/dynamic-sql",children:"\u52a8\u6001 SQL"})," - \u52a8\u6001 SQL \u7f16\u5199"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"/docs/mybatis/caching",children:"\u7f13\u5b58\u673a\u5236"})," - \u7f13\u5b58\u4f18\u5316"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.a,{href:"/docs/mybatis/spring-integration",children:"Spring \u96c6\u6210"})," - Spring \u96c6\u6210"]}),"\n"]}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.strong,{children:"\u6700\u540e\u66f4\u65b0"}),": 2025 \u5e74 12 \u6708"]})]})}function o(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},48885:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>t});var i=s(99378);const a={},r=i.createContext(a);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);