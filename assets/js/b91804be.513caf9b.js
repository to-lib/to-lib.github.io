"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[17292],{48885:(n,e,s)=>{s.d(e,{R:()=>l,x:()=>d});var i=s(99378);const t={},r=i.createContext(t);function l(n){const e=i.useContext(r);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:l(n.components),i.createElement(r.Provider,{value:e},n.children)}},93421:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"ml/ensemble-learning","title":"\ud83c\udfad \u96c6\u6210\u5b66\u4e60","description":"\u96c6\u6210\u5b66\u4e60\u901a\u8fc7\u7ec4\u5408\u591a\u4e2a\u6a21\u578b\u6765\u83b7\u5f97\u6bd4\u5355\u4e2a\u6a21\u578b\u66f4\u597d\u7684\u9884\u6d4b\u6027\u80fd\u3002","source":"@site/docs/ml/ensemble-learning.md","sourceDirName":"ml","slug":"/ml/ensemble-learning","permalink":"/docs/ml/ensemble-learning","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/ensemble-learning.md","tags":[],"version":"current","sidebarPosition":14,"frontMatter":{"sidebar_position":14,"title":"\ud83c\udfad \u96c6\u6210\u5b66\u4e60"},"sidebar":"ml","previous":{"title":"\ud83d\udd0d \u65e0\u76d1\u7763\u5b66\u4e60","permalink":"/docs/ml/unsupervised-learning"},"next":{"title":"\ud83d\udcca \u8d1d\u53f6\u65af\u65b9\u6cd5","permalink":"/docs/ml/bayesian-methods"}}');var t=s(22714),r=s(48885);const l={sidebar_position:14,title:"\ud83c\udfad \u96c6\u6210\u5b66\u4e60"},d="\u96c6\u6210\u5b66\u4e60",a={},o=[{value:"\u6838\u5fc3\u601d\u60f3",id:"\u6838\u5fc3\u601d\u60f3",level:2},{value:"Bagging (Bootstrap Aggregating)",id:"bagging-bootstrap-aggregating",level:2},{value:"\u6838\u5fc3\u539f\u7406",id:"\u6838\u5fc3\u539f\u7406",level:3},{value:"\u968f\u673a\u68ee\u6797",id:"\u968f\u673a\u68ee\u6797",level:3},{value:"Boosting",id:"boosting",level:2},{value:"AdaBoost",id:"adaboost",level:3},{value:"Gradient Boosting",id:"gradient-boosting",level:3},{value:"XGBoost",id:"xgboost",level:3},{value:"LightGBM",id:"lightgbm",level:3},{value:"CatBoost",id:"catboost",level:3},{value:"Bagging vs Boosting",id:"bagging-vs-boosting",level:2},{value:"Stacking",id:"stacking",level:2},{value:"\u7b97\u6cd5\u9009\u62e9",id:"\u7b97\u6cd5\u9009\u62e9",level:2}];function c(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"\u96c6\u6210\u5b66\u4e60",children:"\u96c6\u6210\u5b66\u4e60"})}),"\n",(0,t.jsx)(e.p,{children:"\u96c6\u6210\u5b66\u4e60\u901a\u8fc7\u7ec4\u5408\u591a\u4e2a\u6a21\u578b\u6765\u83b7\u5f97\u6bd4\u5355\u4e2a\u6a21\u578b\u66f4\u597d\u7684\u9884\u6d4b\u6027\u80fd\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"\u6838\u5fc3\u601d\u60f3",children:"\u6838\u5fc3\u601d\u60f3"}),"\n",(0,t.jsxs)(e.blockquote,{children:["\n",(0,t.jsx)(e.p,{children:"\u4e09\u4e2a\u81ed\u76ae\u5320\uff0c\u9876\u4e2a\u8bf8\u845b\u4eae"}),"\n"]}),"\n",(0,t.jsx)(e.mermaid,{value:"graph LR\n    A[\u8bad\u7ec3\u6570\u636e] --\x3e B[\u6a21\u578b1]\n    A --\x3e C[\u6a21\u578b2]\n    A --\x3e D[\u6a21\u578b3]\n    B --\x3e E[\u7ec4\u5408\u7b56\u7565]\n    C --\x3e E\n    D --\x3e E\n    E --\x3e F[\u6700\u7ec8\u9884\u6d4b]"}),"\n",(0,t.jsx)(e.h2,{id:"bagging-bootstrap-aggregating",children:"Bagging (Bootstrap Aggregating)"}),"\n",(0,t.jsxs)(e.p,{children:["\u901a\u8fc7",(0,t.jsx)(e.strong,{children:"\u81ea\u52a9\u91c7\u6837"}),"\u6784\u5efa\u591a\u4e2a\u72ec\u7acb\u6a21\u578b\uff0c\u7136\u540e\u5e73\u5747/\u6295\u7968\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u6838\u5fc3\u539f\u7406",children:"\u6838\u5fc3\u539f\u7406"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"\u4ece\u8bad\u7ec3\u96c6\u4e2d\u6709\u653e\u56de\u5730\u91c7\u6837 N \u4e2a\u5b50\u96c6"}),"\n",(0,t.jsx)(e.li,{children:"\u5728\u6bcf\u4e2a\u5b50\u96c6\u4e0a\u8bad\u7ec3\u4e00\u4e2a\u57fa\u6a21\u578b"}),"\n",(0,t.jsx)(e.li,{children:"\u9884\u6d4b\u65f6\u53d6\u5e73\u5747\uff08\u56de\u5f52\uff09\u6216\u6295\u7968\uff08\u5206\u7c7b\uff09"}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from sklearn.ensemble import BaggingClassifier, RandomForestClassifier\n\n# \u624b\u52a8 Bagging\nbagging = BaggingClassifier(\n    estimator=DecisionTreeClassifier(),\n    n_estimators=100,\n    max_samples=0.8,    # \u6bcf\u6b21\u91c7\u6837 80%\n    bootstrap=True,      # \u6709\u653e\u56de\u91c7\u6837\n    n_jobs=-1\n)\nbagging.fit(X_train, y_train)\n\n# \u968f\u673a\u68ee\u6797 = Bagging + \u7279\u5f81\u968f\u673a\nrf = RandomForestClassifier(n_estimators=100, max_features='sqrt')\nrf.fit(X_train, y_train)\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u968f\u673a\u68ee\u6797",children:"\u968f\u673a\u68ee\u6797"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"\u53c2\u6570"}),(0,t.jsx)(e.th,{children:"\u63cf\u8ff0"}),(0,t.jsx)(e.th,{children:"\u5efa\u8bae"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"n_estimators"}),(0,t.jsx)(e.td,{children:"\u6811\u7684\u6570\u91cf"}),(0,t.jsx)(e.td,{children:"100-500"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"max_depth"}),(0,t.jsx)(e.td,{children:"\u6811\u7684\u6700\u5927\u6df1\u5ea6"}),(0,t.jsx)(e.td,{children:"None \u6216 10-30"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"max_features"}),(0,t.jsx)(e.td,{children:"\u6bcf\u6b21\u5206\u88c2\u7684\u7279\u5f81\u6570"}),(0,t.jsx)(e.td,{children:"sqrt (\u5206\u7c7b), 1/3 (\u56de\u5f52)"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"min_samples_leaf"}),(0,t.jsx)(e.td,{children:"\u53f6\u8282\u70b9\u6700\u5c0f\u6837\u672c"}),(0,t.jsx)(e.td,{children:"1-5"})]})]})]}),"\n",(0,t.jsx)(e.h2,{id:"boosting",children:"Boosting"}),"\n",(0,t.jsxs)(e.p,{children:["\u4e32\u884c\u8bad\u7ec3\u6a21\u578b\uff0c\u6bcf\u4e2a\u65b0\u6a21\u578b",(0,t.jsx)(e.strong,{children:"\u4e13\u6ce8\u4e8e\u4e4b\u524d\u6a21\u578b\u7684\u9519\u8bef"}),"\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"adaboost",children:"AdaBoost"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from sklearn.ensemble import AdaBoostClassifier\n\nada = AdaBoostClassifier(\n    estimator=DecisionTreeClassifier(max_depth=1),  # \u5f31\u5206\u7c7b\u5668\n    n_estimators=50,\n    learning_rate=1.0\n)\nada.fit(X_train, y_train)\n"})}),"\n",(0,t.jsx)(e.h3,{id:"gradient-boosting",children:"Gradient Boosting"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from sklearn.ensemble import GradientBoostingClassifier\n\ngb = GradientBoostingClassifier(\n    n_estimators=100,\n    learning_rate=0.1,\n    max_depth=3,\n    subsample=0.8\n)\ngb.fit(X_train, y_train)\n"})}),"\n",(0,t.jsx)(e.h3,{id:"xgboost",children:"XGBoost"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import xgboost as xgb\n\nxgb_model = xgb.XGBClassifier(\n    n_estimators=100,\n    learning_rate=0.1,\n    max_depth=6,\n    subsample=0.8,\n    colsample_bytree=0.8,\n    reg_alpha=0.1,      # L1 \u6b63\u5219\u5316\n    reg_lambda=1.0,     # L2 \u6b63\u5219\u5316\n    use_label_encoder=False,\n    eval_metric='logloss'\n)\n\n# \u5e26\u65e9\u505c\u7684\u8bad\u7ec3\nxgb_model.fit(\n    X_train, y_train,\n    eval_set=[(X_val, y_val)],\n    early_stopping_rounds=10,\n    verbose=False\n)\n"})}),"\n",(0,t.jsx)(e.h3,{id:"lightgbm",children:"LightGBM"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import lightgbm as lgb\n\nlgb_model = lgb.LGBMClassifier(\n    n_estimators=100,\n    learning_rate=0.1,\n    max_depth=-1,\n    num_leaves=31,\n    subsample=0.8,\n    colsample_bytree=0.8\n)\nlgb_model.fit(X_train, y_train)\n"})}),"\n",(0,t.jsx)(e.h3,{id:"catboost",children:"CatBoost"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from catboost import CatBoostClassifier\n\ncat_model = CatBoostClassifier(\n    iterations=100,\n    learning_rate=0.1,\n    depth=6,\n    cat_features=categorical_indices,  # \u81ea\u52a8\u5904\u7406\u5206\u7c7b\u7279\u5f81\n    verbose=False\n)\ncat_model.fit(X_train, y_train)\n"})}),"\n",(0,t.jsx)(e.h2,{id:"bagging-vs-boosting",children:"Bagging vs Boosting"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"\u7279\u6027"}),(0,t.jsx)(e.th,{children:"Bagging"}),(0,t.jsx)(e.th,{children:"Boosting"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u8bad\u7ec3\u65b9\u5f0f"}),(0,t.jsx)(e.td,{children:"\u5e76\u884c"}),(0,t.jsx)(e.td,{children:"\u4e32\u884c"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u76ee\u6807"}),(0,t.jsx)(e.td,{children:"\u964d\u4f4e\u65b9\u5dee"}),(0,t.jsx)(e.td,{children:"\u964d\u4f4e\u504f\u5dee"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u57fa\u6a21\u578b"}),(0,t.jsx)(e.td,{children:"\u590d\u6742\u6a21\u578b"}),(0,t.jsx)(e.td,{children:"\u7b80\u5355\u6a21\u578b"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u6570\u636e\u91c7\u6837"}),(0,t.jsx)(e.td,{children:"\u6709\u653e\u56de"}),(0,t.jsx)(e.td,{children:"\u52a0\u6743"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u8fc7\u62df\u5408\u98ce\u9669"}),(0,t.jsx)(e.td,{children:"\u4f4e"}),(0,t.jsx)(e.td,{children:"\u8f83\u9ad8"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u4ee3\u8868\u7b97\u6cd5"}),(0,t.jsx)(e.td,{children:"\u968f\u673a\u68ee\u6797"}),(0,t.jsx)(e.td,{children:"XGBoost, LightGBM"})]})]})]}),"\n",(0,t.jsx)(e.h2,{id:"stacking",children:"Stacking"}),"\n",(0,t.jsx)(e.p,{children:"\u7528\u4e00\u4e2a\u5143\u6a21\u578b\u6765\u7ec4\u5408\u591a\u4e2a\u57fa\u6a21\u578b\u7684\u9884\u6d4b\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"from sklearn.ensemble import StackingClassifier\n\nstacking = StackingClassifier(\n    estimators=[\n        ('rf', RandomForestClassifier(n_estimators=100)),\n        ('xgb', xgb.XGBClassifier(n_estimators=100)),\n        ('lgb', lgb.LGBMClassifier(n_estimators=100))\n    ],\n    final_estimator=LogisticRegression(),\n    cv=5\n)\nstacking.fit(X_train, y_train)\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u7b97\u6cd5\u9009\u62e9",children:"\u7b97\u6cd5\u9009\u62e9"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{children:"\u573a\u666f"}),(0,t.jsx)(e.th,{children:"\u63a8\u8350"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u8868\u683c\u6570\u636e\u7ade\u8d5b"}),(0,t.jsx)(e.td,{children:"XGBoost / LightGBM"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u5927\u89c4\u6a21\u6570\u636e"}),(0,t.jsx)(e.td,{children:"LightGBM"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u6709\u5206\u7c7b\u7279\u5f81"}),(0,t.jsx)(e.td,{children:"CatBoost"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u9700\u8981\u89e3\u91ca\u6027"}),(0,t.jsx)(e.td,{children:"\u968f\u673a\u68ee\u6797"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{children:"\u5feb\u901f\u57fa\u7ebf"}),(0,t.jsx)(e.td,{children:"\u968f\u673a\u68ee\u6797"})]})]})]})]})}function h(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}}}]);