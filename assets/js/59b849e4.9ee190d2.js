"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[3761],{18216:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>a,contentTitle:()=>l,default:()=>o,frontMatter:()=>d,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"ml/transfer-learning","title":"\ud83d\udd04 \u8fc1\u79fb\u5b66\u4e60","description":"\u8fc1\u79fb\u5b66\u4e60\u5c06\u4ece\u6e90\u4efb\u52a1\u5b66\u5230\u7684\u77e5\u8bc6\u5e94\u7528\u5230\u76ee\u6807\u4efb\u52a1\u3002","source":"@site/docs/ml/transfer-learning.md","sourceDirName":"ml","slug":"/ml/transfer-learning","permalink":"/docs/ml/transfer-learning","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/transfer-learning.md","tags":[],"version":"current","sidebarPosition":45,"frontMatter":{"sidebar_position":45,"title":"\ud83d\udd04 \u8fc1\u79fb\u5b66\u4e60"},"sidebar":"ml","previous":{"title":"\ud83c\udfe5 \u9886\u57df\u7279\u5b9a ML","permalink":"/docs/ml/domain-specific-ml"},"next":{"title":"\ud83c\udf10 \u9886\u57df\u81ea\u9002\u5e94","permalink":"/docs/ml/domain-adaptation"}}');var s=r(22714),t=r(48885);const d={sidebar_position:45,title:"\ud83d\udd04 \u8fc1\u79fb\u5b66\u4e60"},l="\u8fc1\u79fb\u5b66\u4e60",a={},c=[{value:"\u6838\u5fc3\u6982\u5ff5",id:"\u6838\u5fc3\u6982\u5ff5",level:2},{value:"\u8fc1\u79fb\u7b56\u7565",id:"\u8fc1\u79fb\u7b56\u7565",level:2},{value:"\u7279\u5f81\u63d0\u53d6",id:"\u7279\u5f81\u63d0\u53d6",level:3},{value:"\u5fae\u8c03",id:"\u5fae\u8c03",level:3},{value:"\u6e10\u8fdb\u5f0f\u89e3\u51bb",id:"\u6e10\u8fdb\u5f0f\u89e3\u51bb",level:3},{value:"Hugging Face \u8fc1\u79fb\u5b66\u4e60",id:"hugging-face-\u8fc1\u79fb\u5b66\u4e60",level:2},{value:"\u8fc1\u79fb\u5b66\u4e60\u7c7b\u578b",id:"\u8fc1\u79fb\u5b66\u4e60\u7c7b\u578b",level:2},{value:"\u4f55\u65f6\u4f7f\u7528",id:"\u4f55\u65f6\u4f7f\u7528",level:2}];function h(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",mermaid:"mermaid",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"\u8fc1\u79fb\u5b66\u4e60",children:"\u8fc1\u79fb\u5b66\u4e60"})}),"\n",(0,s.jsx)(e.p,{children:"\u8fc1\u79fb\u5b66\u4e60\u5c06\u4ece\u6e90\u4efb\u52a1\u5b66\u5230\u7684\u77e5\u8bc6\u5e94\u7528\u5230\u76ee\u6807\u4efb\u52a1\u3002"}),"\n",(0,s.jsx)(e.h2,{id:"\u6838\u5fc3\u6982\u5ff5",children:"\u6838\u5fc3\u6982\u5ff5"}),"\n",(0,s.jsx)(e.mermaid,{value:"graph LR\n    A[\u6e90\u57df] --\x3e B[\u9884\u8bad\u7ec3\u6a21\u578b]\n    B --\x3e C[\u8fc1\u79fb]\n    C --\x3e D[\u76ee\u6807\u57df]\n    D --\x3e E[\u5fae\u8c03]"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u672f\u8bed"}),(0,s.jsx)(e.th,{children:"\u63cf\u8ff0"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u6e90\u57df"}),(0,s.jsx)(e.td,{children:"\u6709\u5927\u91cf\u6807\u6ce8\u6570\u636e\u7684\u9886\u57df"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u76ee\u6807\u57df"}),(0,s.jsx)(e.td,{children:"\u6570\u636e\u8f83\u5c11\u7684\u76ee\u6807\u9886\u57df"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u57df\u504f\u79fb"}),(0,s.jsx)(e.td,{children:"\u6e90\u57df\u548c\u76ee\u6807\u57df\u5206\u5e03\u4e0d\u540c"})]})]})]}),"\n",(0,s.jsx)(e.h2,{id:"\u8fc1\u79fb\u7b56\u7565",children:"\u8fc1\u79fb\u7b56\u7565"}),"\n",(0,s.jsx)(e.h3,{id:"\u7279\u5f81\u63d0\u53d6",children:"\u7279\u5f81\u63d0\u53d6"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import torch\nimport torchvision.models as models\n\n# \u52a0\u8f7d\u9884\u8bad\u7ec3\u6a21\u578b\nmodel = models.resnet50(pretrained=True)\n\n# \u51bb\u7ed3\u6240\u6709\u5c42\nfor param in model.parameters():\n    param.requires_grad = False\n\n# \u66ff\u6362\u5206\u7c7b\u5934\nmodel.fc = torch.nn.Linear(model.fc.in_features, num_classes)\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u5fae\u8c03",children:"\u5fae\u8c03"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"# \u90e8\u5206\u5fae\u8c03 - \u89e3\u51bb\u540e\u51e0\u5c42\nfor name, param in model.named_parameters():\n    if 'layer4' in name or 'fc' in name:\n        param.requires_grad = True\n    else:\n        param.requires_grad = False\n\n# \u4f7f\u7528\u4e0d\u540c\u5b66\u4e60\u7387\noptimizer = torch.optim.Adam([\n    {'params': model.fc.parameters(), 'lr': 1e-3},\n    {'params': model.layer4.parameters(), 'lr': 1e-4}\n])\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u6e10\u8fdb\u5f0f\u89e3\u51bb",children:"\u6e10\u8fdb\u5f0f\u89e3\u51bb"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"def progressive_unfreeze(model, epoch):\n    layers = ['layer4', 'layer3', 'layer2', 'layer1']\n    if epoch < len(layers):\n        layer_name = layers[epoch]\n        for name, param in model.named_parameters():\n            if layer_name in name:\n                param.requires_grad = True\n"})}),"\n",(0,s.jsx)(e.h2,{id:"hugging-face-\u8fc1\u79fb\u5b66\u4e60",children:"Hugging Face \u8fc1\u79fb\u5b66\u4e60"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"from transformers import AutoModelForSequenceClassification, Trainer\n\n# \u52a0\u8f7d\u9884\u8bad\u7ec3\u6a21\u578b\nmodel = AutoModelForSequenceClassification.from_pretrained(\n    'bert-base-uncased',\n    num_labels=2\n)\n\n# \u5fae\u8c03\ntrainer = Trainer(\n    model=model,\n    train_dataset=train_dataset,\n    eval_dataset=eval_dataset\n)\ntrainer.train()\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u8fc1\u79fb\u5b66\u4e60\u7c7b\u578b",children:"\u8fc1\u79fb\u5b66\u4e60\u7c7b\u578b"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,s.jsx)(e.th,{children:"\u6761\u4ef6"}),(0,s.jsx)(e.th,{children:"\u65b9\u6cd5"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u5f52\u7eb3\u8fc1\u79fb"}),(0,s.jsx)(e.td,{children:"\u76f8\u540c\u4efb\u52a1\uff0c\u4e0d\u540c\u57df"}),(0,s.jsx)(e.td,{children:"\u5fae\u8c03"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u76f4\u63a8\u8fc1\u79fb"}),(0,s.jsx)(e.td,{children:"\u6e90\u57df\u6709\u6807\u7b7e\uff0c\u76ee\u6807\u57df\u65e0\u6807\u7b7e"}),(0,s.jsx)(e.td,{children:"\u57df\u81ea\u9002\u5e94"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u65e0\u76d1\u7763\u8fc1\u79fb"}),(0,s.jsx)(e.td,{children:"\u4e24\u8fb9\u90fd\u65e0\u6807\u7b7e"}),(0,s.jsx)(e.td,{children:"\u81ea\u76d1\u7763\u9884\u8bad\u7ec3"})]})]})]}),"\n",(0,s.jsx)(e.h2,{id:"\u4f55\u65f6\u4f7f\u7528",children:"\u4f55\u65f6\u4f7f\u7528"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u573a\u666f"}),(0,s.jsx)(e.th,{children:"\u5efa\u8bae"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u76ee\u6807\u6570\u636e < 1000"}),(0,s.jsx)(e.td,{children:"\u7279\u5f81\u63d0\u53d6"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u76ee\u6807\u6570\u636e 1000-10000"}),(0,s.jsx)(e.td,{children:"\u5fae\u8c03\u9876\u5c42"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u76ee\u6807\u6570\u636e > 10000"}),(0,s.jsx)(e.td,{children:"\u5168\u91cf\u5fae\u8c03"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u57df\u5dee\u5f02\u5927"}),(0,s.jsx)(e.td,{children:"\u53ef\u80fd\u9700\u91cd\u65b0\u8bad\u7ec3"})]})]})]})]})}function o(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(h,{...n})}):h(n)}},48885:(n,e,r)=>{r.d(e,{R:()=>d,x:()=>l});var i=r(99378);const s={},t=i.createContext(s);function d(n){const e=i.useContext(t);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:d(n.components),i.createElement(t.Provider,{value:e},n.children)}}}]);