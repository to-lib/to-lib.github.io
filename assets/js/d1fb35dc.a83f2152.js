"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[11765],{48885:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>r});var s=t(99378);const a={},l=s.createContext(a);function i(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(l.Provider,{value:n},e.children)}},88178:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>o,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"cpp/templates","title":"\u6a21\u677f\u7f16\u7a0b","description":"\u6a21\u677f\u662f C++ \u6cdb\u578b\u7f16\u7a0b\u7684\u6838\u5fc3\uff0c\u5141\u8bb8\u7f16\u5199\u7c7b\u578b\u65e0\u5173\u7684\u4ee3\u7801\u3002","source":"@site/docs/cpp/templates.md","sourceDirName":"cpp","slug":"/cpp/templates","permalink":"/docs/cpp/templates","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/cpp/templates.md","tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"sidebar_position":13,"title":"\u6a21\u677f\u7f16\u7a0b"},"sidebar":"cpp","previous":{"title":"\u62bd\u8c61\u7c7b\u548c\u63a5\u53e3","permalink":"/docs/cpp/abstract-interface"},"next":{"title":"\u6807\u51c6\u6a21\u677f\u5e93 (STL)","permalink":"/docs/cpp/stl"}}');var a=t(22714),l=t(48885);const i={sidebar_position:13,title:"\u6a21\u677f\u7f16\u7a0b"},r="C++ \u6a21\u677f\u7f16\u7a0b",c={},d=[{value:"\ud83c\udfaf \u51fd\u6570\u6a21\u677f",id:"-\u51fd\u6570\u6a21\u677f",level:2},{value:"\ud83d\udce6 \u7c7b\u6a21\u677f",id:"-\u7c7b\u6a21\u677f",level:2},{value:"\ud83d\udd27 \u6a21\u677f\u7279\u5316",id:"-\u6a21\u677f\u7279\u5316",level:2},{value:"\ud83d\udccb \u975e\u7c7b\u578b\u6a21\u677f\u53c2\u6570",id:"-\u975e\u7c7b\u578b\u6a21\u677f\u53c2\u6570",level:2},{value:"\ud83d\udd04 \u53ef\u53d8\u53c2\u6570\u6a21\u677f",id:"-\u53ef\u53d8\u53c2\u6570\u6a21\u677f",level:2},{value:"\ud83c\udfad SFINAE (\u66ff\u6362\u5931\u8d25\u4e0d\u662f\u9519\u8bef)",id:"-sfinae-\u66ff\u6362\u5931\u8d25\u4e0d\u662f\u9519\u8bef",level:2},{value:"enable_if",id:"enable_if",level:3},{value:"void_t \u68c0\u6d4b\u6210\u5458",id:"void_t-\u68c0\u6d4b\u6210\u5458",level:3},{value:"\ud83d\udd37 Concepts (C++20)",id:"-concepts-c20",level:2},{value:"\u5b9a\u4e49\u548c\u4f7f\u7528 Concept",id:"\u5b9a\u4e49\u548c\u4f7f\u7528-concept",level:3},{value:"\u4f7f\u7528 Concept \u7ea6\u675f",id:"\u4f7f\u7528-concept-\u7ea6\u675f",level:3},{value:"\u6807\u51c6\u5e93 Concepts",id:"\u6807\u51c6\u5e93-concepts",level:3},{value:"requires \u8868\u8fbe\u5f0f",id:"requires-\u8868\u8fbe\u5f0f",level:3},{value:"\u26a1 \u6700\u4f73\u5b9e\u8df5",id:"-\u6700\u4f73\u5b9e\u8df5",level:2}];function p(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"c-\u6a21\u677f\u7f16\u7a0b",children:"C++ \u6a21\u677f\u7f16\u7a0b"})}),"\n",(0,a.jsx)(n.p,{children:"\u6a21\u677f\u662f C++ \u6cdb\u578b\u7f16\u7a0b\u7684\u6838\u5fc3\uff0c\u5141\u8bb8\u7f16\u5199\u7c7b\u578b\u65e0\u5173\u7684\u4ee3\u7801\u3002"}),"\n",(0,a.jsx)(n.h2,{id:"-\u51fd\u6570\u6a21\u677f",children:"\ud83c\udfaf \u51fd\u6570\u6a21\u677f"}),"\n",(0,a.jsx)(n.mermaid,{value:"graph TD\n    Source[Source Code] --\x3e|Contains| Tmpl[Template&lt;T&gt;]\n    Source --\x3e|Call| Usage[max&lt;int&gt;(10, 20)]\n\n    Tmpl --\x3e|Compiler| Inst[Instantiation]\n    Usage --\x3e|Trigger| Inst\n\n    Inst --\x3e|Generate| Func[int max(int, int)]\n\n    style Source fill:#f9f,stroke:#333\n    style Tmpl fill:#ff9999\n    style Usage fill:#99ccff\n    style Func fill:#90EE90"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:"#include <iostream>\n\n// \u51fd\u6570\u6a21\u677f\ntemplate<typename T>\nT maximum(T a, T b) {\n    return (a > b) ? a : b;\n}\n\n// \u591a\u7c7b\u578b\u53c2\u6570\ntemplate<typename T, typename U>\nauto add(T a, U b) -> decltype(a + b) {\n    return a + b;\n}\n\n// C++14 \u8fd4\u56de\u7c7b\u578b\u63a8\u5bfc\ntemplate<typename T, typename U>\nauto multiply(T a, U b) {\n    return a * b;\n}\n\nint main() {\n    std::cout << maximum(10, 20) << std::endl;      // int\n    std::cout << maximum(3.14, 2.71) << std::endl;  // double\n    std::cout << maximum<double>(10, 3.14) << std::endl;  // \u663e\u5f0f\u6307\u5b9a\n\n    std::cout << add(1, 2.5) << std::endl;  // 3.5\n    return 0;\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"-\u7c7b\u6a21\u677f",children:"\ud83d\udce6 \u7c7b\u6a21\u677f"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:'template<typename T>\nclass Stack {\nprivate:\n    std::vector<T> data;\n\npublic:\n    void push(const T& value) {\n        data.push_back(value);\n    }\n\n    T pop() {\n        if (data.empty()) throw std::runtime_error("Empty");\n        T value = data.back();\n        data.pop_back();\n        return value;\n    }\n\n    bool empty() const { return data.empty(); }\n    size_t size() const { return data.size(); }\n};\n\nint main() {\n    Stack<int> intStack;\n    intStack.push(1);\n    intStack.push(2);\n\n    Stack<std::string> strStack;\n    strStack.push("Hello");\n\n    return 0;\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"-\u6a21\u677f\u7279\u5316",children:"\ud83d\udd27 \u6a21\u677f\u7279\u5316"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:'// \u901a\u7528\u6a21\u677f\ntemplate<typename T>\nclass Printer {\npublic:\n    void print(const T& value) {\n        std::cout << value << std::endl;\n    }\n};\n\n// \u5b8c\u5168\u7279\u5316\ntemplate<>\nclass Printer<bool> {\npublic:\n    void print(bool value) {\n        std::cout << (value ? "true" : "false") << std::endl;\n    }\n};\n\n// \u504f\u7279\u5316\uff08\u6307\u9488\u7c7b\u578b\uff09\ntemplate<typename T>\nclass Printer<T*> {\npublic:\n    void print(T* value) {\n        if (value) std::cout << *value << std::endl;\n        else std::cout << "nullptr" << std::endl;\n    }\n};\n'})}),"\n",(0,a.jsx)(n.h2,{id:"-\u975e\u7c7b\u578b\u6a21\u677f\u53c2\u6570",children:"\ud83d\udccb \u975e\u7c7b\u578b\u6a21\u677f\u53c2\u6570"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:"template<typename T, size_t N>\nclass Array {\nprivate:\n    T data[N];\n\npublic:\n    T& operator[](size_t i) { return data[i]; }\n    constexpr size_t size() const { return N; }\n};\n\nint main() {\n    Array<int, 5> arr;\n    arr[0] = 10;\n    return 0;\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"-\u53ef\u53d8\u53c2\u6570\u6a21\u677f",children:"\ud83d\udd04 \u53ef\u53d8\u53c2\u6570\u6a21\u677f"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:'// \u9012\u5f52\u7ec8\u6b62\nvoid print() {\n    std::cout << std::endl;\n}\n\n// \u53ef\u53d8\u53c2\u6570\u6a21\u677f\ntemplate<typename T, typename... Args>\nvoid print(T first, Args... rest) {\n    std::cout << first << " ";\n    print(rest...);\n}\n\n// \u6298\u53e0\u8868\u8fbe\u5f0f (C++17)\ntemplate<typename... Args>\nauto sum(Args... args) {\n    return (args + ...);\n}\n\nint main() {\n    print(1, 2.5, "hello", \'c\');  // 1 2.5 hello c\n    std::cout << sum(1, 2, 3, 4) << std::endl;  // 10\n    return 0;\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"-sfinae-\u66ff\u6362\u5931\u8d25\u4e0d\u662f\u9519\u8bef",children:"\ud83c\udfad SFINAE (\u66ff\u6362\u5931\u8d25\u4e0d\u662f\u9519\u8bef)"}),"\n",(0,a.jsx)(n.p,{children:"SFINAE \u5141\u8bb8\u5728\u6a21\u677f\u5b9e\u4f8b\u5316\u5931\u8d25\u65f6\uff0c\u9009\u62e9\u5176\u4ed6\u91cd\u8f7d\u800c\u4e0d\u662f\u62a5\u9519\u3002"}),"\n",(0,a.jsx)(n.h3,{id:"enable_if",children:"enable_if"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:"#include <type_traits>\n\n// \u53ea\u5bf9\u6574\u6570\u7c7b\u578b\u542f\u7528\ntemplate<typename T>\ntypename std::enable_if<std::is_integral<T>::value, T>::type\ndouble_value(T x) {\n    return x * 2;\n}\n\n// \u53ea\u5bf9\u6d6e\u70b9\u7c7b\u578b\u542f\u7528\ntemplate<typename T>\ntypename std::enable_if<std::is_floating_point<T>::value, T>::type\ndouble_value(T x) {\n    return x * 2.0;\n}\n\n// C++14 \u7b80\u5316\u5199\u6cd5\ntemplate<typename T>\nstd::enable_if_t<std::is_integral_v<T>, T>\ntriple_value(T x) {\n    return x * 3;\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"void_t-\u68c0\u6d4b\u6210\u5458",children:"void_t \u68c0\u6d4b\u6210\u5458"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:'#include <type_traits>\n\n// \u68c0\u6d4b\u7c7b\u578b\u662f\u5426\u6709 size() \u65b9\u6cd5\ntemplate<typename, typename = void>\nstruct has_size : std::false_type {};\n\ntemplate<typename T>\nstruct has_size<T, std::void_t<decltype(std::declval<T>().size())>>\n    : std::true_type {};\n\nstatic_assert(has_size<std::vector<int>>::value, "");\nstatic_assert(!has_size<int>::value, "");\n'})}),"\n",(0,a.jsx)(n.h2,{id:"-concepts-c20",children:"\ud83d\udd37 Concepts (C++20)"}),"\n",(0,a.jsx)(n.p,{children:"Concepts \u662f C++20 \u5f15\u5165\u7684\u7ea6\u675f\u6a21\u677f\u53c2\u6570\u7684\u65b9\u5f0f\uff0c\u6bd4 SFINAE \u66f4\u6e05\u6670\u3002"}),"\n",(0,a.jsx)(n.h3,{id:"\u5b9a\u4e49\u548c\u4f7f\u7528-concept",children:"\u5b9a\u4e49\u548c\u4f7f\u7528 Concept"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:"#include <concepts>\n\n// \u5b9a\u4e49 Concept\ntemplate<typename T>\nconcept Addable = requires(T a, T b) {\n    { a + b } -> std::same_as<T>;\n};\n\ntemplate<typename T>\nconcept Numeric = std::integral<T> || std::floating_point<T>;\n\ntemplate<typename T>\nconcept Printable = requires(T t, std::ostream& os) {\n    { os << t } -> std::same_as<std::ostream&>;\n};\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u4f7f\u7528-concept-\u7ea6\u675f",children:"\u4f7f\u7528 Concept \u7ea6\u675f"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:"// \u65b9\u5f0f1\uff1arequires \u5b50\u53e5\ntemplate<typename T>\n    requires Addable<T>\nT add(T a, T b) {\n    return a + b;\n}\n\n// \u65b9\u5f0f2\uff1aConcept \u4f5c\u4e3a\u7c7b\u578b\u7ea6\u675f\ntemplate<Numeric T>\nT multiply(T a, T b) {\n    return a * b;\n}\n\n// \u65b9\u5f0f3\uff1a\u7b80\u5199\u8bed\u6cd5\nauto divide(std::floating_point auto a, std::floating_point auto b) {\n    return a / b;\n}\n"})}),"\n",(0,a.jsx)(n.h3,{id:"\u6807\u51c6\u5e93-concepts",children:"\u6807\u51c6\u5e93 Concepts"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:"#include <concepts>\n\n// \u5e38\u7528\u6807\u51c6 Concepts\nstd::integral<T>           // \u6574\u6570\u7c7b\u578b\nstd::floating_point<T>     // \u6d6e\u70b9\u7c7b\u578b\nstd::signed_integral<T>    // \u6709\u7b26\u53f7\u6574\u6570\nstd::same_as<T, U>         // \u7c7b\u578b\u76f8\u540c\nstd::derived_from<T, U>    // T \u6d3e\u751f\u81ea U\nstd::convertible_to<T, U>  // T \u53ef\u8f6c\u6362\u4e3a U\nstd::invocable<F, Args...> // F \u53ef\u4ee5\u7528 Args \u8c03\u7528\nstd::copyable<T>           // \u53ef\u62f7\u8d1d\nstd::movable<T>            // \u53ef\u79fb\u52a8\nstd::default_initializable<T>  // \u53ef\u9ed8\u8ba4\u521d\u59cb\u5316\n"})}),"\n",(0,a.jsx)(n.h3,{id:"requires-\u8868\u8fbe\u5f0f",children:"requires \u8868\u8fbe\u5f0f"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:"template<typename T>\nconcept Container = requires(T t) {\n    typename T::value_type;           // \u8981\u6c42\u6709 value_type \u7c7b\u578b\n    typename T::iterator;             // \u8981\u6c42\u6709 iterator \u7c7b\u578b\n    { t.begin() } -> std::same_as<typename T::iterator>;\n    { t.end() } -> std::same_as<typename T::iterator>;\n    { t.size() } -> std::convertible_to<std::size_t>;\n    { t.empty() } -> std::same_as<bool>;\n};\n\ntemplate<Container C>\nvoid process_container(const C& c) {\n    for (const auto& item : c) {\n        // ...\n    }\n}\n"})}),"\n",(0,a.jsx)(n.h2,{id:"-\u6700\u4f73\u5b9e\u8df5",children:"\u26a1 \u6700\u4f73\u5b9e\u8df5"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"\u4f7f\u7528 typename \u6216 class"})," - \u6a21\u677f\u53c2\u6570\u5173\u952e\u5b57"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"\u7f16\u8bd1\u671f\u8ba1\u7b97"})," - \u5229\u7528 constexpr"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"\u4f18\u5148\u4f7f\u7528 Concepts (C++20)"})," - \u6bd4 SFINAE \u66f4\u6e05\u6670\u3001\u9519\u8bef\u4fe1\u606f\u66f4\u53cb\u597d"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"SFINAE"})," - C++20 \u524d\u4f7f\u7528\uff0c\u63a7\u5236\u6a21\u677f\u5b9e\u4f8b\u5316"]}),"\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.strong,{children:"\u9650\u5236\u6a21\u677f\u53c2\u6570"})," - \u4f7f\u7528 static_assert \u6216 Concepts"]}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}}}]);