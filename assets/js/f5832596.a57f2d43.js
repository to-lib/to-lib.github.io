"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[7122],{1266:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>a});var i=r(9378);const t={},s=i.createContext(t);function l(n){const e=i.useContext(s);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:l(n.components),i.createElement(s.Provider,{value:e},n.children)}},2111:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>p,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"java-design-patterns/interpreter-pattern","title":"\u89e3\u91ca\u5668\u6a21\u5f0f (Interpreter Pattern)","description":"\u6a21\u5f0f\u5b9a\u4e49","source":"@site/docs/java-design-patterns/interpreter-pattern.md","sourceDirName":"java-design-patterns","slug":"/java-design-patterns/interpreter-pattern","permalink":"/docs/java-design-patterns/interpreter-pattern","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/java-design-patterns/interpreter-pattern.md","tags":[],"version":"current","sidebarPosition":24,"frontMatter":{"sidebar_position":24},"sidebar":"docsSidebar","previous":{"title":"\u8bbf\u95ee\u8005\u6a21\u5f0f (Visitor Pattern)","permalink":"/docs/java-design-patterns/visitor-pattern"},"next":{"title":"\u8bbe\u8ba1\u6a21\u5f0f\u5feb\u901f\u53c2\u8003","permalink":"/docs/java-design-patterns/quick-reference"}}');var t=r(2714),s=r(1266);const l={sidebar_position:24},a="\u89e3\u91ca\u5668\u6a21\u5f0f (Interpreter Pattern)",p={},c=[{value:"\u6a21\u5f0f\u5b9a\u4e49",id:"\u6a21\u5f0f\u5b9a\u4e49",level:2},{value:"\u95ee\u9898\u5206\u6790",id:"\u95ee\u9898\u5206\u6790",level:2},{value:"\u89e3\u51b3\u65b9\u6848",id:"\u89e3\u51b3\u65b9\u6848",level:2},{value:"\u4ee3\u7801\u5b9e\u73b0",id:"\u4ee3\u7801\u5b9e\u73b0",level:2},{value:"1. \u5b9a\u4e49\u8868\u8fbe\u5f0f\u62bd\u8c61\u7c7b",id:"1-\u5b9a\u4e49\u8868\u8fbe\u5f0f\u62bd\u8c61\u7c7b",level:3},{value:"2. \u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f",id:"2-\u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f",level:3},{value:"3. \u975e\u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f",id:"3-\u975e\u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f",level:3},{value:"4. \u5ba2\u6237\u7aef\u4f7f\u7528",id:"4-\u5ba2\u6237\u7aef\u4f7f\u7528",level:3},{value:"\u5b9e\u9645\u5e94\u7528\u793a\u4f8b",id:"\u5b9e\u9645\u5e94\u7528\u793a\u4f8b",level:2},{value:"\u6570\u5b66\u8868\u8fbe\u5f0f\u6c42\u503c",id:"\u6570\u5b66\u8868\u8fbe\u5f0f\u6c42\u503c",level:3},{value:"SQL\u67e5\u8be2\u8868\u8fbe\u5f0f",id:"sql\u67e5\u8be2\u8868\u8fbe\u5f0f",level:3},{value:"\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u5339\u914d",id:"\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u5339\u914d",level:3},{value:"\u4e0e\u5176\u4ed6\u6a21\u5f0f\u7684\u5173\u7cfb",id:"\u4e0e\u5176\u4ed6\u6a21\u5f0f\u7684\u5173\u7cfb",level:2},{value:"\u4f18\u7f3a\u70b9",id:"\u4f18\u7f3a\u70b9",level:2},{value:"\u4f18\u70b9",id:"\u4f18\u70b9",level:3},{value:"\u7f3a\u70b9",id:"\u7f3a\u70b9",level:3},{value:"\u9002\u7528\u573a\u666f",id:"\u9002\u7528\u573a\u666f",level:2},{value:"Java\u4e2d\u7684\u5e94\u7528",id:"java\u4e2d\u7684\u5e94\u7528",level:2},{value:"\u4f55\u65f6\u4f7f\u7528",id:"\u4f55\u65f6\u4f7f\u7528",level:2}];function o(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"\u89e3\u91ca\u5668\u6a21\u5f0f-interpreter-pattern",children:"\u89e3\u91ca\u5668\u6a21\u5f0f (Interpreter Pattern)"})}),"\n",(0,t.jsx)(e.h2,{id:"\u6a21\u5f0f\u5b9a\u4e49",children:"\u6a21\u5f0f\u5b9a\u4e49"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"\u89e3\u91ca\u5668\u6a21\u5f0f"}),"\u662f\u4e00\u79cd\u884c\u4e3a\u578b\u8bbe\u8ba1\u6a21\u5f0f\uff0c\u5b83\u7ed9\u5b9a\u4e00\u4e2a\u8bed\u8a00\uff0c\u5b9a\u4e49\u5b83\u7684\u6587\u6cd5\u8868\u793a\uff0c\u5e76\u5b9a\u4e49\u4e00\u4e2a\u89e3\u91ca\u5668\u6765\u5904\u7406\u8fd9\u4e2a\u8bed\u8a00\u4e2d\u7684\u53e5\u5b50\u3002"]}),"\n",(0,t.jsx)(e.h2,{id:"\u95ee\u9898\u5206\u6790",children:"\u95ee\u9898\u5206\u6790"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u9700\u8981\u5904\u7406\u7279\u5b9a\u8bed\u8a00\u6216\u8868\u8fbe\u5f0f\u65f6\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u9700\u8981\u5b9a\u4e49\u548c\u89e3\u6790\u8bed\u8a00"}),"\n",(0,t.jsx)(e.li,{children:"\u9700\u8981\u5904\u7406\u8bed\u8a00\u4e2d\u7684\u5404\u79cd\u6784\u9020"}),"\n",(0,t.jsx)(e.li,{children:"\u9891\u7e41\u6dfb\u52a0\u65b0\u7684\u8bed\u8a00\u7ed3\u6784"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u89e3\u51b3\u65b9\u6848",children:"\u89e3\u51b3\u65b9\u6848"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Expression    \u2502\n\u2502+ interpret()    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u25b3\n    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502                  \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502Terminal    \u2502   \u2502Non-Terminal  \u2502\n\u2502Expression  \u2502   \u2502Expression    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u4ee3\u7801\u5b9e\u73b0",children:"\u4ee3\u7801\u5b9e\u73b0"}),"\n",(0,t.jsx)(e.h3,{id:"1-\u5b9a\u4e49\u8868\u8fbe\u5f0f\u62bd\u8c61\u7c7b",children:"1. \u5b9a\u4e49\u8868\u8fbe\u5f0f\u62bd\u8c61\u7c7b"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public interface Expression {\n    boolean interpret(String context);\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"2-\u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f",children:"2. \u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"// \u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f - \u53f6\u5b50\u8282\u70b9\npublic class TerminalExpression implements Expression {\n    private String data;\n    \n    public TerminalExpression(String data) {\n        this.data = data;\n    }\n    \n    @Override\n    public boolean interpret(String context) {\n        return context.contains(data);\n    }\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"3-\u975e\u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f",children:"3. \u975e\u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"// \u975e\u7ec8\u7ed3\u7b26\u8868\u8fbe\u5f0f - \u7ec4\u5408\u8282\u70b9\npublic class AndExpression implements Expression {\n    private Expression expr1;\n    private Expression expr2;\n    \n    public AndExpression(Expression expr1, Expression expr2) {\n        this.expr1 = expr1;\n        this.expr2 = expr2;\n    }\n    \n    @Override\n    public boolean interpret(String context) {\n        return expr1.interpret(context) && expr2.interpret(context);\n    }\n}\n\npublic class OrExpression implements Expression {\n    private Expression expr1;\n    private Expression expr2;\n    \n    public OrExpression(Expression expr1, Expression expr2) {\n        this.expr1 = expr1;\n        this.expr2 = expr2;\n    }\n    \n    @Override\n    public boolean interpret(String context) {\n        return expr1.interpret(context) || expr2.interpret(context);\n    }\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"4-\u5ba2\u6237\u7aef\u4f7f\u7528",children:"4. \u5ba2\u6237\u7aef\u4f7f\u7528"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public class Demo {\n    public static void main(String[] args) {\n        Expression isMale = new TerminalExpression("male");\n        Expression isAdult = new TerminalExpression("adult");\n        \n        // \u7537\u6027\u4e14\u6210\u4eba\n        Expression maleAndAdult = new AndExpression(isMale, isAdult);\n        \n        System.out.println("male adult: " + maleAndAdult.interpret("male adult"));\n        System.out.println("male: " + maleAndAdult.interpret("male"));\n        System.out.println("female adult: " + maleAndAdult.interpret("female adult"));\n    }\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u5b9e\u9645\u5e94\u7528\u793a\u4f8b",children:"\u5b9e\u9645\u5e94\u7528\u793a\u4f8b"}),"\n",(0,t.jsx)(e.h3,{id:"\u6570\u5b66\u8868\u8fbe\u5f0f\u6c42\u503c",children:"\u6570\u5b66\u8868\u8fbe\u5f0f\u6c42\u503c"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public interface MathExpression {\n    int evaluate();\n}\n\npublic class Number implements MathExpression {\n    private int value;\n    \n    public Number(int value) {\n        this.value = value;\n    }\n    \n    @Override\n    public int evaluate() {\n        return value;\n    }\n}\n\npublic class Add implements MathExpression {\n    private MathExpression left;\n    private MathExpression right;\n    \n    public Add(MathExpression left, MathExpression right) {\n        this.left = left;\n        this.right = right;\n    }\n    \n    @Override\n    public int evaluate() {\n        return left.evaluate() + right.evaluate();\n    }\n}\n\npublic class Subtract implements MathExpression {\n    private MathExpression left;\n    private MathExpression right;\n    \n    public Subtract(MathExpression left, MathExpression right) {\n        this.left = left;\n        this.right = right;\n    }\n    \n    @Override\n    public int evaluate() {\n        return left.evaluate() - right.evaluate();\n    }\n}\n\npublic class Multiply implements MathExpression {\n    private MathExpression left;\n    private MathExpression right;\n    \n    public Multiply(MathExpression left, MathExpression right) {\n        this.left = left;\n        this.right = right;\n    }\n    \n    @Override\n    public int evaluate() {\n        return left.evaluate() * right.evaluate();\n    }\n}\n\n// \u4f7f\u7528: (5 + 3) * 2 = 16\nMathExpression expr = new Multiply(\n    new Add(new Number(5), new Number(3)),\n    new Number(2)\n);\nSystem.out.println("\u7ed3\u679c: " + expr.evaluate());\n'})}),"\n",(0,t.jsx)(e.h3,{id:"sql\u67e5\u8be2\u8868\u8fbe\u5f0f",children:"SQL\u67e5\u8be2\u8868\u8fbe\u5f0f"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public interface SQLExpression {\n    String toSQL();\n}\n\npublic class SelectExpression implements SQLExpression {\n    private String columns;\n    private SQLExpression from;\n    \n    public SelectExpression(String columns, SQLExpression from) {\n        this.columns = columns;\n        this.from = from;\n    }\n    \n    @Override\n    public String toSQL() {\n        return "SELECT " + columns + " " + from.toSQL();\n    }\n}\n\npublic class FromExpression implements SQLExpression {\n    private String table;\n    private SQLExpression where;\n    \n    public FromExpression(String table, SQLExpression where) {\n        this.table = table;\n        this.where = where;\n    }\n    \n    @Override\n    public String toSQL() {\n        if (where != null) {\n            return "FROM " + table + " " + where.toSQL();\n        }\n        return "FROM " + table;\n    }\n}\n\npublic class WhereExpression implements SQLExpression {\n    private String condition;\n    \n    public WhereExpression(String condition) {\n        this.condition = condition;\n    }\n    \n    @Override\n    public String toSQL() {\n        return "WHERE " + condition;\n    }\n}\n\n// \u4f7f\u7528\nSQLExpression expr = new SelectExpression("*",\n    new FromExpression("users",\n        new WhereExpression("age > 18")\n    )\n);\nSystem.out.println(expr.toSQL());\n// SELECT * FROM users WHERE age > 18\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u5339\u914d",children:"\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u5339\u914d"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public interface PatternExpression {\n    boolean matches(String text);\n}\n\npublic class LiteralPattern implements PatternExpression {\n    private String literal;\n    \n    public LiteralPattern(String literal) {\n        this.literal = literal;\n    }\n    \n    @Override\n    public boolean matches(String text) {\n        return text.contains(literal);\n    }\n}\n\npublic class StarPattern implements PatternExpression {\n    private PatternExpression inner;\n    \n    public StarPattern(PatternExpression inner) {\n        this.inner = inner;\n    }\n    \n    @Override\n    public boolean matches(String text) {\n        // \u5339\u914d0\u6b21\u6216\u591a\u6b21\n        return true;\n    }\n}\n\npublic class SequencePattern implements PatternExpression {\n    private PatternExpression first;\n    private PatternExpression second;\n    \n    public SequencePattern(PatternExpression first, PatternExpression second) {\n        this.first = first;\n        this.second = second;\n    }\n    \n    @Override\n    public boolean matches(String text) {\n        return first.matches(text) && second.matches(text);\n    }\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u4e0e\u5176\u4ed6\u6a21\u5f0f\u7684\u5173\u7cfb",children:"\u4e0e\u5176\u4ed6\u6a21\u5f0f\u7684\u5173\u7cfb"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u8bbf\u95ee\u8005\u6a21\u5f0f"})," - \u5728\u5df2\u6709\u5bf9\u8c61\u7ed3\u6784\u4e0a\u589e\u52a0\u64cd\u4f5c"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u7ec4\u5408\u6a21\u5f0f"})," - \u5904\u7406\u6811\u5f62\u7ed3\u6784"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u5de5\u5382\u6a21\u5f0f"})," - \u521b\u5efa\u8868\u8fbe\u5f0f\u5bf9\u8c61"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u4f18\u7f3a\u70b9",children:"\u4f18\u7f3a\u70b9"}),"\n",(0,t.jsx)(e.h3,{id:"\u4f18\u70b9",children:"\u4f18\u70b9"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u2705 \u6613\u4e8e\u6539\u53d8\u548c\u6269\u5c55\u8bed\u6cd5"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \u5b9e\u73b0\u8bed\u6cd5\u7b80\u5355"}),"\n",(0,t.jsx)(e.li,{children:"\u2705 \u7b26\u5408\u5f00\u95ed\u539f\u5219"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"\u7f3a\u70b9",children:"\u7f3a\u70b9"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u274c \u8bed\u6cd5\u590d\u6742\u65f6\u6027\u80fd\u4e0b\u964d"}),"\n",(0,t.jsx)(e.li,{children:"\u274c \u7ef4\u62a4\u56f0\u96be"}),"\n",(0,t.jsx)(e.li,{children:"\u274c \u7c7b\u6570\u91cf\u591a"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"\u9002\u7528\u573a\u666f",children:"\u9002\u7528\u573a\u666f"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u2713 \u9700\u8981\u89e3\u6790\u8868\u8fbe\u5f0f"}),"\n",(0,t.jsx)(e.li,{children:"\u2713 SQL\u67e5\u8be2"}),"\n",(0,t.jsx)(e.li,{children:"\u2713 \u914d\u7f6e\u6587\u4ef6\u89e3\u6790"}),"\n",(0,t.jsx)(e.li,{children:"\u2713 \u811a\u672c\u8bed\u8a00"}),"\n",(0,t.jsx)(e.li,{children:"\u2713 \u6a21\u5f0f\u5339\u914d"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"java\u4e2d\u7684\u5e94\u7528",children:"Java\u4e2d\u7684\u5e94\u7528"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'// \u6b63\u5219\u8868\u8fbe\u5f0f - Pattern\u662f\u89e3\u91ca\u5668\u6a21\u5f0f\nPattern pattern = Pattern.compile("[a-z]+");\nMatcher matcher = pattern.matcher("hello");\n\n// Spring EL\u8868\u8fbe\u5f0f\nExpressionParser parser = new SpelExpressionParser();\nExpression expr = parser.parseExpression("1 + 2");\nint result = (Integer) expr.getValue();\n\n// SQL\u5904\u7406\nStatement stmt = connection.createStatement();\nResultSet rs = stmt.executeQuery("SELECT * FROM users");\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u4f55\u65f6\u4f7f\u7528",children:"\u4f55\u65f6\u4f7f\u7528"}),"\n",(0,t.jsx)(e.p,{children:"\u89e3\u91ca\u5668\u6a21\u5f0f\u9002\u5408\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u8bed\u6cd5\u76f8\u5bf9\u7b80\u5355\u7684\u8bed\u8a00"}),"\n",(0,t.jsx)(e.li,{children:"\u6027\u80fd\u4e0d\u662f\u9996\u8981\u95ee\u9898"}),"\n",(0,t.jsx)(e.li,{children:"\u9700\u8981\u7075\u6d3b\u6269\u5c55\u8bed\u6cd5"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"\u5bf9\u4e8e\u590d\u6742\u8bed\u8a00\uff0c\u66f4\u597d\u7684\u9009\u62e9\u662f\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u4f7f\u7528\u4e13\u4e1a\u7684\u89e3\u6790\u5668\u751f\u6210\u5de5\u5177\uff08\u5982ANTLR\uff09"}),"\n",(0,t.jsx)(e.li,{children:"\u4f7f\u7528\u7f16\u8bd1\u5668\u6846\u67b6"}),"\n"]})]})}function d(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(o,{...n})}):o(n)}}}]);