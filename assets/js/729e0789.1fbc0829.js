"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[71812],{46724:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"flink/connectors","title":"\u8fde\u63a5\u5668","description":"Flink \u6570\u636e\u6e90\u548c\u63a5\u6536\u5668\u8fde\u63a5\u5668\u8be6\u89e3","source":"@site/docs/flink/connectors.md","sourceDirName":"flink","slug":"/flink/connectors","permalink":"/docs/flink/connectors","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/flink/connectors.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"sidebar_position":12,"title":"\u8fde\u63a5\u5668","description":"Flink \u6570\u636e\u6e90\u548c\u63a5\u6536\u5668\u8fde\u63a5\u5668\u8be6\u89e3"},"sidebar":"flink","previous":{"title":"\u72b6\u6001\u7ba1\u7406","permalink":"/docs/flink/state-management"},"next":{"title":"CEP \u590d\u6742\u4e8b\u4ef6\u5904\u7406","permalink":"/docs/flink/cep"}}');var t=i(22714),r=i(48885);const l={sidebar_position:12,title:"\u8fde\u63a5\u5668",description:"Flink \u6570\u636e\u6e90\u548c\u63a5\u6536\u5668\u8fde\u63a5\u5668\u8be6\u89e3"},a="Flink \u8fde\u63a5\u5668",c={},d=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"Kafka \u8fde\u63a5\u5668",id:"kafka-\u8fde\u63a5\u5668",level:2},{value:"\u6dfb\u52a0\u4f9d\u8d56",id:"\u6dfb\u52a0\u4f9d\u8d56",level:3},{value:"Kafka Source",id:"kafka-source",level:3},{value:"Kafka Sink",id:"kafka-sink",level:3},{value:"Kafka SQL \u8fde\u63a5\u5668",id:"kafka-sql-\u8fde\u63a5\u5668",level:3},{value:"JDBC \u8fde\u63a5\u5668",id:"jdbc-\u8fde\u63a5\u5668",level:2},{value:"\u6dfb\u52a0\u4f9d\u8d56",id:"\u6dfb\u52a0\u4f9d\u8d56-1",level:3},{value:"JDBC Source\uff08Table API\uff09",id:"jdbc-sourcetable-api",level:3},{value:"JDBC Sink",id:"jdbc-sink",level:3},{value:"JDBC Lookup Join",id:"jdbc-lookup-join",level:3},{value:"Elasticsearch \u8fde\u63a5\u5668",id:"elasticsearch-\u8fde\u63a5\u5668",level:2},{value:"\u6dfb\u52a0\u4f9d\u8d56",id:"\u6dfb\u52a0\u4f9d\u8d56-2",level:3},{value:"Elasticsearch Sink",id:"elasticsearch-sink",level:3},{value:"Elasticsearch SQL",id:"elasticsearch-sql",level:3},{value:"\u6587\u4ef6\u7cfb\u7edf\u8fde\u63a5\u5668",id:"\u6587\u4ef6\u7cfb\u7edf\u8fde\u63a5\u5668",level:2},{value:"\u6587\u4ef6 Source",id:"\u6587\u4ef6-source",level:3},{value:"\u6587\u4ef6 Sink\uff08\u6d41\u5f0f\u5199\u5165\uff09",id:"\u6587\u4ef6-sink\u6d41\u5f0f\u5199\u5165",level:3},{value:"\u6587\u4ef6\u7cfb\u7edf SQL",id:"\u6587\u4ef6\u7cfb\u7edf-sql",level:3},{value:"Redis \u8fde\u63a5\u5668",id:"redis-\u8fde\u63a5\u5668",level:2},{value:"\u81ea\u5b9a\u4e49 Redis Sink",id:"\u81ea\u5b9a\u4e49-redis-sink",level:3},{value:"\u8fde\u63a5\u5668\u914d\u7f6e\u6c47\u603b",id:"\u8fde\u63a5\u5668\u914d\u7f6e\u6c47\u603b",level:2},{value:"\u4e0b\u4e00\u6b65",id:"\u4e0b\u4e00\u6b65",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"flink-\u8fde\u63a5\u5668",children:"Flink \u8fde\u63a5\u5668"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"\u9002\u7528\u7248\u672c\uff1aApache Flink v2.2.0"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,t.jsx)(n.p,{children:"Flink \u8fde\u63a5\u5668\u7528\u4e8e\u4e0e\u5916\u90e8\u7cfb\u7edf\u8fdb\u884c\u6570\u636e\u4ea4\u4e92\uff0c\u5305\u62ec\u6570\u636e\u6e90\uff08Source\uff09\u548c\u6570\u636e\u63a5\u6536\u5668\uff08Sink\uff09\u3002"}),"\n",(0,t.jsx)(n.h2,{id:"kafka-\u8fde\u63a5\u5668",children:"Kafka \u8fde\u63a5\u5668"}),"\n",(0,t.jsx)(n.h3,{id:"\u6dfb\u52a0\u4f9d\u8d56",children:"\u6dfb\u52a0\u4f9d\u8d56"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.apache.flink</groupId>\n    <artifactId>flink-connector-kafka</artifactId>\n    <version>${flink.version}</version>\n</dependency>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"kafka-source",children:"Kafka Source"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'KafkaSource<String> source = KafkaSource.<String>builder()\n    .setBootstrapServers("localhost:9092")\n    .setTopics("input-topic")\n    .setGroupId("my-group")\n    .setStartingOffsets(OffsetsInitializer.earliest())\n    .setValueOnlyDeserializer(new SimpleStringSchema())\n    .build();\n\nDataStream<String> stream = env.fromSource(\n    source,\n    WatermarkStrategy.noWatermarks(),\n    "Kafka Source"\n);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"kafka-sink",children:"Kafka Sink"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'KafkaSink<String> sink = KafkaSink.<String>builder()\n    .setBootstrapServers("localhost:9092")\n    .setRecordSerializer(KafkaRecordSerializationSchema.builder()\n        .setTopic("output-topic")\n        .setValueSerializationSchema(new SimpleStringSchema())\n        .build()\n    )\n    .setDeliveryGuarantee(DeliveryGuarantee.AT_LEAST_ONCE)\n    .build();\n\nstream.sinkTo(sink);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"kafka-sql-\u8fde\u63a5\u5668",children:"Kafka SQL \u8fde\u63a5\u5668"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE kafka_source (\n    id STRING,\n    name STRING,\n    ts TIMESTAMP(3),\n    WATERMARK FOR ts AS ts - INTERVAL '5' SECOND\n) WITH (\n    'connector' = 'kafka',\n    'topic' = 'input-topic',\n    'properties.bootstrap.servers' = 'localhost:9092',\n    'properties.group.id' = 'my-group',\n    'scan.startup.mode' = 'earliest-offset',\n    'format' = 'json'\n);\n\nCREATE TABLE kafka_sink (\n    id STRING,\n    result STRING,\n    ts TIMESTAMP(3)\n) WITH (\n    'connector' = 'kafka',\n    'topic' = 'output-topic',\n    'properties.bootstrap.servers' = 'localhost:9092',\n    'format' = 'json'\n);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"jdbc-\u8fde\u63a5\u5668",children:"JDBC \u8fde\u63a5\u5668"}),"\n",(0,t.jsx)(n.h3,{id:"\u6dfb\u52a0\u4f9d\u8d56-1",children:"\u6dfb\u52a0\u4f9d\u8d56"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.apache.flink</groupId>\n    <artifactId>flink-connector-jdbc</artifactId>\n    <version>${flink.connector.jdbc.version}</version>\n</dependency>\n<dependency>\n    <groupId>mysql</groupId>\n    <artifactId>mysql-connector-java</artifactId>\n    <version>8.0.28</version>\n</dependency>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"jdbc-sourcetable-api",children:"JDBC Source\uff08Table API\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE mysql_source (\n    id INT,\n    name STRING,\n    age INT,\n    PRIMARY KEY (id) NOT ENFORCED\n) WITH (\n    'connector' = 'jdbc',\n    'url' = 'jdbc:mysql://localhost:3306/mydb',\n    'table-name' = 'users',\n    'username' = 'root',\n    'password' = 'password'\n);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"jdbc-sink",children:"JDBC Sink"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'stream.addSink(JdbcSink.sink(\n    "INSERT INTO users (id, name, age) VALUES (?, ?, ?)",\n    (statement, user) -> {\n        statement.setInt(1, user.getId());\n        statement.setString(2, user.getName());\n        statement.setInt(3, user.getAge());\n    },\n    JdbcExecutionOptions.builder()\n        .withBatchSize(1000)\n        .withBatchIntervalMs(200)\n        .withMaxRetries(5)\n        .build(),\n    new JdbcConnectionOptions.JdbcConnectionOptionsBuilder()\n        .withUrl("jdbc:mysql://localhost:3306/mydb")\n        .withDriverName("com.mysql.cj.jdbc.Driver")\n        .withUsername("root")\n        .withPassword("password")\n        .build()\n));\n'})}),"\n",(0,t.jsx)(n.h3,{id:"jdbc-lookup-join",children:"JDBC Lookup Join"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"-- \u7ef4\u8868\u5b9a\u4e49\nCREATE TABLE products (\n    id INT,\n    name STRING,\n    price DECIMAL(10, 2),\n    PRIMARY KEY (id) NOT ENFORCED\n) WITH (\n    'connector' = 'jdbc',\n    'url' = 'jdbc:mysql://localhost:3306/mydb',\n    'table-name' = 'products',\n    'lookup.cache.max-rows' = '5000',\n    'lookup.cache.ttl' = '10min'\n);\n\n-- Lookup Join\nSELECT o.order_id, p.name, p.price\nFROM orders AS o\nJOIN products FOR SYSTEM_TIME AS OF o.proc_time AS p\n  ON o.product_id = p.id;\n"})}),"\n",(0,t.jsx)(n.h2,{id:"elasticsearch-\u8fde\u63a5\u5668",children:"Elasticsearch \u8fde\u63a5\u5668"}),"\n",(0,t.jsx)(n.h3,{id:"\u6dfb\u52a0\u4f9d\u8d56-2",children:"\u6dfb\u52a0\u4f9d\u8d56"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.apache.flink</groupId>\n    <artifactId>flink-connector-elasticsearch7</artifactId>\n    <version>${flink.version}</version>\n</dependency>\n"})}),"\n",(0,t.jsx)(n.h3,{id:"elasticsearch-sink",children:"Elasticsearch Sink"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'ElasticsearchSink<Event> esSink = new Elasticsearch7SinkBuilder<Event>()\n    .setHosts(new HttpHost("localhost", 9200, "http"))\n    .setEmitter((element, context, indexer) -> {\n        indexer.add(Requests.indexRequest()\n            .index("events")\n            .id(element.getId())\n            .source(Map.of(\n                "id", element.getId(),\n                "name", element.getName(),\n                "timestamp", element.getTimestamp()\n            ))\n        );\n    })\n    .setBulkFlushMaxActions(1000)\n    .build();\n\nstream.sinkTo(esSink);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"elasticsearch-sql",children:"Elasticsearch SQL"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE es_sink (\n    id STRING,\n    name STRING,\n    ts TIMESTAMP(3),\n    PRIMARY KEY (id) NOT ENFORCED\n) WITH (\n    'connector' = 'elasticsearch-7',\n    'hosts' = 'http://localhost:9200',\n    'index' = 'events'\n);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"\u6587\u4ef6\u7cfb\u7edf\u8fde\u63a5\u5668",children:"\u6587\u4ef6\u7cfb\u7edf\u8fde\u63a5\u5668"}),"\n",(0,t.jsx)(n.h3,{id:"\u6587\u4ef6-source",children:"\u6587\u4ef6 Source"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'FileSource<String> source = FileSource\n    .forRecordStreamFormat(\n        new TextLineInputFormat(),\n        new Path("hdfs:///data/input")\n    )\n    .monitorContinuously(Duration.ofSeconds(10))\n    .build();\n\nDataStream<String> stream = env.fromSource(\n    source,\n    WatermarkStrategy.noWatermarks(),\n    "File Source"\n);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u6587\u4ef6-sink\u6d41\u5f0f\u5199\u5165",children:"\u6587\u4ef6 Sink\uff08\u6d41\u5f0f\u5199\u5165\uff09"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'FileSink<String> sink = FileSink\n    .forRowFormat(\n        new Path("hdfs:///data/output"),\n        new SimpleStringEncoder<String>("UTF-8")\n    )\n    .withRollingPolicy(\n        DefaultRollingPolicy.builder()\n            .withRolloverInterval(Duration.ofMinutes(15))\n            .withInactivityInterval(Duration.ofMinutes(5))\n            .withMaxPartSize(MemorySize.ofMebiBytes(1024))\n            .build()\n    )\n    .withBucketAssigner(new DateTimeBucketAssigner<>("yyyy-MM-dd--HH"))\n    .build();\n\nstream.sinkTo(sink);\n'})}),"\n",(0,t.jsx)(n.h3,{id:"\u6587\u4ef6\u7cfb\u7edf-sql",children:"\u6587\u4ef6\u7cfb\u7edf SQL"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE file_source (\n    id STRING,\n    name STRING,\n    dt STRING\n) PARTITIONED BY (dt) WITH (\n    'connector' = 'filesystem',\n    'path' = 'hdfs:///data/input',\n    'format' = 'parquet'\n);\n\nCREATE TABLE file_sink (\n    id STRING,\n    name STRING,\n    dt STRING\n) PARTITIONED BY (dt) WITH (\n    'connector' = 'filesystem',\n    'path' = 'hdfs:///data/output',\n    'format' = 'parquet',\n    'sink.partition-commit.policy.kind' = 'success-file'\n);\n"})}),"\n",(0,t.jsx)(n.h2,{id:"redis-\u8fde\u63a5\u5668",children:"Redis \u8fde\u63a5\u5668"}),"\n",(0,t.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49-redis-sink",children:"\u81ea\u5b9a\u4e49 Redis Sink"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'public class RedisSink extends RichSinkFunction<Event> {\n    private transient Jedis jedis;\n\n    @Override\n    public void open(Configuration parameters) {\n        jedis = new Jedis("localhost", 6379);\n    }\n\n    @Override\n    public void invoke(Event event, Context context) {\n        jedis.hset("events", event.getId(), event.toJson());\n    }\n\n    @Override\n    public void close() {\n        if (jedis != null) {\n            jedis.close();\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"\u8fde\u63a5\u5668\u914d\u7f6e\u6c47\u603b",children:"\u8fde\u63a5\u5668\u914d\u7f6e\u6c47\u603b"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"\u8fde\u63a5\u5668"}),(0,t.jsx)(n.th,{children:"\u4f9d\u8d56"}),(0,t.jsx)(n.th,{children:"\u7279\u70b9"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Kafka"}),(0,t.jsx)(n.td,{children:"flink-connector-kafka"}),(0,t.jsx)(n.td,{children:"\u6700\u5e38\u7528\uff0c\u652f\u6301\u7cbe\u786e\u4e00\u6b21"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"JDBC"}),(0,t.jsx)(n.td,{children:"flink-connector-jdbc"}),(0,t.jsx)(n.td,{children:"\u652f\u6301\u5404\u79cd\u5173\u7cfb\u578b\u6570\u636e\u5e93"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Elasticsearch"}),(0,t.jsx)(n.td,{children:"flink-connector-elasticsearch"}),(0,t.jsx)(n.td,{children:"\u5168\u6587\u641c\u7d22\u3001\u65e5\u5fd7\u5206\u6790"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Filesystem"}),(0,t.jsx)(n.td,{children:"flink-connector-files"}),(0,t.jsx)(n.td,{children:"HDFS/S3/\u672c\u5730\u6587\u4ef6"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Pulsar"}),(0,t.jsx)(n.td,{children:"flink-connector-pulsar"}),(0,t.jsx)(n.td,{children:"\u65b0\u4e00\u4ee3\u6d88\u606f\u7cfb\u7edf"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"HBase"}),(0,t.jsx)(n.td,{children:"flink-connector-hbase"}),(0,t.jsx)(n.td,{children:"NoSQL \u6570\u636e\u5e93"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"\u4e0b\u4e00\u6b65",children:"\u4e0b\u4e00\u6b65"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\ud83d\udcca ",(0,t.jsx)(n.a,{href:"/docs/flink/table-sql",children:"Table API & SQL"})," - SQL \u8fde\u63a5\u5668\u4f7f\u7528"]}),"\n",(0,t.jsxs)(n.li,{children:["\ud83d\ude80 ",(0,t.jsx)(n.a,{href:"/docs/flink/deployment",children:"\u90e8\u7f72\u4e0e\u8fd0\u7ef4"})," - \u751f\u4ea7\u90e8\u7f72"]}),"\n",(0,t.jsxs)(n.li,{children:["\ud83d\udccb ",(0,t.jsx)(n.a,{href:"/docs/flink/best-practices",children:"\u6700\u4f73\u5b9e\u8df5"})," - \u5f00\u53d1\u89c4\u8303"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},48885:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var s=i(99378);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);