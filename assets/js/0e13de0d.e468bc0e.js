"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[3659],{48885:(n,d,e)=>{e.d(d,{R:()=>i,x:()=>t});var s=e(99378);const l={},a=s.createContext(l);function i(n){const d=s.useContext(a);return s.useMemo(function(){return"function"==typeof n?n(d):{...d,...n}},[d,n])}function t(n){let d;return d=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:i(n.components),s.createElement(a.Provider,{value:d},n.children)}},74482:(n,d,e)=>{e.r(d),e.d(d,{assets:()=>r,contentTitle:()=>t,default:()=>o,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"linux/disk-management","title":"\u78c1\u76d8\u548c\u5b58\u50a8\u7ba1\u7406","description":"\u78c1\u76d8\u7ba1\u7406\u662f Linux \u7cfb\u7edf\u7ba1\u7406\u7684\u91cd\u8981\u90e8\u5206\uff0c\u5305\u62ec\u5206\u533a\u3001\u683c\u5f0f\u5316\u3001\u6302\u8f7d\u3001LVM \u548c RAID \u7b49\u3002","source":"@site/docs/linux/disk-management.md","sourceDirName":"linux","slug":"/linux/disk-management","permalink":"/docs/linux/disk-management","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/linux/disk-management.md","tags":[],"version":"current","sidebarPosition":13,"frontMatter":{"sidebar_position":13,"title":"\u78c1\u76d8\u548c\u5b58\u50a8\u7ba1\u7406"},"sidebar":"linux","previous":{"title":"\u65e5\u5fd7\u7ba1\u7406","permalink":"/docs/linux/log-management"},"next":{"title":"\u7f51\u7edc\u914d\u7f6e","permalink":"/docs/linux/networking"}}');var l=e(22714),a=e(48885);const i={sidebar_position:13,title:"\u78c1\u76d8\u548c\u5b58\u50a8\u7ba1\u7406"},t="Linux \u78c1\u76d8\u548c\u5b58\u50a8\u7ba1\u7406",r={},c=[{value:"\u78c1\u76d8\u57fa\u7840",id:"\u78c1\u76d8\u57fa\u7840",level:2},{value:"\u78c1\u76d8\u7c7b\u578b",id:"\u78c1\u76d8\u7c7b\u578b",level:3},{value:"\u67e5\u770b\u78c1\u76d8\u4fe1\u606f",id:"\u67e5\u770b\u78c1\u76d8\u4fe1\u606f",level:3},{value:"\u5206\u533a\u7ba1\u7406",id:"\u5206\u533a\u7ba1\u7406",level:2},{value:"fdisk \u5206\u533a\uff08MBR\uff09",id:"fdisk-\u5206\u533ambr",level:3},{value:"parted \u5206\u533a\uff08GPT\uff09",id:"parted-\u5206\u533agpt",level:3},{value:"gdisk \u5206\u533a\uff08GPT\uff09",id:"gdisk-\u5206\u533agpt",level:3},{value:"\u6587\u4ef6\u7cfb\u7edf",id:"\u6587\u4ef6\u7cfb\u7edf",level:2},{value:"\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf",id:"\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf",level:3},{value:"\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf",id:"\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf",level:3},{value:"\u6587\u4ef6\u7cfb\u7edf\u68c0\u67e5\u548c\u4fee\u590d",id:"\u6587\u4ef6\u7cfb\u7edf\u68c0\u67e5\u548c\u4fee\u590d",level:3},{value:"\u6302\u8f7d\u7ba1\u7406",id:"\u6302\u8f7d\u7ba1\u7406",level:2},{value:"\u4e34\u65f6\u6302\u8f7d",id:"\u4e34\u65f6\u6302\u8f7d",level:3},{value:"\u6c38\u4e45\u6302\u8f7d\uff08/etc/fstab\uff09",id:"\u6c38\u4e45\u6302\u8f7detcfstab",level:3},{value:"\u6302\u8f7d\u9009\u9879",id:"\u6302\u8f7d\u9009\u9879",level:3},{value:"LVM\uff08\u903b\u8f91\u5377\u7ba1\u7406\uff09",id:"lvm\u903b\u8f91\u5377\u7ba1\u7406",level:2},{value:"LVM \u6982\u5ff5",id:"lvm-\u6982\u5ff5",level:3},{value:"\u521b\u5efa LVM",id:"\u521b\u5efa-lvm",level:3},{value:"\u6269\u5c55 LVM",id:"\u6269\u5c55-lvm",level:3},{value:"\u7f29\u5c0f LVM",id:"\u7f29\u5c0f-lvm",level:3},{value:"LVM \u5feb\u7167",id:"lvm-\u5feb\u7167",level:3},{value:"RAID",id:"raid",level:2},{value:"RAID \u7ea7\u522b",id:"raid-\u7ea7\u522b",level:3},{value:"\u521b\u5efa RAID",id:"\u521b\u5efa-raid",level:3},{value:"RAID \u7ba1\u7406",id:"raid-\u7ba1\u7406",level:3},{value:"\u5b58\u50a8\u4f18\u5316",id:"\u5b58\u50a8\u4f18\u5316",level:2},{value:"\u6027\u80fd\u4f18\u5316",id:"\u6027\u80fd\u4f18\u5316",level:3},{value:"\u78c1\u76d8\u6e05\u7406",id:"\u78c1\u76d8\u6e05\u7406",level:3},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2},{value:"1. \u4f7f\u7528 LVM",id:"1-\u4f7f\u7528-lvm",level:3},{value:"2. \u5b9a\u671f\u68c0\u67e5",id:"2-\u5b9a\u671f\u68c0\u67e5",level:3},{value:"3. \u5907\u4efd\u7b56\u7565",id:"3-\u5907\u4efd\u7b56\u7565",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function u(n){const d={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.header,{children:(0,l.jsx)(d.h1,{id:"linux-\u78c1\u76d8\u548c\u5b58\u50a8\u7ba1\u7406",children:"Linux \u78c1\u76d8\u548c\u5b58\u50a8\u7ba1\u7406"})}),"\n",(0,l.jsx)(d.p,{children:"\u78c1\u76d8\u7ba1\u7406\u662f Linux \u7cfb\u7edf\u7ba1\u7406\u7684\u91cd\u8981\u90e8\u5206\uff0c\u5305\u62ec\u5206\u533a\u3001\u683c\u5f0f\u5316\u3001\u6302\u8f7d\u3001LVM \u548c RAID \u7b49\u3002"}),"\n",(0,l.jsx)(d.h2,{id:"\u78c1\u76d8\u57fa\u7840",children:"\u78c1\u76d8\u57fa\u7840"}),"\n",(0,l.jsx)(d.h3,{id:"\u78c1\u76d8\u7c7b\u578b",children:"\u78c1\u76d8\u7c7b\u578b"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# SATA \u78c1\u76d8\n/dev/sda, /dev/sdb, /dev/sdc...\n\n# NVMe \u78c1\u76d8\n/dev/nvme0n1, /dev/nvme0n2...\n\n# SCSI \u78c1\u76d8\n/dev/sd*\n\n# \u865a\u62df\u78c1\u76d8\uff08\u4e91\u73af\u5883\uff09\n/dev/vda, /dev/vdb...\n"})}),"\n",(0,l.jsx)(d.h3,{id:"\u67e5\u770b\u78c1\u76d8\u4fe1\u606f",children:"\u67e5\u770b\u78c1\u76d8\u4fe1\u606f"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u5217\u51fa\u5757\u8bbe\u5907\nlsblk\nlsblk -f        # \u663e\u793a\u6587\u4ef6\u7cfb\u7edf\n\n# \u78c1\u76d8\u5206\u533a\u8be6\u60c5\nsudo fdisk -l\nsudo parted -l\n\n# \u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\ndf -h\ndf -i           # inodes \u4f7f\u7528\n\n# \u76ee\u5f55\u5927\u5c0f\ndu -sh /path\ndu -h --max-depth=1 /\n\n# \u67e5\u627e\u7279\u5b9a\u5927\u5c0f\u7684\u6587\u4ef6\nfind / -type f -size +100M 2>/dev/null\nfind / -type f -size +1G 2>/dev/null\n\n# \u78c1\u76d8 IO \u7edf\u8ba1\niostat\niostat -x 1\n\n# \u78c1\u76d8\u4fe1\u606f\u8be6\u60c5\nsudo hdparm -I /dev/sda\nsudo smartctl -a /dev/sda\n"})}),"\n",(0,l.jsx)(d.h2,{id:"\u5206\u533a\u7ba1\u7406",children:"\u5206\u533a\u7ba1\u7406"}),"\n",(0,l.jsx)(d.h3,{id:"fdisk-\u5206\u533ambr",children:"fdisk \u5206\u533a\uff08MBR\uff09"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u542f\u52a8 fdisk\nsudo fdisk /dev/sdb\n\n# fdisk \u547d\u4ee4\nm       # \u5e2e\u52a9\np       # \u6253\u5370\u5206\u533a\u8868\nn       # \u65b0\u5efa\u5206\u533a\nd       # \u5220\u9664\u5206\u533a\nt       # \u66f4\u6539\u5206\u533a\u7c7b\u578b\nw       # \u5199\u5165\u5e76\u9000\u51fa\nq       # \u4e0d\u4fdd\u5b58\u9000\u51fa\n\n# \u793a\u4f8b\uff1a\u521b\u5efa\u65b0\u5206\u533a\nsudo fdisk /dev/sdb\nn       # \u65b0\u5efa\np       # \u4e3b\u5206\u533a\n1       # \u5206\u533a\u53f7\n[Enter] # \u9ed8\u8ba4\u8d77\u59cb\u6247\u533a\n+10G    # \u5927\u5c0f10GB\nw       # \u5199\u5165\n"})}),"\n",(0,l.jsx)(d.h3,{id:"parted-\u5206\u533agpt",children:"parted \u5206\u533a\uff08GPT\uff09"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u542f\u52a8 parted\nsudo parted /dev/sdb\n\n# \u521b\u5efa GPT \u5206\u533a\u8868\n(parted) mklabel gpt\n\n# \u521b\u5efa\u5206\u533a\n(parted) mkpart primary ext4 0% 100%\n(parted) mkpart primary ext4 0GB 50GB\n(parted) mkpart primary ext4 50GB 100GB\n\n# \u67e5\u770b\u5206\u533a\n(parted) print\n\n# \u5220\u9664\u5206\u533a\n(parted) rm 1\n\n# \u9000\u51fa\n(parted) quit\n"})}),"\n",(0,l.jsx)(d.h3,{id:"gdisk-\u5206\u533agpt",children:"gdisk \u5206\u533a\uff08GPT\uff09"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u4f7f\u7528 gdisk\uff08GPT fdisk\uff09\nsudo gdisk /dev/sdb\n\n# \u547d\u4ee4\u7c7b\u4f3c fdisk\nn       # \u65b0\u5efa\u5206\u533a\nd       # \u5220\u9664\u5206\u533a\np       # \u6253\u5370\u5206\u533a\u8868\nw       # \u5199\u5165\u5e76\u9000\u51fa\n"})}),"\n",(0,l.jsx)(d.h2,{id:"\u6587\u4ef6\u7cfb\u7edf",children:"\u6587\u4ef6\u7cfb\u7edf"}),"\n",(0,l.jsx)(d.h3,{id:"\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf",children:"\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# ext4\uff08\u63a8\u8350\u4f7f\u7528\uff09\nsudo mkfs.ext4 /dev/sdb1\n\n# xfs\nsudo mkfs.xfs /dev/sdb1\n\n# btrfs\nsudo mkfs.btrfs /dev/sdb1\n\n# FAT32\uff08\u517c\u5bb9\u6027\u597d\uff09\nsudo mkfs.vfat -F 32 /dev/sdb1\n\n# NTFS\uff08\u4e0e Windows \u517c\u5bb9\uff09\nsudo mkfs.ntfs /dev/sdb1\nsudo mkfs.ntfs -f /dev/sdb1    # \u5feb\u901f\u683c\u5f0f\u5316\n\n# \u4f7f\u7528\u6807\u7b7e\nsudo mkfs.ext4 -L MyData /dev/sdb1\n"})}),"\n",(0,l.jsx)(d.h3,{id:"\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf",children:"\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\nlsblk -f\nblkid\n\n# \u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\u8be6\u60c5\nsudo tune2fs -l /dev/sdb1       # ext \u6587\u4ef6\u7cfb\u7edf\nsudo xfs_info /dev/sdb1         # xfs \u6587\u4ef6\u7cfb\u7edf\n\n# \u4fee\u6539\u6587\u4ef6\u7cfb\u7edf\u6807\u7b7e\nsudo e2label /dev/sdb1 NewLabel        # ext\nsudo xfs_admin -L NewLabel /dev/sdb1   # xfs\n"})}),"\n",(0,l.jsx)(d.h3,{id:"\u6587\u4ef6\u7cfb\u7edf\u68c0\u67e5\u548c\u4fee\u590d",children:"\u6587\u4ef6\u7cfb\u7edf\u68c0\u67e5\u548c\u4fee\u590d"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# ext \u6587\u4ef6\u7cfb\u7edf\u68c0\u67e5\uff08\u9700\u5148\u5378\u8f7d\uff09\nsudo umount /dev/sdb1\nsudo fsck /dev/sdb1\nsudo e2fsck /dev/sdb1\n\n# \u81ea\u52a8\u4fee\u590d\nsudo fsck -y /dev/sdb1\nsudo e2fsck -p /dev/sdb1\n\n# \u5f3a\u5236\u68c0\u67e5\nsudo fsck -f /dev/sdb1\n\n# xfs \u6587\u4ef6\u7cfb\u7edf\u4fee\u590d\nsudo xfs_repair /dev/sdb1\n"})}),"\n",(0,l.jsx)(d.h2,{id:"\u6302\u8f7d\u7ba1\u7406",children:"\u6302\u8f7d\u7ba1\u7406"}),"\n",(0,l.jsx)(d.h3,{id:"\u4e34\u65f6\u6302\u8f7d",children:"\u4e34\u65f6\u6302\u8f7d"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u521b\u5efa\u6302\u8f7d\u70b9\nsudo mkdir /mnt/data\n\n# \u6302\u8f7d\u5206\u533a\nsudo mount /dev/sdb1 /mnt/data\n\n# \u6302\u8f7d ISO \u6587\u4ef6\nsudo mount -o loop image.iso /mnt/iso\n\n# \u53ea\u8bfb\u6302\u8f7d\nsudo mount -o ro /dev/sdb1 /mnt/data\n\n# \u6302\u8f7d\u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf\uff08NFS\uff09\nsudo mount -t nfs server:/path /mnt/nfs\n\n# \u5378\u8f7d\nsudo umount /mnt/data\nsudo umount /dev/sdb1\n\n# \u5f3a\u5236\u5378\u8f7d\nsudo umount -f /mnt/data\nsudo umount -l /mnt/data    # \u61d2\u5378\u8f7d\n"})}),"\n",(0,l.jsx)(d.h3,{id:"\u6c38\u4e45\u6302\u8f7detcfstab",children:"\u6c38\u4e45\u6302\u8f7d\uff08/etc/fstab\uff09"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u7f16\u8f91 fstab\nsudo vim /etc/fstab\n\n# fstab \u683c\u5f0f\n# <\u8bbe\u5907> <\u6302\u8f7d\u70b9> <\u6587\u4ef6\u7cfb\u7edf> <\u9009\u9879> <dump> <fsck>\n\n# UUID \u6302\u8f7d\uff08\u63a8\u8350\uff09\nUUID=xxx-xxx-xxx /mnt/data ext4 defaults 0 2\n\n# \u8bbe\u5907\u8def\u5f84\u6302\u8f7d\n/dev/sdb1 /mnt/data ext4 defaults 0 2\n\n# \u7f51\u7edc\u6302\u8f7d\nserver:/export /mnt/nfs nfs defaults 0 0\n\n# \u83b7\u53d6 UUID\nsudo blkid /dev/sdb1\nlsblk -f\n\n# \u6d4b\u8bd5 fstab\nsudo mount -a\n\n# fstab dump \u9009\u9879\n# 0 - \u4e0d\u5907\u4efd\n# 1 - \u5907\u4efd\n\n# fstab fsck \u9009\u9879\n# 0 - \u4e0d\u68c0\u67e5\n# 1 - \u6839\u6587\u4ef6\u7cfb\u7edf\n# 2 - \u5176\u4ed6\u6587\u4ef6\u7cfb\u7edf\n"})}),"\n",(0,l.jsx)(d.h3,{id:"\u6302\u8f7d\u9009\u9879",children:"\u6302\u8f7d\u9009\u9879"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u5e38\u7528\u9009\u9879\ndefaults    # \u9ed8\u8ba4\u9009\u9879\uff08rw,suid,dev,exec,auto,nouser,async\uff09\nrw          # \u8bfb\u5199\nro          # \u53ea\u8bfb\nnoexec      # \u7981\u6b62\u6267\u884c\nnosuid      # \u7981\u7528 SUID\nnodev       # \u7981\u6b62\u8bbe\u5907\u6587\u4ef6\nnoatime     # \u4e0d\u66f4\u65b0\u8bbf\u95ee\u65f6\u95f4\uff08\u6027\u80fd\u4f18\u5316\uff09\nnodiratime  # \u4e0d\u66f4\u65b0\u76ee\u5f55\u8bbf\u95ee\u65f6\u95f4\nuser        # \u5141\u8bb8\u666e\u901a\u7528\u6237\u6302\u8f7d\nauto        # \u5f00\u673a\u81ea\u52a8\u6302\u8f7d\nnoauto      # \u4e0d\u81ea\u52a8\u6302\u8f7d\n\n# \u793a\u4f8b\nUUID=xxx /mnt/data ext4 defaults,noatime 0 2\n"})}),"\n",(0,l.jsx)(d.h2,{id:"lvm\u903b\u8f91\u5377\u7ba1\u7406",children:"LVM\uff08\u903b\u8f91\u5377\u7ba1\u7406\uff09"}),"\n",(0,l.jsx)(d.h3,{id:"lvm-\u6982\u5ff5",children:"LVM \u6982\u5ff5"}),"\n",(0,l.jsx)(d.mermaid,{value:"graph TD\n    A[\u7269\u7406\u78c1\u76d8 PV] --\x3e B[\u5377\u7ec4 VG]\n    B --\x3e C[\u903b\u8f91\u5377 LV]\n    C --\x3e D[\u6587\u4ef6\u7cfb\u7edf]"}),"\n",(0,l.jsx)(d.h3,{id:"\u521b\u5efa-lvm",children:"\u521b\u5efa LVM"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# 1. \u521b\u5efa\u7269\u7406\u5377\uff08PV\uff09\nsudo pvcreate /dev/sdb1\nsudo pvcreate /dev/sdc1\n\n# \u67e5\u770b PV\nsudo pvdisplay\nsudo pvs\n\n# 2. \u521b\u5efa\u5377\u7ec4\uff08VG\uff09\nsudo vgcreate vg_data /dev/sdb1 /dev/sdc1\n\n# \u67e5\u770b VG\nsudo vgdisplay\nsudo vgs\n\n# 3. \u521b\u5efa\u903b\u8f91\u5377\uff08LV\uff09\nsudo lvcreate -L 10G -n lv_data vg_data\nsudo lvcreate -l 100%FREE -n lv_data vg_data    # \u4f7f\u7528\u5168\u90e8\u7a7a\u95f4\n\n# \u67e5\u770b LV\nsudo lvdisplay\nsudo lvs\n\n# 4. \u683c\u5f0f\u5316\u5e76\u6302\u8f7d\nsudo mkfs.ext4 /dev/vg_data/lv_data\nsudo mkdir /mnt/lvm\nsudo mount /dev/vg_data/lv_data /mnt/lvm\n"})}),"\n",(0,l.jsx)(d.h3,{id:"\u6269\u5c55-lvm",children:"\u6269\u5c55 LVM"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u6269\u5c55VG\uff08\u6dfb\u52a0\u65b0\u786c\u76d8\uff09\nsudo pvcreate /dev/sdd1\nsudo vgextend vg_data /dev/sdd1\n\n# \u6269\u5c55 LV\nsudo lvextend -L +5G /dev/vg_data/lv_data       # \u589e\u52a05GB\nsudo lvextend -l +100%FREE /dev/vg_data/lv_data  # \u4f7f\u7528\u6240\u6709\u7a7a\u95f4\n\n# \u6269\u5c55\u6587\u4ef6\u7cfb\u7edf\nsudo resize2fs /dev/vg_data/lv_data             # ext4\nsudo xfs_growfs /mnt/lvm                         # xfs\n\n# \u4e00\u6b65\u5b8c\u6210\uff08\u6269\u5c55LV\u548c\u6587\u4ef6\u7cfb\u7edf\uff09\nsudo lvextend -r -L +5G /dev/vg_data/lv_data\n"})}),"\n",(0,l.jsx)(d.h3,{id:"\u7f29\u5c0f-lvm",children:"\u7f29\u5c0f LVM"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u6ce8\u610f\uff1axfs \u4e0d\u652f\u6301\u7f29\u5c0f\uff0c\u53ea\u6709 ext \u7cfb\u5217\u652f\u6301\n\n# 1. \u5378\u8f7d\nsudo umount /mnt/lvm\n\n# 2. \u68c0\u67e5\u6587\u4ef6\u7cfb\u7edf\nsudo e2fsck -f /dev/vg_data/lv_data\n\n# 3. \u7f29\u5c0f\u6587\u4ef6\u7cfb\u7edf\nsudo resize2fs /dev/vg_data/lv_data 5G\n\n# 4. \u7f29\u5c0f LV\nsudo lvreduce -L 5G /dev/vg_data/lv_data\n\n# 5. \u91cd\u65b0\u6302\u8f7d\nsudo mount /dev/vg_data/lv_data /mnt/lvm\n"})}),"\n",(0,l.jsx)(d.h3,{id:"lvm-\u5feb\u7167",children:"LVM \u5feb\u7167"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u521b\u5efa\u5feb\u7167\nsudo lvcreate -L 1G -s -n lv_snap /dev/vg_data/lv_data\n\n# \u6302\u8f7d\u5feb\u7167\nsudo mkdir /mnt/snapshot\nsudo mount /dev/vg_data/lv_snap /mnt/snapshot\n\n# \u6062\u590d\u5feb\u7167\nsudo umount /mnt/lvm\nsudo lvconvert --merge /dev/vg_data/lv_snap\n\n# \u5220\u9664\u5feb\u7167\nsudo lvremove /dev/vg_data/lv_snap\n"})}),"\n",(0,l.jsx)(d.h2,{id:"raid",children:"RAID"}),"\n",(0,l.jsx)(d.h3,{id:"raid-\u7ea7\u522b",children:"RAID \u7ea7\u522b"}),"\n",(0,l.jsxs)(d.table,{children:[(0,l.jsx)(d.thead,{children:(0,l.jsxs)(d.tr,{children:[(0,l.jsx)(d.th,{children:"RAID"}),(0,l.jsx)(d.th,{children:"\u6700\u5c11\u78c1\u76d8"}),(0,l.jsx)(d.th,{children:"\u5bb9\u91cf"}),(0,l.jsx)(d.th,{children:"\u5bb9\u9519"}),(0,l.jsx)(d.th,{children:"\u6027\u80fd"}),(0,l.jsx)(d.th,{children:"\u8bf4\u660e"})]})}),(0,l.jsxs)(d.tbody,{children:[(0,l.jsxs)(d.tr,{children:[(0,l.jsx)(d.td,{children:"RAID 0"}),(0,l.jsx)(d.td,{children:"2"}),(0,l.jsx)(d.td,{children:"100%"}),(0,l.jsx)(d.td,{children:"\u65e0"}),(0,l.jsx)(d.td,{children:"\u9ad8"}),(0,l.jsx)(d.td,{children:"\u6761\u5e26\u5316\uff0c\u65e0\u5197\u4f59"})]}),(0,l.jsxs)(d.tr,{children:[(0,l.jsx)(d.td,{children:"RAID 1"}),(0,l.jsx)(d.td,{children:"2"}),(0,l.jsx)(d.td,{children:"50%"}),(0,l.jsx)(d.td,{children:"1 \u5757"}),(0,l.jsx)(d.td,{children:"\u8bfb\u5feb"}),(0,l.jsx)(d.td,{children:"\u955c\u50cf"})]}),(0,l.jsxs)(d.tr,{children:[(0,l.jsx)(d.td,{children:"RAID 5"}),(0,l.jsx)(d.td,{children:"3"}),(0,l.jsx)(d.td,{children:"(n-1)/n"}),(0,l.jsx)(d.td,{children:"1 \u5757"}),(0,l.jsx)(d.td,{children:"\u5747\u8861"}),(0,l.jsx)(d.td,{children:"\u5206\u5e03\u5f0f\u5947\u5076\u6821\u9a8c"})]}),(0,l.jsxs)(d.tr,{children:[(0,l.jsx)(d.td,{children:"RAID 6"}),(0,l.jsx)(d.td,{children:"4"}),(0,l.jsx)(d.td,{children:"(n-2)/n"}),(0,l.jsx)(d.td,{children:"2 \u5757"}),(0,l.jsx)(d.td,{children:"\u8bfb\u5feb"}),(0,l.jsx)(d.td,{children:"\u53cc\u91cd\u5947\u5076\u6821\u9a8c"})]}),(0,l.jsxs)(d.tr,{children:[(0,l.jsx)(d.td,{children:"RAID 10"}),(0,l.jsx)(d.td,{children:"4"}),(0,l.jsx)(d.td,{children:"50%"}),(0,l.jsx)(d.td,{children:"\u6bcf\u7ec4 1 \u5757"}),(0,l.jsx)(d.td,{children:"\u9ad8"}),(0,l.jsx)(d.td,{children:"\u955c\u50cf+\u6761\u5e26"})]})]})]}),"\n",(0,l.jsx)(d.h3,{id:"\u521b\u5efa-raid",children:"\u521b\u5efa RAID"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u5b89\u88c5 mdadm\nsudo apt install mdadm\n\n# \u521b\u5efa RAID 1\nsudo mdadm --create /dev/md0 --level=1 --raid-devices=2 /dev/sdb1 /dev/sdc1\n\n# \u521b\u5efa RAID 5\nsudo mdadm --create /dev/md0 --level=5 --raid-devices=3 /dev/sdb1 /dev/sdc1 /dev/sdd1\n\n# \u67e5\u770b RAID \u72b6\u6001\ncat /proc/mdstat\nsudo mdadm --detail /dev/md0\n\n# \u683c\u5f0f\u5316 RAID\nsudo mkfs.ext4 /dev/md0\n\n# \u6302\u8f7d\nsudo mkdir /mnt/raid\nsudo mount /dev/md0 /mnt/raid\n\n# \u4fdd\u5b58 RAID \u914d\u7f6e\nsudo mdadm --detail --scan | sudo tee -a /etc/mdadm/mdadm.conf\nsudo update-initramfs -u\n"})}),"\n",(0,l.jsx)(d.h3,{id:"raid-\u7ba1\u7406",children:"RAID \u7ba1\u7406"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u6dfb\u52a0\u70ed\u5907\u76d8\nsudo mdadm --add /dev/md0 /dev/sde1\n\n# \u6807\u8bb0\u78c1\u76d8\u4e3a\u6545\u969c\nsudo mdadm --fail /dev/md0 /dev/sdb1\n\n# \u79fb\u9664\u6545\u969c\u78c1\u76d8\nsudo mdadm --remove /dev/md0 /dev/sdb1\n\n# \u66ff\u6362\u78c1\u76d8\nsudo mdadm --add /dev/md0 /dev/sdf1    # \u4f1a\u81ea\u52a8\u5f00\u59cb\u91cd\u5efa\n\n# \u505c\u6b62 RAID\nsudo mdadm --stop /dev/md0\n\n# \u5220\u9664 RAID\nsudo mdadm --zero-superblock /dev/sdb1\n"})}),"\n",(0,l.jsx)(d.h2,{id:"\u5b58\u50a8\u4f18\u5316",children:"\u5b58\u50a8\u4f18\u5316"}),"\n",(0,l.jsx)(d.h3,{id:"\u6027\u80fd\u4f18\u5316",children:"\u6027\u80fd\u4f18\u5316"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u6302\u8f7d\u9009\u9879\u4f18\u5316\nnoatime,nodiratime    # \u4e0d\u66f4\u65b0\u8bbf\u95ee\u65f6\u95f4\n\n# \u67e5\u770b\u78c1\u76d8\u8c03\u5ea6\u5668\ncat /sys/block/sda/queue/scheduler\n\n# \u4fee\u6539\u8c03\u5ea6\u5668\necho noop | sudo tee /sys/block/sda/queue/scheduler\necho deadline | sudo tee /sys/block/sda/queue/scheduler\n\n# IO\u4f18\u5148\u7ea7\nionice -c3 command    # \u7a7a\u95f2\u65f6\u8fd0\u884c\nionice -c2 -n0 command  # \u6700\u9ad8\u4f18\u5148\u7ea7\n"})}),"\n",(0,l.jsx)(d.h3,{id:"\u78c1\u76d8\u6e05\u7406",children:"\u78c1\u76d8\u6e05\u7406"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u67e5\u627e\u5927\u6587\u4ef6\nsudo find / -type f -size +1G 2>/dev/null\n\n# \u6e05\u7406\u5305\u7f13\u5b58\nsudo apt clean\nsudo yum clean all\n\n# \u6e05\u7406\u65e5\u5fd7\nsudo journalctl --vacuum-time=7d\n\n# \u67e5\u627e\u7a7a\u76ee\u5f55\nfind . -type d -empty\n\n# \u5220\u9664\u65e7\u5185\u6838\nsudo apt autoremove\ndpkg --list | grep linux-image\n"})}),"\n",(0,l.jsx)(d.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,l.jsx)(d.h3,{id:"1-\u4f7f\u7528-lvm",children:"1. \u4f7f\u7528 LVM"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u2705 \u9884\u7559\u7a7a\u95f4\u4fbf\u4e8e\u6269\u5c55\n# \u2705 \u4f7f\u7528\u5feb\u7167\u8fdb\u884c\u5907\u4efd\n# \u2705 \u5408\u7406\u89c4\u5212\u5377\u7ec4\u5927\u5c0f\n"})}),"\n",(0,l.jsx)(d.h3,{id:"2-\u5b9a\u671f\u68c0\u67e5",children:"2. \u5b9a\u671f\u68c0\u67e5"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u5b9a\u671f\u68c0\u67e5\u78c1\u76d8\u5065\u5eb7\nsudo smartctl -a /dev/sda\n\n# \u76d1\u63a7\u78c1\u76d8\u4f7f\u7528\ndf -h\ndu -sh /*\n"})}),"\n",(0,l.jsx)(d.h3,{id:"3-\u5907\u4efd\u7b56\u7565",children:"3. \u5907\u4efd\u7b56\u7565"}),"\n",(0,l.jsx)(d.pre,{children:(0,l.jsx)(d.code,{className:"language-bash",children:"# \u91cd\u8981\u6570\u636e\u4f7f\u7528 RAID 1 \u6216 RAID 10\n# \u5b9a\u671f\u5f02\u5730\u5907\u4efd\n# \u4f7f\u7528 LVM \u5feb\u7167\n"})}),"\n",(0,l.jsx)(d.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,l.jsx)(d.p,{children:"\u672c\u6587\u4ecb\u7ecd\u4e86 Linux \u78c1\u76d8\u548c\u5b58\u50a8\u7ba1\u7406\uff1a"}),"\n",(0,l.jsxs)(d.ul,{children:["\n",(0,l.jsx)(d.li,{children:"\u2705 \u78c1\u76d8\u5206\u533a\uff08fdisk\u3001parted\uff09"}),"\n",(0,l.jsx)(d.li,{children:"\u2705 \u6587\u4ef6\u7cfb\u7edf\u521b\u5efa\u548c\u7ba1\u7406"}),"\n",(0,l.jsx)(d.li,{children:"\u2705 \u6302\u8f7d\u914d\u7f6e\uff08fstab\uff09"}),"\n",(0,l.jsx)(d.li,{children:"\u2705 LVM \u903b\u8f91\u5377\u7ba1\u7406"}),"\n",(0,l.jsx)(d.li,{children:"\u2705 RAID \u78c1\u76d8\u9635\u5217"}),"\n",(0,l.jsx)(d.li,{children:"\u2705 \u5b58\u50a8\u6027\u80fd\u4f18\u5316"}),"\n"]}),"\n",(0,l.jsxs)(d.p,{children:["\u7ee7\u7eed\u5b66\u4e60 ",(0,l.jsx)(d.a,{href:"/docs/linux/performance-tuning",children:"\u6027\u80fd\u4f18\u5316"})," \u548c ",(0,l.jsx)(d.a,{href:"/docs/linux/security",children:"\u7cfb\u7edf\u5b89\u5168"}),"\u3002"]})]})}function o(n={}){const{wrapper:d}={...(0,a.R)(),...n.components};return d?(0,l.jsx)(d,{...n,children:(0,l.jsx)(u,{...n})}):u(n)}}}]);