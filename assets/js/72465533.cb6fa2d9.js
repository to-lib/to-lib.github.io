"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[15906],{48885:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var i=s(99378);const r={},l=i.createContext(r);function t(e){const n=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(l.Provider,{value:n},e.children)}},68403:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"springcloud/bus","title":"Spring Cloud Bus \u6d88\u606f\u603b\u7ebf","description":"[!TIP]","source":"@site/docs/springcloud/bus.md","sourceDirName":"springcloud","slug":"/springcloud/bus","permalink":"/docs/springcloud/bus","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/springcloud/bus.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{"title":"Spring Cloud Bus \u6d88\u606f\u603b\u7ebf","sidebar_label":"Bus \u6d88\u606f\u603b\u7ebf","sidebar_position":11},"sidebar":"springcloud","previous":{"title":"Stream \u6d88\u606f\u9a71\u52a8","permalink":"/docs/springcloud/stream"},"next":{"title":"Consul","permalink":"/docs/springcloud/consul"}}');var r=s(22714),l=s(48885);const t={title:"Spring Cloud Bus \u6d88\u606f\u603b\u7ebf",sidebar_label:"Bus \u6d88\u606f\u603b\u7ebf",sidebar_position:11},a="Spring Cloud Bus \u6d88\u606f\u603b\u7ebf",c={},d=[{value:"1. \u7b80\u4ecb",id:"1-\u7b80\u4ecb",level:2},{value:"\u4ec0\u4e48\u662f Spring Cloud Bus\uff1f",id:"\u4ec0\u4e48\u662f-spring-cloud-bus",level:3},{value:"\u5de5\u4f5c\u539f\u7406",id:"\u5de5\u4f5c\u539f\u7406",level:3},{value:"2. \u5feb\u901f\u5f00\u59cb",id:"2-\u5feb\u901f\u5f00\u59cb",level:2},{value:"\u6dfb\u52a0\u4f9d\u8d56",id:"\u6dfb\u52a0\u4f9d\u8d56",level:3},{value:"\u914d\u7f6e RabbitMQ",id:"\u914d\u7f6e-rabbitmq",level:3},{value:"\u914d\u7f6e Kafka",id:"\u914d\u7f6e-kafka",level:3},{value:"3. \u914d\u7f6e\u5237\u65b0\u5e7f\u64ad",id:"3-\u914d\u7f6e\u5237\u65b0\u5e7f\u64ad",level:2},{value:"\u624b\u52a8\u89e6\u53d1\u5168\u5c40\u5237\u65b0",id:"\u624b\u52a8\u89e6\u53d1\u5168\u5c40\u5237\u65b0",level:3},{value:"\u914d\u5408 Git Webhook \u81ea\u52a8\u5237\u65b0",id:"\u914d\u5408-git-webhook-\u81ea\u52a8\u5237\u65b0",level:3},{value:"\u4f7f\u7528 @RefreshScope",id:"\u4f7f\u7528-refreshscope",level:3},{value:"4. \u5237\u65b0\u6307\u5b9a\u670d\u52a1",id:"4-\u5237\u65b0\u6307\u5b9a\u670d\u52a1",level:2},{value:"destination \u53c2\u6570",id:"destination-\u53c2\u6570",level:3},{value:"\u914d\u7f6e\u670d\u52a1 ID",id:"\u914d\u7f6e\u670d\u52a1-id",level:3},{value:"5. \u81ea\u5b9a\u4e49\u4e8b\u4ef6",id:"5-\u81ea\u5b9a\u4e49\u4e8b\u4ef6",level:2},{value:"\u5b9a\u4e49\u4e8b\u4ef6",id:"\u5b9a\u4e49\u4e8b\u4ef6",level:3},{value:"\u53d1\u5e03\u4e8b\u4ef6",id:"\u53d1\u5e03\u4e8b\u4ef6",level:3},{value:"\u76d1\u542c\u4e8b\u4ef6",id:"\u76d1\u542c\u4e8b\u4ef6",level:3},{value:"\u6ce8\u518c\u4e8b\u4ef6\u7c7b\u578b",id:"\u6ce8\u518c\u4e8b\u4ef6\u7c7b\u578b",level:3},{value:"6. \u5237\u65b0\u73af\u5883\u53d8\u91cf",id:"6-\u5237\u65b0\u73af\u5883\u53d8\u91cf",level:2},{value:"busenv \u7aef\u70b9",id:"busenv-\u7aef\u70b9",level:3},{value:"\u76d1\u542c\u73af\u5883\u53d8\u66f4\u4e8b\u4ef6",id:"\u76d1\u542c\u73af\u5883\u53d8\u66f4\u4e8b\u4ef6",level:3},{value:"7. \u914d\u7f6e\u9009\u9879",id:"7-\u914d\u7f6e\u9009\u9879",level:2},{value:"8. \u76d1\u63a7\u4e0e\u8ffd\u8e2a",id:"8-\u76d1\u63a7\u4e0e\u8ffd\u8e2a",level:2},{value:"\u67e5\u770b\u5237\u65b0\u72b6\u6001",id:"\u67e5\u770b\u5237\u65b0\u72b6\u6001",level:3},{value:"\u5237\u65b0\u4e8b\u4ef6\u8ffd\u8e2a",id:"\u5237\u65b0\u4e8b\u4ef6\u8ffd\u8e2a",level:3},{value:"9. \u6700\u4f73\u5b9e\u8df5",id:"9-\u6700\u4f73\u5b9e\u8df5",level:2},{value:"\u751f\u4ea7\u73af\u5883\u914d\u7f6e",id:"\u751f\u4ea7\u73af\u5883\u914d\u7f6e",level:3},{value:"\u5b89\u5168\u63a7\u5236",id:"\u5b89\u5168\u63a7\u5236",level:3},{value:"\u9ad8\u53ef\u7528\u6d88\u606f\u4e2d\u95f4\u4ef6",id:"\u9ad8\u53ef\u7528\u6d88\u606f\u4e2d\u95f4\u4ef6",level:3},{value:"10. \u5e38\u89c1\u95ee\u9898",id:"10-\u5e38\u89c1\u95ee\u9898",level:2},{value:"\u5237\u65b0\u4e0d\u751f\u6548",id:"\u5237\u65b0\u4e0d\u751f\u6548",level:3},{value:"\u6d88\u606f\u5ef6\u8fdf",id:"\u6d88\u606f\u5ef6\u8fdf",level:3}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"spring-cloud-bus-\u6d88\u606f\u603b\u7ebf",children:"Spring Cloud Bus \u6d88\u606f\u603b\u7ebf"})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"[!TIP]\nSpring Cloud Bus \u5c06\u5206\u5e03\u5f0f\u7cfb\u7edf\u7684\u8282\u70b9\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u5b9e\u73b0\u914d\u7f6e\u5237\u65b0\u5e7f\u64ad\u3001\u4e8b\u4ef6\u4f20\u64ad\u7b49\u529f\u80fd\u3002\u901a\u5e38\u4e0e Config Server \u914d\u5408\u4f7f\u7528\uff0c\u5b9e\u73b0\u914d\u7f6e\u7684\u81ea\u52a8\u5237\u65b0\u3002"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"1-\u7b80\u4ecb",children:"1. \u7b80\u4ecb"}),"\n",(0,r.jsx)(n.h3,{id:"\u4ec0\u4e48\u662f-spring-cloud-bus",children:"\u4ec0\u4e48\u662f Spring Cloud Bus\uff1f"}),"\n",(0,r.jsx)(n.p,{children:"Spring Cloud Bus \u4f7f\u7528\u8f7b\u91cf\u7ea7\u6d88\u606f\u4ee3\u7406\uff08RabbitMQ \u6216 Kafka\uff09\u8fde\u63a5\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u6240\u6709\u8282\u70b9\uff0c\u7528\u4e8e\uff1a"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u914d\u7f6e\u5237\u65b0\u5e7f\u64ad"}),": \u4e00\u6b21\u5237\u65b0\uff0c\u6240\u6709\u5b9e\u4f8b\u66f4\u65b0"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u4e8b\u4ef6\u4f20\u64ad"}),": \u81ea\u5b9a\u4e49\u4e8b\u4ef6\u5728\u670d\u52a1\u95f4\u5e7f\u64ad"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"\u72b6\u6001\u540c\u6b65"}),": \u670d\u52a1\u95f4\u72b6\u6001\u540c\u6b65"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u5de5\u4f5c\u539f\u7406",children:"\u5de5\u4f5c\u539f\u7406"}),"\n",(0,r.jsx)(n.mermaid,{value:"graph LR\n    Config[Config Server] --\x3e MQ[\u6d88\u606f\u4e2d\u95f4\u4ef6]\n    MQ --\x3e Service1[\u670d\u52a1\u5b9e\u4f8b 1]\n    MQ --\x3e Service2[\u670d\u52a1\u5b9e\u4f8b 2]\n    MQ --\x3e Service3[\u670d\u52a1\u5b9e\u4f8b 3]\n\n    Webhook[Git Webhook] -.-> Config"}),"\n",(0,r.jsx)(n.h2,{id:"2-\u5feb\u901f\u5f00\u59cb",children:"2. \u5feb\u901f\u5f00\u59cb"}),"\n",(0,r.jsx)(n.h3,{id:"\u6dfb\u52a0\u4f9d\u8d56",children:"\u6dfb\u52a0\u4f9d\u8d56"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u4f7f\u7528 RabbitMQ"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-bus-amqp</artifactId>\n</dependency>\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u4f7f\u7528 Kafka"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-bus-kafka</artifactId>\n</dependency>\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u914d\u7f6e-rabbitmq",children:"\u914d\u7f6e RabbitMQ"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  rabbitmq:\n    host: localhost\n    port: 5672\n    username: guest\n    password: guest\n\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: bus-refresh, bus-env\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u914d\u7f6e-kafka",children:"\u914d\u7f6e Kafka"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  kafka:\n    bootstrap-servers: localhost:9092\n\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: bus-refresh, bus-env\n"})}),"\n",(0,r.jsx)(n.h2,{id:"3-\u914d\u7f6e\u5237\u65b0\u5e7f\u64ad",children:"3. \u914d\u7f6e\u5237\u65b0\u5e7f\u64ad"}),"\n",(0,r.jsx)(n.h3,{id:"\u624b\u52a8\u89e6\u53d1\u5168\u5c40\u5237\u65b0",children:"\u624b\u52a8\u89e6\u53d1\u5168\u5c40\u5237\u65b0"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u5237\u65b0\u6240\u6709\u670d\u52a1\u7684\u6240\u6709\u5b9e\u4f8b\ncurl -X POST http://config-server:8888/actuator/busrefresh\n\n# \u5237\u65b0\u6307\u5b9a\u670d\u52a1\u7684\u6240\u6709\u5b9e\u4f8b\ncurl -X POST http://config-server:8888/actuator/busrefresh/user-service:**\n\n# \u5237\u65b0\u6307\u5b9a\u5b9e\u4f8b\ncurl -X POST http://config-server:8888/actuator/busrefresh/user-service:8081\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u914d\u5408-git-webhook-\u81ea\u52a8\u5237\u65b0",children:"\u914d\u5408 Git Webhook \u81ea\u52a8\u5237\u65b0"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Git \u4ed3\u5e93\u914d\u7f6e\u53d8\u66f4\n       \u2193\n   Git Webhook\n       \u2193\nPOST /actuator/busrefresh\n       \u2193\n   \u6d88\u606f\u5e7f\u64ad\n       \u2193\n\u6240\u6709\u670d\u52a1\u5b9e\u4f8b\u5237\u65b0\u914d\u7f6e\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Webhook URL"}),": ",(0,r.jsx)(n.code,{children:"http://config-server:8888/actuator/busrefresh"})]}),"\n",(0,r.jsx)(n.h3,{id:"\u4f7f\u7528-refreshscope",children:"\u4f7f\u7528 @RefreshScope"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@RestController\n@RefreshScope\npublic class ConfigController {\n\n    @Value("${app.message}")\n    private String message;\n\n    @GetMapping("/message")\n    public String getMessage() {\n        return message;\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"4-\u5237\u65b0\u6307\u5b9a\u670d\u52a1",children:"4. \u5237\u65b0\u6307\u5b9a\u670d\u52a1"}),"\n",(0,r.jsx)(n.h3,{id:"destination-\u53c2\u6570",children:"destination \u53c2\u6570"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u683c\u5f0f: /{destination}\n# destination \u683c\u5f0f: {serviceId}:{instanceId}\n\n# \u5237\u65b0 user-service \u7684\u6240\u6709\u5b9e\u4f8b\nPOST /actuator/busrefresh/user-service:**\n\n# \u5237\u65b0 user-service \u7aef\u53e3\u4e3a 8081 \u7684\u5b9e\u4f8b\nPOST /actuator/busrefresh/user-service:8081\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u914d\u7f6e\u670d\u52a1-id",children:"\u914d\u7f6e\u670d\u52a1 ID"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  cloud:\n    bus:\n      id: ${spring.application.name}:${server.port}\n"})}),"\n",(0,r.jsx)(n.h2,{id:"5-\u81ea\u5b9a\u4e49\u4e8b\u4ef6",children:"5. \u81ea\u5b9a\u4e49\u4e8b\u4ef6"}),"\n",(0,r.jsx)(n.h3,{id:"\u5b9a\u4e49\u4e8b\u4ef6",children:"\u5b9a\u4e49\u4e8b\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"public class CustomEvent extends RemoteApplicationEvent {\n\n    private String message;\n\n    public CustomEvent() {}\n\n    public CustomEvent(Object source, String originService,\n                       String destinationService, String message) {\n        super(source, originService, destinationService);\n        this.message = message;\n    }\n\n    public String getMessage() {\n        return message;\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u53d1\u5e03\u4e8b\u4ef6",children:"\u53d1\u5e03\u4e8b\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:"@Service\npublic class EventPublisher {\n\n    @Autowired\n    private ApplicationContext context;\n\n    @Autowired\n    private BusProperties busProperties;\n\n    public void publishEvent(String message) {\n        CustomEvent event = new CustomEvent(\n            this,\n            busProperties.getId(),\n            null,  // null \u8868\u793a\u5e7f\u64ad\u7ed9\u6240\u6709\u670d\u52a1\n            message\n        );\n        context.publishEvent(event);\n    }\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u76d1\u542c\u4e8b\u4ef6",children:"\u76d1\u542c\u4e8b\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Component\npublic class CustomEventListener {\n\n    @EventListener\n    public void handleCustomEvent(CustomEvent event) {\n        System.out.println("\u6536\u5230\u81ea\u5b9a\u4e49\u4e8b\u4ef6: " + event.getMessage());\n        // \u5904\u7406\u4e8b\u4ef6...\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u6ce8\u518c\u4e8b\u4ef6\u7c7b\u578b",children:"\u6ce8\u518c\u4e8b\u4ef6\u7c7b\u578b"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Configuration\n@RemoteApplicationEventScan(basePackages = "com.example.events")\npublic class BusConfig {\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"6-\u5237\u65b0\u73af\u5883\u53d8\u91cf",children:"6. \u5237\u65b0\u73af\u5883\u53d8\u91cf"}),"\n",(0,r.jsx)(n.h3,{id:"busenv-\u7aef\u70b9",children:"busenv \u7aef\u70b9"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'# \u66f4\u65b0\u73af\u5883\u53d8\u91cf\u5e76\u5e7f\u64ad\ncurl -X POST http://localhost:8080/actuator/busenv \\\n  -H "Content-Type: application/json" \\\n  -d \'{"name": "app.message", "value": "new value"}\'\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u76d1\u542c\u73af\u5883\u53d8\u66f4\u4e8b\u4ef6",children:"\u76d1\u542c\u73af\u5883\u53d8\u66f4\u4e8b\u4ef6"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Component\npublic class EnvChangeListener {\n\n    @EventListener\n    public void handleEnvChange(EnvironmentChangeRemoteApplicationEvent event) {\n        Map<String, String> changes = event.getValues();\n        changes.forEach((key, value) -> {\n            System.out.println("\u73af\u5883\u53d8\u91cf\u53d8\u66f4: " + key + " = " + value);\n        });\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"7-\u914d\u7f6e\u9009\u9879",children:"7. \u914d\u7f6e\u9009\u9879"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  cloud:\n    bus:\n      # \u662f\u5426\u542f\u7528 Bus\n      enabled: true\n      # \u670d\u52a1\u6807\u8bc6\n      id: ${spring.application.name}:${server.port}\n      # traceId \u914d\u7f6e\n      trace:\n        enabled: true\n      # \u5237\u65b0\u914d\u7f6e\n      refresh:\n        enabled: true\n      # \u73af\u5883\u53d8\u66f4\u914d\u7f6e\n      env:\n        enabled: true\n      # ACK \u914d\u7f6e\n      ack:\n        enabled: true\n"})}),"\n",(0,r.jsx)(n.h2,{id:"8-\u76d1\u63a7\u4e0e\u8ffd\u8e2a",children:"8. \u76d1\u63a7\u4e0e\u8ffd\u8e2a"}),"\n",(0,r.jsx)(n.h3,{id:"\u67e5\u770b\u5237\u65b0\u72b6\u6001",children:"\u67e5\u770b\u5237\u65b0\u72b6\u6001"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# \u67e5\u770b trace \u4e8b\u4ef6\nGET /actuator/busenv?trace=true\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u5237\u65b0\u4e8b\u4ef6\u8ffd\u8e2a",children:"\u5237\u65b0\u4e8b\u4ef6\u8ffd\u8e2a"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Component\npublic class RefreshEventListener {\n\n    private static final Logger log = LoggerFactory.getLogger(RefreshEventListener.class);\n\n    @EventListener\n    public void onRefresh(RefreshRemoteApplicationEvent event) {\n        log.info("\u6536\u5230\u914d\u7f6e\u5237\u65b0\u4e8b\u4ef6, \u6765\u6e90: {}", event.getOriginService());\n    }\n\n    @EventListener\n    public void onAck(AckRemoteApplicationEvent event) {\n        log.info("\u6536\u5230 ACK, \u670d\u52a1: {}, \u4e8b\u4ef6: {}",\n            event.getAckDestinationService(),\n            event.getAckId());\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"9-\u6700\u4f73\u5b9e\u8df5",children:"9. \u6700\u4f73\u5b9e\u8df5"}),"\n",(0,r.jsx)(n.h3,{id:"\u751f\u4ea7\u73af\u5883\u914d\u7f6e",children:"\u751f\u4ea7\u73af\u5883\u914d\u7f6e"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  cloud:\n    bus:\n      enabled: true\n      # \u53ea\u5237\u65b0\u9700\u8981\u7684\u5b9e\u4f8b\uff0c\u907f\u514d\u4e0d\u5fc5\u8981\u7684\u5237\u65b0\n      refresh:\n        enabled: true\n\nmanagement:\n  endpoints:\n    web:\n      exposure:\n        include: busrefresh\n  endpoint:\n    busrefresh:\n      # \u751f\u4ea7\u73af\u5883\u5efa\u8bae\u6dfb\u52a0\u5b89\u5168\u63a7\u5236\n      sensitive: true\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u5b89\u5168\u63a7\u5236",children:"\u5b89\u5168\u63a7\u5236"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-java",children:'@Configuration\n@EnableWebSecurity\npublic class SecurityConfig {\n\n    @Bean\n    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {\n        http\n            .authorizeHttpRequests(auth -> auth\n                // \u4fdd\u62a4 bus \u7aef\u70b9\n                .requestMatchers("/actuator/busrefresh").hasRole("ADMIN")\n                .anyRequest().permitAll()\n            );\n        return http.build();\n    }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u9ad8\u53ef\u7528\u6d88\u606f\u4e2d\u95f4\u4ef6",children:"\u9ad8\u53ef\u7528\u6d88\u606f\u4e2d\u95f4\u4ef6"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"RabbitMQ"}),": \u4f7f\u7528\u96c6\u7fa4\u6a21\u5f0f + \u955c\u50cf\u961f\u5217"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Kafka"}),": \u591a Broker \u96c6\u7fa4 + \u526f\u672c"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"10-\u5e38\u89c1\u95ee\u9898",children:"10. \u5e38\u89c1\u95ee\u9898"}),"\n",(0,r.jsx)(n.h3,{id:"\u5237\u65b0\u4e0d\u751f\u6548",children:"\u5237\u65b0\u4e0d\u751f\u6548"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u68c0\u67e5\u9879"}),":"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\u786e\u4fdd\u6dfb\u52a0\u4e86 ",(0,r.jsx)(n.code,{children:"@RefreshScope"})]}),"\n",(0,r.jsx)(n.li,{children:"\u786e\u4fdd\u6d88\u606f\u4e2d\u95f4\u4ef6\u8fde\u63a5\u6b63\u5e38"}),"\n",(0,r.jsx)(n.li,{children:"\u68c0\u67e5\u670d\u52a1\u662f\u5426\u8ba2\u9605\u5230\u6b63\u786e\u7684 topic/exchange"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"\u6d88\u606f\u5ef6\u8fdf",children:"\u6d88\u606f\u5ef6\u8fdf"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u89e3\u51b3\u65b9\u6848"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"spring:\n  rabbitmq:\n    listener:\n      simple:\n        prefetch: 1\n        concurrency: 5\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\u76f8\u5173\u6587\u6863"}),"\uff1a"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/springcloud/config",children:"Config \u914d\u7f6e\u4e2d\u5fc3"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/docs/springcloud/quick-reference",children:"\u5feb\u901f\u53c2\u8003"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}}}]);