"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[46705],{48885:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>a});var s=t(99378);const i={},r=s.createContext(i);function l(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(r.Provider,{value:n},e.children)}},71830:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"frontend/advanced/performance","title":"\u6027\u80fd\u4f18\u5316","description":"[!TIP]","source":"@site/docs/frontend/advanced/performance.md","sourceDirName":"frontend/advanced","slug":"/frontend/advanced/performance","permalink":"/docs/frontend/advanced/performance","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/frontend/advanced/performance.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"\u6027\u80fd\u4f18\u5316"},"sidebar":"frontend","previous":{"title":"\u8c03\u8bd5\u6280\u5de7","permalink":"/docs/frontend/browser/debugging"},"next":{"title":"\u524d\u7aef\u5b89\u5168","permalink":"/docs/frontend/advanced/security"}}');var i=t(22714),r=t(48885);const l={sidebar_position:1,title:"\u6027\u80fd\u4f18\u5316"},a="\u524d\u7aef\u6027\u80fd\u4f18\u5316",c={},d=[{value:"\ud83d\udcca \u6838\u5fc3\u6027\u80fd\u6307\u6807 (Core Web Vitals)",id:"-\u6838\u5fc3\u6027\u80fd\u6307\u6807-core-web-vitals",level:2},{value:"\u6d4b\u91cf\u5de5\u5177",id:"\u6d4b\u91cf\u5de5\u5177",level:3},{value:"\u26a1 \u52a0\u8f7d\u4f18\u5316",id:"-\u52a0\u8f7d\u4f18\u5316",level:2},{value:"\u8d44\u6e90\u538b\u7f29",id:"\u8d44\u6e90\u538b\u7f29",level:3},{value:"\u4ee3\u7801\u5206\u5272",id:"\u4ee3\u7801\u5206\u5272",level:3},{value:"\u8d44\u6e90\u9884\u52a0\u8f7d",id:"\u8d44\u6e90\u9884\u52a0\u8f7d",level:3},{value:"\u5ef6\u8fdf\u52a0\u8f7d",id:"\u5ef6\u8fdf\u52a0\u8f7d",level:3},{value:"\ud83c\udfa8 \u6e32\u67d3\u4f18\u5316",id:"-\u6e32\u67d3\u4f18\u5316",level:2},{value:"\u907f\u514d\u5f3a\u5236\u540c\u6b65\u5e03\u5c40",id:"\u907f\u514d\u5f3a\u5236\u540c\u6b65\u5e03\u5c40",level:3},{value:"\u4f7f\u7528 transform \u548c opacity",id:"\u4f7f\u7528-transform-\u548c-opacity",level:3},{value:"\u865a\u62df\u5217\u8868",id:"\u865a\u62df\u5217\u8868",level:3},{value:"\ud83d\udce6 \u7f13\u5b58\u7b56\u7565",id:"-\u7f13\u5b58\u7b56\u7565",level:2},{value:"HTTP \u7f13\u5b58",id:"http-\u7f13\u5b58",level:3},{value:"Service Worker",id:"service-worker",level:3},{value:"\ud83d\uddbc\ufe0f \u56fe\u7247\u4f18\u5316",id:"\ufe0f-\u56fe\u7247\u4f18\u5316",level:2},{value:"\u73b0\u4ee3\u683c\u5f0f",id:"\u73b0\u4ee3\u683c\u5f0f",level:3},{value:"\u54cd\u5e94\u5f0f\u56fe\u7247",id:"\u54cd\u5e94\u5f0f\u56fe\u7247",level:3},{value:"\u2699\ufe0f JavaScript \u4f18\u5316",id:"\ufe0f-javascript-\u4f18\u5316",level:2},{value:"\u9632\u6296\u548c\u8282\u6d41",id:"\u9632\u6296\u548c\u8282\u6d41",level:3},{value:"Web Worker",id:"web-worker",level:3},{value:"\ud83d\udca1 \u68c0\u67e5\u6e05\u5355",id:"-\u68c0\u67e5\u6e05\u5355",level:2},{value:"\ud83d\udd17 \u76f8\u5173\u8d44\u6e90",id:"-\u76f8\u5173\u8d44\u6e90",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"\u524d\u7aef\u6027\u80fd\u4f18\u5316",children:"\u524d\u7aef\u6027\u80fd\u4f18\u5316"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"[!TIP]\n\u6027\u80fd\u4f18\u5316\u76f4\u63a5\u5f71\u54cd\u7528\u6237\u4f53\u9a8c\u548c\u4e1a\u52a1\u6307\u6807\u3002\u9875\u9762\u52a0\u8f7d\u6bcf\u6162 1 \u79d2\uff0c\u8f6c\u5316\u7387\u53ef\u80fd\u4e0b\u964d 7%\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-\u6838\u5fc3\u6027\u80fd\u6307\u6807-core-web-vitals",children:"\ud83d\udcca \u6838\u5fc3\u6027\u80fd\u6307\u6807 (Core Web Vitals)"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u6307\u6807"}),(0,i.jsx)(n.th,{children:"\u542b\u4e49"}),(0,i.jsx)(n.th,{children:"\u76ee\u6807"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"LCP"})}),(0,i.jsx)(n.td,{children:"\u6700\u5927\u5185\u5bb9\u7ed8\u5236\u65f6\u95f4"}),(0,i.jsx)(n.td,{children:"< 2.5s"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"FID"})}),(0,i.jsx)(n.td,{children:"\u9996\u6b21\u8f93\u5165\u5ef6\u8fdf"}),(0,i.jsx)(n.td,{children:"< 100ms"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"CLS"})}),(0,i.jsx)(n.td,{children:"\u7d2f\u79ef\u5e03\u5c40\u504f\u79fb"}),(0,i.jsx)(n.td,{children:"< 0.1"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"\u6d4b\u91cf\u5de5\u5177",children:"\u6d4b\u91cf\u5de5\u5177"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Chrome DevTools Performance"}),"\n",(0,i.jsx)(n.li,{children:"Lighthouse"}),"\n",(0,i.jsx)(n.li,{children:"WebPageTest"}),"\n",(0,i.jsx)(n.li,{children:"web.dev/measure"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-\u52a0\u8f7d\u4f18\u5316",children:"\u26a1 \u52a0\u8f7d\u4f18\u5316"}),"\n",(0,i.jsx)(n.h3,{id:"\u8d44\u6e90\u538b\u7f29",children:"\u8d44\u6e90\u538b\u7f29"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# \u56fe\u7247\u538b\u7f29\nnpx imagemin src/images/* --out-dir=dist/images\n\n# JS/CSS \u538b\u7f29\uff08\u6784\u5efa\u5de5\u5177\u81ea\u52a8\u5904\u7406\uff09\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u4ee3\u7801\u5206\u5272",children:"\u4ee3\u7801\u5206\u5272"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// React \u52a8\u6001\u5bfc\u5165\nconst HeavyComponent = React.lazy(() => import("./HeavyComponent"));\n\n// \u8def\u7531\u7ea7\u5206\u5272\nconst routes = [\n  {\n    path: "/dashboard",\n    component: () => import("./pages/Dashboard"),\n  },\n];\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u8d44\u6e90\u9884\u52a0\u8f7d",children:"\u8d44\u6e90\u9884\u52a0\u8f7d"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'\x3c!-- \u9884\u52a0\u8f7d\u5173\u952e\u8d44\u6e90 --\x3e\n<link rel="preload" href="font.woff2" as="font" crossorigin />\n<link rel="preload" href="hero.jpg" as="image" />\n\n\x3c!-- \u9884\u8fde\u63a5\u7b2c\u4e09\u65b9\u57df\u540d --\x3e\n<link rel="preconnect" href="https://api.example.com" />\n<link rel="dns-prefetch" href="https://cdn.example.com" />\n\n\x3c!-- \u9884\u83b7\u53d6\u4e0b\u4e00\u9875 --\x3e\n<link rel="prefetch" href="/next-page.js" />\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u5ef6\u8fdf\u52a0\u8f7d",children:"\u5ef6\u8fdf\u52a0\u8f7d"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'\x3c!-- \u56fe\u7247\u61d2\u52a0\u8f7d --\x3e\n<img\n  src="placeholder.jpg"\n  data-src="real-image.jpg"\n  loading="lazy"\n  alt="\u63cf\u8ff0"\n/>\n\n\x3c!-- \u4f7f\u7528 Intersection Observer --\x3e\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'const observer = new IntersectionObserver((entries) => {\n  entries.forEach((entry) => {\n    if (entry.isIntersecting) {\n      const img = entry.target;\n      img.src = img.dataset.src;\n      observer.unobserve(img);\n    }\n  });\n});\n\ndocument.querySelectorAll("img[data-src]").forEach((img) => {\n  observer.observe(img);\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"-\u6e32\u67d3\u4f18\u5316",children:"\ud83c\udfa8 \u6e32\u67d3\u4f18\u5316"}),"\n",(0,i.jsx)(n.h3,{id:"\u907f\u514d\u5f3a\u5236\u540c\u6b65\u5e03\u5c40",children:"\u907f\u514d\u5f3a\u5236\u540c\u6b65\u5e03\u5c40"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// \u274c \u5f3a\u5236\u540c\u6b65\u5e03\u5c40\nelements.forEach((el) => {\n  el.style.width = container.offsetWidth + "px";\n});\n\n// \u2705 \u5148\u8bfb\u540e\u5199\nconst width = container.offsetWidth;\nelements.forEach((el) => {\n  el.style.width = width + "px";\n});\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u4f7f\u7528-transform-\u548c-opacity",children:"\u4f7f\u7528 transform \u548c opacity"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",children:"/* \u274c \u89e6\u53d1\u91cd\u6392 */\n.animate {\n  left: 100px;\n  top: 100px;\n}\n\n/* \u2705 \u53ea\u89e6\u53d1\u5408\u6210 */\n.animate {\n  transform: translate(100px, 100px);\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u865a\u62df\u5217\u8868",children:"\u865a\u62df\u5217\u8868"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// \u53ea\u6e32\u67d3\u53ef\u89c1\u533a\u57df\u7684\u5217\u8868\u9879\nfunction VirtualList({ items, itemHeight, containerHeight }) {\n  const [scrollTop, setScrollTop] = useState(0);\n\n  const startIndex = Math.floor(scrollTop / itemHeight);\n  const endIndex = Math.min(\n    startIndex + Math.ceil(containerHeight / itemHeight) + 1,\n    items.length\n  );\n\n  const visibleItems = items.slice(startIndex, endIndex);\n\n  return (\n    <div\n      style={{ height: containerHeight, overflow: "auto" }}\n      onScroll={(e) => setScrollTop(e.target.scrollTop)}\n    >\n      <div style={{ height: items.length * itemHeight }}>\n        <div style={{ transform: `translateY(${startIndex * itemHeight}px)` }}>\n          {visibleItems.map((item) => (\n            <div key={item.id} style={{ height: itemHeight }}>\n              {item.content}\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"-\u7f13\u5b58\u7b56\u7565",children:"\ud83d\udce6 \u7f13\u5b58\u7b56\u7565"}),"\n",(0,i.jsx)(n.h3,{id:"http-\u7f13\u5b58",children:"HTTP \u7f13\u5b58"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"# \u9759\u6001\u8d44\u6e90 - \u957f\u671f\u7f13\u5b58 + hash\nCache-Control: max-age=31536000\n\n# HTML - \u9700\u8981\u9a8c\u8bc1\nCache-Control: no-cache\n\n# API - \u77ed\u671f\u7f13\u5b58\nCache-Control: max-age=60\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-worker",children:"Service Worker"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// \u5b89\u88c5\u65f6\u7f13\u5b58\u9759\u6001\u8d44\u6e90\nself.addEventListener("install", (event) => {\n  event.waitUntil(\n    caches.open("v1").then((cache) => {\n      return cache.addAll(["/", "/styles.css", "/app.js"]);\n    })\n  );\n});\n\n// \u8bf7\u6c42\u65f6\u4f18\u5148\u4f7f\u7528\u7f13\u5b58\nself.addEventListener("fetch", (event) => {\n  event.respondWith(\n    caches.match(event.request).then((response) => {\n      return response || fetch(event.request);\n    })\n  );\n});\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-\u56fe\u7247\u4f18\u5316",children:"\ud83d\uddbc\ufe0f \u56fe\u7247\u4f18\u5316"}),"\n",(0,i.jsx)(n.h3,{id:"\u73b0\u4ee3\u683c\u5f0f",children:"\u73b0\u4ee3\u683c\u5f0f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<picture>\n  <source srcset="image.avif" type="image/avif" />\n  <source srcset="image.webp" type="image/webp" />\n  <img src="image.jpg" alt="\u63cf\u8ff0" />\n</picture>\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u54cd\u5e94\u5f0f\u56fe\u7247",children:"\u54cd\u5e94\u5f0f\u56fe\u7247"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<img\n  srcset="small.jpg 300w, medium.jpg 600w, large.jpg 1200w"\n  sizes="(max-width: 600px) 300px,\n         (max-width: 1200px) 600px,\n         1200px"\n  src="medium.jpg"\n  alt="\u63cf\u8ff0"\n/>\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-javascript-\u4f18\u5316",children:"\u2699\ufe0f JavaScript \u4f18\u5316"}),"\n",(0,i.jsx)(n.h3,{id:"\u9632\u6296\u548c\u8282\u6d41",children:"\u9632\u6296\u548c\u8282\u6d41"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// \u9632\u6296 - \u505c\u6b62\u89e6\u53d1\u540e\u6267\u884c\nfunction debounce(fn, delay) {\n  let timer;\n  return function (...args) {\n    clearTimeout(timer);\n    timer = setTimeout(() => fn.apply(this, args), delay);\n  };\n}\n\n// \u8282\u6d41 - \u56fa\u5b9a\u9891\u7387\u6267\u884c\nfunction throttle(fn, limit) {\n  let inThrottle;\n  return function (...args) {\n    if (!inThrottle) {\n      fn.apply(this, args);\n      inThrottle = true;\n      setTimeout(() => (inThrottle = false), limit);\n    }\n  };\n}\n\n// \u4f7f\u7528\nwindow.addEventListener("scroll", throttle(handleScroll, 100));\ninput.addEventListener("input", debounce(search, 300));\n'})}),"\n",(0,i.jsx)(n.h3,{id:"web-worker",children:"Web Worker"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// main.js\nconst worker = new Worker("worker.js");\n\nworker.postMessage({ data: largeArray });\n\nworker.onmessage = (e) => {\n  console.log("Result:", e.data);\n};\n\n// worker.js\nself.onmessage = (e) => {\n  const result = heavyComputation(e.data);\n  self.postMessage(result);\n};\n'})}),"\n",(0,i.jsx)(n.h2,{id:"-\u68c0\u67e5\u6e05\u5355",children:"\ud83d\udca1 \u68c0\u67e5\u6e05\u5355"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," \u542f\u7528 Gzip/Brotli \u538b\u7f29"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," \u4f7f\u7528 CDN \u5206\u53d1\u9759\u6001\u8d44\u6e90"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," \u56fe\u7247\u4f7f\u7528 WebP/AVIF \u683c\u5f0f"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," \u5b9e\u73b0\u4ee3\u7801\u5206\u5272"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," \u5173\u952e CSS \u5185\u8054"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," \u5ef6\u8fdf\u52a0\u8f7d\u975e\u5173\u952e\u8d44\u6e90"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," \u4f7f\u7528 HTTP/2"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," \u914d\u7f6e\u5408\u9002\u7684\u7f13\u5b58\u7b56\u7565"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," \u79fb\u9664\u672a\u4f7f\u7528\u7684 CSS/JS"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," \u4f18\u5316 Web Fonts"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"-\u76f8\u5173\u8d44\u6e90",children:"\ud83d\udd17 \u76f8\u5173\u8d44\u6e90"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/frontend/browser/",children:"\u6d4f\u89c8\u5668\u539f\u7406"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"/docs/frontend/css/animation",children:"CSS \u52a8\u753b"})}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u4e0b\u4e00\u6b65"}),"\uff1a\u5b66\u4e60 ",(0,i.jsx)(n.a,{href:"/docs/frontend/advanced/security",children:"\u524d\u7aef\u5b89\u5168"})," \u4fdd\u62a4\u5e94\u7528\u5b89\u5168\u3002"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);