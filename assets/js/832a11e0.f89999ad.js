"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[7874],{48885:(n,e,s)=>{s.d(e,{R:()=>r,x:()=>o});var l=s(99378);const d={},i=l.createContext(d);function r(n){const e=l.useContext(i);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:r(n.components),l.createElement(i.Provider,{value:e},n.children)}},67856:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>t});const l=JSON.parse('{"id":"linux/troubleshooting","title":"\u6545\u969c\u6392\u67e5","description":"\u6545\u969c\u6392\u67e5\u662f\u7cfb\u7edf\u8fd0\u7ef4\u7684\u6838\u5fc3\u6280\u80fd\uff0c\u672c\u6587\u4ecb\u7ecd\u5e38\u89c1\u95ee\u9898\u7684\u8bca\u65ad\u548c\u89e3\u51b3\u65b9\u6cd5\u3002","source":"@site/docs/linux/troubleshooting.md","sourceDirName":"linux","slug":"/linux/troubleshooting","permalink":"/docs/linux/troubleshooting","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/linux/troubleshooting.md","tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"sidebar_position":16,"title":"\u6545\u969c\u6392\u67e5"},"sidebar":"linux","previous":{"title":"\u6027\u80fd\u4f18\u5316","permalink":"/docs/linux/performance-tuning"},"next":{"title":"\u5feb\u901f\u53c2\u8003","permalink":"/docs/linux/quick-reference"}}');var d=s(22714),i=s(48885);const r={sidebar_position:16,title:"\u6545\u969c\u6392\u67e5"},o="Linux \u6545\u969c\u6392\u67e5",a={},t=[{value:"\u6392\u67e5\u65b9\u6cd5\u8bba",id:"\u6392\u67e5\u65b9\u6cd5\u8bba",level:2},{value:"\u6545\u969c\u6392\u67e5\u6d41\u7a0b",id:"\u6545\u969c\u6392\u67e5\u6d41\u7a0b",level:3},{value:"\u57fa\u672c\u539f\u5219",id:"\u57fa\u672c\u539f\u5219",level:3},{value:"\u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8",id:"\u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8",level:2},{value:"GRUB \u95ee\u9898",id:"grub-\u95ee\u9898",level:3},{value:"\u6587\u4ef6\u7cfb\u7edf\u9519\u8bef",id:"\u6587\u4ef6\u7cfb\u7edf\u9519\u8bef",level:3},{value:"\u5185\u6838 Panic",id:"\u5185\u6838-panic",level:3},{value:"\u65e0\u6cd5\u767b\u5f55",id:"\u65e0\u6cd5\u767b\u5f55",level:2},{value:"\u5fd8\u8bb0\u5bc6\u7801",id:"\u5fd8\u8bb0\u5bc6\u7801",level:3},{value:"SSH \u8fde\u63a5\u5931\u8d25",id:"ssh-\u8fde\u63a5\u5931\u8d25",level:3},{value:"\u8d26\u6237\u9501\u5b9a",id:"\u8d26\u6237\u9501\u5b9a",level:3},{value:"\u6027\u80fd\u95ee\u9898",id:"\u6027\u80fd\u95ee\u9898",level:2},{value:"CPU 100%",id:"cpu-100",level:3},{value:"\u5185\u5b58\u4e0d\u8db3",id:"\u5185\u5b58\u4e0d\u8db3",level:3},{value:"\u78c1\u76d8\u7a7a\u95f4\u6ee1",id:"\u78c1\u76d8\u7a7a\u95f4\u6ee1",level:3},{value:"\u9ad8\u8d1f\u8f7d",id:"\u9ad8\u8d1f\u8f7d",level:3},{value:"\u7f51\u7edc\u95ee\u9898",id:"\u7f51\u7edc\u95ee\u9898",level:2},{value:"\u7f51\u7edc\u4e0d\u901a",id:"\u7f51\u7edc\u4e0d\u901a",level:3},{value:"\u7aef\u53e3\u95ee\u9898",id:"\u7aef\u53e3\u95ee\u9898",level:3},{value:"DNS \u95ee\u9898",id:"dns-\u95ee\u9898",level:3},{value:"\u670d\u52a1\u95ee\u9898",id:"\u670d\u52a1\u95ee\u9898",level:2},{value:"\u670d\u52a1\u65e0\u6cd5\u542f\u52a8",id:"\u670d\u52a1\u65e0\u6cd5\u542f\u52a8",level:3},{value:"\u670d\u52a1\u9891\u7e41\u91cd\u542f",id:"\u670d\u52a1\u9891\u7e41\u91cd\u542f",level:3},{value:"\u5e94\u7528\u95ee\u9898",id:"\u5e94\u7528\u95ee\u9898",level:2},{value:"\u5e94\u7528\u5d29\u6e83",id:"\u5e94\u7528\u5d29\u6e83",level:3},{value:"\u6570\u636e\u5e93\u95ee\u9898",id:"\u6570\u636e\u5e93\u95ee\u9898",level:3},{value:"\u6587\u4ef6\u7cfb\u7edf\u95ee\u9898",id:"\u6587\u4ef6\u7cfb\u7edf\u95ee\u9898",level:2},{value:"\u6587\u4ef6\u635f\u574f",id:"\u6587\u4ef6\u635f\u574f",level:3},{value:"inode \u8017\u5c3d",id:"inode-\u8017\u5c3d",level:3},{value:"\u65e5\u5fd7\u5206\u6790",id:"\u65e5\u5fd7\u5206\u6790",level:2},{value:"\u67e5\u627e\u9519\u8bef",id:"\u67e5\u627e\u9519\u8bef",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function c(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.header,{children:(0,d.jsx)(e.h1,{id:"linux-\u6545\u969c\u6392\u67e5",children:"Linux \u6545\u969c\u6392\u67e5"})}),"\n",(0,d.jsx)(e.p,{children:"\u6545\u969c\u6392\u67e5\u662f\u7cfb\u7edf\u8fd0\u7ef4\u7684\u6838\u5fc3\u6280\u80fd\uff0c\u672c\u6587\u4ecb\u7ecd\u5e38\u89c1\u95ee\u9898\u7684\u8bca\u65ad\u548c\u89e3\u51b3\u65b9\u6cd5\u3002"}),"\n",(0,d.jsx)(e.h2,{id:"\u6392\u67e5\u65b9\u6cd5\u8bba",children:"\u6392\u67e5\u65b9\u6cd5\u8bba"}),"\n",(0,d.jsx)(e.h3,{id:"\u6545\u969c\u6392\u67e5\u6d41\u7a0b",children:"\u6545\u969c\u6392\u67e5\u6d41\u7a0b"}),"\n",(0,d.jsx)(e.mermaid,{value:"graph TD\n    A[\u53d1\u73b0\u95ee\u9898] --\x3e B[\u6536\u96c6\u4fe1\u606f]\n    B --\x3e C[\u5206\u6790\u539f\u56e0]\n    C --\x3e D[\u5236\u5b9a\u65b9\u6848]\n    D --\x3e E[\u5b9e\u65bd\u4fee\u590d]\n    E --\x3e F[\u9a8c\u8bc1\u7ed3\u679c]\n    F --\x3e G[\u8bb0\u5f55\u6587\u6863]"}),"\n",(0,d.jsx)(e.h3,{id:"\u57fa\u672c\u539f\u5219",children:"\u57fa\u672c\u539f\u5219"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:"\u91cd\u73b0\u95ee\u9898"})," - \u786e\u4fdd\u80fd\u7a33\u5b9a\u91cd\u73b0"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:"\u6536\u96c6\u65e5\u5fd7"})," - \u67e5\u770b\u6240\u6709\u76f8\u5173\u65e5\u5fd7"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:"\u9010\u6b65\u6392\u67e5"})," - \u4ece\u7b80\u5355\u5230\u590d\u6742"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:"\u505a\u597d\u5907\u4efd"})," - \u4fee\u6539\u524d\u5907\u4efd"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:"\u8bb0\u5f55\u8fc7\u7a0b"})," - \u6587\u6863\u5316\u6240\u6709\u6b65\u9aa4"]}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"\u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8",children:"\u7cfb\u7edf\u65e0\u6cd5\u542f\u52a8"}),"\n",(0,d.jsx)(e.h3,{id:"grub-\u95ee\u9898",children:"GRUB \u95ee\u9898"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u75c7\u72b6\uff1a\u542f\u52a8\u65f6\u5361\u5728 GRUB\n\n# \u89e3\u51b3\u65b9\u68481\uff1a\u8fdb\u5165 GRUB \u547d\u4ee4\u884c\n# \u6309 'c' \u8fdb\u5165\u547d\u4ee4\u884c\u6a21\u5f0f\ngrub> ls                      # \u5217\u51fa\u5206\u533a\ngrub> ls (hd0,1)/             # \u67e5\u770b\u5206\u533a\u5185\u5bb9\ngrub> set root=(hd0,1)        # \u8bbe\u7f6e\u6839\u5206\u533a\ngrub> linux /vmlinuz root=/dev/sda1\ngrub> initrd /initrd.img\ngrub> boot\n\n# \u89e3\u51b3\u65b9\u68482\uff1a\u4ece Live CD \u4fee\u590d\n# \u542f\u52a8 Live CD\nsudo mount /dev/sda1 /mnt\nsudo mount --bind /dev /mnt/dev\nsudo mount --bind /proc /mnt/proc\nsudo mount --bind /sys /mnt/sys\nsudo chroot /mnt\ngrub-install /dev/sda\nupdate-grub\nexit\nsudo reboot\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u6587\u4ef6\u7cfb\u7edf\u9519\u8bef",children:"\u6587\u4ef6\u7cfb\u7edf\u9519\u8bef"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u75c7\u72b6\uff1a\u63d0\u793a\u6587\u4ef6\u7cfb\u7edf\u53ea\u8bfb\u6216\u635f\u574f\n\n# \u5355\u7528\u6237\u6a21\u5f0f\u68c0\u67e5\n# \u542f\u52a8\u65f6\u6309 'e'\uff0c\u5728 linux \u884c\u672b\u6dfb\u52a0\uff1a\nsingle\n\n# \u6216\nsystemd.unit=rescue.target\n\n# \u68c0\u67e5\u6587\u4ef6\u7cfb\u7edf\uff08\u9700\u5148\u5378\u8f7d\uff09\nsudo fsck -y /dev/sda1\n\n# \u5f3a\u5236\u68c0\u67e5\nsudo fsck -f /dev/sda1\n\n# \u6062\u590d\u8d85\u7ea7\u5757\nsudo e2fsck -b 32768 /dev/sda1\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u5185\u6838-panic",children:"\u5185\u6838 Panic"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:'# \u75c7\u72b6\uff1a\u7cfb\u7edf\u5d29\u6e83\uff0c\u663e\u793a kernel panic\n\n# \u67e5\u770b\u5d29\u6e83\u65e5\u5fd7\ndmesg | grep -i panic\njournalctl -k\n\n# \u542f\u52a8\u65f6\u9009\u62e9\u65e7\u5185\u6838\n# \u5728 GRUB \u83dc\u5355\u9009\u62e9 "Advanced options"\n\n# \u79fb\u9664\u95ee\u9898\u5185\u6838\nsudo apt remove linux-image-x.x.x\n'})}),"\n",(0,d.jsx)(e.h2,{id:"\u65e0\u6cd5\u767b\u5f55",children:"\u65e0\u6cd5\u767b\u5f55"}),"\n",(0,d.jsx)(e.h3,{id:"\u5fd8\u8bb0\u5bc6\u7801",children:"\u5fd8\u8bb0\u5bc6\u7801"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u5355\u7528\u6237\u6a21\u5f0f\u91cd\u7f6e\u5bc6\u7801\n# 1. \u542f\u52a8\u65f6\u6309 'e' \u7f16\u8f91 GRUB\n# 2. \u627e\u5230 linux \u5f00\u5934\u7684\u884c\uff0c\u5728\u672b\u5c3e\u6dfb\u52a0\uff1a\ninit=/bin/bash\n\n# 3. \u6309 Ctrl+X \u6216 F10 \u542f\u52a8\n\n# 4. \u91cd\u65b0\u6302\u8f7d\u6839\u5206\u533a\u4e3a\u8bfb\u5199\nmount -o remount,rw /\n\n# 5. \u91cd\u7f6e\u5bc6\u7801\npasswd username\n\n# 6. \u91cd\u542f\nexec /sbin/init\n"})}),"\n",(0,d.jsx)(e.h3,{id:"ssh-\u8fde\u63a5\u5931\u8d25",children:"SSH \u8fde\u63a5\u5931\u8d25"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5 SSH \u670d\u52a1\nsudo systemctl status sshd\n\n# \u67e5\u770b SSH \u65e5\u5fd7\nsudo tail -f /var/log/auth.log\njournalctl -u sshd -f\n\n# \u68c0\u67e5\u7aef\u53e3\nsudo ss -tuln | grep 22\n\n# \u68c0\u67e5\u9632\u706b\u5899\nsudo ufw status\nsudo iptables -L -n | grep 22\n\n# \u6d4b\u8bd5\u7f51\u7edc\u8fde\u63a5\nping server\ntelnet server 22\n\n# \u6743\u9650\u95ee\u9898\nchmod 700 ~/.ssh\nchmod 600 ~/.ssh/authorized_keys\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u8d26\u6237\u9501\u5b9a",children:"\u8d26\u6237\u9501\u5b9a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b\u8d26\u6237\u72b6\u6001\nsudo passwd -S username\n\n# \u89e3\u9501\u8d26\u6237\nsudo passwd -u username\nsudo usermod -U username\n\n# \u67e5\u770b\u5931\u8d25\u767b\u5f55\nsudo lastb\n\n# \u68c0\u67e5 PAM \u914d\u7f6e\nsudo cat /etc/pam.d/common-auth\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u6027\u80fd\u95ee\u9898",children:"\u6027\u80fd\u95ee\u9898"}),"\n",(0,d.jsx)(e.h3,{id:"cpu-100",children:"CPU 100%"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u627e CPU \u5360\u7528\u9ad8\u7684\u8fdb\u7a0b\ntop\nhtop\nps aux --sort=-%cpu | head\n\n# \u67e5\u770b\u8fdb\u7a0b\u8be6\u60c5\nps -p PID -o %cpu,%mem,cmd\n\n# \u67e5\u770b\u7ebf\u7a0b\ntop -H -p PID\nps -Lf -p PID\n\n# \u8ffd\u8e2a\u7cfb\u7edf\u8c03\u7528\nstrace -p PID\n\n# \u751f\u6210\u8fdb\u7a0b\u5806\u6808\nsudo gdb -p PID\n(gdb) thread apply all bt\n(gdb) quit\n\n# kill \u5360\u7528 CPU \u7684\u8fdb\u7a0b\nkill -15 PID\nkill -9 PID    # \u5f3a\u5236\u7ec8\u6b62\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u5185\u5b58\u4e0d\u8db3",children:"\u5185\u5b58\u4e0d\u8db3"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b\u5185\u5b58\u4f7f\u7528\nfree -h\ntop\nhtop\n\n# \u67e5\u770b\u5185\u5b58\u5360\u7528\u8fdb\u7a0b\nps aux --sort=-%mem | head\n\n# \u67e5\u770b\u8be6\u7ec6\u5185\u5b58\u4fe1\u606f\ncat /proc/meminfo\n\n# \u67e5\u770b OOM\uff08Out of Memory\uff09\u65e5\u5fd7\ndmesg | grep -i oom\njournalctl | grep -i oom\n\n# \u6e05\u7406\u7f13\u5b58\nsync\necho 3 | sudo tee /proc/sys/vm/drop_caches\n\n# \u589e\u52a0 swap\nsudo fallocate -l 2G /swapfile\nsudo chmod 600 /swapfile\nsudo mkswap /swapfile\nsudo swapon /swapfile\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u78c1\u76d8\u7a7a\u95f4\u6ee1",children:"\u78c1\u76d8\u7a7a\u95f4\u6ee1"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:'# \u67e5\u770b\u78c1\u76d8\u4f7f\u7528\ndf -h\ndf -i          # inode \u4f7f\u7528\u60c5\u51b5\n\n# \u67e5\u627e\u5927\u6587\u4ef6\nsudo find / -type f -size +100M 2>/dev/null\nsudo du -sh /* | sort -rh | head\n\n# \u67e5\u627e\u5927\u76ee\u5f55\nsudo du -h --max-depth=1 / | sort -rh | head\n\n# \u6e05\u7406\u7a7a\u95f4\n# 1. \u6e05\u7406\u5305\u7f13\u5b58\nsudo apt clean\nsudo apt autoclean\n\n# 2. \u6e05\u7406\u65e5\u5fd7\nsudo journalctl --vacuum-time=7d\nsudo find /var/log -type f -name "*.log" -mtime +30 -delete\n\n# 3. \u6e05\u7406\u4e34\u65f6\u6587\u4ef6\nsudo rm -rf /tmp/*\nsudo rm -rf /var/tmp/*\n\n# 4. \u5220\u9664\u65e7\u5185\u6838\ndpkg --list | grep linux-image\nsudo apt autoremove\n\n# 5. \u67e5\u627e\u5220\u9664\u7684\u4f46\u4ecd\u5360\u7528\u7a7a\u95f4\u7684\u6587\u4ef6\nsudo lsof | grep deleted\n'})}),"\n",(0,d.jsx)(e.h3,{id:"\u9ad8\u8d1f\u8f7d",children:"\u9ad8\u8d1f\u8f7d"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b\u8d1f\u8f7d\nuptime\nw\ntop\n\n# \u67e5\u770b\u7b49\u5f85 IO \u7684\u8fdb\u7a0b\ntop\n# \u67e5\u770b wa\uff08IO wait\uff09\u5217\n\n# IO \u7edf\u8ba1\niostat -x 1\niotop\n\n# \u67e5\u627e\u5bfc\u81f4\u9ad8\u8d1f\u8f7d\u7684\u8fdb\u7a0b\nps aux | awk '$3 > 50'    # CPU > 50%\nps aux --sort=-%cpu | head\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u7f51\u7edc\u95ee\u9898",children:"\u7f51\u7edc\u95ee\u9898"}),"\n",(0,d.jsx)(e.h3,{id:"\u7f51\u7edc\u4e0d\u901a",children:"\u7f51\u7edc\u4e0d\u901a"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5\u7f51\u7edc\u63a5\u53e3\nip addr\nifconfig\n\n# \u68c0\u67e5\u7f51\u7edc\u63a5\u53e3\u72b6\u6001\nip link\nip link set eth0 up\n\n# \u68c0\u67e5\u8def\u7531\nip route\nroute -n\n\n# \u6d4b\u8bd5\u7f51\u5173\nping 192.168.1.1\n\n# \u6d4b\u8bd5 DNS\nping 8.8.8.8\nnslookup google.com\ndig google.com\n\n# \u68c0\u67e5 DNS \u914d\u7f6e\ncat /etc/resolv.conf\n\n# \u8ffd\u8e2a\u8def\u7531\ntraceroute google.com\nmtr google.com\n\n# \u68c0\u67e5\u9632\u706b\u5899\nsudo iptables -L -n\nsudo ufw status\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u7aef\u53e3\u95ee\u9898",children:"\u7aef\u53e3\u95ee\u9898"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5\u7aef\u53e3\u76d1\u542c\nsudo ss -tuln\nsudo netstat -tuln\n\n# \u68c0\u67e5\u7aef\u53e3\u5360\u7528\nsudo lsof -i :80\nsudo fuser 80/tcp\n\n# \u6d4b\u8bd5\u7aef\u53e3\u8fde\u63a5\ntelnet server 80\nnc -zv server 80\n\n# \u626b\u63cf\u7aef\u53e3\nnmap server\n"})}),"\n",(0,d.jsx)(e.h3,{id:"dns-\u95ee\u9898",children:"DNS \u95ee\u9898"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u6d4b\u8bd5 DNS \u89e3\u6790\nnslookup google.com\ndig google.com\nhost google.com\n\n# \u6307\u5b9a DNS \u670d\u52a1\u5668\u6d4b\u8bd5\nnslookup google.com 8.8.8.8\ndig @8.8.8.8 google.com\n\n# \u6e05\u9664 DNS \u7f13\u5b58\nsudo systemd-resolve --flush-caches\nsudo /etc/init.d/nscd restart\n\n# \u68c0\u67e5 DNS \u914d\u7f6e\ncat /etc/resolv.conf\ncat /etc/nsswitch.conf\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u670d\u52a1\u95ee\u9898",children:"\u670d\u52a1\u95ee\u9898"}),"\n",(0,d.jsx)(e.h3,{id:"\u670d\u52a1\u65e0\u6cd5\u542f\u52a8",children:"\u670d\u52a1\u65e0\u6cd5\u542f\u52a8"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b\u670d\u52a1\u72b6\u6001\nsudo systemctl status service_name\n\n# \u67e5\u770b\u8be6\u7ec6\u65e5\u5fd7\njournalctl -u service_name -n 50\njournalctl -u service_name -f\n\n# \u67e5\u770b\u670d\u52a1\u914d\u7f6e\nsystemctl cat service_name\n\n# \u68c0\u67e5\u914d\u7f6e\u6587\u4ef6\u8bed\u6cd5\n# Nginx\nsudo nginx -t\n\n# Apache\nsudo apache2ctl configtest\n\n# \u67e5\u770b\u4f9d\u8d56\nsystemctl list-dependencies service_name\n\n# \u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\nsudo systemctl daemon-reload\n"})}),"\n",(0,d.jsx)(e.h3,{id:"\u670d\u52a1\u9891\u7e41\u91cd\u542f",children:"\u670d\u52a1\u9891\u7e41\u91cd\u542f"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b\u91cd\u542f\u65e5\u5fd7\njournalctl -u service_name | grep -i restart\n\n# \u67e5\u770b\u670d\u52a1\u914d\u7f6e\nsystemctl cat service_name\n\n# \u68c0\u67e5\u91cd\u542f\u7b56\u7565\nRestart=on-failure\nRestartSec=5s\n\n# \u7981\u7528\u81ea\u52a8\u91cd\u542f\u8fdb\u884c\u8c03\u8bd5\nsudo systemctl edit service_name\n[Service]\nRestart=no\n\n# \u624b\u52a8\u8fd0\u884c\u670d\u52a1\u67e5\u770b\u9519\u8bef\n/path/to/service --debug\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u5e94\u7528\u95ee\u9898",children:"\u5e94\u7528\u95ee\u9898"}),"\n",(0,d.jsx)(e.h3,{id:"\u5e94\u7528\u5d29\u6e83",children:"\u5e94\u7528\u5d29\u6e83"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:'# \u67e5\u770b\u5d29\u6e83\u65e5\u5fd7\ndmesg | tail\njournalctl -xe\n\n# \u67e5\u770b\u5e94\u7528\u65e5\u5fd7\ntail -f /var/log/app.log\n\n# \u751f\u6210 core dump\nulimit -c unlimited\necho "/tmp/core.%e.%p" | sudo tee /proc/sys/kernel/core_pattern\n\n# \u5206\u6790 core dump\ngdb /path/to/binary /tmp/core.xxx\n\n# \u8ffd\u8e2a\u8fdb\u7a0b\nstrace -p PID\nstrace -f -e trace=open,read,write command\n'})}),"\n",(0,d.jsx)(e.h3,{id:"\u6570\u636e\u5e93\u95ee\u9898",children:"\u6570\u636e\u5e93\u95ee\u9898"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# MySQL \u65e0\u6cd5\u542f\u52a8\nsudo systemctl status mysql\nsudo tail -f /var/log/mysql/error.log\n\n# \u68c0\u67e5\u914d\u7f6e\u6587\u4ef6\nsudo mysqld --help --verbose | grep my.cnf\n\n# \u68c0\u67e5\u78c1\u76d8\u7a7a\u95f4\ndf -h /var/lib/mysql\n\n# \u4fee\u590d\u8868\nmysqlcheck -u root -p --auto-repair --all-databases\n\n# \u6162\u67e5\u8be2\nsudo tail -f /var/log/mysql/mysql-slow.log\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u6587\u4ef6\u7cfb\u7edf\u95ee\u9898",children:"\u6587\u4ef6\u7cfb\u7edf\u95ee\u9898"}),"\n",(0,d.jsx)(e.h3,{id:"\u6587\u4ef6\u635f\u574f",children:"\u6587\u4ef6\u635f\u574f"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5\u6587\u4ef6\u7cfb\u7edf\nsudo umount /dev/sda1\nsudo fsck -y /dev/sda1\n\n# \u6062\u590d\u5220\u9664\u7684\u6587\u4ef6\nsudo apt install extundelete\nsudo extundelete /dev/sda1 --restore-all\n"})}),"\n",(0,d.jsx)(e.h3,{id:"inode-\u8017\u5c3d",children:"inode \u8017\u5c3d"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b inode \u4f7f\u7528\ndf -i\n\n# \u67e5\u627e\u5927\u91cf\u5c0f\u6587\u4ef6\nsudo find / -xdev -printf '%h\\n' | sort | uniq -c | sort -k 1 -n\n\n# \u5220\u9664\u4e0d\u9700\u8981\u7684\u5c0f\u6587\u4ef6\nsudo find /tmp -type f -delete\n"})}),"\n",(0,d.jsx)(e.h2,{id:"\u65e5\u5fd7\u5206\u6790",children:"\u65e5\u5fd7\u5206\u6790"}),"\n",(0,d.jsx)(e.h3,{id:"\u67e5\u627e\u9519\u8bef",children:"\u67e5\u627e\u9519\u8bef"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-bash",children:'# \u7cfb\u7edf\u65e5\u5fd7\nsudo grep -i error /var/log/syslog\nsudo grep -i fail /var/log/syslog\n\n# \u8ba4\u8bc1\u65e5\u5fd7\nsudo grep "Failed password" /var/log/auth.log\nsudo grep "authentication failure" /var/log/auth.log\n\n# \u5185\u6838\u65e5\u5fd7\ndmesg | grep -i error\ndmesg | grep -i fail\n\n# journalctl\njournalctl -p err\njournalctl -p crit\n'})}),"\n",(0,d.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,d.jsx)(e.p,{children:"\u672c\u6587\u4ecb\u7ecd\u4e86 Linux \u6545\u969c\u6392\u67e5\uff1a"}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"\u2705 \u542f\u52a8\u95ee\u9898\uff08GRUB\u3001\u6587\u4ef6\u7cfb\u7edf\uff09"}),"\n",(0,d.jsx)(e.li,{children:"\u2705 \u767b\u5f55\u95ee\u9898\uff08\u5bc6\u7801\u3001SSH\u3001\u8d26\u6237\u9501\u5b9a\uff09"}),"\n",(0,d.jsx)(e.li,{children:"\u2705 \u6027\u80fd\u95ee\u9898\uff08CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8\u3001\u8d1f\u8f7d\uff09"}),"\n",(0,d.jsx)(e.li,{children:"\u2705 \u7f51\u7edc\u95ee\u9898\uff08\u8fde\u63a5\u3001\u7aef\u53e3\u3001DNS\uff09"}),"\n",(0,d.jsx)(e.li,{children:"\u2705 \u670d\u52a1\u95ee\u9898\uff08\u542f\u52a8\u5931\u8d25\u3001\u91cd\u542f\uff09"}),"\n",(0,d.jsx)(e.li,{children:"\u2705 \u65e5\u5fd7\u5206\u6790\u548c\u8c03\u8bd5"}),"\n"]}),"\n",(0,d.jsxs)(e.p,{children:["\u7ee7\u7eed\u5b66\u4e60 ",(0,d.jsx)(e.a,{href:"/docs/linux/best-practices",children:"\u6700\u4f73\u5b9e\u8df5"})," \u548c ",(0,d.jsx)(e.a,{href:"/docs/linux/quick-reference",children:"\u5feb\u901f\u53c2\u8003"}),"\u3002"]})]})}function u(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(c,{...n})}):c(n)}}}]);