"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[1170],{8951:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>r,contentTitle:()=>o,default:()=>x,frontMatter:()=>a,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"nginx/installation","title":"\u5b89\u88c5\u914d\u7f6e","description":"Nginx \u5728\u5404\u5e73\u53f0\u7684\u5b89\u88c5\u4e0e\u57fa\u672c\u914d\u7f6e\u6307\u5357","source":"@site/docs/nginx/installation.md","sourceDirName":"nginx","slug":"/nginx/installation","permalink":"/docs/nginx/installation","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/nginx/installation.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"\u5b89\u88c5\u914d\u7f6e","description":"Nginx \u5728\u5404\u5e73\u53f0\u7684\u5b89\u88c5\u4e0e\u57fa\u672c\u914d\u7f6e\u6307\u5357"},"sidebar":"nginx","previous":{"title":"Nginx \u6982\u8ff0","permalink":"/docs/nginx/"},"next":{"title":"\u57fa\u7840\u914d\u7f6e","permalink":"/docs/nginx/basic-config"}}');var t=s(22714),l=s(48885);const a={sidebar_position:2,title:"\u5b89\u88c5\u914d\u7f6e",description:"Nginx \u5728\u5404\u5e73\u53f0\u7684\u5b89\u88c5\u4e0e\u57fa\u672c\u914d\u7f6e\u6307\u5357"},o="Nginx \u5b89\u88c5\u914d\u7f6e",r={},d=[{value:"\u5404\u5e73\u53f0\u5b89\u88c5",id:"\u5404\u5e73\u53f0\u5b89\u88c5",level:2},{value:"macOS",id:"macos",level:3},{value:"Ubuntu / Debian",id:"ubuntu--debian",level:3},{value:"CentOS / RHEL / Rocky Linux",id:"centos--rhel--rocky-linux",level:3},{value:"Docker",id:"docker",level:3},{value:"\u6e90\u7801\u7f16\u8bd1\u5b89\u88c5",id:"\u6e90\u7801\u7f16\u8bd1\u5b89\u88c5",level:3},{value:"\u76ee\u5f55\u7ed3\u6784",id:"\u76ee\u5f55\u7ed3\u6784",level:2},{value:"\u6807\u51c6\u5b89\u88c5\u76ee\u5f55",id:"\u6807\u51c6\u5b89\u88c5\u76ee\u5f55",level:3},{value:"\u5e38\u7528\u547d\u4ee4",id:"\u5e38\u7528\u547d\u4ee4",level:2},{value:"systemd \u7ba1\u7406",id:"systemd-\u7ba1\u7406",level:2},{value:"\u57fa\u7840\u914d\u7f6e\u7ed3\u6784",id:"\u57fa\u7840\u914d\u7f6e\u7ed3\u6784",level:2},{value:"\u9a8c\u8bc1\u5b89\u88c5",id:"\u9a8c\u8bc1\u5b89\u88c5",level:2},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2},{value:"\u7aef\u53e3\u88ab\u5360\u7528",id:"\u7aef\u53e3\u88ab\u5360\u7528",level:3},{value:"\u6743\u9650\u95ee\u9898",id:"\u6743\u9650\u95ee\u9898",level:3},{value:"SELinux \u95ee\u9898\uff08CentOS/RHEL\uff09",id:"selinux-\u95ee\u9898centosrhel",level:3},{value:"\u9632\u706b\u5899\u914d\u7f6e",id:"\u9632\u706b\u5899\u914d\u7f6e",level:3}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",pre:"pre",...(0,l.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"nginx-\u5b89\u88c5\u914d\u7f6e",children:"Nginx \u5b89\u88c5\u914d\u7f6e"})}),"\n",(0,t.jsx)(e.h2,{id:"\u5404\u5e73\u53f0\u5b89\u88c5",children:"\u5404\u5e73\u53f0\u5b89\u88c5"}),"\n",(0,t.jsx)(e.h3,{id:"macos",children:"macOS"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u4f7f\u7528 Homebrew \u5b89\u88c5\nbrew install nginx\n\n# \u542f\u52a8 Nginx\nbrew services start nginx\n\n# \u6216\u624b\u52a8\u542f\u52a8\nnginx\n\n# \u9ed8\u8ba4\u914d\u7f6e\u8def\u5f84\n/opt/homebrew/etc/nginx/nginx.conf  # Apple Silicon\n/usr/local/etc/nginx/nginx.conf      # Intel Mac\n"})}),"\n",(0,t.jsx)(e.h3,{id:"ubuntu--debian",children:"Ubuntu / Debian"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u66f4\u65b0\u5305\u7d22\u5f15\nsudo apt update\n\n# \u5b89\u88c5 Nginx\nsudo apt install nginx\n\n# \u542f\u52a8\u5e76\u8bbe\u7f6e\u5f00\u673a\u542f\u52a8\nsudo systemctl start nginx\nsudo systemctl enable nginx\n\n# \u67e5\u770b\u72b6\u6001\nsudo systemctl status nginx\n"})}),"\n",(0,t.jsx)(e.h3,{id:"centos--rhel--rocky-linux",children:"CentOS / RHEL / Rocky Linux"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u5b89\u88c5 EPEL \u4ed3\u5e93\uff08\u5982\u9700\u8981\uff09\nsudo yum install epel-release\n\n# \u5b89\u88c5 Nginx\nsudo yum install nginx\n\n# \u542f\u52a8\u5e76\u8bbe\u7f6e\u5f00\u673a\u542f\u52a8\nsudo systemctl start nginx\nsudo systemctl enable nginx\n"})}),"\n",(0,t.jsx)(e.h3,{id:"docker",children:"Docker"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u62c9\u53d6\u5b98\u65b9\u955c\u50cf\ndocker pull nginx:latest\n\n# \u8fd0\u884c Nginx \u5bb9\u5668\ndocker run -d \\\n  --name nginx \\\n  -p 80:80 \\\n  -p 443:443 \\\n  -v /path/to/nginx.conf:/etc/nginx/nginx.conf:ro \\\n  -v /path/to/html:/usr/share/nginx/html:ro \\\n  nginx:latest\n"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-yaml",metastring:'title="docker-compose.yml"',children:'version: "3.8"\nservices:\n  nginx:\n    image: nginx:alpine\n    ports:\n      - "80:80"\n      - "443:443"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf:ro\n      - ./html:/usr/share/nginx/html:ro\n      - ./ssl:/etc/nginx/ssl:ro\n    restart: unless-stopped\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u6e90\u7801\u7f16\u8bd1\u5b89\u88c5",children:"\u6e90\u7801\u7f16\u8bd1\u5b89\u88c5"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u5b89\u88c5\u4f9d\u8d56\uff08Ubuntu/Debian\uff09\nsudo apt install build-essential libpcre3 libpcre3-dev zlib1g zlib1g-dev libssl-dev\n\n# \u4e0b\u8f7d\u6e90\u7801\nwget https://nginx.org/download/nginx-1.24.0.tar.gz\ntar -xzf nginx-1.24.0.tar.gz\ncd nginx-1.24.0\n\n# \u914d\u7f6e\uff08\u5305\u542b\u5e38\u7528\u6a21\u5757\uff09\n./configure \\\n  --prefix=/usr/local/nginx \\\n  --with-http_ssl_module \\\n  --with-http_v2_module \\\n  --with-http_realip_module \\\n  --with-http_gzip_static_module \\\n  --with-http_stub_status_module \\\n  --with-stream \\\n  --with-stream_ssl_module\n\n# \u7f16\u8bd1\u5b89\u88c5\nmake && sudo make install\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u76ee\u5f55\u7ed3\u6784",children:"\u76ee\u5f55\u7ed3\u6784"}),"\n",(0,t.jsx)(e.h3,{id:"\u6807\u51c6\u5b89\u88c5\u76ee\u5f55",children:"\u6807\u51c6\u5b89\u88c5\u76ee\u5f55"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"/etc/nginx/                    # \u914d\u7f6e\u76ee\u5f55\n\u251c\u2500\u2500 nginx.conf                 # \u4e3b\u914d\u7f6e\u6587\u4ef6\n\u251c\u2500\u2500 conf.d/                    # \u989d\u5916\u914d\u7f6e\u76ee\u5f55\n\u2502   \u2514\u2500\u2500 default.conf           # \u9ed8\u8ba4\u7ad9\u70b9\u914d\u7f6e\n\u251c\u2500\u2500 sites-available/           # \u53ef\u7528\u7ad9\u70b9\u914d\u7f6e\uff08Debian \u98ce\u683c\uff09\n\u251c\u2500\u2500 sites-enabled/             # \u5df2\u542f\u7528\u7ad9\u70b9\u914d\u7f6e\n\u251c\u2500\u2500 mime.types                 # MIME \u7c7b\u578b\u6620\u5c04\n\u251c\u2500\u2500 fastcgi_params             # FastCGI \u53c2\u6570\n\u251c\u2500\u2500 proxy_params               # \u4ee3\u7406\u53c2\u6570\n\u2514\u2500\u2500 ssl/                       # SSL \u8bc1\u4e66\u76ee\u5f55\n\n/var/log/nginx/                # \u65e5\u5fd7\u76ee\u5f55\n\u251c\u2500\u2500 access.log                 # \u8bbf\u95ee\u65e5\u5fd7\n\u2514\u2500\u2500 error.log                  # \u9519\u8bef\u65e5\u5fd7\n\n/var/www/html/                 # \u9ed8\u8ba4\u7f51\u7ad9\u6839\u76ee\u5f55\n/usr/share/nginx/html/         # \u90e8\u5206\u7cfb\u7edf\u7684\u9ed8\u8ba4\u76ee\u5f55\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u5e38\u7528\u547d\u4ee4",children:"\u5e38\u7528\u547d\u4ee4"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u542f\u52a8 Nginx\nsudo nginx\n\n# \u505c\u6b62 Nginx\nsudo nginx -s stop      # \u5feb\u901f\u505c\u6b62\nsudo nginx -s quit      # \u4f18\u96c5\u505c\u6b62\uff08\u7b49\u5f85\u8bf7\u6c42\u5b8c\u6210\uff09\n\n# \u91cd\u8f7d\u914d\u7f6e\uff08\u4e0d\u4e2d\u65ad\u670d\u52a1\uff09\nsudo nginx -s reload\n\n# \u91cd\u65b0\u6253\u5f00\u65e5\u5fd7\u6587\u4ef6\nsudo nginx -s reopen\n\n# \u6d4b\u8bd5\u914d\u7f6e\u6587\u4ef6\u8bed\u6cd5\nsudo nginx -t\nsudo nginx -T          # \u6d4b\u8bd5\u5e76\u6253\u5370\u914d\u7f6e\n\n# \u67e5\u770b\u7248\u672c\u548c\u7f16\u8bd1\u4fe1\u606f\nnginx -v               # \u7248\u672c\u53f7\nnginx -V               # \u7248\u672c\u548c\u7f16\u8bd1\u53c2\u6570\n\n# \u6307\u5b9a\u914d\u7f6e\u6587\u4ef6\u542f\u52a8\nsudo nginx -c /path/to/nginx.conf\n\n# \u67e5\u770b Nginx \u8fdb\u7a0b\nps aux | grep nginx\n\n# \u67e5\u770b\u76d1\u542c\u7aef\u53e3\nsudo netstat -tlnp | grep nginx\n# \u6216\nsudo ss -tlnp | grep nginx\n"})}),"\n",(0,t.jsx)(e.h2,{id:"systemd-\u7ba1\u7406",children:"systemd \u7ba1\u7406"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u542f\u52a8/\u505c\u6b62/\u91cd\u542f\nsudo systemctl start nginx\nsudo systemctl stop nginx\nsudo systemctl restart nginx\n\n# \u91cd\u8f7d\u914d\u7f6e\nsudo systemctl reload nginx\n\n# \u67e5\u770b\u72b6\u6001\nsudo systemctl status nginx\n\n# \u5f00\u673a\u542f\u52a8\nsudo systemctl enable nginx\nsudo systemctl disable nginx\n\n# \u67e5\u770b\u65e5\u5fd7\nsudo journalctl -u nginx\nsudo journalctl -u nginx -f  # \u5b9e\u65f6\u67e5\u770b\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u57fa\u7840\u914d\u7f6e\u7ed3\u6784",children:"\u57fa\u7840\u914d\u7f6e\u7ed3\u6784"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-nginx",metastring:'title="/etc/nginx/nginx.conf"',children:'# \u5168\u5c40\u5757\nuser nginx;\nworker_processes auto;\nerror_log /var/log/nginx/error.log warn;\npid /var/run/nginx.pid;\n\n# \u4e8b\u4ef6\u5757\nevents {\n    worker_connections 1024;\n    use epoll;  # Linux \u63a8\u8350\n    multi_accept on;\n}\n\n# HTTP \u5757\nhttp {\n    include /etc/nginx/mime.types;\n    default_type application/octet-stream;\n\n    # \u65e5\u5fd7\u683c\u5f0f\n    log_format main \'$remote_addr - $remote_user [$time_local] "$request" \'\n                    \'$status $body_bytes_sent "$http_referer" \'\n                    \'"$http_user_agent" "$http_x_forwarded_for"\';\n\n    access_log /var/log/nginx/access.log main;\n\n    # \u6027\u80fd\u4f18\u5316\n    sendfile on;\n    tcp_nopush on;\n    tcp_nodelay on;\n    keepalive_timeout 65;\n    types_hash_max_size 2048;\n\n    # Gzip \u538b\u7f29\n    gzip on;\n    gzip_disable "msie6";\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types text/plain text/css application/json application/javascript\n               text/xml application/xml application/xml+rss text/javascript;\n\n    # \u5305\u542b\u5176\u4ed6\u914d\u7f6e\n    include /etc/nginx/conf.d/*.conf;\n    include /etc/nginx/sites-enabled/*;\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u9a8c\u8bc1\u5b89\u88c5",children:"\u9a8c\u8bc1\u5b89\u88c5"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# 1. \u68c0\u67e5 Nginx \u662f\u5426\u8fd0\u884c\nsudo systemctl status nginx\n\n# 2. \u6d4b\u8bd5\u914d\u7f6e\u8bed\u6cd5\nsudo nginx -t\n\n# 3. \u6d4f\u89c8\u5668\u8bbf\u95ee\ncurl http://localhost\n# \u6216\u8bbf\u95ee http://your-server-ip\n\n# 4. \u67e5\u770b\u7248\u672c\nnginx -v\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,t.jsx)(e.h3,{id:"\u7aef\u53e3\u88ab\u5360\u7528",children:"\u7aef\u53e3\u88ab\u5360\u7528"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b\u7aef\u53e3\u5360\u7528\nsudo lsof -i :80\nsudo netstat -tlnp | grep :80\n\n# \u505c\u6b62\u5360\u7528\u8fdb\u7a0b\u6216\u4fee\u6539 Nginx \u7aef\u53e3\nlisten 8080;\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u6743\u9650\u95ee\u9898",children:"\u6743\u9650\u95ee\u9898"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u786e\u4fdd Nginx \u7528\u6237\u6709\u6743\u9650\u8bbf\u95ee\u7f51\u7ad9\u76ee\u5f55\nsudo chown -R nginx:nginx /var/www/html\nsudo chmod -R 755 /var/www/html\n\n# \u786e\u4fdd\u65e5\u5fd7\u76ee\u5f55\u53ef\u5199\nsudo chown -R nginx:nginx /var/log/nginx\n"})}),"\n",(0,t.jsx)(e.h3,{id:"selinux-\u95ee\u9898centosrhel",children:"SELinux \u95ee\u9898\uff08CentOS/RHEL\uff09"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# \u4e34\u65f6\u7981\u7528\nsudo setenforce 0\n\n# \u6c38\u4e45\u7981\u7528\uff08\u4e0d\u63a8\u8350\u751f\u4ea7\u73af\u5883\uff09\nsudo sed -i 's/SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config\n\n# \u6b63\u786e\u65b9\u5f0f\uff1a\u914d\u7f6e SELinux \u7b56\u7565\nsudo setsebool -P httpd_can_network_connect 1\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u9632\u706b\u5899\u914d\u7f6e",children:"\u9632\u706b\u5899\u914d\u7f6e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-bash",children:"# Ubuntu (UFW)\nsudo ufw allow 'Nginx Full'\n# \u6216\nsudo ufw allow 80/tcp\nsudo ufw allow 443/tcp\n\n# CentOS (firewalld)\nsudo firewall-cmd --permanent --add-service=http\nsudo firewall-cmd --permanent --add-service=https\nsudo firewall-cmd --reload\n"})})]})}function x(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},48885:(n,e,s)=>{s.d(e,{R:()=>a,x:()=>o});var i=s(99378);const t={},l=i.createContext(t);function a(n){const e=i.useContext(l);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),i.createElement(l.Provider,{value:e},n.children)}}}]);