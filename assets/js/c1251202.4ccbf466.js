"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[3239],{48885:(n,e,r)=>{r.d(e,{R:()=>c,x:()=>l});var s=r(99378);const i={},t=s.createContext(i);function c(n){const e=s.useContext(t);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:c(n.components),s.createElement(t.Provider,{value:e},n.children)}},51279:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"java/senior-interview-questions","title":"Java \u9ad8\u7ea7\u9762\u8bd5\u9898\u7cbe\u9009","description":"[!TIP]","source":"@site/docs/java/senior-interview-questions.md","sourceDirName":"java","slug":"/java/senior-interview-questions","permalink":"/docs/java/senior-interview-questions","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/java/senior-interview-questions.md","tags":[],"version":"current","sidebarPosition":101,"frontMatter":{"sidebar_position":101,"title":"Java \u9ad8\u7ea7\u9762\u8bd5\u9898\u7cbe\u9009"},"sidebar":"java","previous":{"title":"Java \u9762\u8bd5\u9898\u7cbe\u9009","permalink":"/docs/java/interview-questions"}}');var i=r(22714),t=r(48885);const c={sidebar_position:101,title:"Java \u9ad8\u7ea7\u9762\u8bd5\u9898\u7cbe\u9009"},l="Java \u9ad8\u7ea7\u9762\u8bd5\u9898\u7cbe\u9009",d={},a=[{value:"\u76ee\u5f55",id:"\u76ee\u5f55",level:2},{value:"\ud83c\udfaf JVM \u6df1\u5ea6\uff08\u9ad8\u7ea7\uff09",id:"-jvm-\u6df1\u5ea6\u9ad8\u7ea7",level:2},{value:"1. \u8be6\u7ec6\u63cf\u8ff0 JVM \u5185\u5b58\u6a21\u578b\uff0c\u5404\u533a\u57df\u7684\u4f5c\u7528\u548c\u7279\u70b9\uff1f",id:"1-\u8be6\u7ec6\u63cf\u8ff0-jvm-\u5185\u5b58\u6a21\u578b\u5404\u533a\u57df\u7684\u4f5c\u7528\u548c\u7279\u70b9",level:3},{value:"2. \u5bf9\u6bd4 CMS\u3001G1\u3001ZGC \u5783\u573e\u56de\u6536\u5668\u7684\u7279\u70b9\u548c\u9002\u7528\u573a\u666f\uff1f",id:"2-\u5bf9\u6bd4-cmsg1zgc-\u5783\u573e\u56de\u6536\u5668\u7684\u7279\u70b9\u548c\u9002\u7528\u573a\u666f",level:3},{value:"3. \u5982\u4f55\u8fdb\u884c GC \u8c03\u4f18\uff1f\u8bf7\u63cf\u8ff0\u4e00\u4e2a\u5b9e\u9645\u7684\u8c03\u4f18\u6848\u4f8b",id:"3-\u5982\u4f55\u8fdb\u884c-gc-\u8c03\u4f18\u8bf7\u63cf\u8ff0\u4e00\u4e2a\u5b9e\u9645\u7684\u8c03\u4f18\u6848\u4f8b",level:3},{value:"4. \u89e3\u91ca\u7c7b\u52a0\u8f7d\u673a\u5236\u548c\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\uff0c\u5982\u4f55\u6253\u7834\u53cc\u4eb2\u59d4\u6d3e\uff1f",id:"4-\u89e3\u91ca\u7c7b\u52a0\u8f7d\u673a\u5236\u548c\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\u5982\u4f55\u6253\u7834\u53cc\u4eb2\u59d4\u6d3e",level:3},{value:"5. JIT \u7f16\u8bd1\u5668\u6709\u54ea\u4e9b\u4f18\u5316\u6280\u672f\uff1f\u4ec0\u4e48\u662f\u9003\u9038\u5206\u6790\uff1f",id:"5-jit-\u7f16\u8bd1\u5668\u6709\u54ea\u4e9b\u4f18\u5316\u6280\u672f\u4ec0\u4e48\u662f\u9003\u9038\u5206\u6790",level:3},{value:"\ud83c\udfaf \u9ad8\u7ea7\u5e76\u53d1\u7f16\u7a0b\uff08\u9ad8\u7ea7\uff09",id:"-\u9ad8\u7ea7\u5e76\u53d1\u7f16\u7a0b\u9ad8\u7ea7",level:2},{value:"6. \u8be6\u7ec6\u89e3\u91ca AQS\uff08AbstractQueuedSynchronizer\uff09\u7684\u539f\u7406",id:"6-\u8be6\u7ec6\u89e3\u91ca-aqsabstractqueuedsynchronizer\u7684\u539f\u7406",level:3},{value:"7. \u7ebf\u7a0b\u6c60\u6838\u5fc3\u53c2\u6570\u5982\u4f55\u914d\u7f6e\uff1f\u5982\u4f55\u76d1\u63a7\u7ebf\u7a0b\u6c60\u72b6\u6001\uff1f",id:"7-\u7ebf\u7a0b\u6c60\u6838\u5fc3\u53c2\u6570\u5982\u4f55\u914d\u7f6e\u5982\u4f55\u76d1\u63a7\u7ebf\u7a0b\u6c60\u72b6\u6001",level:3},{value:"8. synchronized \u9501\u5347\u7ea7\u8fc7\u7a0b\u662f\u600e\u6837\u7684\uff1f",id:"8-synchronized-\u9501\u5347\u7ea7\u8fc7\u7a0b\u662f\u600e\u6837\u7684",level:3},{value:"9. CAS \u539f\u7406\u662f\u4ec0\u4e48\uff1fABA \u95ee\u9898\u5982\u4f55\u89e3\u51b3\uff1f",id:"9-cas-\u539f\u7406\u662f\u4ec0\u4e48aba-\u95ee\u9898\u5982\u4f55\u89e3\u51b3",level:3},{value:"10. \u5982\u4f55\u5b9e\u73b0\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u5f0f\uff1f",id:"10-\u5982\u4f55\u5b9e\u73b0\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u5f0f",level:3},{value:"\ud83c\udfaf \u6027\u80fd\u8c03\u4f18\uff08\u4e13\u5bb6\u7ea7\uff09",id:"-\u6027\u80fd\u8c03\u4f18\u4e13\u5bb6\u7ea7",level:2},{value:"11. \u5982\u4f55\u6392\u67e5\u7ebf\u4e0a CPU \u98d9\u9ad8\u95ee\u9898\uff1f",id:"11-\u5982\u4f55\u6392\u67e5\u7ebf\u4e0a-cpu-\u98d9\u9ad8\u95ee\u9898",level:3},{value:"12. \u5982\u4f55\u6392\u67e5\u5185\u5b58\u6cc4\u6f0f\u95ee\u9898\uff1f",id:"12-\u5982\u4f55\u6392\u67e5\u5185\u5b58\u6cc4\u6f0f\u95ee\u9898",level:3},{value:"13. Arthas \u6709\u54ea\u4e9b\u5e38\u7528\u547d\u4ee4\uff1f\u5982\u4f55\u4f7f\u7528\uff1f",id:"13-arthas-\u6709\u54ea\u4e9b\u5e38\u7528\u547d\u4ee4\u5982\u4f55\u4f7f\u7528",level:3},{value:"14. \u5982\u4f55\u4f18\u5316\u6570\u636e\u5e93\u67e5\u8be2\u6027\u80fd\uff1f",id:"14-\u5982\u4f55\u4f18\u5316\u6570\u636e\u5e93\u67e5\u8be2\u6027\u80fd",level:3},{value:"15. \u7f13\u5b58\u7a7f\u900f\u3001\u7f13\u5b58\u51fb\u7a7f\u3001\u7f13\u5b58\u96ea\u5d29\u5982\u4f55\u89e3\u51b3\uff1f",id:"15-\u7f13\u5b58\u7a7f\u900f\u7f13\u5b58\u51fb\u7a7f\u7f13\u5b58\u96ea\u5d29\u5982\u4f55\u89e3\u51b3",level:3},{value:"\ud83c\udfaf \u67b6\u6784\u8bbe\u8ba1\uff08\u4e13\u5bb6\u7ea7\uff09",id:"-\u67b6\u6784\u8bbe\u8ba1\u4e13\u5bb6\u7ea7",level:2},{value:"16. \u4ec0\u4e48\u662f CAP \u7406\u8bba\uff1f\u5982\u4f55\u5728\u5b9e\u9645\u7cfb\u7edf\u4e2d\u6743\u8861\uff1f",id:"16-\u4ec0\u4e48\u662f-cap-\u7406\u8bba\u5982\u4f55\u5728\u5b9e\u9645\u7cfb\u7edf\u4e2d\u6743\u8861",level:3},{value:"17. \u5206\u5e03\u5f0f\u4e8b\u52a1\u6709\u54ea\u4e9b\u89e3\u51b3\u65b9\u6848\uff1f\u5404\u6709\u4ec0\u4e48\u4f18\u7f3a\u70b9\uff1f",id:"17-\u5206\u5e03\u5f0f\u4e8b\u52a1\u6709\u54ea\u4e9b\u89e3\u51b3\u65b9\u6848\u5404\u6709\u4ec0\u4e48\u4f18\u7f3a\u70b9",level:3},{value:"18. \u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u9ad8\u53ef\u7528\u7684\u7cfb\u7edf\uff1f",id:"18-\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u9ad8\u53ef\u7528\u7684\u7cfb\u7edf",level:3},{value:"19. \u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u79d2\u6740\u7cfb\u7edf\uff1f",id:"19-\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u79d2\u6740\u7cfb\u7edf",level:3},{value:"20. \u5fae\u670d\u52a1\u62c6\u5206\u7684\u539f\u5219\u662f\u4ec0\u4e48\uff1f\u5982\u4f55\u786e\u5b9a\u670d\u52a1\u8fb9\u754c\uff1f",id:"20-\u5fae\u670d\u52a1\u62c6\u5206\u7684\u539f\u5219\u662f\u4ec0\u4e48\u5982\u4f55\u786e\u5b9a\u670d\u52a1\u8fb9\u754c",level:3},{value:"\ud83c\udfaf \u6846\u67b6\u6e90\u7801\u5206\u6790\uff08\u4e13\u5bb6\u7ea7\uff09",id:"-\u6846\u67b6\u6e90\u7801\u5206\u6790\u4e13\u5bb6\u7ea7",level:2},{value:"21. Spring IoC \u5bb9\u5668\u542f\u52a8\u6d41\u7a0b\u662f\u600e\u6837\u7684\uff1f",id:"21-spring-ioc-\u5bb9\u5668\u542f\u52a8\u6d41\u7a0b\u662f\u600e\u6837\u7684",level:3},{value:"22. Spring AOP \u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f",id:"22-spring-aop-\u662f\u5982\u4f55\u5b9e\u73b0\u7684",level:3},{value:"23. Spring Boot \u81ea\u52a8\u914d\u7f6e\u539f\u7406\u662f\u4ec0\u4e48\uff1f",id:"23-spring-boot-\u81ea\u52a8\u914d\u7f6e\u539f\u7406\u662f\u4ec0\u4e48",level:3},{value:"24. MyBatis \u7684\u6267\u884c\u6d41\u7a0b\u548c\u7f13\u5b58\u673a\u5236\u662f\u600e\u6837\u7684\uff1f",id:"24-mybatis-\u7684\u6267\u884c\u6d41\u7a0b\u548c\u7f13\u5b58\u673a\u5236\u662f\u600e\u6837\u7684",level:3},{value:"25. Netty \u7684\u7ebf\u7a0b\u6a21\u578b\u548c\u6838\u5fc3\u7ec4\u4ef6\u662f\u4ec0\u4e48\uff1f",id:"25-netty-\u7684\u7ebf\u7a0b\u6a21\u578b\u548c\u6838\u5fc3\u7ec4\u4ef6\u662f\u4ec0\u4e48",level:3},{value:"\ud83d\udccc \u603b\u7ed3\u4e0e\u5b66\u4e60\u5efa\u8bae",id:"-\u603b\u7ed3\u4e0e\u5b66\u4e60\u5efa\u8bae",level:2},{value:"\u96be\u5ea6\u5206\u7ea7",id:"\u96be\u5ea6\u5206\u7ea7",level:3},{value:"\u5b66\u4e60\u8def\u5f84",id:"\u5b66\u4e60\u8def\u5f84",level:3},{value:"\u9762\u8bd5\u51c6\u5907\u5efa\u8bae",id:"\u9762\u8bd5\u51c6\u5907\u5efa\u8bae",level:3},{value:"\u76f8\u5173\u8d44\u6e90",id:"\u76f8\u5173\u8d44\u6e90",level:3}];function o(n){const e={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"java-\u9ad8\u7ea7\u9762\u8bd5\u9898\u7cbe\u9009",children:"Java \u9ad8\u7ea7\u9762\u8bd5\u9898\u7cbe\u9009"})}),"\n",(0,i.jsxs)(e.blockquote,{children:["\n",(0,i.jsx)(e.p,{children:"[!TIP]\n\u672c\u6587\u7cbe\u9009\u4e86 30+ \u9053 Java \u9ad8\u7ea7\u5f00\u53d1\u5de5\u7a0b\u5e08\u9762\u8bd5\u9898\uff0c\u6db5\u76d6 JVM \u6df1\u5ea6\u3001\u9ad8\u7ea7\u5e76\u53d1\u3001\u6027\u80fd\u8c03\u4f18\u3001\u67b6\u6784\u8bbe\u8ba1\u3001\u6846\u67b6\u6e90\u7801\u7b49\u6838\u5fc3\u4e3b\u9898\u3002\u9002\u5408 3-5 \u5e74\u4ee5\u4e0a\u7ecf\u9a8c\u7684\u5f00\u53d1\u8005\u9762\u8bd5\u51c6\u5907\u3002"}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u76ee\u5f55",children:"\u76ee\u5f55"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"#-jvm-%E6%B7%B1%E5%BA%A6%E9%AB%98%E7%BA%A7",children:"\ud83c\udfaf JVM \u6df1\u5ea6\uff08\u9ad8\u7ea7\uff09"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"#-%E9%AB%98%E7%BA%A7%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E9%AB%98%E7%BA%A7",children:"\ud83c\udfaf \u9ad8\u7ea7\u5e76\u53d1\u7f16\u7a0b\uff08\u9ad8\u7ea7\uff09"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"#-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%E4%B8%93%E5%AE%B6%E7%BA%A7",children:"\ud83c\udfaf \u6027\u80fd\u8c03\u4f18\uff08\u4e13\u5bb6\u7ea7\uff09"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"#-%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E4%B8%93%E5%AE%B6%E7%BA%A7",children:"\ud83c\udfaf \u67b6\u6784\u8bbe\u8ba1\uff08\u4e13\u5bb6\u7ea7\uff09"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"#-%E6%A1%86%E6%9E%B6%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90%E4%B8%93%E5%AE%B6%E7%BA%A7",children:"\ud83c\udfaf \u6846\u67b6\u6e90\u7801\u5206\u6790\uff08\u4e13\u5bb6\u7ea7\uff09"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"#-%E6%80%BB%E7%BB%93%E4%B8%8E%E5%AD%A6%E4%B9%A0%E5%BB%BA%E8%AE%AE",children:"\ud83d\udccc \u603b\u7ed3\u4e0e\u5b66\u4e60\u5efa\u8bae"})}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"-jvm-\u6df1\u5ea6\u9ad8\u7ea7",children:"\ud83c\udfaf JVM \u6df1\u5ea6\uff08\u9ad8\u7ea7\uff09"}),"\n",(0,i.jsx)(e.h3,{id:"1-\u8be6\u7ec6\u63cf\u8ff0-jvm-\u5185\u5b58\u6a21\u578b\u5404\u533a\u57df\u7684\u4f5c\u7528\u548c\u7279\u70b9",children:"1. \u8be6\u7ec6\u63cf\u8ff0 JVM \u5185\u5b58\u6a21\u578b\uff0c\u5404\u533a\u57df\u7684\u4f5c\u7528\u548c\u7279\u70b9\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JDK 8+ \u8fd0\u884c\u65f6\u6570\u636e\u533a\u57df\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u533a\u57df"}),(0,i.jsx)(e.th,{children:"\u7ebf\u7a0b\u5171\u4eab"}),(0,i.jsx)(e.th,{children:"\u4f5c\u7528"}),(0,i.jsx)(e.th,{children:"\u5f02\u5e38"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u5806\uff08Heap\uff09"})}),(0,i.jsx)(e.td,{children:"\u5171\u4eab"}),(0,i.jsx)(e.td,{children:"\u5b58\u50a8\u5bf9\u8c61\u5b9e\u4f8b\u548c\u6570\u7ec4"}),(0,i.jsx)(e.td,{children:"OutOfMemoryError"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u65b9\u6cd5\u533a/\u5143\u7a7a\u95f4"})}),(0,i.jsx)(e.td,{children:"\u5171\u4eab"}),(0,i.jsx)(e.td,{children:"\u5b58\u50a8\u7c7b\u4fe1\u606f\u3001\u5e38\u91cf\u3001\u9759\u6001\u53d8\u91cf"}),(0,i.jsx)(e.td,{children:"OutOfMemoryError"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u865a\u62df\u673a\u6808"})}),(0,i.jsx)(e.td,{children:"\u79c1\u6709"}),(0,i.jsx)(e.td,{children:"\u5b58\u50a8\u5c40\u90e8\u53d8\u91cf\u3001\u64cd\u4f5c\u6570\u6808\u3001\u65b9\u6cd5\u51fa\u53e3"}),(0,i.jsx)(e.td,{children:"StackOverflowError/OOM"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u672c\u5730\u65b9\u6cd5\u6808"})}),(0,i.jsx)(e.td,{children:"\u79c1\u6709"}),(0,i.jsx)(e.td,{children:"\u4e3a native \u65b9\u6cd5\u670d\u52a1"}),(0,i.jsx)(e.td,{children:"StackOverflowError/OOM"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u7a0b\u5e8f\u8ba1\u6570\u5668"})}),(0,i.jsx)(e.td,{children:"\u79c1\u6709"}),(0,i.jsx)(e.td,{children:"\u8bb0\u5f55\u5f53\u524d\u6267\u884c\u7684\u5b57\u8282\u7801\u6307\u4ee4\u5730\u5740"}),(0,i.jsx)(e.td,{children:"\u65e0"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5806\u5185\u5b58\u5206\u4ee3\u7ed3\u6784\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u5806\u5185\u5b58\n\u251c\u2500\u2500 \u65b0\u751f\u4ee3\uff08Young Generation\uff09- 1/3 \u5806\n\u2502   \u251c\u2500\u2500 Eden \u533a - 8/10 \u65b0\u751f\u4ee3\n\u2502   \u251c\u2500\u2500 Survivor From (S0) - 1/10 \u65b0\u751f\u4ee3\n\u2502   \u2514\u2500\u2500 Survivor To (S1) - 1/10 \u65b0\u751f\u4ee3\n\u2514\u2500\u2500 \u8001\u5e74\u4ee3\uff08Old Generation\uff09- 2/3 \u5806\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4ee3\u7801\u793a\u4f8b - \u67e5\u770b\u5185\u5b58\u5206\u914d\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class MemoryDemo {\n    public static void main(String[] args) {\n        // \u5806\u5185\u5b58\u4fe1\u606f\n        Runtime runtime = Runtime.getRuntime();\n        long maxMemory = runtime.maxMemory();      // \u6700\u5927\u5806\u5185\u5b58\n        long totalMemory = runtime.totalMemory();  // \u5f53\u524d\u5806\u5185\u5b58\n        long freeMemory = runtime.freeMemory();    // \u7a7a\u95f2\u5806\u5185\u5b58\n\n        System.out.println("Max: " + maxMemory / 1024 / 1024 + "MB");\n        System.out.println("Total: " + totalMemory / 1024 / 1024 + "MB");\n        System.out.println("Free: " + freeMemory / 1024 / 1024 + "MB");\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JVM \u53c2\u6570\u914d\u7f6e\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u5806\u5185\u5b58\u914d\u7f6e\n-Xms512m          # \u521d\u59cb\u5806\u5927\u5c0f\n-Xmx1024m         # \u6700\u5927\u5806\u5927\u5c0f\n-Xmn256m          # \u65b0\u751f\u4ee3\u5927\u5c0f\n\n# \u5143\u7a7a\u95f4\u914d\u7f6e\uff08JDK 8+\uff09\n-XX:MetaspaceSize=128m\n-XX:MaxMetaspaceSize=256m\n\n# \u6808\u5927\u5c0f\u914d\u7f6e\n-Xss256k          # \u6bcf\u4e2a\u7ebf\u7a0b\u6808\u5927\u5c0f\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/jvm-basics#%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B",children:"JVM \u57fa\u7840 - \u5185\u5b58\u6a21\u578b"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"2-\u5bf9\u6bd4-cmsg1zgc-\u5783\u573e\u56de\u6536\u5668\u7684\u7279\u70b9\u548c\u9002\u7528\u573a\u666f",children:"2. \u5bf9\u6bd4 CMS\u3001G1\u3001ZGC \u5783\u573e\u56de\u6536\u5668\u7684\u7279\u70b9\u548c\u9002\u7528\u573a\u666f\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u7279\u6027"}),(0,i.jsx)(e.th,{children:"CMS"}),(0,i.jsx)(e.th,{children:"G1"}),(0,i.jsx)(e.th,{children:"ZGC"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u7b97\u6cd5"})}),(0,i.jsx)(e.td,{children:"\u6807\u8bb0-\u6e05\u9664"}),(0,i.jsx)(e.td,{children:"\u6807\u8bb0-\u6574\u7406"}),(0,i.jsx)(e.td,{children:"\u67d3\u8272\u6307\u9488+\u8bfb\u5c4f\u969c"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u505c\u987f\u65f6\u95f4"})}),(0,i.jsx)(e.td,{children:"\u4e0d\u53ef\u9884\u6d4b"}),(0,i.jsxs)(e.td,{children:["\u53ef\u9884\u6d4b\uff08-XX",":MaxGCPauseMillis","\uff09"]}),(0,i.jsx)(e.td,{children:"<10ms"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u5185\u5b58\u788e\u7247"})}),(0,i.jsx)(e.td,{children:"\u6709"}),(0,i.jsx)(e.td,{children:"\u65e0"}),(0,i.jsx)(e.td,{children:"\u65e0"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u5806\u5927\u5c0f"})}),(0,i.jsx)(e.td,{children:"<32GB"}),(0,i.jsx)(e.td,{children:"4GB-64GB"}),(0,i.jsx)(e.td,{children:"8MB-16TB"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"JDK \u7248\u672c"})}),(0,i.jsx)(e.td,{children:"JDK 5+"}),(0,i.jsx)(e.td,{children:"JDK 7+"}),(0,i.jsx)(e.td,{children:"JDK 11+"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u9002\u7528\u573a\u666f"})}),(0,i.jsx)(e.td,{children:"\u4f4e\u5ef6\u8fdf\u3001\u4e2d\u5c0f\u5806"}),(0,i.jsx)(e.td,{children:"\u5927\u5806\u3001\u53ef\u63a7\u505c\u987f"}),(0,i.jsx)(e.td,{children:"\u8d85\u5927\u5806\u3001\u6781\u4f4e\u5ef6\u8fdf"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"G1 \u6536\u96c6\u5668\u5de5\u4f5c\u539f\u7406\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"G1 \u5806\u5185\u5b58\u5e03\u5c40\uff08Region \u5316\uff09\n\u250c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Eden\u2502 Eden\u2502 Sur \u2502 Old \u2502 Old \u2502 Hum \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Old \u2502 Free\u2502 Eden\u2502 Old \u2502 Sur \u2502 Old \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2518\n\u6bcf\u4e2a Region \u5927\u5c0f\uff1a1MB-32MB\uff082\u7684\u5e42\u6b21\uff09\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"GC \u9009\u62e9\u5efa\u8bae\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# CMS\uff08JDK 8 \u9ed8\u8ba4\u53ef\u7528\uff0cJDK 14 \u79fb\u9664\uff09\n-XX:+UseConcMarkSweepGC\n\n# G1\uff08JDK 9+ \u9ed8\u8ba4\uff09\n-XX:+UseG1GC\n-XX:MaxGCPauseMillis=200\n\n# ZGC\uff08JDK 15+ \u751f\u4ea7\u53ef\u7528\uff09\n-XX:+UseZGC\n-XX:+ZGenerational  # JDK 21+ \u5206\u4ee3 ZGC\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/jvm-basics#%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6gc",children:"JVM \u57fa\u7840 - \u5783\u573e\u56de\u6536"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"3-\u5982\u4f55\u8fdb\u884c-gc-\u8c03\u4f18\u8bf7\u63cf\u8ff0\u4e00\u4e2a\u5b9e\u9645\u7684\u8c03\u4f18\u6848\u4f8b",children:"3. \u5982\u4f55\u8fdb\u884c GC \u8c03\u4f18\uff1f\u8bf7\u63cf\u8ff0\u4e00\u4e2a\u5b9e\u9645\u7684\u8c03\u4f18\u6848\u4f8b"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"GC \u8c03\u4f18\u6b65\u9aa4\uff1a"})}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.strong,{children:"\u6536\u96c6 GC \u65e5\u5fd7"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.strong,{children:"\u5206\u6790 GC \u884c\u4e3a"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.strong,{children:"\u8c03\u6574 JVM \u53c2\u6570"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.strong,{children:"\u9a8c\u8bc1\u4f18\u5316\u6548\u679c"})}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5f00\u542f GC \u65e5\u5fd7\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# JDK 8\n-XX:+PrintGCDetails\n-XX:+PrintGCDateStamps\n-Xloggc:/path/to/gc.log\n\n# JDK 9+\n-Xlog:gc*:file=/path/to/gc.log:time,uptime,level,tags\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5b9e\u9645\u8c03\u4f18\u6848\u4f8b - Full GC \u9891\u7e41\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u95ee\u9898\u73b0\u8c61\uff1a\u6bcf\u9694\u51e0\u5206\u949f\u53d1\u751f Full GC\uff0c\u505c\u987f 2-3 \u79d2\n\n# \u539f\u59cb\u914d\u7f6e\n-Xms2g -Xmx2g -Xmn512m\n\n# \u5206\u6790\u53d1\u73b0\uff1a\n# 1. \u65b0\u751f\u4ee3\u592a\u5c0f\uff0c\u5bf9\u8c61\u8fc7\u65e9\u664b\u5347\u5230\u8001\u5e74\u4ee3\n# 2. \u8001\u5e74\u4ee3\u5f88\u5feb\u88ab\u586b\u6ee1\uff0c\u89e6\u53d1 Full GC\n\n# \u4f18\u5316\u540e\u914d\u7f6e\n-Xms4g -Xmx4g -Xmn1536m\n-XX:SurvivorRatio=8\n-XX:MaxTenuringThreshold=15\n-XX:+UseG1GC\n-XX:MaxGCPauseMillis=200\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"GC \u65e5\u5fd7\u5206\u6790\u5173\u952e\u6307\u6807\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"[GC (Allocation Failure) [PSYoungGen: 524288K->87654K(611840K)]\n 524288K->87654K(2010112K), 0.0876543 secs]\n\n\u5173\u952e\u6307\u6807\uff1a\n- GC \u539f\u56e0\uff1aAllocation Failure\n- Young GC \u524d\u540e\uff1a524288K -> 87654K\n- \u5806\u603b\u91cf\u53d8\u5316\uff1a524288K -> 87654K\n- GC \u8017\u65f6\uff1a0.0876543 \u79d2\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/jvm-basics",children:"JVM \u57fa\u7840 - \u6027\u80fd\u8c03\u4f18"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"4-\u89e3\u91ca\u7c7b\u52a0\u8f7d\u673a\u5236\u548c\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\u5982\u4f55\u6253\u7834\u53cc\u4eb2\u59d4\u6d3e",children:"4. \u89e3\u91ca\u7c7b\u52a0\u8f7d\u673a\u5236\u548c\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\uff0c\u5982\u4f55\u6253\u7834\u53cc\u4eb2\u59d4\u6d3e\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7c7b\u52a0\u8f7d\u8fc7\u7a0b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u52a0\u8f7d \u2192 \u9a8c\u8bc1 \u2192 \u51c6\u5907 \u2192 \u89e3\u6790 \u2192 \u521d\u59cb\u5316 \u2192 \u4f7f\u7528 \u2192 \u5378\u8f7d\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u53cc\u4eb2\u59d4\u6d3e\u6a21\u578b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Bootstrap       \u2502 \u52a0\u8f7d rt.jar\n                    \u2502 ClassLoader     \u2502 (C++ \u5b9e\u73b0)\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502 \u59d4\u6d3e\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Extension       \u2502 \u52a0\u8f7d ext/*.jar\n                    \u2502 ClassLoader     \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502 \u59d4\u6d3e\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Application     \u2502 \u52a0\u8f7d classpath\n                    \u2502 ClassLoader     \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502 \u59d4\u6d3e\n                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502 Custom          \u2502 \u81ea\u5b9a\u4e49\u52a0\u8f7d\n                    \u2502 ClassLoader     \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6253\u7834\u53cc\u4eb2\u59d4\u6d3e\u7684\u573a\u666f\uff1a"})}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"SPI \u673a\u5236"}),"\uff08JDBC\u3001JNDI\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u70ed\u90e8\u7f72"}),"\uff08Tomcat\u3001OSGi\uff09"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u4ee3\u7801\u9694\u79bb"}),"\uff08\u4e0d\u540c\u7248\u672c\u7c7b\u5e93\uff09"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u81ea\u5b9a\u4e49\u7c7b\u52a0\u8f7d\u5668\u793a\u4f8b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class HotSwapClassLoader extends ClassLoader {\n\n    @Override\n    protected Class<?> loadClass(String name, boolean resolve)\n            throws ClassNotFoundException {\n        // \u6253\u7834\u53cc\u4eb2\u59d4\u6d3e\uff1a\u5148\u5c1d\u8bd5\u81ea\u5df1\u52a0\u8f7d\n        if (name.startsWith(\"com.myapp.\")) {\n            return findClass(name);\n        }\n        // \u5176\u4ed6\u7c7b\u4ecd\u8d70\u53cc\u4eb2\u59d4\u6d3e\n        return super.loadClass(name, resolve);\n    }\n\n    @Override\n    protected Class<?> findClass(String name) throws ClassNotFoundException {\n        byte[] classData = loadClassData(name);\n        if (classData == null) {\n            throw new ClassNotFoundException(name);\n        }\n        return defineClass(name, classData, 0, classData.length);\n    }\n\n    private byte[] loadClassData(String name) {\n        // \u4ece\u6587\u4ef6/\u7f51\u7edc\u52a0\u8f7d\u7c7b\u5b57\u8282\u7801\n        String path = name.replace('.', '/') + \".class\";\n        try (InputStream is = new FileInputStream(path)) {\n            ByteArrayOutputStream baos = new ByteArrayOutputStream();\n            byte[] buffer = new byte[1024];\n            int len;\n            while ((len = is.read(buffer)) != -1) {\n                baos.write(buffer, 0, len);\n            }\n            return baos.toByteArray();\n        } catch (IOException e) {\n            return null;\n        }\n    }\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/jvm-basics#%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6",children:"JVM \u57fa\u7840 - \u7c7b\u52a0\u8f7d\u673a\u5236"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"5-jit-\u7f16\u8bd1\u5668\u6709\u54ea\u4e9b\u4f18\u5316\u6280\u672f\u4ec0\u4e48\u662f\u9003\u9038\u5206\u6790",children:"5. JIT \u7f16\u8bd1\u5668\u6709\u54ea\u4e9b\u4f18\u5316\u6280\u672f\uff1f\u4ec0\u4e48\u662f\u9003\u9038\u5206\u6790\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JIT \u4e3b\u8981\u4f18\u5316\u6280\u672f\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u4f18\u5316\u6280\u672f"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"}),(0,i.jsx)(e.th,{children:"\u6548\u679c"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u65b9\u6cd5\u5185\u8054"})}),(0,i.jsx)(e.td,{children:"\u5c06\u5c0f\u65b9\u6cd5\u4ee3\u7801\u76f4\u63a5\u5d4c\u5165\u8c03\u7528\u5904"}),(0,i.jsx)(e.td,{children:"\u51cf\u5c11\u65b9\u6cd5\u8c03\u7528\u5f00\u9500"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u9003\u9038\u5206\u6790"})}),(0,i.jsx)(e.td,{children:"\u5206\u6790\u5bf9\u8c61\u4f5c\u7528\u57df"}),(0,i.jsx)(e.td,{children:"\u6808\u4e0a\u5206\u914d\u3001\u9501\u6d88\u9664"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u9501\u6d88\u9664"})}),(0,i.jsx)(e.td,{children:"\u6d88\u9664\u4e0d\u5fc5\u8981\u7684\u540c\u6b65"}),(0,i.jsx)(e.td,{children:"\u63d0\u5347\u5e76\u53d1\u6027\u80fd"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u9501\u7c97\u5316"})}),(0,i.jsx)(e.td,{children:"\u5408\u5e76\u8fde\u7eed\u7684\u52a0\u9501\u64cd\u4f5c"}),(0,i.jsx)(e.td,{children:"\u51cf\u5c11\u9501\u5f00\u9500"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u6807\u91cf\u66ff\u6362"})}),(0,i.jsx)(e.td,{children:"\u5c06\u5bf9\u8c61\u62c6\u89e3\u4e3a\u57fa\u672c\u7c7b\u578b"}),(0,i.jsx)(e.td,{children:"\u51cf\u5c11\u5185\u5b58\u5206\u914d"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u9003\u9038\u5206\u6790\u8be6\u89e3\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// \u4e0d\u9003\u9038 - \u53ef\u4ee5\u6808\u4e0a\u5206\u914d\npublic void noEscape() {\n    Point p = new Point(1, 2);  // \u5bf9\u8c61\u53ea\u5728\u65b9\u6cd5\u5185\u4f7f\u7528\n    System.out.println(p.x + p.y);\n}\n\n// \u65b9\u6cd5\u9003\u9038 - \u4e0d\u80fd\u6808\u4e0a\u5206\u914d\npublic Point methodEscape() {\n    Point p = new Point(1, 2);\n    return p;  // \u5bf9\u8c61\u88ab\u8fd4\u56de\uff0c\u9003\u9038\u5230\u65b9\u6cd5\u5916\n}\n\n// \u7ebf\u7a0b\u9003\u9038 - \u4e0d\u80fd\u6808\u4e0a\u5206\u914d\npublic void threadEscape() {\n    Point p = new Point(1, 2);\n    new Thread(() -> System.out.println(p)).start();  // \u88ab\u5176\u4ed6\u7ebf\u7a0b\u8bbf\u95ee\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u9501\u6d88\u9664\u793a\u4f8b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// JIT \u4f1a\u6d88\u9664\u8fd9\u4e2a\u540c\u6b65\uff0c\u56e0\u4e3a sb \u4e0d\u4f1a\u9003\u9038\npublic String concat(String s1, String s2) {\n    StringBuffer sb = new StringBuffer();  // \u5c40\u90e8\u53d8\u91cf\uff0c\u4e0d\u9003\u9038\n    sb.append(s1);\n    sb.append(s2);\n    return sb.toString();\n}\n// \u4f18\u5316\u540e\u7b49\u4ef7\u4e8e\u4f7f\u7528 StringBuilder\uff08\u65e0\u540c\u6b65\uff09\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JIT \u76f8\u5173 JVM \u53c2\u6570\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u5f00\u542f/\u5173\u95ed\u9003\u9038\u5206\u6790\n-XX:+DoEscapeAnalysis    # \u9ed8\u8ba4\u5f00\u542f\n-XX:-DoEscapeAnalysis    # \u5173\u95ed\n\n# \u5f00\u542f/\u5173\u95ed\u9501\u6d88\u9664\n-XX:+EliminateLocks      # \u9ed8\u8ba4\u5f00\u542f\n\n# \u5f00\u542f/\u5173\u95ed\u6807\u91cf\u66ff\u6362\n-XX:+EliminateAllocations\n\n# \u67e5\u770b JIT \u7f16\u8bd1\u65e5\u5fd7\n-XX:+PrintCompilation\n-XX:+UnlockDiagnosticVMOptions\n-XX:+PrintInlining\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/jvm-basics",children:"JVM \u57fa\u7840 - JIT \u7f16\u8bd1"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"-\u9ad8\u7ea7\u5e76\u53d1\u7f16\u7a0b\u9ad8\u7ea7",children:"\ud83c\udfaf \u9ad8\u7ea7\u5e76\u53d1\u7f16\u7a0b\uff08\u9ad8\u7ea7\uff09"}),"\n",(0,i.jsx)(e.h3,{id:"6-\u8be6\u7ec6\u89e3\u91ca-aqsabstractqueuedsynchronizer\u7684\u539f\u7406",children:"6. \u8be6\u7ec6\u89e3\u91ca AQS\uff08AbstractQueuedSynchronizer\uff09\u7684\u539f\u7406"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"AQS \u6838\u5fc3\u7ed3\u6784\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public abstract class AbstractQueuedSynchronizer {\n    // \u540c\u6b65\u72b6\u6001\n    private volatile int state;\n\n    // CLH \u961f\u5217\u5934\u5c3e\u8282\u70b9\n    private transient volatile Node head;\n    private transient volatile Node tail;\n\n    // \u5185\u90e8\u8282\u70b9\u7c7b\n    static final class Node {\n        volatile int waitStatus;\n        volatile Node prev;\n        volatile Node next;\n        volatile Thread thread;\n    }\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"AQS \u5de5\u4f5c\u539f\u7406\u56fe\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u83b7\u53d6\u9501\u5931\u8d25\u7684\u7ebf\u7a0b\u8fdb\u5165 CLH \u961f\u5217\u7b49\u5f85\n\n     head                                    tail\n       \u2502                                       \u2502\n       \u25bc                                       \u25bc\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502 Node \u2502\u25c4\u2500\u2500\u25ba\u2502 Node \u2502\u25c4\u2500\u2500\u25ba\u2502 Node \u2502\u25c4\u2500\u2500\u25ba\u2502 Node \u2502\n    \u2502(\u6301\u9501)\u2502    \u2502(\u7b49\u5f85)\u2502    \u2502(\u7b49\u5f85)\u2502    \u2502(\u7b49\u5f85)\u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"ReentrantLock \u83b7\u53d6\u9501\u6d41\u7a0b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// \u975e\u516c\u5e73\u9501\u83b7\u53d6\nfinal boolean nonfairTryAcquire(int acquires) {\n    final Thread current = Thread.currentThread();\n    int c = getState();\n    if (c == 0) {\n        // \u72b6\u6001\u4e3a0\uff0cCAS\u5c1d\u8bd5\u83b7\u53d6\u9501\n        if (compareAndSetState(0, acquires)) {\n            setExclusiveOwnerThread(current);\n            return true;\n        }\n    }\n    else if (current == getExclusiveOwnerThread()) {\n        // \u91cd\u5165\uff1a\u5f53\u524d\u7ebf\u7a0b\u5df2\u6301\u6709\u9501\n        int nextc = c + acquires;\n        setState(nextc);\n        return true;\n    }\n    return false;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u57fa\u4e8e AQS \u5b9e\u73b0\u81ea\u5b9a\u4e49\u540c\u6b65\u5668\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class SimpleLock {\n    private final Sync sync = new Sync();\n\n    private static class Sync extends AbstractQueuedSynchronizer {\n        @Override\n        protected boolean tryAcquire(int arg) {\n            if (compareAndSetState(0, 1)) {\n                setExclusiveOwnerThread(Thread.currentThread());\n                return true;\n            }\n            return false;\n        }\n\n        @Override\n        protected boolean tryRelease(int arg) {\n            setExclusiveOwnerThread(null);\n            setState(0);\n            return true;\n        }\n\n        @Override\n        protected boolean isHeldExclusively() {\n            return getState() == 1;\n        }\n    }\n\n    public void lock() { sync.acquire(1); }\n    public void unlock() { sync.release(1); }\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/multithreading",children:"\u591a\u7ebf\u7a0b - JUC \u5de5\u5177\u7c7b"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"7-\u7ebf\u7a0b\u6c60\u6838\u5fc3\u53c2\u6570\u5982\u4f55\u914d\u7f6e\u5982\u4f55\u76d1\u63a7\u7ebf\u7a0b\u6c60\u72b6\u6001",children:"7. \u7ebf\u7a0b\u6c60\u6838\u5fc3\u53c2\u6570\u5982\u4f55\u914d\u7f6e\uff1f\u5982\u4f55\u76d1\u63a7\u7ebf\u7a0b\u6c60\u72b6\u6001\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7ebf\u7a0b\u6c60\u53c2\u6570\u914d\u7f6e\u539f\u5219\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u573a\u666f"}),(0,i.jsx)(e.th,{children:"corePoolSize"}),(0,i.jsx)(e.th,{children:"maximumPoolSize"}),(0,i.jsx)(e.th,{children:"\u961f\u5217"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"CPU \u5bc6\u96c6\u578b"})}),(0,i.jsx)(e.td,{children:"CPU \u6838\u5fc3\u6570"}),(0,i.jsx)(e.td,{children:"CPU \u6838\u5fc3\u6570"}),(0,i.jsx)(e.td,{children:"\u5c0f\u961f\u5217"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"IO \u5bc6\u96c6\u578b"})}),(0,i.jsx)(e.td,{children:"2 * CPU \u6838\u5fc3\u6570"}),(0,i.jsx)(e.td,{children:"2 * CPU \u6838\u5fc3\u6570"}),(0,i.jsx)(e.td,{children:"\u5927\u961f\u5217"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u6df7\u5408\u578b"})}),(0,i.jsx)(e.td,{children:"\u6839\u636e IO/CPU \u6bd4\u4f8b\u8c03\u6574"}),(0,i.jsx)(e.td,{children:"-"}),(0,i.jsx)(e.td,{children:"-"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7ebf\u7a0b\u6c60\u53c2\u6570\u8ba1\u7b97\u516c\u5f0f\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u7ebf\u7a0b\u6570 = CPU \u6838\u5fc3\u6570 * (1 + \u7b49\u5f85\u65f6\u95f4/\u8ba1\u7b97\u65f6\u95f4)\n\n\u4f8b\u5982\uff1a8\u6838CPU\uff0cIO\u7b49\u5f85\u65f6\u95f4\u662f\u8ba1\u7b97\u65f6\u95f4\u76842\u500d\n\u7ebf\u7a0b\u6570 = 8 * (1 + 2) = 24\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u751f\u4ea7\u73af\u5883\u7ebf\u7a0b\u6c60\u914d\u7f6e\u793a\u4f8b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\npublic class ThreadPoolConfig {\n\n    @Bean("businessThreadPool")\n    public ThreadPoolExecutor businessThreadPool() {\n        int coreSize = Runtime.getRuntime().availableProcessors();\n\n        return new ThreadPoolExecutor(\n            coreSize,                              // \u6838\u5fc3\u7ebf\u7a0b\u6570\n            coreSize * 2,                          // \u6700\u5927\u7ebf\u7a0b\u6570\n            60L, TimeUnit.SECONDS,                 // \u7a7a\u95f2\u7ebf\u7a0b\u5b58\u6d3b\u65f6\u95f4\n            new LinkedBlockingQueue<>(1000),       // \u4efb\u52a1\u961f\u5217\n            new ThreadFactoryBuilder()\n                .setNameFormat("business-pool-%d")\n                .setUncaughtExceptionHandler((t, e) ->\n                    log.error("Thread {} error", t.getName(), e))\n                .build(),\n            new ThreadPoolExecutor.CallerRunsPolicy()  // \u62d2\u7edd\u7b56\u7565\n        );\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7ebf\u7a0b\u6c60\u76d1\u63a7\u65b9\u6848\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Scheduled(fixedRate = 60000)\npublic void monitorThreadPool() {\n    ThreadPoolExecutor executor = businessThreadPool;\n\n    // \u6838\u5fc3\u6307\u6807\n    int poolSize = executor.getPoolSize();           // \u5f53\u524d\u7ebf\u7a0b\u6570\n    int activeCount = executor.getActiveCount();     // \u6d3b\u8dc3\u7ebf\u7a0b\u6570\n    int queueSize = executor.getQueue().size();      // \u961f\u5217\u4efb\u52a1\u6570\n    long completedCount = executor.getCompletedTaskCount();  // \u5df2\u5b8c\u6210\u4efb\u52a1\u6570\n    long taskCount = executor.getTaskCount();        // \u603b\u4efb\u52a1\u6570\n\n    // \u544a\u8b66\u9608\u503c\n    double queueUsage = queueSize / 1000.0;\n    if (queueUsage > 0.8) {\n        log.warn("\u7ebf\u7a0b\u6c60\u961f\u5217\u4f7f\u7528\u7387\u8fc7\u9ad8: {}%", queueUsage * 100);\n    }\n\n    // \u4e0a\u62a5\u76d1\u63a7\u6307\u6807\n    Metrics.gauge("threadpool.pool.size", poolSize);\n    Metrics.gauge("threadpool.active.count", activeCount);\n    Metrics.gauge("threadpool.queue.size", queueSize);\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/multithreading#%E7%BA%BF%E7%A8%8B%E6%B1%A0",children:"\u591a\u7ebf\u7a0b - \u7ebf\u7a0b\u6c60"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"8-synchronized-\u9501\u5347\u7ea7\u8fc7\u7a0b\u662f\u600e\u6837\u7684",children:"8. synchronized \u9501\u5347\u7ea7\u8fc7\u7a0b\u662f\u600e\u6837\u7684\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u9501\u72b6\u6001\u6f14\u8fdb\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u65e0\u9501 \u2192 \u504f\u5411\u9501 \u2192 \u8f7b\u91cf\u7ea7\u9501 \u2192 \u91cd\u91cf\u7ea7\u9501\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5bf9\u8c61\u5934 Mark Word \u7ed3\u6784\uff0864 \u4f4d\uff09\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        Mark Word (64 bits)                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u65e0\u9501    \u2502 unused:25 \u2502 hashcode:31 \u2502 unused:1 \u2502 age:4 \u2502 0 \u2502 01 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u504f\u5411\u9501  \u2502 thread:54 \u2502 epoch:2 \u2502 unused:1 \u2502 age:4 \u2502 1 \u2502 01 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u8f7b\u91cf\u7ea7\u9501\u2502 ptr_to_lock_record:62                      \u2502 00 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 \u91cd\u91cf\u7ea7\u9501\u2502 ptr_to_heavyweight_monitor:62              \u2502 10 \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 GC\u6807\u8bb0  \u2502                                            \u2502 11 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u9501\u5347\u7ea7\u8be6\u7ec6\u8fc7\u7a0b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class LockEscalation {\n    private Object lock = new Object();\n\n    public void method() {\n        synchronized (lock) {\n            // 1. \u9996\u6b21\u83b7\u53d6\uff1a\u504f\u5411\u9501\n            //    - \u68c0\u67e5 Mark Word \u662f\u5426\u4e3a\u53ef\u504f\u5411\u72b6\u6001\n            //    - CAS \u5c06\u7ebf\u7a0b ID \u5199\u5165 Mark Word\n            //    - \u540e\u7eed\u540c\u4e00\u7ebf\u7a0b\u8fdb\u5165\u65e0\u9700 CAS\n\n            // 2. \u5176\u4ed6\u7ebf\u7a0b\u7ade\u4e89\uff1a\u5347\u7ea7\u4e3a\u8f7b\u91cf\u7ea7\u9501\n            //    - \u64a4\u9500\u504f\u5411\u9501\n            //    - \u5728\u6808\u5e27\u4e2d\u521b\u5efa Lock Record\n            //    - CAS \u5c06 Mark Word \u66ff\u6362\u4e3a Lock Record \u6307\u9488\n\n            // 3. CAS \u81ea\u65cb\u5931\u8d25\uff1a\u5347\u7ea7\u4e3a\u91cd\u91cf\u7ea7\u9501\n            //    - \u81ea\u65cb\u8d85\u8fc7\u9608\u503c\uff08\u9ed8\u8ba410\u6b21\uff09\n            //    - \u81a8\u80c0\u4e3a Monitor \u5bf9\u8c61\n            //    - \u7ebf\u7a0b\u8fdb\u5165\u963b\u585e\u72b6\u6001\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JVM \u9501\u4f18\u5316\u53c2\u6570\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u504f\u5411\u9501\uff08JDK 15 \u9ed8\u8ba4\u5173\u95ed\uff09\n-XX:+UseBiasedLocking\n-XX:BiasedLockingStartupDelay=0\n\n# \u81ea\u65cb\u9501\n-XX:PreBlockSpin=10  # \u81ea\u65cb\u6b21\u6570\n\n# \u67e5\u770b\u9501\u4fe1\u606f\n-XX:+PrintSafepointStatistics\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/multithreading#%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5",children:"\u591a\u7ebf\u7a0b - \u7ebf\u7a0b\u540c\u6b65"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"9-cas-\u539f\u7406\u662f\u4ec0\u4e48aba-\u95ee\u9898\u5982\u4f55\u89e3\u51b3",children:"9. CAS \u539f\u7406\u662f\u4ec0\u4e48\uff1fABA \u95ee\u9898\u5982\u4f55\u89e3\u51b3\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"CAS\uff08Compare And Swap\uff09\u539f\u7406\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// CAS \u4f2a\u4ee3\u7801\nboolean compareAndSwap(V* address, V expectedValue, V newValue) {\n    if (*address == expectedValue) {\n        *address = newValue;\n        return true;\n    }\n    return false;\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Java \u4e2d\u7684 CAS \u5b9e\u73b0\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class CASDemo {\n    private AtomicInteger count = new AtomicInteger(0);\n\n    public void increment() {\n        int oldValue, newValue;\n        do {\n            oldValue = count.get();\n            newValue = oldValue + 1;\n        } while (!count.compareAndSet(oldValue, newValue));\n    }\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"ABA \u95ee\u9898\u793a\u4f8b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u7ebf\u7a0b1\uff1a\u8bfb\u53d6\u503c A\n\u7ebf\u7a0b2\uff1a\u5c06 A \u6539\u4e3a B\n\u7ebf\u7a0b2\uff1a\u5c06 B \u6539\u56de A\n\u7ebf\u7a0b1\uff1aCAS \u6210\u529f\uff08\u4f46\u503c\u5df2\u88ab\u4fee\u6539\u8fc7\uff09\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u89e3\u51b3\u65b9\u6848 - AtomicStampedReference\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class ABADemo {\n    // \u4f7f\u7528\u7248\u672c\u53f7\u89e3\u51b3 ABA \u95ee\u9898\n    private AtomicStampedReference<Integer> ref =\n        new AtomicStampedReference<>(100, 0);\n\n    public void update() {\n        int[] stampHolder = new int[1];\n        Integer value = ref.get(stampHolder);\n        int stamp = stampHolder[0];\n\n        // CAS \u540c\u65f6\u6bd4\u8f83\u503c\u548c\u7248\u672c\u53f7\n        boolean success = ref.compareAndSet(\n            value,           // \u671f\u671b\u503c\n            value + 1,       // \u65b0\u503c\n            stamp,           // \u671f\u671b\u7248\u672c\u53f7\n            stamp + 1        // \u65b0\u7248\u672c\u53f7\n        );\n    }\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"LongAdder \u4f18\u5316\u539f\u7406\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// AtomicLong\uff1a\u6240\u6709\u7ebf\u7a0b\u7ade\u4e89\u540c\u4e00\u4e2a value\n// LongAdder\uff1a\u5206\u6563\u70ed\u70b9\uff0c\u51cf\u5c11\u7ade\u4e89\n\npublic class LongAdderDemo {\n    // \u9ad8\u5e76\u53d1\u573a\u666f\u63a8\u8350\u4f7f\u7528 LongAdder\n    private LongAdder counter = new LongAdder();\n\n    public void increment() {\n        counter.increment();  // \u5185\u90e8\u5206\u6563\u5230\u591a\u4e2a Cell\n    }\n\n    public long get() {\n        return counter.sum();  // \u6c47\u603b\u6240\u6709 Cell\n    }\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/multithreading",children:"\u591a\u7ebf\u7a0b - \u539f\u5b50\u7c7b"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"10-\u5982\u4f55\u5b9e\u73b0\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u5f0f",children:"10. \u5982\u4f55\u5b9e\u73b0\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u5f0f\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u65b9\u6848\u5bf9\u6bd4\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u6848"}),(0,i.jsx)(e.th,{children:"\u4f18\u70b9"}),(0,i.jsx)(e.th,{children:"\u7f3a\u70b9"}),(0,i.jsx)(e.th,{children:"\u9002\u7528\u573a\u666f"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"wait/notify"}),(0,i.jsx)(e.td,{children:"\u7b80\u5355"}),(0,i.jsx)(e.td,{children:"\u6027\u80fd\u4e00\u822c"}),(0,i.jsx)(e.td,{children:"\u7b80\u5355\u573a\u666f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"BlockingQueue"}),(0,i.jsx)(e.td,{children:"\u6613\u7528"}),(0,i.jsx)(e.td,{children:"\u6709\u9501\u5f00\u9500"}),(0,i.jsx)(e.td,{children:"\u4e00\u822c\u573a\u666f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Disruptor"}),(0,i.jsx)(e.td,{children:"\u6781\u9ad8\u6027\u80fd"}),(0,i.jsx)(e.td,{children:"\u590d\u6742"}),(0,i.jsx)(e.td,{children:"\u9ad8\u6027\u80fd\u573a\u666f"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"BlockingQueue \u5b9e\u73b0\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class ProducerConsumer {\n    private final BlockingQueue<Task> queue =\n        new ArrayBlockingQueue<>(1000);\n\n    // \u751f\u4ea7\u8005\n    class Producer implements Runnable {\n        @Override\n        public void run() {\n            while (true) {\n                Task task = createTask();\n                try {\n                    queue.put(task);  // \u961f\u5217\u6ee1\u65f6\u963b\u585e\n                } catch (InterruptedException e) {\n                    Thread.currentThread().interrupt();\n                    break;\n                }\n            }\n        }\n    }\n\n    // \u6d88\u8d39\u8005\n    class Consumer implements Runnable {\n        @Override\n        public void run() {\n            while (true) {\n                try {\n                    Task task = queue.take();  // \u961f\u5217\u7a7a\u65f6\u963b\u585e\n                    process(task);\n                } catch (InterruptedException e) {\n                    Thread.currentThread().interrupt();\n                    break;\n                }\n            }\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Disruptor \u9ad8\u6027\u80fd\u5b9e\u73b0\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"public class DisruptorDemo {\n\n    public static void main(String[] args) {\n        // \u521b\u5efa Disruptor\n        Disruptor<OrderEvent> disruptor = new Disruptor<>(\n            OrderEvent::new,\n            1024 * 1024,  // RingBuffer \u5927\u5c0f\uff0c\u5fc5\u987b\u662f2\u7684\u5e42\n            DaemonThreadFactory.INSTANCE,\n            ProducerType.MULTI,\n            new YieldingWaitStrategy()  // \u7b49\u5f85\u7b56\u7565\n        );\n\n        // \u8bbe\u7f6e\u6d88\u8d39\u8005\n        disruptor.handleEventsWith(new OrderEventHandler());\n\n        // \u542f\u52a8\n        RingBuffer<OrderEvent> ringBuffer = disruptor.start();\n\n        // \u751f\u4ea7\u8005\u53d1\u5e03\u4e8b\u4ef6\n        long sequence = ringBuffer.next();\n        try {\n            OrderEvent event = ringBuffer.get(sequence);\n            event.setOrderId(12345L);\n        } finally {\n            ringBuffer.publish(sequence);\n        }\n    }\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/multithreading",children:"\u591a\u7ebf\u7a0b - \u5e76\u53d1\u8bbe\u8ba1\u6a21\u5f0f"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"-\u6027\u80fd\u8c03\u4f18\u4e13\u5bb6\u7ea7",children:"\ud83c\udfaf \u6027\u80fd\u8c03\u4f18\uff08\u4e13\u5bb6\u7ea7\uff09"}),"\n",(0,i.jsx)(e.h3,{id:"11-\u5982\u4f55\u6392\u67e5\u7ebf\u4e0a-cpu-\u98d9\u9ad8\u95ee\u9898",children:"11. \u5982\u4f55\u6392\u67e5\u7ebf\u4e0a CPU \u98d9\u9ad8\u95ee\u9898\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6392\u67e5\u6b65\u9aa4\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# 1. \u627e\u5230 CPU \u5360\u7528\u6700\u9ad8\u7684 Java \u8fdb\u7a0b\ntop -c\n\n# 2. \u627e\u5230\u8fdb\u7a0b\u4e2d CPU \u5360\u7528\u6700\u9ad8\u7684\u7ebf\u7a0b\ntop -Hp <pid>\n\n# 3. \u5c06\u7ebf\u7a0b ID \u8f6c\u4e3a 16 \u8fdb\u5236\nprintf "%x\\n" <tid>\n\n# 4. \u5bfc\u51fa\u7ebf\u7a0b\u5806\u6808\njstack <pid> > thread_dump.txt\n\n# 5. \u5728\u5806\u6808\u4e2d\u641c\u7d22\u5bf9\u5e94\u7ebf\u7a0b\ngrep -A 30 "nid=0x<hex_tid>" thread_dump.txt\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4f7f\u7528 Arthas \u5feb\u901f\u5b9a\u4f4d\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:'# \u542f\u52a8 Arthas\njava -jar arthas-boot.jar\n\n# \u67e5\u770b\u6700\u7e41\u5fd9\u7684\u7ebf\u7a0b\nthread -n 3\n\n# \u67e5\u770b\u7279\u5b9a\u7ebf\u7a0b\u5806\u6808\nthread <tid>\n\n# \u5b9e\u65f6\u76d1\u63a7\u65b9\u6cd5\u6267\u884c\nwatch com.example.Service method "{params, returnObj}" -x 3\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5e38\u89c1 CPU \u98d9\u9ad8\u539f\u56e0\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// 1. \u6b7b\u5faa\u73af\nwhile (true) {\n    // \u6ca1\u6709 sleep \u6216\u963b\u585e\u64cd\u4f5c\n}\n\n// 2. \u9891\u7e41 GC\n// \u68c0\u67e5 GC \u65e5\u5fd7\uff0c\u53ef\u80fd\u662f\u5185\u5b58\u6cc4\u6f0f\u5bfc\u81f4\n\n// 3. \u6b63\u5219\u8868\u8fbe\u5f0f\u56de\u6eaf\nString regex = "(a+)+b";  // \u707e\u96be\u6027\u56de\u6eaf\n"aaaaaaaaaaaaaaaaaaaaac".matches(regex);\n\n// 4. \u5e8f\u5217\u5316/\u53cd\u5e8f\u5217\u5316\n// \u5927\u5bf9\u8c61\u9891\u7e41\u5e8f\u5217\u5316\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/performance",children:"\u6027\u80fd\u4f18\u5316 - \u95ee\u9898\u6392\u67e5"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"12-\u5982\u4f55\u6392\u67e5\u5185\u5b58\u6cc4\u6f0f\u95ee\u9898",children:"12. \u5982\u4f55\u6392\u67e5\u5185\u5b58\u6cc4\u6f0f\u95ee\u9898\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5185\u5b58\u6cc4\u6f0f\u6392\u67e5\u6b65\u9aa4\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# 1. \u67e5\u770b\u5806\u5185\u5b58\u4f7f\u7528\u60c5\u51b5\njmap -heap <pid>\n\n# 2. \u5bfc\u51fa\u5806\u8f6c\u50a8\u6587\u4ef6\njmap -dump:format=b,file=heap.hprof <pid>\n\n# 3. \u4f7f\u7528 MAT \u6216 VisualVM \u5206\u6790\n# \u91cd\u70b9\u5173\u6ce8\uff1a\n# - Dominator Tree\uff08\u652f\u914d\u6811\uff09\n# - Leak Suspects\uff08\u6cc4\u6f0f\u5acc\u7591\uff09\n# - Histogram\uff08\u5bf9\u8c61\u76f4\u65b9\u56fe\uff09\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4f7f\u7528 Arthas \u5728\u7ebf\u5206\u6790\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b\u5806\u5185\u5b58\u6982\u51b5\nmemory\n\n# \u67e5\u770b\u5bf9\u8c61\u5b9e\u4f8b\u6570\u91cf\nheapdump --live /tmp/heap.hprof\n\n# \u67e5\u770b\u7c7b\u52a0\u8f7d\u4fe1\u606f\nclassloader -l\n\n# \u641c\u7d22\u7c7b\u5b9e\u4f8b\nvmtool --action getInstances --className java.util.HashMap --limit 10\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5e38\u89c1\u5185\u5b58\u6cc4\u6f0f\u573a\u666f\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// 1. \u9759\u6001\u96c6\u5408\u6301\u6709\u5bf9\u8c61\u5f15\u7528\npublic class Cache {\n    private static Map<String, Object> cache = new HashMap<>();\n\n    public void add(String key, Object value) {\n        cache.put(key, value);  // \u6c38\u8fdc\u4e0d\u4f1a\u88ab GC\n    }\n}\n\n// 2. \u672a\u5173\u95ed\u7684\u8d44\u6e90\npublic void readFile() {\n    InputStream is = new FileInputStream("file.txt");\n    // \u5fd8\u8bb0\u5173\u95ed\uff0c\u5bfc\u81f4\u8d44\u6e90\u6cc4\u6f0f\n}\n\n// 3. \u76d1\u542c\u5668\u672a\u6ce8\u9500\npublic class EventManager {\n    private List<EventListener> listeners = new ArrayList<>();\n\n    public void addListener(EventListener listener) {\n        listeners.add(listener);\n    }\n    // \u7f3a\u5c11 removeListener \u65b9\u6cd5\n}\n\n// 4. ThreadLocal \u672a\u6e05\u7406\nprivate static ThreadLocal<User> userHolder = new ThreadLocal<>();\n\npublic void process() {\n    userHolder.set(new User());\n    // \u7ebf\u7a0b\u6c60\u573a\u666f\u4e0b\uff0c\u7ebf\u7a0b\u590d\u7528\u5bfc\u81f4 ThreadLocal \u4e0d\u4f1a\u88ab\u6e05\u7406\n    // \u5e94\u8be5\u5728 finally \u4e2d\u8c03\u7528 userHolder.remove()\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/performance",children:"\u6027\u80fd\u4f18\u5316 - \u5185\u5b58\u4f18\u5316"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"13-arthas-\u6709\u54ea\u4e9b\u5e38\u7528\u547d\u4ee4\u5982\u4f55\u4f7f\u7528",children:"13. Arthas \u6709\u54ea\u4e9b\u5e38\u7528\u547d\u4ee4\uff1f\u5982\u4f55\u4f7f\u7528\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Arthas \u6838\u5fc3\u547d\u4ee4\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u547d\u4ee4"}),(0,i.jsx)(e.th,{children:"\u529f\u80fd"}),(0,i.jsx)(e.th,{children:"\u793a\u4f8b"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"dashboard"})}),(0,i.jsx)(e.td,{children:"\u7cfb\u7edf\u5b9e\u65f6\u9762\u677f"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"dashboard"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"thread"})}),(0,i.jsx)(e.td,{children:"\u7ebf\u7a0b\u4fe1\u606f"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"thread -n 3"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"jvm"})}),(0,i.jsx)(e.td,{children:"JVM \u4fe1\u606f"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"jvm"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"memory"})}),(0,i.jsx)(e.td,{children:"\u5185\u5b58\u4fe1\u606f"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"memory"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"watch"})}),(0,i.jsx)(e.td,{children:"\u65b9\u6cd5\u76d1\u63a7"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:'watch class method "{params}"'})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"trace"})}),(0,i.jsx)(e.td,{children:"\u65b9\u6cd5\u8c03\u7528\u94fe\u8def"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"trace class method"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"stack"})}),(0,i.jsx)(e.td,{children:"\u65b9\u6cd5\u8c03\u7528\u6808"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"stack class method"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"tt"})}),(0,i.jsx)(e.td,{children:"\u65f6\u95f4\u96a7\u9053"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"tt -t class method"})})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"profiler"})}),(0,i.jsx)(e.td,{children:"\u706b\u7130\u56fe"}),(0,i.jsx)(e.td,{children:(0,i.jsx)(e.code,{children:"profiler start"})})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5b9e\u6218\u793a\u4f8b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# 1. \u67e5\u770b\u65b9\u6cd5\u5165\u53c2\u548c\u8fd4\u56de\u503c\nwatch com.example.UserService getUser \"{params, returnObj}\" -x 3\n\n# 2. \u8ffd\u8e2a\u65b9\u6cd5\u8c03\u7528\u8017\u65f6\ntrace com.example.UserService getUser '#cost > 100'\n\n# 3. \u67e5\u770b\u65b9\u6cd5\u8c03\u7528\u6808\nstack com.example.UserService getUser\n\n# 4. \u65f6\u95f4\u96a7\u9053 - \u8bb0\u5f55\u65b9\u6cd5\u8c03\u7528\ntt -t com.example.UserService getUser\ntt -i 1001  # \u67e5\u770b\u7b2c1001\u6b21\u8c03\u7528\ntt -i 1001 -p  # \u91cd\u653e\u8c03\u7528\n\n# 5. \u751f\u6210\u706b\u7130\u56fe\nprofiler start\n# \u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\nprofiler stop --format html --file /tmp/flame.html\n\n# 6. \u53cd\u7f16\u8bd1\u7c7b\njad com.example.UserService\n\n# 7. \u70ed\u66f4\u65b0\u4ee3\u7801\nredefine /tmp/UserService.class\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/java/performance",children:"\u6027\u80fd\u4f18\u5316 - \u76d1\u63a7\u5de5\u5177"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"14-\u5982\u4f55\u4f18\u5316\u6570\u636e\u5e93\u67e5\u8be2\u6027\u80fd",children:"14. \u5982\u4f55\u4f18\u5316\u6570\u636e\u5e93\u67e5\u8be2\u6027\u80fd\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"SQL \u4f18\u5316\u539f\u5219\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"-- 1. \u907f\u514d SELECT *\nSELECT id, name, age FROM users WHERE id = 1;\n\n-- 2. \u4f7f\u7528\u8986\u76d6\u7d22\u5f15\nCREATE INDEX idx_name_age ON users(name, age);\nSELECT name, age FROM users WHERE name = 'Tom';  -- \u4e0d\u9700\u8981\u56de\u8868\n\n-- 3. \u907f\u514d\u7d22\u5f15\u5931\u6548\n-- \u9519\u8bef\uff1a\u51fd\u6570\u64cd\u4f5c\u5bfc\u81f4\u7d22\u5f15\u5931\u6548\nSELECT * FROM users WHERE YEAR(create_time) = 2024;\n-- \u6b63\u786e\uff1a\u8303\u56f4\u67e5\u8be2\nSELECT * FROM users WHERE create_time >= '2024-01-01' AND create_time < '2025-01-01';\n\n-- 4. \u907f\u514d OR \u5bfc\u81f4\u7d22\u5f15\u5931\u6548\n-- \u9519\u8bef\nSELECT * FROM users WHERE name = 'Tom' OR age = 20;\n-- \u6b63\u786e\uff1a\u4f7f\u7528 UNION\nSELECT * FROM users WHERE name = 'Tom'\nUNION\nSELECT * FROM users WHERE age = 20;\n\n-- 5. \u5206\u9875\u4f18\u5316\n-- \u9519\u8bef\uff1a\u6df1\u5206\u9875\u6027\u80fd\u5dee\nSELECT * FROM users LIMIT 1000000, 10;\n-- \u6b63\u786e\uff1a\u4f7f\u7528\u6e38\u6807\u5206\u9875\nSELECT * FROM users WHERE id > 1000000 LIMIT 10;\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u8fde\u63a5\u6c60\u914d\u7f6e\u4f18\u5316\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:"# HikariCP \u914d\u7f6e\nspring:\n  datasource:\n    hikari:\n      minimum-idle: 10\n      maximum-pool-size: 50\n      idle-timeout: 600000\n      max-lifetime: 1800000\n      connection-timeout: 30000\n      connection-test-query: SELECT 1\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6162\u67e5\u8be2\u5206\u6790\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-sql",children:"-- \u5f00\u542f\u6162\u67e5\u8be2\u65e5\u5fd7\nSET GLOBAL slow_query_log = 'ON';\nSET GLOBAL long_query_time = 1;\n\n-- \u4f7f\u7528 EXPLAIN \u5206\u6790\nEXPLAIN SELECT * FROM users WHERE name = 'Tom';\n\n-- \u5173\u6ce8\u5b57\u6bb5\uff1a\n-- type: \u8bbf\u95ee\u7c7b\u578b\uff08ALL < index < range < ref < eq_ref < const\uff09\n-- key: \u4f7f\u7528\u7684\u7d22\u5f15\n-- rows: \u626b\u63cf\u884c\u6570\n-- Extra: \u989d\u5916\u4fe1\u606f\uff08Using filesort, Using temporary \u9700\u8981\u4f18\u5316\uff09\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/mysql/performance-optimization",children:"MySQL \u6027\u80fd\u4f18\u5316"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"15-\u7f13\u5b58\u7a7f\u900f\u7f13\u5b58\u51fb\u7a7f\u7f13\u5b58\u96ea\u5d29\u5982\u4f55\u89e3\u51b3",children:"15. \u7f13\u5b58\u7a7f\u900f\u3001\u7f13\u5b58\u51fb\u7a7f\u3001\u7f13\u5b58\u96ea\u5d29\u5982\u4f55\u89e3\u51b3\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u95ee\u9898"}),(0,i.jsx)(e.th,{children:"\u63cf\u8ff0"}),(0,i.jsx)(e.th,{children:"\u89e3\u51b3\u65b9\u6848"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u7f13\u5b58\u7a7f\u900f"})}),(0,i.jsx)(e.td,{children:"\u67e5\u8be2\u4e0d\u5b58\u5728\u7684\u6570\u636e"}),(0,i.jsx)(e.td,{children:"\u5e03\u9686\u8fc7\u6ee4\u5668\u3001\u7a7a\u503c\u7f13\u5b58"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u7f13\u5b58\u51fb\u7a7f"})}),(0,i.jsx)(e.td,{children:"\u70ed\u70b9 key \u8fc7\u671f"}),(0,i.jsx)(e.td,{children:"\u4e92\u65a5\u9501\u3001\u6c38\u4e0d\u8fc7\u671f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u7f13\u5b58\u96ea\u5d29"})}),(0,i.jsx)(e.td,{children:"\u5927\u91cf key \u540c\u65f6\u8fc7\u671f"}),(0,i.jsx)(e.td,{children:"\u968f\u673a\u8fc7\u671f\u65f6\u95f4\u3001\u591a\u7ea7\u7f13\u5b58"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7f13\u5b58\u7a7f\u900f\u89e3\u51b3\u65b9\u6848\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// \u65b9\u68481\uff1a\u5e03\u9686\u8fc7\u6ee4\u5668\npublic class BloomFilterDemo {\n    private BloomFilter<String> bloomFilter = BloomFilter.create(\n        Funnels.stringFunnel(Charset.defaultCharset()),\n        1000000,  // \u9884\u671f\u5143\u7d20\u6570\u91cf\n        0.01      // \u8bef\u5224\u7387\n    );\n\n    public User getUser(String id) {\n        // \u5148\u68c0\u67e5\u5e03\u9686\u8fc7\u6ee4\u5668\n        if (!bloomFilter.mightContain(id)) {\n            return null;  // \u4e00\u5b9a\u4e0d\u5b58\u5728\n        }\n        // \u67e5\u7f13\u5b58\u548c\u6570\u636e\u5e93\n        return getUserFromCacheOrDB(id);\n    }\n}\n\n// \u65b9\u68482\uff1a\u7a7a\u503c\u7f13\u5b58\npublic User getUser(String id) {\n    String cacheKey = "user:" + id;\n    User user = cache.get(cacheKey);\n\n    if (user == null) {\n        user = db.getUser(id);\n        if (user == null) {\n            // \u7f13\u5b58\u7a7a\u503c\uff0c\u8bbe\u7f6e\u8f83\u77ed\u8fc7\u671f\u65f6\u95f4\n            cache.set(cacheKey, NULL_USER, 60);\n        } else {\n            cache.set(cacheKey, user, 3600);\n        }\n    }\n    return user == NULL_USER ? null : user;\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7f13\u5b58\u51fb\u7a7f\u89e3\u51b3\u65b9\u6848\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// \u65b9\u6848\uff1a\u4e92\u65a5\u9501\npublic User getUser(String id) {\n    String cacheKey = "user:" + id;\n    User user = cache.get(cacheKey);\n\n    if (user == null) {\n        String lockKey = "lock:user:" + id;\n        // \u5c1d\u8bd5\u83b7\u53d6\u5206\u5e03\u5f0f\u9501\n        if (redis.setnx(lockKey, "1", 10)) {\n            try {\n                // \u53cc\u91cd\u68c0\u67e5\n                user = cache.get(cacheKey);\n                if (user == null) {\n                    user = db.getUser(id);\n                    cache.set(cacheKey, user, 3600);\n                }\n            } finally {\n                redis.del(lockKey);\n            }\n        } else {\n            // \u7b49\u5f85\u540e\u91cd\u8bd5\n            Thread.sleep(100);\n            return getUser(id);\n        }\n    }\n    return user;\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7f13\u5b58\u96ea\u5d29\u89e3\u51b3\u65b9\u6848\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// \u65b9\u68481\uff1a\u968f\u673a\u8fc7\u671f\u65f6\u95f4\npublic void setCache(String key, Object value) {\n    int baseExpire = 3600;\n    int randomExpire = new Random().nextInt(600);  // 0-600\u79d2\u968f\u673a\n    cache.set(key, value, baseExpire + randomExpire);\n}\n\n// \u65b9\u68482\uff1a\u591a\u7ea7\u7f13\u5b58\npublic User getUser(String id) {\n    // L1: \u672c\u5730\u7f13\u5b58\uff08Caffeine\uff09\n    User user = localCache.get(id);\n    if (user != null) return user;\n\n    // L2: \u5206\u5e03\u5f0f\u7f13\u5b58\uff08Redis\uff09\n    user = redisCache.get(id);\n    if (user != null) {\n        localCache.put(id, user);\n        return user;\n    }\n\n    // L3: \u6570\u636e\u5e93\n    user = db.getUser(id);\n    redisCache.set(id, user);\n    localCache.put(id, user);\n    return user;\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/redis/cache-strategies",children:"Redis \u7f13\u5b58\u7b56\u7565"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"-\u67b6\u6784\u8bbe\u8ba1\u4e13\u5bb6\u7ea7",children:"\ud83c\udfaf \u67b6\u6784\u8bbe\u8ba1\uff08\u4e13\u5bb6\u7ea7\uff09"}),"\n",(0,i.jsx)(e.h3,{id:"16-\u4ec0\u4e48\u662f-cap-\u7406\u8bba\u5982\u4f55\u5728\u5b9e\u9645\u7cfb\u7edf\u4e2d\u6743\u8861",children:"16. \u4ec0\u4e48\u662f CAP \u7406\u8bba\uff1f\u5982\u4f55\u5728\u5b9e\u9645\u7cfb\u7edf\u4e2d\u6743\u8861\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"CAP \u4e09\u8981\u7d20\uff1a"})}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"C\uff08Consistency\uff09\u4e00\u81f4\u6027"}),"\uff1a\u6240\u6709\u8282\u70b9\u540c\u4e00\u65f6\u523b\u6570\u636e\u76f8\u540c"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"A\uff08Availability\uff09\u53ef\u7528\u6027"}),"\uff1a\u6bcf\u4e2a\u8bf7\u6c42\u90fd\u80fd\u5f97\u5230\u54cd\u5e94"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"P\uff08Partition tolerance\uff09\u5206\u533a\u5bb9\u9519"}),"\uff1a\u7f51\u7edc\u5206\u533a\u65f6\u7cfb\u7edf\u4ecd\u80fd\u8fd0\u884c"]}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"CAP \u4e0d\u53ef\u80fd\u4e09\u89d2\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"        C\uff08\u4e00\u81f4\u6027\uff09\n           /\\\n          /  \\\n         /    \\\n        /  CA  \\\n       /________\\\n      A          P\n   (\u53ef\u7528\u6027)  (\u5206\u533a\u5bb9\u9519)\n\n\u5206\u5e03\u5f0f\u7cfb\u7edf\u5fc5\u987b\u9009\u62e9 P\uff0c\u56e0\u6b64\u53ea\u80fd\u5728 CP \u548c AP \u4e4b\u95f4\u9009\u62e9\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5b9e\u9645\u7cfb\u7edf\u9009\u62e9\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u7cfb\u7edf"}),(0,i.jsx)(e.th,{children:"\u9009\u62e9"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"ZooKeeper"}),(0,i.jsx)(e.td,{children:"CP"}),(0,i.jsx)(e.td,{children:"\u5f3a\u4e00\u81f4\u6027\uff0c\u53ef\u80fd\u77ed\u6682\u4e0d\u53ef\u7528"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Eureka"}),(0,i.jsx)(e.td,{children:"AP"}),(0,i.jsx)(e.td,{children:"\u9ad8\u53ef\u7528\uff0c\u5141\u8bb8\u6570\u636e\u4e0d\u4e00\u81f4"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Redis Cluster"}),(0,i.jsx)(e.td,{children:"AP"}),(0,i.jsx)(e.td,{children:"\u5f02\u6b65\u590d\u5236\uff0c\u53ef\u80fd\u4e22\u6570\u636e"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"MySQL \u4e3b\u4ece"}),(0,i.jsx)(e.td,{children:"CP"}),(0,i.jsx)(e.td,{children:"\u540c\u6b65\u590d\u5236\u4fdd\u8bc1\u4e00\u81f4\u6027"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"BASE \u7406\u8bba\uff08AP \u7684\u5ef6\u4f38\uff09\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"BA - Basically Available\uff08\u57fa\u672c\u53ef\u7528\uff09\nS  - Soft state\uff08\u8f6f\u72b6\u6001\uff09\nE  - Eventually consistent\uff08\u6700\u7ec8\u4e00\u81f4\u6027\uff09\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5b9e\u9645\u6743\u8861\u793a\u4f8b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// \u7535\u5546\u4e0b\u5355\u573a\u666f\n// 1. \u5e93\u5b58\u6263\u51cf - \u9700\u8981\u5f3a\u4e00\u81f4\u6027\uff08CP\uff09\n// 2. \u8ba2\u5355\u521b\u5efa - \u9700\u8981\u9ad8\u53ef\u7528\uff08AP\uff09\n// 3. \u901a\u77e5\u53d1\u9001 - \u6700\u7ec8\u4e00\u81f4\u6027\u5373\u53ef\n\n@Transactional\npublic Order createOrder(OrderRequest request) {\n    // CP: \u540c\u6b65\u6263\u51cf\u5e93\u5b58\n    inventoryService.deduct(request.getProductId(), request.getQuantity());\n\n    // AP: \u521b\u5efa\u8ba2\u5355\n    Order order = orderRepository.save(new Order(request));\n\n    // \u6700\u7ec8\u4e00\u81f4\u6027: \u5f02\u6b65\u53d1\u9001\u901a\u77e5\n    messageQueue.send(new OrderCreatedEvent(order));\n\n    return order;\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/microservices/core-concepts",children:"\u5fae\u670d\u52a1 - \u5206\u5e03\u5f0f\u7406\u8bba"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"17-\u5206\u5e03\u5f0f\u4e8b\u52a1\u6709\u54ea\u4e9b\u89e3\u51b3\u65b9\u6848\u5404\u6709\u4ec0\u4e48\u4f18\u7f3a\u70b9",children:"17. \u5206\u5e03\u5f0f\u4e8b\u52a1\u6709\u54ea\u4e9b\u89e3\u51b3\u65b9\u6848\uff1f\u5404\u6709\u4ec0\u4e48\u4f18\u7f3a\u70b9\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u5206\u5e03\u5f0f\u4e8b\u52a1\u65b9\u6848\u5bf9\u6bd4\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u6848"}),(0,i.jsx)(e.th,{children:"\u4e00\u81f4\u6027"}),(0,i.jsx)(e.th,{children:"\u6027\u80fd"}),(0,i.jsx)(e.th,{children:"\u590d\u6742\u5ea6"}),(0,i.jsx)(e.th,{children:"\u9002\u7528\u573a\u666f"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"2PC"}),(0,i.jsx)(e.td,{children:"\u5f3a\u4e00\u81f4"}),(0,i.jsx)(e.td,{children:"\u4f4e"}),(0,i.jsx)(e.td,{children:"\u4e2d"}),(0,i.jsx)(e.td,{children:"\u6570\u636e\u5e93\u5206\u5e03\u5f0f\u4e8b\u52a1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"TCC"}),(0,i.jsx)(e.td,{children:"\u6700\u7ec8\u4e00\u81f4"}),(0,i.jsx)(e.td,{children:"\u4e2d"}),(0,i.jsx)(e.td,{children:"\u9ad8"}),(0,i.jsx)(e.td,{children:"\u8d44\u91d1\u4ea4\u6613"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Saga"}),(0,i.jsx)(e.td,{children:"\u6700\u7ec8\u4e00\u81f4"}),(0,i.jsx)(e.td,{children:"\u9ad8"}),(0,i.jsx)(e.td,{children:"\u4e2d"}),(0,i.jsx)(e.td,{children:"\u957f\u4e8b\u52a1"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u672c\u5730\u6d88\u606f\u8868"}),(0,i.jsx)(e.td,{children:"\u6700\u7ec8\u4e00\u81f4"}),(0,i.jsx)(e.td,{children:"\u9ad8"}),(0,i.jsx)(e.td,{children:"\u4f4e"}),(0,i.jsx)(e.td,{children:"\u5f02\u6b65\u573a\u666f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"MQ \u4e8b\u52a1\u6d88\u606f"}),(0,i.jsx)(e.td,{children:"\u6700\u7ec8\u4e00\u81f4"}),(0,i.jsx)(e.td,{children:"\u9ad8"}),(0,i.jsx)(e.td,{children:"\u4f4e"}),(0,i.jsx)(e.td,{children:"\u6d88\u606f\u9a71\u52a8"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"TCC \u5b9e\u73b0\u793a\u4f8b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// TCC: Try-Confirm-Cancel\npublic interface AccountService {\n    // Try: \u9884\u7559\u8d44\u6e90\n    @TwoPhaseBusinessAction(name = "deduct",\n        commitMethod = "confirm", rollbackMethod = "cancel")\n    boolean tryDeduct(BusinessActionContext context,\n                      @BusinessActionContextParameter("accountId") String accountId,\n                      @BusinessActionContextParameter("amount") BigDecimal amount);\n\n    // Confirm: \u786e\u8ba4\u63d0\u4ea4\n    boolean confirm(BusinessActionContext context);\n\n    // Cancel: \u53d6\u6d88\u56de\u6eda\n    boolean cancel(BusinessActionContext context);\n}\n\n@Service\npublic class AccountServiceImpl implements AccountService {\n\n    @Override\n    public boolean tryDeduct(BusinessActionContext context,\n                             String accountId, BigDecimal amount) {\n        // \u51bb\u7ed3\u91d1\u989d\n        accountDao.freeze(accountId, amount);\n        return true;\n    }\n\n    @Override\n    public boolean confirm(BusinessActionContext context) {\n        String accountId = context.getActionContext("accountId");\n        BigDecimal amount = context.getActionContext("amount");\n        // \u6263\u51cf\u51bb\u7ed3\u91d1\u989d\n        accountDao.deductFrozen(accountId, amount);\n        return true;\n    }\n\n    @Override\n    public boolean cancel(BusinessActionContext context) {\n        String accountId = context.getActionContext("accountId");\n        BigDecimal amount = context.getActionContext("amount");\n        // \u89e3\u51bb\u91d1\u989d\n        accountDao.unfreeze(accountId, amount);\n        return true;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u672c\u5730\u6d88\u606f\u8868\u65b9\u6848\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Transactional\npublic void createOrder(OrderRequest request) {\n    // 1. \u521b\u5efa\u8ba2\u5355\n    Order order = orderRepository.save(new Order(request));\n\n    // 2. \u5199\u5165\u672c\u5730\u6d88\u606f\u8868\uff08\u540c\u4e00\u4e8b\u52a1\uff09\n    LocalMessage message = new LocalMessage();\n    message.setMessageId(UUID.randomUUID().toString());\n    message.setContent(JSON.toJSONString(new OrderCreatedEvent(order)));\n    message.setStatus("PENDING");\n    localMessageRepository.save(message);\n}\n\n// \u5b9a\u65f6\u4efb\u52a1\u53d1\u9001\u6d88\u606f\n@Scheduled(fixedRate = 1000)\npublic void sendPendingMessages() {\n    List<LocalMessage> messages = localMessageRepository.findByStatus("PENDING");\n    for (LocalMessage message : messages) {\n        try {\n            messageQueue.send(message.getContent());\n            message.setStatus("SENT");\n            localMessageRepository.save(message);\n        } catch (Exception e) {\n            // \u91cd\u8bd5\n        }\n    }\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/microservices/design-patterns",children:"\u5fae\u670d\u52a1 - \u5206\u5e03\u5f0f\u4e8b\u52a1"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"18-\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u9ad8\u53ef\u7528\u7684\u7cfb\u7edf",children:"18. \u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u9ad8\u53ef\u7528\u7684\u7cfb\u7edf\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u9ad8\u53ef\u7528\u8bbe\u8ba1\u539f\u5219\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u53ef\u7528\u6027 = MTBF / (MTBF + MTTR)\n\nMTBF: \u5e73\u5747\u6545\u969c\u95f4\u9694\u65f6\u95f4\nMTTR: \u5e73\u5747\u4fee\u590d\u65f6\u95f4\n\n99.9%  = 8.76 \u5c0f\u65f6/\u5e74 \u505c\u673a\n99.99% = 52.6 \u5206\u949f/\u5e74 \u505c\u673a\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u9ad8\u53ef\u7528\u67b6\u6784\u8bbe\u8ba1\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502   DNS/CDN   \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u2502\n              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n              \u2502            \u2502            \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502   LB-1    \u2502 \u2502  LB-2   \u2502 \u2502   LB-3    \u2502  \u8d1f\u8f7d\u5747\u8861\n        \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2502            \u2502            \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502         \u2502            \u2502            \u2502         \u2502\n\u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2510\n\u2502 App-1 \u2502 \u2502 App-2 \u2502 \u2502    App-3    \u2502 \u2502 App-4 \u2502 \u2502 App-5 \u2502  \u5e94\u7528\u96c6\u7fa4\n\u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2518\n    \u2502         \u2502            \u2502            \u2502         \u2502\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2502            \u2502            \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502  Redis-M  \u2502 \u2502 Redis-S \u2502 \u2502  Redis-S  \u2502  \u7f13\u5b58\u96c6\u7fa4\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2502\n        \u250c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502  MySQL-M  \u2502 \u2502 MySQL-S \u2502 \u2502  MySQL-S  \u2502  \u6570\u636e\u5e93\u96c6\u7fa4\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u9650\u6d41\u7194\u65ad\u5b9e\u73b0\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// Sentinel \u9650\u6d41\u914d\u7f6e\n@SentinelResource(value = "getUser",\n    blockHandler = "getUserBlockHandler",\n    fallback = "getUserFallback")\npublic User getUser(String id) {\n    return userService.getUser(id);\n}\n\n// \u9650\u6d41\u5904\u7406\npublic User getUserBlockHandler(String id, BlockException e) {\n    return new User("\u9650\u6d41\u4e2d\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5");\n}\n\n// \u964d\u7ea7\u5904\u7406\npublic User getUserFallback(String id, Throwable e) {\n    return new User("\u670d\u52a1\u6682\u65f6\u4e0d\u53ef\u7528");\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/microservices/service-governance",children:"\u5fae\u670d\u52a1 - \u670d\u52a1\u6cbb\u7406"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"19-\u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u79d2\u6740\u7cfb\u7edf",children:"19. \u5982\u4f55\u8bbe\u8ba1\u4e00\u4e2a\u79d2\u6740\u7cfb\u7edf\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u79d2\u6740\u7cfb\u7edf\u67b6\u6784\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u7528\u6237\u8bf7\u6c42 \u2192 CDN \u2192 \u7f51\u5173\uff08\u9650\u6d41\uff09\u2192 \u79d2\u6740\u670d\u52a1 \u2192 Redis \u2192 \u6d88\u606f\u961f\u5217 \u2192 \u8ba2\u5355\u670d\u52a1\n                    \u2193\n              \u9759\u6001\u9875\u9762\u7f13\u5b58\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6838\u5fc3\u8bbe\u8ba1\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// 1. \u5e93\u5b58\u9884\u70ed\u5230 Redis\n@PostConstruct\npublic void initStock() {\n    List<SeckillProduct> products = productService.getSeckillProducts();\n    for (SeckillProduct product : products) {\n        redisTemplate.opsForValue().set(\n            "seckill:stock:" + product.getId(),\n            product.getStock()\n        );\n    }\n}\n\n// 2. Redis \u539f\u5b50\u6263\u51cf\u5e93\u5b58\npublic boolean deductStock(Long productId) {\n    String key = "seckill:stock:" + productId;\n    Long stock = redisTemplate.opsForValue().decrement(key);\n    if (stock < 0) {\n        // \u5e93\u5b58\u4e0d\u8db3\uff0c\u6062\u590d\n        redisTemplate.opsForValue().increment(key);\n        return false;\n    }\n    return true;\n}\n\n// 3. \u5f02\u6b65\u521b\u5efa\u8ba2\u5355\n@Transactional\npublic void createOrder(SeckillRequest request) {\n    // \u6263\u51cf Redis \u5e93\u5b58\n    if (!deductStock(request.getProductId())) {\n        throw new SeckillException("\u5e93\u5b58\u4e0d\u8db3");\n    }\n\n    // \u53d1\u9001\u6d88\u606f\u5f02\u6b65\u521b\u5efa\u8ba2\u5355\n    OrderMessage message = new OrderMessage(\n        request.getUserId(),\n        request.getProductId()\n    );\n    kafkaTemplate.send("seckill-order", message);\n}\n\n// 4. \u6d88\u8d39\u8005\u5904\u7406\u8ba2\u5355\n@KafkaListener(topics = "seckill-order")\npublic void handleOrder(OrderMessage message) {\n    // \u521b\u5efa\u8ba2\u5355\n    Order order = new Order();\n    order.setUserId(message.getUserId());\n    order.setProductId(message.getProductId());\n    orderRepository.save(order);\n\n    // \u6263\u51cf\u6570\u636e\u5e93\u5e93\u5b58\n    productRepository.deductStock(message.getProductId());\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u9632\u5237\u7b56\u7565\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// 1. \u7528\u6237\u9650\u6d41\n@RateLimiter(key = "seckill:user:#userId", rate = 1, interval = 1)\npublic void seckill(Long userId, Long productId) { }\n\n// 2. IP \u9650\u6d41\n@RateLimiter(key = "seckill:ip:#ip", rate = 10, interval = 1)\npublic void seckill(String ip, Long productId) { }\n\n// 3. \u9a8c\u8bc1\u7801\n// 4. \u9690\u85cf\u79d2\u6740\u63a5\u53e3\uff08\u52a8\u6001 URL\uff09\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/microservices/design-patterns",children:"\u5fae\u670d\u52a1 - \u9ad8\u5e76\u53d1\u8bbe\u8ba1"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"20-\u5fae\u670d\u52a1\u62c6\u5206\u7684\u539f\u5219\u662f\u4ec0\u4e48\u5982\u4f55\u786e\u5b9a\u670d\u52a1\u8fb9\u754c",children:"20. \u5fae\u670d\u52a1\u62c6\u5206\u7684\u539f\u5219\u662f\u4ec0\u4e48\uff1f\u5982\u4f55\u786e\u5b9a\u670d\u52a1\u8fb9\u754c\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u670d\u52a1\u62c6\u5206\u539f\u5219\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u539f\u5219"}),(0,i.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u5355\u4e00\u804c\u8d23"})}),(0,i.jsx)(e.td,{children:"\u6bcf\u4e2a\u670d\u52a1\u53ea\u8d1f\u8d23\u4e00\u4e2a\u4e1a\u52a1\u9886\u57df"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u9ad8\u5185\u805a\u4f4e\u8026\u5408"})}),(0,i.jsx)(e.td,{children:"\u670d\u52a1\u5185\u90e8\u9ad8\u5ea6\u76f8\u5173\uff0c\u670d\u52a1\u95f4\u4f9d\u8d56\u6700\u5c0f"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u4e1a\u52a1\u8fb9\u754c\u6e05\u6670"})}),(0,i.jsx)(e.td,{children:"\u57fa\u4e8e\u9886\u57df\u9a71\u52a8\u8bbe\u8ba1\uff08DDD\uff09\u5212\u5206"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u6570\u636e\u72ec\u7acb"})}),(0,i.jsx)(e.td,{children:"\u6bcf\u4e2a\u670d\u52a1\u62e5\u6709\u72ec\u7acb\u7684\u6570\u636e\u5b58\u50a8"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"\u53ef\u72ec\u7acb\u90e8\u7f72"})}),(0,i.jsx)(e.td,{children:"\u670d\u52a1\u53ef\u4ee5\u72ec\u7acb\u5f00\u53d1\u3001\u6d4b\u8bd5\u3001\u90e8\u7f72"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"DDD \u9886\u57df\u5212\u5206\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u7535\u5546\u7cfb\u7edf\u9886\u57df\u5212\u5206\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      \u6838\u5fc3\u57df                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502  \u2502 \u5546\u54c1\u57df   \u2502  \u2502 \u8ba2\u5355\u57df   \u2502  \u2502 \u652f\u4ed8\u57df   \u2502  \u2502 \u5e93\u5b58\u57df   \u2502    \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      \u652f\u6491\u57df                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502 \u7528\u6237\u57df   \u2502  \u2502 \u8425\u9500\u57df   \u2502  \u2502 \u7269\u6d41\u57df   \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                      \u901a\u7528\u57df                              \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502 \u6d88\u606f\u901a\u77e5 \u2502  \u2502 \u6587\u4ef6\u5b58\u50a8 \u2502  \u2502 \u65e5\u5fd7\u76d1\u63a7 \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u670d\u52a1\u62c6\u5206\u53cd\u6a21\u5f0f\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// \u274c \u9519\u8bef\uff1a\u5206\u5e03\u5f0f\u5355\u4f53\n// \u670d\u52a1\u95f4\u5f3a\u4f9d\u8d56\uff0c\u540c\u6b65\u8c03\u7528\u94fe\u8fc7\u957f\nOrderService \u2192 InventoryService \u2192 PaymentService \u2192 LogisticsService\n\n// \u2705 \u6b63\u786e\uff1a\u4e8b\u4ef6\u9a71\u52a8\u89e3\u8026\nOrderService --\u53d1\u5e03\u4e8b\u4ef6--\x3e EventBus\n                              \u2193\n              InventoryService\uff08\u8ba2\u9605\uff09\n              PaymentService\uff08\u8ba2\u9605\uff09\n              LogisticsService\uff08\u8ba2\u9605\uff09\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/microservices/core-concepts",children:"\u5fae\u670d\u52a1 - \u6838\u5fc3\u6982\u5ff5"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"-\u6846\u67b6\u6e90\u7801\u5206\u6790\u4e13\u5bb6\u7ea7",children:"\ud83c\udfaf \u6846\u67b6\u6e90\u7801\u5206\u6790\uff08\u4e13\u5bb6\u7ea7\uff09"}),"\n",(0,i.jsx)(e.h3,{id:"21-spring-ioc-\u5bb9\u5668\u542f\u52a8\u6d41\u7a0b\u662f\u600e\u6837\u7684",children:"21. Spring IoC \u5bb9\u5668\u542f\u52a8\u6d41\u7a0b\u662f\u600e\u6837\u7684\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6838\u5fc3\u542f\u52a8\u6d41\u7a0b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// AbstractApplicationContext.refresh() \u65b9\u6cd5\npublic void refresh() {\n    // 1. \u51c6\u5907\u5237\u65b0\n    prepareRefresh();\n\n    // 2. \u83b7\u53d6 BeanFactory\n    ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();\n\n    // 3. \u51c6\u5907 BeanFactory\n    prepareBeanFactory(beanFactory);\n\n    // 4. \u540e\u7f6e\u5904\u7406 BeanFactory\n    postProcessBeanFactory(beanFactory);\n\n    // 5. \u8c03\u7528 BeanFactoryPostProcessor\n    invokeBeanFactoryPostProcessors(beanFactory);\n\n    // 6. \u6ce8\u518c BeanPostProcessor\n    registerBeanPostProcessors(beanFactory);\n\n    // 7. \u521d\u59cb\u5316\u6d88\u606f\u6e90\n    initMessageSource();\n\n    // 8. \u521d\u59cb\u5316\u4e8b\u4ef6\u5e7f\u64ad\u5668\n    initApplicationEventMulticaster();\n\n    // 9. \u5b50\u7c7b\u6269\u5c55\u70b9\n    onRefresh();\n\n    // 10. \u6ce8\u518c\u76d1\u542c\u5668\n    registerListeners();\n\n    // 11. \u5b9e\u4f8b\u5316\u6240\u6709\u975e\u61d2\u52a0\u8f7d\u7684\u5355\u4f8b Bean\n    finishBeanFactoryInitialization(beanFactory);\n\n    // 12. \u5b8c\u6210\u5237\u65b0\n    finishRefresh();\n}\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Bean \u521b\u5efa\u6d41\u7a0b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"getBean()\n    \u2192 doGetBean()\n        \u2192 getSingleton() // \u4ece\u7f13\u5b58\u83b7\u53d6\n        \u2192 createBean()\n            \u2192 resolveBeforeInstantiation() // \u5b9e\u4f8b\u5316\u524d\u5904\u7406\n            \u2192 doCreateBean()\n                \u2192 createBeanInstance() // \u5b9e\u4f8b\u5316\n                \u2192 populateBean() // \u5c5e\u6027\u586b\u5145\n                \u2192 initializeBean() // \u521d\u59cb\u5316\n                    \u2192 invokeAwareMethods()\n                    \u2192 applyBeanPostProcessorsBeforeInitialization()\n                    \u2192 invokeInitMethods()\n                    \u2192 applyBeanPostProcessorsAfterInitialization()\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4e09\u7ea7\u7f13\u5b58\u89e3\u51b3\u5faa\u73af\u4f9d\u8d56\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// DefaultSingletonBeanRegistry\n// \u4e00\u7ea7\u7f13\u5b58\uff1a\u5b8c\u6574\u7684 Bean\nprivate final Map<String, Object> singletonObjects = new ConcurrentHashMap<>();\n\n// \u4e8c\u7ea7\u7f13\u5b58\uff1a\u65e9\u671f\u66b4\u9732\u7684 Bean\uff08\u672a\u5b8c\u6210\u5c5e\u6027\u586b\u5145\uff09\nprivate final Map<String, Object> earlySingletonObjects = new ConcurrentHashMap<>();\n\n// \u4e09\u7ea7\u7f13\u5b58\uff1aBean \u5de5\u5382\nprivate final Map<String, ObjectFactory<?>> singletonFactories = new HashMap<>();\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/spring/core-concepts",children:"Spring \u6838\u5fc3\u6982\u5ff5"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"22-spring-aop-\u662f\u5982\u4f55\u5b9e\u73b0\u7684",children:"22. Spring AOP \u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"AOP \u5b9e\u73b0\u65b9\u5f0f\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u5f0f"}),(0,i.jsx)(e.th,{children:"\u6761\u4ef6"}),(0,i.jsx)(e.th,{children:"\u7279\u70b9"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"JDK \u52a8\u6001\u4ee3\u7406"}),(0,i.jsx)(e.td,{children:"\u76ee\u6807\u7c7b\u5b9e\u73b0\u63a5\u53e3"}),(0,i.jsx)(e.td,{children:"\u57fa\u4e8e\u63a5\u53e3\u4ee3\u7406"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"CGLIB \u4ee3\u7406"}),(0,i.jsx)(e.td,{children:"\u76ee\u6807\u7c7b\u65e0\u63a5\u53e3"}),(0,i.jsx)(e.td,{children:"\u57fa\u4e8e\u7ee7\u627f\u4ee3\u7406"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"JDK \u52a8\u6001\u4ee3\u7406\u539f\u7406\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class JdkProxyDemo {\n    public static void main(String[] args) {\n        UserService target = new UserServiceImpl();\n\n        UserService proxy = (UserService) Proxy.newProxyInstance(\n            target.getClass().getClassLoader(),\n            target.getClass().getInterfaces(),\n            new InvocationHandler() {\n                @Override\n                public Object invoke(Object proxy, Method method, Object[] args)\n                        throws Throwable {\n                    System.out.println("Before: " + method.getName());\n                    Object result = method.invoke(target, args);\n                    System.out.println("After: " + method.getName());\n                    return result;\n                }\n            }\n        );\n\n        proxy.getUser("1");\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"CGLIB \u4ee3\u7406\u539f\u7406\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class CglibProxyDemo {\n    public static void main(String[] args) {\n        Enhancer enhancer = new Enhancer();\n        enhancer.setSuperclass(UserServiceImpl.class);\n        enhancer.setCallback(new MethodInterceptor() {\n            @Override\n            public Object intercept(Object obj, Method method, Object[] args,\n                    MethodProxy proxy) throws Throwable {\n                System.out.println("Before: " + method.getName());\n                Object result = proxy.invokeSuper(obj, args);\n                System.out.println("After: " + method.getName());\n                return result;\n            }\n        });\n\n        UserServiceImpl proxy = (UserServiceImpl) enhancer.create();\n        proxy.getUser("1");\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Spring AOP \u4ee3\u7406\u521b\u5efa\u6d41\u7a0b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"@EnableAspectJAutoProxy\n    \u2192 \u6ce8\u518c AnnotationAwareAspectJAutoProxyCreator\n        \u2192 postProcessAfterInitialization()\n            \u2192 wrapIfNecessary()\n                \u2192 getAdvicesAndAdvisorsForBean() // \u83b7\u53d6\u5207\u9762\n                \u2192 createProxy() // \u521b\u5efa\u4ee3\u7406\n                    \u2192 ProxyFactory.getProxy()\n                        \u2192 JdkDynamicAopProxy \u6216 CglibAopProxy\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/spring/aop",children:"Spring AOP \u8be6\u89e3"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"23-spring-boot-\u81ea\u52a8\u914d\u7f6e\u539f\u7406\u662f\u4ec0\u4e48",children:"23. Spring Boot \u81ea\u52a8\u914d\u7f6e\u539f\u7406\u662f\u4ec0\u4e48\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u81ea\u52a8\u914d\u7f6e\u6838\u5fc3\u6ce8\u89e3\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"@SpringBootApplication\n    \u251c\u2500\u2500 @SpringBootConfiguration  // \u914d\u7f6e\u7c7b\n    \u251c\u2500\u2500 @EnableAutoConfiguration  // \u542f\u7528\u81ea\u52a8\u914d\u7f6e\n    \u2502       \u2514\u2500\u2500 @Import(AutoConfigurationImportSelector.class)\n    \u2514\u2500\u2500 @ComponentScan            // \u7ec4\u4ef6\u626b\u63cf\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u81ea\u52a8\u914d\u7f6e\u52a0\u8f7d\u6d41\u7a0b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"1. @EnableAutoConfiguration\n    \u2193\n2. AutoConfigurationImportSelector.selectImports()\n    \u2193\n3. SpringFactoriesLoader.loadFactoryNames()\n    \u2193\n4. \u8bfb\u53d6 META-INF/spring.factories\n    \u2193\n5. \u8fc7\u6ee4\u6761\u4ef6\u6ce8\u89e3\uff08@ConditionalOnXxx\uff09\n    \u2193\n6. \u52a0\u8f7d\u7b26\u5408\u6761\u4ef6\u7684\u81ea\u52a8\u914d\u7f6e\u7c7b\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"spring.factories \u793a\u4f8b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-properties",children:"# META-INF/spring.factories\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\norg.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration,\\\norg.springframework.boot.autoconfigure.web.servlet.WebMvcAutoConfiguration,\\\norg.springframework.boot.autoconfigure.data.redis.RedisAutoConfiguration\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6761\u4ef6\u6ce8\u89e3\u539f\u7406\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'@Configuration\n@ConditionalOnClass(DataSource.class)  // \u7c7b\u8def\u5f84\u5b58\u5728 DataSource\n@ConditionalOnMissingBean(DataSource.class)  // \u672a\u81ea\u5b9a\u4e49 DataSource Bean\n@EnableConfigurationProperties(DataSourceProperties.class)\npublic class DataSourceAutoConfiguration {\n\n    @Bean\n    @ConfigurationProperties(prefix = "spring.datasource")\n    public DataSource dataSource() {\n        return DataSourceBuilder.create().build();\n    }\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u81ea\u5b9a\u4e49 Starter\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:"// 1. \u521b\u5efa\u81ea\u52a8\u914d\u7f6e\u7c7b\n@Configuration\n@ConditionalOnClass(MyService.class)\n@EnableConfigurationProperties(MyProperties.class)\npublic class MyAutoConfiguration {\n\n    @Bean\n    @ConditionalOnMissingBean\n    public MyService myService(MyProperties properties) {\n        return new MyService(properties);\n    }\n}\n\n// 2. \u521b\u5efa spring.factories\n// META-INF/spring.factories\norg.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\ncom.example.MyAutoConfiguration\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/springboot",children:"Spring Boot \u81ea\u52a8\u914d\u7f6e"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"24-mybatis-\u7684\u6267\u884c\u6d41\u7a0b\u548c\u7f13\u5b58\u673a\u5236\u662f\u600e\u6837\u7684",children:"24. MyBatis \u7684\u6267\u884c\u6d41\u7a0b\u548c\u7f13\u5b58\u673a\u5236\u662f\u600e\u6837\u7684\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"MyBatis \u6267\u884c\u6d41\u7a0b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"SqlSessionFactory\n    \u2193 openSession()\nSqlSession\n    \u2193 getMapper()\nMapperProxy\uff08\u52a8\u6001\u4ee3\u7406\uff09\n    \u2193 invoke()\nMapperMethod\n    \u2193 execute()\nExecutor\uff08\u6267\u884c\u5668\uff09\n    \u2193 query/update\nStatementHandler\n    \u2193 prepare/parameterize/query\nResultSetHandler\n    \u2193 handleResultSets\n\u8fd4\u56de\u7ed3\u679c\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6838\u5fc3\u7ec4\u4ef6\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'// 1. SqlSessionFactory \u521b\u5efa\nSqlSessionFactory factory = new SqlSessionFactoryBuilder()\n    .build(Resources.getResourceAsStream("mybatis-config.xml"));\n\n// 2. \u83b7\u53d6 SqlSession\ntry (SqlSession session = factory.openSession()) {\n    // 3. \u83b7\u53d6 Mapper \u4ee3\u7406\n    UserMapper mapper = session.getMapper(UserMapper.class);\n\n    // 4. \u6267\u884c\u67e5\u8be2\n    User user = mapper.selectById(1L);\n}\n'})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7f13\u5b58\u673a\u5236\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u4e8c\u7ea7\u7f13\u5b58\uff08Mapper \u7ea7\u522b\uff09                \u2502\n\u2502                    namespace \u8303\u56f4\u5171\u4eab                    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u2193 \u672a\u547d\u4e2d\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    \u4e00\u7ea7\u7f13\u5b58\uff08SqlSession \u7ea7\u522b\uff09           \u2502\n\u2502                    \u9ed8\u8ba4\u5f00\u542f\uff0c\u540c\u4e00 SqlSession \u5171\u4eab        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                           \u2193 \u672a\u547d\u4e2d\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                         \u6570\u636e\u5e93                           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u4e8c\u7ea7\u7f13\u5b58\u914d\u7f6e\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-xml",children:'\x3c!-- mybatis-config.xml --\x3e\n<settings>\n    <setting name="cacheEnabled" value="true"/>\n</settings>\n\n\x3c!-- UserMapper.xml --\x3e\n<mapper namespace="com.example.mapper.UserMapper">\n    <cache eviction="LRU" flushInterval="60000" size="512" readOnly="true"/>\n\n    <select id="selectById" resultType="User" useCache="true">\n        SELECT * FROM user WHERE id = #{id}\n    </select>\n</mapper>\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/spring",children:"MyBatis \u6838\u5fc3\u539f\u7406"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"25-netty-\u7684\u7ebf\u7a0b\u6a21\u578b\u548c\u6838\u5fc3\u7ec4\u4ef6\u662f\u4ec0\u4e48",children:"25. Netty \u7684\u7ebf\u7a0b\u6a21\u578b\u548c\u6838\u5fc3\u7ec4\u4ef6\u662f\u4ec0\u4e48\uff1f"}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u7b54\u6848\u8981\u70b9\uff1a"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Netty \u7ebf\u7a0b\u6a21\u578b\uff08\u4e3b\u4ece Reactor\uff09\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n                    \u2502   BossGroup     \u2502  \u63a5\u6536\u8fde\u63a5\n                    \u2502  (1\u4e2aEventLoop) \u2502\n                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                             \u2502 \u5206\u53d1\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502                    \u2502                    \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  WorkerGroup  \u2502  \u2502   WorkerGroup     \u2502  \u2502  WorkerGroup  \u2502\n\u2502  EventLoop-1  \u2502  \u2502   EventLoop-2     \u2502  \u2502  EventLoop-N  \u2502\n\u2502  (\u5904\u7406IO)     \u2502  \u2502   (\u5904\u7406IO)        \u2502  \u2502  (\u5904\u7406IO)     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"\u6838\u5fc3\u7ec4\u4ef6\uff1a"})}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u7ec4\u4ef6"}),(0,i.jsx)(e.th,{children:"\u4f5c\u7528"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"Channel"})}),(0,i.jsx)(e.td,{children:"\u7f51\u7edc\u8fde\u63a5\u901a\u9053"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"EventLoop"})}),(0,i.jsx)(e.td,{children:"\u4e8b\u4ef6\u5faa\u73af\uff0c\u5904\u7406 IO \u4e8b\u4ef6"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"ChannelPipeline"})}),(0,i.jsx)(e.td,{children:"\u5904\u7406\u5668\u94fe"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"ChannelHandler"})}),(0,i.jsx)(e.td,{children:"\u4e8b\u4ef6\u5904\u7406\u5668"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:(0,i.jsx)(e.strong,{children:"ByteBuf"})}),(0,i.jsx)(e.td,{children:"\u5b57\u8282\u7f13\u51b2\u533a"})]})]})]}),"\n",(0,i.jsx)(e.p,{children:(0,i.jsx)(e.strong,{children:"Netty \u670d\u52a1\u7aef\u793a\u4f8b\uff1a"})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-java",children:'public class NettyServer {\n    public static void main(String[] args) throws Exception {\n        EventLoopGroup bossGroup = new NioEventLoopGroup(1);\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n\n        try {\n            ServerBootstrap bootstrap = new ServerBootstrap();\n            bootstrap.group(bossGroup, workerGroup)\n                .channel(NioServerSocketChannel.class)\n                .option(ChannelOption.SO_BACKLOG, 128)\n                .childOption(ChannelOption.SO_KEEPALIVE, true)\n                .childHandler(new ChannelInitializer<SocketChannel>() {\n                    @Override\n                    protected void initChannel(SocketChannel ch) {\n                        ChannelPipeline pipeline = ch.pipeline();\n                        pipeline.addLast(new StringDecoder());\n                        pipeline.addLast(new StringEncoder());\n                        pipeline.addLast(new MyServerHandler());\n                    }\n                });\n\n            ChannelFuture future = bootstrap.bind(8080).sync();\n            future.channel().closeFuture().sync();\n        } finally {\n            bossGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n}\n\nclass MyServerHandler extends SimpleChannelInboundHandler<String> {\n    @Override\n    protected void channelRead0(ChannelHandlerContext ctx, String msg) {\n        System.out.println("Received: " + msg);\n        ctx.writeAndFlush("Server: " + msg);\n    }\n}\n'})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u5ef6\u4f38\uff1a"})," \u53c2\u8003 ",(0,i.jsx)(e.a,{href:"/docs/netty/core-components",children:"Netty \u6838\u5fc3\u7ec4\u4ef6"})]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"-\u603b\u7ed3\u4e0e\u5b66\u4e60\u5efa\u8bae",children:"\ud83d\udccc \u603b\u7ed3\u4e0e\u5b66\u4e60\u5efa\u8bae"}),"\n",(0,i.jsx)(e.h3,{id:"\u96be\u5ea6\u5206\u7ea7",children:"\u96be\u5ea6\u5206\u7ea7"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u9ad8\u7ea7\uff083-5 \u5e74\uff09\uff1a"})," JVM \u6df1\u5ea6\u3001\u9ad8\u7ea7\u5e76\u53d1\u3001\u6846\u67b6\u6e90\u7801\u57fa\u7840"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u4e13\u5bb6\u7ea7\uff085 \u5e74+\uff09\uff1a"})," \u6027\u80fd\u8c03\u4f18\u3001\u67b6\u6784\u8bbe\u8ba1\u3001\u6e90\u7801\u6df1\u5ea6\u5206\u6790"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u5b66\u4e60\u8def\u5f84",children:"\u5b66\u4e60\u8def\u5f84"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"1. \u592f\u5b9e\u57fa\u7840\n   \u2514\u2500\u2500 Java \u57fa\u7840 \u2192 \u96c6\u5408 \u2192 \u591a\u7ebf\u7a0b \u2192 JVM\n\n2. \u6df1\u5165\u539f\u7406\n   \u2514\u2500\u2500 \u5e76\u53d1\u5305\u6e90\u7801 \u2192 Spring \u6e90\u7801 \u2192 MyBatis \u6e90\u7801\n\n3. \u67b6\u6784\u63d0\u5347\n   \u2514\u2500\u2500 \u8bbe\u8ba1\u6a21\u5f0f \u2192 \u5206\u5e03\u5f0f\u7406\u8bba \u2192 \u5fae\u670d\u52a1\u67b6\u6784\n\n4. \u5b9e\u6218\u7ecf\u9a8c\n   \u2514\u2500\u2500 \u6027\u80fd\u8c03\u4f18 \u2192 \u95ee\u9898\u6392\u67e5 \u2192 \u7cfb\u7edf\u8bbe\u8ba1\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u9762\u8bd5\u51c6\u5907\u5efa\u8bae",children:"\u9762\u8bd5\u51c6\u5907\u5efa\u8bae"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u7406\u89e3\u539f\u7406"})," > \u80cc\u8bf5\u7b54\u6848"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u52a8\u624b\u5b9e\u8df5"})," > \u7eb8\u4e0a\u8c08\u5175"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6e90\u7801\u9605\u8bfb"})," > \u6587\u6863\u6d4f\u89c8"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u9879\u76ee\u7ecf\u9a8c"})," > \u7406\u8bba\u77e5\u8bc6"]}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"\u76f8\u5173\u8d44\u6e90",children:"\u76f8\u5173\u8d44\u6e90"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"/docs/java/interview-questions",children:"Java \u57fa\u7840\u9762\u8bd5\u9898"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"/docs/spring/interview-questions",children:"Spring \u9762\u8bd5\u9898"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"/docs/java/jvm-basics",children:"JVM \u57fa\u7840"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"/docs/java/multithreading",children:"\u591a\u7ebf\u7a0b\u8be6\u89e3"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"/docs/java/performance",children:"\u6027\u80fd\u4f18\u5316"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"/docs/microservices",children:"\u5fae\u670d\u52a1\u67b6\u6784"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"/docs/java-design-patterns",children:"\u8bbe\u8ba1\u6a21\u5f0f"})}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\u6301\u7eed\u66f4\u65b0\u4e2d..."})," \u6b22\u8fce\u53cd\u9988\u548c\u8865\u5145\uff01"]})]})}function h(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(o,{...n})}):o(n)}}}]);