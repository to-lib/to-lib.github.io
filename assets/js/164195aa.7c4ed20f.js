"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[9639],{1266:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>l});var a=r(9378);const s={},i=a.createContext(s);function t(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),a.createElement(i.Provider,{value:n},e.children)}},6727:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>c,frontMatter:()=>t,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"springboot/data-access","title":"\u6570\u636e\u8bbf\u95ee","description":"Spring Data JPA","source":"@site/docs/springboot/data-access.md","sourceDirName":"springboot","slug":"/springboot/data-access","permalink":"/docs/springboot/data-access","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/springboot/data-access.md","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7}}');var s=r(2714),i=r(1266);const t={sidebar_position:7},l="\u6570\u636e\u8bbf\u95ee",o={},d=[{value:"Spring Data JPA",id:"spring-data-jpa",level:2},{value:"\u4f9d\u8d56\u914d\u7f6e",id:"\u4f9d\u8d56\u914d\u7f6e",level:3},{value:"\u914d\u7f6e\u6587\u4ef6",id:"\u914d\u7f6e\u6587\u4ef6",level:3},{value:"\u5b9e\u4f53\u7c7b\uff08Entity\uff09",id:"\u5b9e\u4f53\u7c7bentity",level:2},{value:"\u57fa\u672c\u5b9e\u4f53",id:"\u57fa\u672c\u5b9e\u4f53",level:3},{value:"\u5173\u8054\u5173\u7cfb",id:"\u5173\u8054\u5173\u7cfb",level:3},{value:"\u4e00\u5bf9\u591a\u5173\u7cfb",id:"\u4e00\u5bf9\u591a\u5173\u7cfb",level:4},{value:"\u591a\u5bf9\u591a\u5173\u7cfb",id:"\u591a\u5bf9\u591a\u5173\u7cfb",level:4},{value:"Repository \u63a5\u53e3",id:"repository-\u63a5\u53e3",level:2},{value:"\u57fa\u672c CRUD \u64cd\u4f5c",id:"\u57fa\u672c-crud-\u64cd\u4f5c",level:3},{value:"\u81ea\u5b9a\u4e49\u67e5\u8be2\u65b9\u6cd5",id:"\u81ea\u5b9a\u4e49\u67e5\u8be2\u65b9\u6cd5",level:3},{value:"@Query \u81ea\u5b9a\u4e49 SQL",id:"query-\u81ea\u5b9a\u4e49-sql",level:3},{value:"Service \u5c42",id:"service-\u5c42",level:2},{value:"\u67e5\u8be2\u793a\u4f8b",id:"\u67e5\u8be2\u793a\u4f8b",level:2},{value:"\u5206\u9875\u67e5\u8be2",id:"\u5206\u9875\u67e5\u8be2",level:3},{value:"\u6761\u4ef6\u67e5\u8be2",id:"\u6761\u4ef6\u67e5\u8be2",level:3},{value:"MyBatis \u96c6\u6210",id:"mybatis-\u96c6\u6210",level:2},{value:"\u4f9d\u8d56\u914d\u7f6e",id:"\u4f9d\u8d56\u914d\u7f6e-1",level:3},{value:"\u914d\u7f6e\u6587\u4ef6",id:"\u914d\u7f6e\u6587\u4ef6-1",level:3},{value:"Mapper \u63a5\u53e3",id:"mapper-\u63a5\u53e3",level:3},{value:"XML \u6620\u5c04\u6587\u4ef6",id:"xml-\u6620\u5c04\u6587\u4ef6",level:3},{value:"\u4e8b\u52a1\u7ba1\u7406",id:"\u4e8b\u52a1\u7ba1\u7406",level:2},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function u(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"\u6570\u636e\u8bbf\u95ee",children:"\u6570\u636e\u8bbf\u95ee"})}),"\n",(0,s.jsx)(n.h2,{id:"spring-data-jpa",children:"Spring Data JPA"}),"\n",(0,s.jsx)(n.h3,{id:"\u4f9d\u8d56\u914d\u7f6e",children:"\u4f9d\u8d56\u914d\u7f6e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- Spring Data JPA --\x3e\n<dependency>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-data-jpa</artifactId>\n</dependency>\n\n\x3c!-- MySQL Driver --\x3e\n<dependency>\n    <groupId>com.mysql</groupId>\n    <artifactId>mysql-connector-java</artifactId>\n    <scope>runtime</scope>\n</dependency>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u914d\u7f6e\u6587\u4ef6",children:"\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"spring:\n  datasource:\n    url: jdbc:mysql://localhost:3306/mydb?useSSL=false&serverTimezone=UTC\n    username: root\n    password: password\n    driver-class-name: com.mysql.cj.jdbc.Driver\n    hikari:\n      maximum-pool-size: 20\n      minimum-idle: 5\n  \n  jpa:\n    hibernate:\n      ddl-auto: update  # create, create-drop, update, validate\n    show-sql: false\n    properties:\n      hibernate:\n        dialect: org.hibernate.dialect.MySQL8Dialect\n        format_sql: true\n        use_sql_comments: true\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5b9e\u4f53\u7c7bentity",children:"\u5b9e\u4f53\u7c7b\uff08Entity\uff09"}),"\n",(0,s.jsx)(n.h3,{id:"\u57fa\u672c\u5b9e\u4f53",children:"\u57fa\u672c\u5b9e\u4f53"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'import jakarta.persistence.*;\nimport lombok.Data;\nimport java.time.LocalDateTime;\n\n@Entity\n@Table(name = "users")\n@Data\npublic class User {\n    \n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n    \n    @Column(name = "username", nullable = false, length = 50, unique = true)\n    private String username;\n    \n    @Column(name = "email", nullable = false, unique = true)\n    private String email;\n    \n    @Column(name = "age")\n    private Integer age;\n    \n    @Column(name = "status", nullable = false, columnDefinition = "varchar(20) default \'ACTIVE\'")\n    private String status;\n    \n    @Column(name = "created_at", nullable = false, updatable = false)\n    private LocalDateTime createdAt;\n    \n    @Column(name = "updated_at")\n    private LocalDateTime updatedAt;\n    \n    @PrePersist\n    protected void onCreate() {\n        createdAt = LocalDateTime.now();\n        updatedAt = LocalDateTime.now();\n    }\n    \n    @PreUpdate\n    protected void onUpdate() {\n        updatedAt = LocalDateTime.now();\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u5173\u8054\u5173\u7cfb",children:"\u5173\u8054\u5173\u7cfb"}),"\n",(0,s.jsx)(n.h4,{id:"\u4e00\u5bf9\u591a\u5173\u7cfb",children:"\u4e00\u5bf9\u591a\u5173\u7cfb"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u7528\u6237\u8868\n@Entity\n@Table(name = "users")\n@Data\npublic class User {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n    \n    private String username;\n    \n    @OneToMany(mappedBy = "user", cascade = CascadeType.ALL, fetch = FetchType.LAZY)\n    private List<Post> posts = new ArrayList<>();\n}\n\n// \u6587\u7ae0\u8868\n@Entity\n@Table(name = "posts")\n@Data\npublic class Post {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n    \n    private String title;\n    \n    @ManyToOne(fetch = FetchType.LAZY)\n    @JoinColumn(name = "user_id", nullable = false)\n    private User user;\n}\n'})}),"\n",(0,s.jsx)(n.h4,{id:"\u591a\u5bf9\u591a\u5173\u7cfb",children:"\u591a\u5bf9\u591a\u5173\u7cfb"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'// \u7528\u6237\u89d2\u8272\uff08\u591a\u5bf9\u591a\uff09\n@Entity\n@Table(name = "users")\n@Data\npublic class User {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n    \n    private String username;\n    \n    @ManyToMany(fetch = FetchType.LAZY)\n    @JoinTable(\n            name = "user_role",\n            joinColumns = @JoinColumn(name = "user_id"),\n            inverseJoinColumns = @JoinColumn(name = "role_id")\n    )\n    private Set<Role> roles = new HashSet<>();\n}\n\n@Entity\n@Table(name = "roles")\n@Data\npublic class Role {\n    @Id\n    @GeneratedValue(strategy = GenerationType.IDENTITY)\n    private Long id;\n    \n    private String name;\n    \n    @ManyToMany(mappedBy = "roles")\n    private Set<User> users = new HashSet<>();\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"repository-\u63a5\u53e3",children:"Repository \u63a5\u53e3"}),"\n",(0,s.jsx)(n.h3,{id:"\u57fa\u672c-crud-\u64cd\u4f5c",children:"\u57fa\u672c CRUD \u64cd\u4f5c"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"import org.springframework.data.jpa.repository.JpaRepository;\nimport org.springframework.stereotype.Repository;\nimport java.util.Optional;\nimport java.util.List;\n\n@Repository\npublic interface UserRepository extends JpaRepository<User, Long> {\n    \n    // JpaRepository \u5df2\u63d0\u4f9b\u7684\u57fa\u672c\u65b9\u6cd5\uff1a\n    // - save(User user)\n    // - saveAll(List<User> users)\n    // - findById(Long id)\n    // - findAll()\n    // - count()\n    // - delete(User user)\n    // - deleteById(Long id)\n    // - deleteAll()\n    // - exists(Long id)\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u81ea\u5b9a\u4e49\u67e5\u8be2\u65b9\u6cd5",children:"\u81ea\u5b9a\u4e49\u67e5\u8be2\u65b9\u6cd5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"@Repository\npublic interface UserRepository extends JpaRepository<User, Long> {\n    \n    // \u6309\u5c5e\u6027\u67e5\u8be2\n    User findByUsername(String username);\n    \n    Optional<User> findByEmail(String email);\n    \n    List<User> findByAgeGreaterThan(Integer age);\n    \n    // \u591a\u6761\u4ef6\u67e5\u8be2\n    List<User> findByUsernameAndEmail(String username, String email);\n    \n    // \u6a21\u7cca\u67e5\u8be2\n    List<User> findByUsernameLike(String username);\n    \n    // \u6392\u5e8f\u67e5\u8be2\n    List<User> findByAgeGreaterThanOrderByUsernameAsc(Integer age);\n    \n    // \u5206\u9875\u67e5\u8be2\n    Page<User> findByAgeGreaterThan(Integer age, Pageable pageable);\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"query-\u81ea\u5b9a\u4e49-sql",children:"@Query \u81ea\u5b9a\u4e49 SQL"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@Repository\npublic interface UserRepository extends JpaRepository<User, Long> {\n    \n    // JPQL \u67e5\u8be2\n    @Query("SELECT u FROM User u WHERE u.username = ?1")\n    User findByUsernameJpql(String username);\n    \n    // JPQL \u67e5\u8be2\uff08\u547d\u540d\u53c2\u6570\uff09\n    @Query("SELECT u FROM User u WHERE u.username = :username AND u.status = :status")\n    List<User> findByUsernameAndStatus(\n            @Param("username") String username,\n            @Param("status") String status);\n    \n    // \u539f\u751f SQL \u67e5\u8be2\n    @Query(value = "SELECT * FROM users WHERE age > ?1", nativeQuery = true)\n    List<User> findByAgeGreaterThanNative(Integer age);\n    \n    // \u4fee\u6539\u67e5\u8be2\n    @Modifying\n    @Transactional\n    @Query("UPDATE User u SET u.status = \'INACTIVE\' WHERE u.id = ?1")\n    void inactivateUser(Long userId);\n    \n    // \u5220\u9664\u67e5\u8be2\n    @Modifying\n    @Transactional\n    @Query("DELETE FROM User u WHERE u.age > ?1")\n    void deleteByAgeGreaterThan(Integer age);\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"service-\u5c42",children:"Service \u5c42"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'import org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.data.domain.Page;\nimport org.springframework.data.domain.Pageable;\nimport org.springframework.stereotype.Service;\nimport org.springframework.transaction.annotation.Transactional;\n\n@Service\n@Transactional\npublic class UserService {\n    \n    @Autowired\n    private UserRepository userRepository;\n    \n    // \u521b\u5efa\u7528\u6237\n    public User createUser(User user) {\n        return userRepository.save(user);\n    }\n    \n    // \u83b7\u53d6\u7528\u6237\n    public User getUserById(Long id) {\n        return userRepository.findById(id)\n                .orElseThrow(() -> new ResourceNotFoundException("User not found"));\n    }\n    \n    // \u83b7\u53d6\u6240\u6709\u7528\u6237\n    @Transactional(readOnly = true)\n    public List<User> getAllUsers() {\n        return userRepository.findAll();\n    }\n    \n    // \u5206\u9875\u67e5\u8be2\n    @Transactional(readOnly = true)\n    public Page<User> getUsersByAge(Integer age, Pageable pageable) {\n        return userRepository.findByAgeGreaterThan(age, pageable);\n    }\n    \n    // \u66f4\u65b0\u7528\u6237\n    public User updateUser(Long id, User userDetails) {\n        User user = getUserById(id);\n        user.setUsername(userDetails.getUsername());\n        user.setEmail(userDetails.getEmail());\n        user.setAge(userDetails.getAge());\n        return userRepository.save(user);\n    }\n    \n    // \u5220\u9664\u7528\u6237\n    public void deleteUser(Long id) {\n        userRepository.deleteById(id);\n    }\n    \n    // \u6279\u91cf\u64cd\u4f5c\n    public List<User> saveAll(List<User> users) {\n        return userRepository.saveAll(users);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\u67e5\u8be2\u793a\u4f8b",children:"\u67e5\u8be2\u793a\u4f8b"}),"\n",(0,s.jsx)(n.h3,{id:"\u5206\u9875\u67e5\u8be2",children:"\u5206\u9875\u67e5\u8be2"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'import org.springframework.data.domain.Page;\nimport org.springframework.data.domain.PageRequest;\nimport org.springframework.data.domain.Pageable;\nimport org.springframework.data.domain.Sort;\n\n@RestController\n@RequestMapping("/api/users")\npublic class UserController {\n    \n    @Autowired\n    private UserService userService;\n    \n    @GetMapping\n    public ResponseEntity<Page<User>> getUsers(\n            @RequestParam(defaultValue = "0") int page,\n            @RequestParam(defaultValue = "10") int size,\n            @RequestParam(defaultValue = "id") String sortBy,\n            @RequestParam(defaultValue = "ASC") Sort.Direction direction) {\n        \n        Pageable pageable = PageRequest.of(page, size, Sort.by(direction, sortBy));\n        Page<User> users = userService.getAllUsers(pageable);\n        \n        return ResponseEntity.ok(users);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u6761\u4ef6\u67e5\u8be2",children:"\u6761\u4ef6\u67e5\u8be2"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'import org.springframework.data.jpa.domain.Specification;\nimport jakarta.persistence.criteria.CriteriaBuilder;\nimport jakarta.persistence.criteria.CriteriaQuery;\nimport jakarta.persistence.criteria.Predicate;\nimport jakarta.persistence.criteria.Root;\n\n@Service\npublic class UserService {\n    \n    @Autowired\n    private UserRepository userRepository;\n    \n    public List<User> searchUsers(String username, Integer minAge, Integer maxAge) {\n        Specification<User> spec = (root, query, cb) -> {\n            List<Predicate> predicates = new ArrayList<>();\n            \n            if (username != null && !username.isEmpty()) {\n                predicates.add(cb.like(root.get("username"), "%" + username + "%"));\n            }\n            \n            if (minAge != null) {\n                predicates.add(cb.greaterThanOrEqualTo(root.get("age"), minAge));\n            }\n            \n            if (maxAge != null) {\n                predicates.add(cb.lessThanOrEqualTo(root.get("age"), maxAge));\n            }\n            \n            return cb.and(predicates.toArray(new Predicate[0]));\n        };\n        \n        return userRepository.findAll(spec);\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"mybatis-\u96c6\u6210",children:"MyBatis \u96c6\u6210"}),"\n",(0,s.jsx)(n.h3,{id:"\u4f9d\u8d56\u914d\u7f6e-1",children:"\u4f9d\u8d56\u914d\u7f6e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.mybatis.spring.boot</groupId>\n    <artifactId>mybatis-spring-boot-starter</artifactId>\n    <version>3.0.0</version>\n</dependency>\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u914d\u7f6e\u6587\u4ef6-1",children:"\u914d\u7f6e\u6587\u4ef6"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"mybatis:\n  mapper-locations: classpath:mapper/*.xml\n  type-aliases-package: com.example.entity\n  configuration:\n    map-underscore-to-camel-case: true\n    cache-enabled: true\n    default-executor-type: reuse\n"})}),"\n",(0,s.jsx)(n.h3,{id:"mapper-\u63a5\u53e3",children:"Mapper \u63a5\u53e3"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'import org.apache.ibatis.annotations.*;\n\n@Mapper\npublic interface UserMapper {\n    \n    @Select("SELECT * FROM users WHERE id = #{id}")\n    @Results({\n            @Result(property = "id", column = "id"),\n            @Result(property = "username", column = "username")\n    })\n    User findById(@Param("id") Long id);\n    \n    @Select("SELECT * FROM users")\n    List<User> findAll();\n    \n    @Insert("INSERT INTO users(username, email, age) VALUES(#{username}, #{email}, #{age})")\n    @Options(useGeneratedKeys = true, keyProperty = "id")\n    int insert(User user);\n    \n    @Update("UPDATE users SET username = #{username}, email = #{email} WHERE id = #{id}")\n    int update(User user);\n    \n    @Delete("DELETE FROM users WHERE id = #{id}")\n    int delete(@Param("id") Long id);\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"xml-\u6620\u5c04\u6587\u4ef6",children:"XML \u6620\u5c04\u6587\u4ef6"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"src/main/resources/mapper/UserMapper.xml"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:'<?xml version="1.0" encoding="UTF-8" ?>\n<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" \n        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">\n\n<mapper namespace="com.example.mapper.UserMapper">\n    \n    <sql id="userColumns">\n        id, username, email, age, created_at, updated_at\n    </sql>\n    \n    <select id="findById" resultType="User">\n        SELECT <include refid="userColumns"/>\n        FROM users\n        WHERE id = #{id}\n    </select>\n    \n    <select id="findAll" resultType="User">\n        SELECT <include refid="userColumns"/>\n        FROM users\n    </select>\n    \n    <select id="searchUsers" resultType="User">\n        SELECT <include refid="userColumns"/>\n        FROM users\n        WHERE 1=1\n        <if test="username != null and username != \'\'">\n            AND username LIKE CONCAT(\'%\', #{username}, \'%\')\n        </if>\n        <if test="minAge != null">\n            AND age >= #{minAge}\n        </if>\n    </select>\n    \n    <insert id="insert" useGeneratedKeys="true" keyProperty="id">\n        INSERT INTO users(username, email, age, created_at, updated_at)\n        VALUES(#{username}, #{email}, #{age}, NOW(), NOW())\n    </insert>\n    \n    <update id="update">\n        UPDATE users\n        <set>\n            <if test="username != null">username = #{username},</if>\n            <if test="email != null">email = #{email},</if>\n            <if test="age != null">age = #{age},</if>\n            updated_at = NOW()\n        </set>\n        WHERE id = #{id}\n    </update>\n    \n    <delete id="delete">\n        DELETE FROM users WHERE id = #{id}\n    </delete>\n    \n</mapper>\n'})}),"\n",(0,s.jsx)(n.h2,{id:"\u4e8b\u52a1\u7ba1\u7406",children:"\u4e8b\u52a1\u7ba1\u7406"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:"import org.springframework.transaction.annotation.Transactional;\nimport org.springframework.transaction.annotation.Isolation;\nimport org.springframework.transaction.annotation.Propagation;\n\n@Service\npublic class UserService {\n    \n    // \u57fa\u672c\u4e8b\u52a1\n    @Transactional\n    public void transferMoney(Long fromId, Long toId, BigDecimal amount) {\n        User from = userRepository.findById(fromId).orElseThrow();\n        User to = userRepository.findById(toId).orElseThrow();\n        \n        from.setBalance(from.getBalance().subtract(amount));\n        to.setBalance(to.getBalance().add(amount));\n        \n        userRepository.save(from);\n        userRepository.save(to);\n    }\n    \n    // \u53ea\u8bfb\u4e8b\u52a1\n    @Transactional(readOnly = true)\n    public User getUser(Long id) {\n        return userRepository.findById(id).orElseThrow();\n    }\n    \n    // \u6307\u5b9a\u9694\u79bb\u7ea7\u522b\n    @Transactional(isolation = Isolation.READ_COMMITTED)\n    public void updateUser(Long id, User userDetails) {\n        User user = userRepository.findById(id).orElseThrow();\n        user.setUsername(userDetails.getUsername());\n        userRepository.save(user);\n    }\n    \n    // \u5f02\u5e38\u56de\u6eda\u914d\u7f6e\n    @Transactional(rollbackFor = Exception.class, noRollbackFor = {ValidationException.class})\n    public void createUserWithValidation(User user) {\n        // \u4ee3\u7801...\n    }\n}\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"JPA"})," - \u4f7f\u7528 Spring Data JPA \u8fdb\u884c ORM \u6620\u5c04"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Repository"})," - \u4f7f\u7528 Repository \u63a5\u53e3\u8fdb\u884c\u6570\u636e\u8bbf\u95ee"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u67e5\u8be2"})," - \u652f\u6301\u81ea\u5b9a\u4e49\u67e5\u8be2\u65b9\u6cd5\u548c @Query \u6ce8\u89e3"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"MyBatis"})," - \u5bf9\u4e8e\u590d\u6742 SQL \u4f7f\u7528 MyBatis"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"\u4e8b\u52a1"})," - \u4f7f\u7528 @Transactional \u7ba1\u7406\u4e8b\u52a1"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u4e0b\u4e00\u6b65\u5b66\u4e60 ",(0,s.jsx)(n.a,{href:"/docs/springboot/cache-management",children:"\u7f13\u5b58\u7ba1\u7406"}),"\u3002"]})]})}function c(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}}}]);