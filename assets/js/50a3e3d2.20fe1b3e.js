"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[9458],{1266:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>s});var d=t(9378);const i={},r=d.createContext(i);function a(e){const n=d.useContext(r);return d.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),d.createElement(r.Provider,{value:n},e.children)}},1544:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>d,toc:()=>c});const d=JSON.parse('{"id":"netty/codec","title":"codec","description":"\u5bf9\u8c61\u7f16\u7801\u89e3\u7801","source":"@site/docs/netty/codec.md","sourceDirName":"netty","slug":"/netty/codec","permalink":"/docs/netty/codec","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/netty/codec.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"netty","previous":{"title":"ByteBuf \u8be6\u89e3","permalink":"/docs/netty/bytebuf"},"next":{"title":"\u5b9e\u6218\u6848\u4f8b","permalink":"/docs/netty/practical-examples"}}');var i=t(2714),r=t(1266);const a={sidebar_position:5},s=void 0,l={},c=[{value:"\u5bf9\u8c61\u7f16\u7801\u89e3\u7801",id:"\u5bf9\u8c61\u7f16\u7801\u89e3\u7801",level:3},{value:"\u81ea\u5b9a\u4e49\u7f16\u7801\u5668",id:"\u81ea\u5b9a\u4e49\u7f16\u7801\u5668",level:2},{value:"ByteToMessageDecoder\uff08\u89e3\u7801\u5668\u57fa\u7c7b\uff09",id:"bytetomessagedecoder\u89e3\u7801\u5668\u57fa\u7c7b",level:3},{value:"MessageToByteEncoder\uff08\u7f16\u7801\u5668\u57fa\u7c7b\uff09",id:"messagetobyteencoder\u7f16\u7801\u5668\u57fa\u7c7b",level:3},{value:"\u5206\u754c\u7b26\u89e3\u7801\u5668",id:"\u5206\u754c\u7b26\u89e3\u7801\u5668",level:2},{value:"DelimitedFrameDecoder\uff08\u5206\u754c\u7b26\u89e3\u7801\uff09",id:"delimitedframedecoder\u5206\u754c\u7b26\u89e3\u7801",level:3},{value:"\u957f\u5ea6\u5b57\u6bb5\u89e3\u7801\u5668",id:"\u957f\u5ea6\u5b57\u6bb5\u89e3\u7801\u5668",level:2},{value:"LengthFieldBasedFrameDecoder\uff08\u6700\u5e38\u7528\uff09",id:"lengthfieldbasedframedecoder\u6700\u5e38\u7528",level:3},{value:"\u5e38\u89c1\u7528\u6cd5",id:"\u5e38\u89c1\u7528\u6cd5",level:3},{value:"\u81ea\u5b9a\u4e49\u534f\u8bae\u7f16\u89e3\u7801",id:"\u81ea\u5b9a\u4e49\u534f\u8bae\u7f16\u89e3\u7801",level:2},{value:"\u5b9a\u4e49\u534f\u8bae\u683c\u5f0f",id:"\u5b9a\u4e49\u534f\u8bae\u683c\u5f0f",level:3},{value:"\u7f16\u7801\u5668",id:"\u7f16\u7801\u5668",level:3},{value:"\u89e3\u7801\u5668",id:"\u89e3\u7801\u5668",level:3},{value:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u7f16\u89e3\u7801\u5668",id:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u7f16\u89e3\u7801\u5668",level:3},{value:"\u5e38\u7528\u7f16\u89e3\u7801\u5668\u603b\u7ed3",id:"\u5e38\u7528\u7f16\u89e3\u7801\u5668\u603b\u7ed3",level:2},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2}];function o(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// \u5728 Pipeline \u4e2d\u6dfb\u52a0\npipeline.addLast(new StringDecoder(CharsetUtil.UTF_8));\npipeline.addLast(new StringEncoder(CharsetUtil.UTF_8));\n\n// Handler \u4e2d\u63a5\u6536\u5df2\u89e3\u7801\u7684\u5b57\u7b26\u4e32\npublic class StringHandler extends SimpleChannelInboundHandler<String> {\n    @Override\n    protected void channelRead0(ChannelHandlerContext ctx, String msg) {\n        System.out.println("\u63a5\u6536\u5230\u5b57\u7b26\u4e32: " + msg);\n        ctx.writeAndFlush("\u670d\u52a1\u5668\u6536\u5230: " + msg);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u5bf9\u8c61\u7f16\u7801\u89e3\u7801",children:"\u5bf9\u8c61\u7f16\u7801\u89e3\u7801"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// Java \u5bf9\u8c61\u5e8f\u5217\u5316\uff08\u4e0d\u63a8\u8350\u7528\u4e8e\u751f\u4ea7\u73af\u5883\uff09\npipeline.addLast(new ObjectDecoder(1024, ClassResolvers.cacheDisabled(null)));\npipeline.addLast(new ObjectEncoder());\n\n// Handler\npublic class ObjectHandler extends SimpleChannelInboundHandler<Object> {\n    @Override\n    protected void channelRead0(ChannelHandlerContext ctx, Object msg) {\n        MyMessage message = (MyMessage) msg;\n        System.out.println("\u63a5\u6536\u5230\u5bf9\u8c61: " + message);\n    }\n}\n\n// \u5e8f\u5217\u5316\u5bf9\u8c61\u9700\u8981\u5b9e\u73b0 Serializable \u63a5\u53e3\npublic class MyMessage implements Serializable {\n    private static final long serialVersionUID = 1L;\n    public String content;\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u81ea\u5b9a\u4e49\u7f16\u7801\u5668",children:"\u81ea\u5b9a\u4e49\u7f16\u7801\u5668"}),"\n",(0,i.jsx)(n.h3,{id:"bytetomessagedecoder\u89e3\u7801\u5668\u57fa\u7c7b",children:"ByteToMessageDecoder\uff08\u89e3\u7801\u5668\u57fa\u7c7b\uff09"}),"\n",(0,i.jsx)(n.p,{children:"\u89e3\u7801\u5668\u7528\u4e8e\u5c06 ByteBuf \u8f6c\u6362\u4e3a Java \u5bf9\u8c61\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"import io.netty.buffer.ByteBuf;\nimport io.netty.channel.ChannelHandlerContext;\nimport io.netty.handler.codec.ByteToMessageDecoder;\nimport java.util.List;\n\n// \u4f8b\u5b50\uff1a\u89e3\u6790\u56fa\u5b9a\u957f\u5ea6\u62a5\u6587\npublic class FixedLengthDecoder extends ByteToMessageDecoder {\n    private final int frameLength;\n\n    public FixedLengthDecoder(int frameLength) {\n        this.frameLength = frameLength;\n    }\n\n    @Override\n    protected void decode(ChannelHandlerContext ctx, ByteBuf in, List<Object> out) {\n        // \u68c0\u67e5\u662f\u5426\u6709\u8db3\u591f\u7684\u6570\u636e\n        if (in.readableBytes() < frameLength) {\n            return; // \u7b49\u5f85\u66f4\u591a\u6570\u636e\n        }\n\n        // \u8bfb\u53d6\u4e00\u4e2a\u5b8c\u6574\u7684\u5e27\n        ByteBuf frame = in.readBytes(frameLength);\n        out.add(frame); // \u4f20\u9012\u7ed9\u4e0b\u4e00\u4e2a Handler\n    }\n}\n\n// \u4f7f\u7528\nChannelInitializer<SocketChannel> initializer = \n    new ChannelInitializer<SocketChannel>() {\n    @Override\n    protected void initChannel(SocketChannel ch) {\n        ch.pipeline().addLast(new FixedLengthDecoder(10));\n        ch.pipeline().addLast(new FrameHandler());\n    }\n};\n"})}),"\n",(0,i.jsx)(n.h3,{id:"messagetobyteencoder\u7f16\u7801\u5668\u57fa\u7c7b",children:"MessageToByteEncoder\uff08\u7f16\u7801\u5668\u57fa\u7c7b\uff09"}),"\n",(0,i.jsx)(n.p,{children:"\u7f16\u7801\u5668\u7528\u4e8e\u5c06 Java \u5bf9\u8c61\u8f6c\u6362\u4e3a ByteBuf\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"import io.netty.buffer.ByteBuf;\nimport io.netty.channel.ChannelHandlerContext;\nimport io.netty.handler.codec.MessageToByteEncoder;\n\npublic class CustomEncoder extends MessageToByteEncoder<String> {\n    @Override\n    protected void encode(ChannelHandlerContext ctx, String msg, ByteBuf out) {\n        // \u5c06\u5b57\u7b26\u4e32\u7f16\u7801\u4e3a\u5b57\u8282\n        byte[] bytes = msg.getBytes(CharsetUtil.UTF_8);\n        \n        // \u5199\u5165\u957f\u5ea6 + \u5185\u5bb9\n        out.writeInt(bytes.length);\n        out.writeBytes(bytes);\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u5206\u754c\u7b26\u89e3\u7801\u5668",children:"\u5206\u754c\u7b26\u89e3\u7801\u5668"}),"\n",(0,i.jsx)(n.h3,{id:"delimitedframedecoder\u5206\u754c\u7b26\u89e3\u7801",children:"DelimitedFrameDecoder\uff08\u5206\u754c\u7b26\u89e3\u7801\uff09"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'// \u6309\u884c\u5206\u5272\npipeline.addLast(new LineBasedFrameDecoder(1024));\npipeline.addLast(new StringDecoder(CharsetUtil.UTF_8));\n\n// \u6309\u81ea\u5b9a\u4e49\u5206\u754c\u7b26\u5206\u5272\nByteBuf delimiter = Unpooled.copiedBuffer("##", CharsetUtil.UTF_8);\npipeline.addLast(new DelimitedFrameDecoder(1024, delimiter));\npipeline.addLast(new StringDecoder(CharsetUtil.UTF_8));\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u957f\u5ea6\u5b57\u6bb5\u89e3\u7801\u5668",children:"\u957f\u5ea6\u5b57\u6bb5\u89e3\u7801\u5668"}),"\n",(0,i.jsx)(n.h3,{id:"lengthfieldbasedframedecoder\u6700\u5e38\u7528",children:"LengthFieldBasedFrameDecoder\uff08\u6700\u5e38\u7528\uff09"}),"\n",(0,i.jsx)(n.p,{children:"\u7528\u4e8e\u89e3\u6790\u5305\u542b\u957f\u5ea6\u5b57\u6bb5\u7684\u534f\u8bae\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u5e38\u89c1\u7684\u534f\u8bae\u683c\u5f0f\uff1a\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  \u957f\u5ea6\u5b57\u6bb5  \u2502  \u4e1a\u52a1\u6570\u636e \u2502  \u957f\u5ea6\u5b57\u6bb5    \u2502\n\u2502 (4\u5b57\u8282)   \u2502(\u53d8\u957f)    \u2502  \u6307\u5411\u6570\u636e\u957f\u5ea6 \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u5e38\u89c1\u7528\u6cd5",children:"\u5e38\u89c1\u7528\u6cd5"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"// \u573a\u666f1\uff1a\u957f\u5ea6\u5b57\u6bb5\u5728\u6570\u636e\u5934\u90e8\uff0c\u5305\u542b\u957f\u5ea6\u5b57\u6bb5\u672c\u8eab\n//  \u683c\u5f0f: [\u6570\u636e\u957f\u5ea6(4\u5b57\u8282)] [\u6570\u636e...]\npipeline.addLast(\n    new LengthFieldBasedFrameDecoder(\n        1024,     // maxFrameLength\uff1a\u6700\u5927\u5e27\u957f\u5ea6\n        0,        // lengthFieldOffset\uff1a\u957f\u5ea6\u5b57\u6bb5\u7684\u8d77\u59cb\u4f4d\u7f6e\n        4,        // lengthFieldLength\uff1a\u957f\u5ea6\u5b57\u6bb5\u7684\u957f\u5ea6\uff084\u5b57\u8282 int\uff09\n        0,        // lengthAdjustment\uff1a\u957f\u5ea6\u5b57\u6bb5\u4e4b\u540e\u5230\u771f\u5b9e\u6570\u636e\u4e4b\u95f4\u7684\u5b57\u8282\u6570\n        4         // initialBytesToStrip\uff1a\u4ece\u5934\u90e8\u79fb\u9664\u7684\u5b57\u8282\u6570\n    )\n);\n\n// \u573a\u666f2\uff1a\u957f\u5ea6\u5b57\u6bb5\u4e0d\u5305\u542b\u81ea\u8eab\u957f\u5ea6\n//  \u683c\u5f0f: [\u957f\u5ea6(4\u5b57\u8282)] [\u6570\u636e...]\n//  \u957f\u5ea6\u5b57\u6bb5\u7684\u503c\u53ea\u8868\u793a\u6570\u636e\u90e8\u5206\u7684\u957f\u5ea6\npipeline.addLast(\n    new LengthFieldBasedFrameDecoder(\n        1024,     // maxFrameLength\n        0,        // lengthFieldOffset\n        4,        // lengthFieldLength\n        0,        // lengthAdjustment\uff1a\u957f\u5ea6\u5b57\u6bb5\u503c\u9700\u8981\u52a0 4\uff08\u5b57\u6bb5\u672c\u8eab\uff09\n        4         // initialBytesToStrip\n    )\n);\n\n// \u573a\u666f3\uff1a\u957f\u5ea6\u5b57\u6bb5\u5728\u4e2d\u95f4\u4f4d\u7f6e\n//  \u683c\u5f0f: [\u5934\u90e8(2\u5b57\u8282)] [\u957f\u5ea6(4\u5b57\u8282)] [\u6570\u636e...]\npipeline.addLast(\n    new LengthFieldBasedFrameDecoder(\n        1024,     // maxFrameLength\n        2,        // lengthFieldOffset\uff1a\u957f\u5ea6\u5b57\u6bb5\u5728\u4f4d\u7f6e 2\n        4,        // lengthFieldLength\n        0,        // lengthAdjustment\n        0         // initialBytesToStrip\uff1a\u4e0d\u79fb\u9664\u4efb\u4f55\u5b57\u8282\uff0c\u4fdd\u7559\u5b8c\u6574\u5e27\n    )\n);\n\n// \u5b8c\u6574\u4f8b\u5b50\nChannelInitializer<SocketChannel> initializer = \n    new ChannelInitializer<SocketChannel>() {\n    @Override\n    protected void initChannel(SocketChannel ch) {\n        ch.pipeline()\n            .addLast(new LengthFieldBasedFrameDecoder(65535, 0, 4, 0, 4))\n            .addLast(new StringDecoder(CharsetUtil.UTF_8))\n            .addLast(new MyMessageHandler());\n    }\n};\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u81ea\u5b9a\u4e49\u534f\u8bae\u7f16\u89e3\u7801",children:"\u81ea\u5b9a\u4e49\u534f\u8bae\u7f16\u89e3\u7801"}),"\n",(0,i.jsx)(n.h3,{id:"\u5b9a\u4e49\u534f\u8bae\u683c\u5f0f",children:"\u5b9a\u4e49\u534f\u8bae\u683c\u5f0f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"// \u534f\u8bae\u683c\u5f0f: [\u957f\u5ea6(4\u5b57\u8282)] [\u7c7b\u578b(1\u5b57\u8282)] [\u6570\u636e...]\npublic class MyMessage {\n    private byte type;\n    private String data;\n\n    public MyMessage(byte type, String data) {\n        this.type = type;\n        this.data = data;\n    }\n\n    public byte getType() {\n        return type;\n    }\n\n    public String getData() {\n        return data;\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u7f16\u7801\u5668",children:"\u7f16\u7801\u5668"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"public class MyMessageEncoder extends MessageToByteEncoder<MyMessage> {\n    @Override\n    protected void encode(ChannelHandlerContext ctx, MyMessage msg, ByteBuf out) {\n        // \u83b7\u53d6\u6d88\u606f\u6570\u636e\n        String data = msg.getData();\n        byte[] bytes = data.getBytes(CharsetUtil.UTF_8);\n\n        // \u5199\u5165\u957f\u5ea6\uff08\u5305\u542b\u7c7b\u578b\u5b57\u6bb5 1 \u5b57\u8282\uff09\n        out.writeInt(bytes.length + 1);\n        \n        // \u5199\u5165\u7c7b\u578b\n        out.writeByte(msg.getType());\n        \n        // \u5199\u5165\u6570\u636e\n        out.writeBytes(bytes);\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u89e3\u7801\u5668",children:"\u89e3\u7801\u5668"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"public class MyMessageDecoder extends ByteToMessageDecoder {\n    private final int HEADER_SIZE = 5; // \u957f\u5ea6(4) + \u7c7b\u578b(1)\n\n    @Override\n    protected void decode(ChannelHandlerContext ctx, ByteBuf in, List<Object> out) {\n        // \u68c0\u67e5\u5934\u90e8\u6570\u636e\u662f\u5426\u5b8c\u6574\n        if (in.readableBytes() < HEADER_SIZE) {\n            return;\n        }\n\n        // \u6807\u8bb0\u8bfb\u4f4d\u7f6e\n        in.markReaderIndex();\n\n        // \u8bfb\u53d6\u6d88\u606f\u957f\u5ea6\n        int length = in.readInt();\n\n        // \u68c0\u67e5\u6570\u636e\u662f\u5426\u5b8c\u6574\n        if (in.readableBytes() < length) {\n            in.resetReaderIndex(); // \u91cd\u7f6e\u8bfb\u4f4d\u7f6e\n            return;\n        }\n\n        // \u8bfb\u53d6\u7c7b\u578b\n        byte type = in.readByte();\n\n        // \u8bfb\u53d6\u6570\u636e\n        byte[] data = new byte[length - 1];\n        in.readBytes(data);\n        String message = new String(data, CharsetUtil.UTF_8);\n\n        // \u521b\u5efa\u6d88\u606f\u5bf9\u8c61\n        MyMessage msg = new MyMessage(type, message);\n        out.add(msg);\n    }\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u7f16\u89e3\u7801\u5668",children:"\u4f7f\u7528\u81ea\u5b9a\u4e49\u7f16\u89e3\u7801\u5668"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'ServerBootstrap bootstrap = new ServerBootstrap();\nbootstrap.childHandler(new ChannelInitializer<SocketChannel>() {\n    @Override\n    protected void initChannel(SocketChannel ch) {\n        ChannelPipeline pipeline = ch.pipeline();\n        \n        // \u6dfb\u52a0\u89e3\u7801\u5668\n        pipeline.addLast(new MyMessageDecoder());\n        \n        // \u6dfb\u52a0\u7f16\u7801\u5668\n        pipeline.addLast(new MyMessageEncoder());\n        \n        // \u6dfb\u52a0\u4e1a\u52a1\u5904\u7406 Handler\n        pipeline.addLast(new MyMessageHandler());\n    }\n});\n\n// \u4e1a\u52a1\u5904\u7406\npublic class MyMessageHandler extends SimpleChannelInboundHandler<MyMessage> {\n    @Override\n    protected void channelRead0(ChannelHandlerContext ctx, MyMessage msg) {\n        System.out.println("\u7c7b\u578b: " + msg.getType() + ", \u6570\u636e: " + msg.getData());\n        \n        // \u53d1\u9001\u54cd\u5e94\n        MyMessage response = new MyMessage((byte) 1, "\u670d\u52a1\u5668\u54cd\u5e94");\n        ctx.writeAndFlush(response);\n    }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u5e38\u7528\u7f16\u89e3\u7801\u5668\u603b\u7ed3",children:"\u5e38\u7528\u7f16\u89e3\u7801\u5668\u603b\u7ed3"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u7f16\u89e3\u7801\u5668"}),(0,i.jsx)(n.th,{children:"\u7528\u9014"}),(0,i.jsx)(n.th,{children:"\u573a\u666f"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"StringDecoder/Encoder"})}),(0,i.jsx)(n.td,{children:"\u5b57\u7b26\u4e32\u7f16\u89e3\u7801"}),(0,i.jsx)(n.td,{children:"\u6587\u672c\u534f\u8bae"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"ObjectDecoder/Encoder"})}),(0,i.jsx)(n.td,{children:"\u5bf9\u8c61\u5e8f\u5217\u5316"}),(0,i.jsx)(n.td,{children:"\u7b80\u5355\u573a\u666f\uff08\u4e0d\u63a8\u8350\u751f\u4ea7\uff09"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"LineBasedFrameDecoder"})}),(0,i.jsx)(n.td,{children:"\u6309\u884c\u5206\u5272"}),(0,i.jsx)(n.td,{children:"HTTP\u3001Redis \u7b49"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"DelimitedFrameDecoder"})}),(0,i.jsx)(n.td,{children:"\u6309\u5206\u754c\u7b26\u5206\u5272"}),(0,i.jsx)(n.td,{children:"\u81ea\u5b9a\u4e49\u5206\u754c\u7b26"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"FixedLengthFrameDecoder"})}),(0,i.jsx)(n.td,{children:"\u56fa\u5b9a\u957f\u5ea6\u5e27"}),(0,i.jsx)(n.td,{children:"\u56fa\u5b9a\u5927\u5c0f\u6d88\u606f"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"LengthFieldBasedFrameDecoder"})}),(0,i.jsx)(n.td,{children:"\u957f\u5ea6\u5b57\u6bb5\u5e27"}),(0,i.jsx)(n.td,{children:"\u5927\u591a\u6570\u4e8c\u8fdb\u5236\u534f\u8bae"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Base64Decoder/Encoder"})}),(0,i.jsx)(n.td,{children:"Base64 \u7f16\u89e3\u7801"}),(0,i.jsx)(n.td,{children:"Base64 \u6570\u636e"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"ZlibCodecFactory"})}),(0,i.jsx)(n.td,{children:"\u538b\u7f29\u7f16\u89e3\u7801"}),(0,i.jsx)(n.td,{children:"\u538b\u7f29\u4f20\u8f93"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:"// \u2713 \u6b63\u786e\uff1a\u89e3\u7801\u5668\u4e2d\u5408\u7406\u68c0\u67e5\u6570\u636e\u5b8c\u6574\u6027\n@Override\nprotected void decode(ChannelHandlerContext ctx, ByteBuf in, List<Object> out) {\n    if (in.readableBytes() < MIN_LENGTH) {\n        return; // \u7b49\u5f85\u66f4\u591a\u6570\u636e\n    }\n    // \u5904\u7406\u6570\u636e\n}\n\n// \u2713 \u6b63\u786e\uff1a\u7f16\u7801\u5668\u4e2d\u68c0\u67e5\u5165\u53c2\n@Override\nprotected void encode(ChannelHandlerContext ctx, MyMessage msg, ByteBuf out) {\n    if (msg == null) {\n        return;\n    }\n    // \u7f16\u7801\n}\n\n// \u2717 \u9519\u8bef\uff1a\u7f16\u7801\u5668\u4e2d\u8fdb\u884c I/O \u64cd\u4f5c\n@Override\nprotected void encode(ChannelHandlerContext ctx, MyMessage msg, ByteBuf out) {\n    // \u4e0d\u8981\u505a\uff1a\u4ece\u6570\u636e\u5e93\u8bfb\u53d6\u6570\u636e\uff08\u963b\u585e\uff09\n    // Object obj = database.query(msg.getId());\n    out.writeBytes(...)\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"/docs/netty/practical-examples",children:"\u4e0b\u4e00\u7ae0\uff1a\u5b9e\u6218\u6848\u4f8b"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);