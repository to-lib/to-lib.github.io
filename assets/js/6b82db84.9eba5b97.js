"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[21811],{48885:(n,e,t)=>{t.d(e,{R:()=>a,x:()=>d});var r=t(99378);const i={},s=r.createContext(i);function a(n){const e=r.useContext(s);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:a(n.components),r.createElement(s.Provider,{value:e},n.children)}},85895:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>d,default:()=>m,frontMatter:()=>a,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"ml/model-tuning","title":"\u2699\ufe0f \u6a21\u578b\u8c03\u4f18","description":"\u8d85\u53c2\u6570\u641c\u7d22","source":"@site/docs/ml/model-tuning.md","sourceDirName":"ml","slug":"/ml/model-tuning","permalink":"/docs/ml/model-tuning","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/model-tuning.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10,"title":"\u2699\ufe0f \u6a21\u578b\u8c03\u4f18"},"sidebar":"ml","previous":{"title":"\ud83d\udccf \u6a21\u578b\u8bc4\u4f30","permalink":"/docs/ml/model-evaluation"},"next":{"title":"\ud83d\udd0d \u53ef\u89e3\u91ca\u6027","permalink":"/docs/ml/interpretability"}}');var i=t(22714),s=t(48885);const a={sidebar_position:10,title:"\u2699\ufe0f \u6a21\u578b\u8c03\u4f18"},d="\u6a21\u578b\u8c03\u4f18",l={},o=[{value:"\u8d85\u53c2\u6570\u641c\u7d22",id:"\u8d85\u53c2\u6570\u641c\u7d22",level:2},{value:"\u7f51\u683c\u641c\u7d22",id:"\u7f51\u683c\u641c\u7d22",level:3},{value:"\u968f\u673a\u641c\u7d22",id:"\u968f\u673a\u641c\u7d22",level:3},{value:"Optuna (\u8d1d\u53f6\u65af\u4f18\u5316)",id:"optuna-\u8d1d\u53f6\u65af\u4f18\u5316",level:3},{value:"\u6b63\u5219\u5316",id:"\u6b63\u5219\u5316",level:2},{value:"\u7c7b\u522b\u4e0d\u5e73\u8861\u5904\u7406",id:"\u7c7b\u522b\u4e0d\u5e73\u8861\u5904\u7406",level:2}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"\u6a21\u578b\u8c03\u4f18",children:"\u6a21\u578b\u8c03\u4f18"})}),"\n",(0,i.jsx)(e.h2,{id:"\u8d85\u53c2\u6570\u641c\u7d22",children:"\u8d85\u53c2\u6570\u641c\u7d22"}),"\n",(0,i.jsx)(e.h3,{id:"\u7f51\u683c\u641c\u7d22",children:"\u7f51\u683c\u641c\u7d22"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from sklearn.model_selection import GridSearchCV\n\nparam_grid = {\n    'n_estimators': [50, 100, 200],\n    'max_depth': [3, 5, 10, None],\n    'min_samples_split': [2, 5, 10]\n}\n\ngrid_search = GridSearchCV(\n    RandomForestClassifier(), param_grid,\n    cv=5, scoring='accuracy', n_jobs=-1\n)\ngrid_search.fit(X_train, y_train)\n\nprint(f\"\u6700\u4f73\u53c2\u6570: {grid_search.best_params_}\")\nprint(f\"\u6700\u4f73\u5206\u6570: {grid_search.best_score_:.2%}\")\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u968f\u673a\u641c\u7d22",children:"\u968f\u673a\u641c\u7d22"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from sklearn.model_selection import RandomizedSearchCV\nfrom scipy.stats import randint, uniform\n\nparam_dist = {\n    'n_estimators': randint(50, 500),\n    'max_depth': randint(3, 20),\n    'learning_rate': uniform(0.01, 0.3)\n}\n\nrandom_search = RandomizedSearchCV(\n    XGBClassifier(), param_dist,\n    n_iter=50, cv=5, random_state=42\n)\nrandom_search.fit(X_train, y_train)\n"})}),"\n",(0,i.jsx)(e.h3,{id:"optuna-\u8d1d\u53f6\u65af\u4f18\u5316",children:"Optuna (\u8d1d\u53f6\u65af\u4f18\u5316)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"import optuna\n\ndef objective(trial):\n    params = {\n        'n_estimators': trial.suggest_int('n_estimators', 50, 500),\n        'max_depth': trial.suggest_int('max_depth', 3, 20),\n        'learning_rate': trial.suggest_float('learning_rate', 0.01, 0.3)\n    }\n    model = XGBClassifier(**params)\n    return cross_val_score(model, X, y, cv=5).mean()\n\nstudy = optuna.create_study(direction='maximize')\nstudy.optimize(objective, n_trials=100)\nprint(f\"\u6700\u4f73\u53c2\u6570: {study.best_params}\")\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u6b63\u5219\u5316",children:"\u6b63\u5219\u5316"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u65b9\u6cd5"}),(0,i.jsx)(e.th,{children:"\u63cf\u8ff0"}),(0,i.jsx)(e.th,{children:"\u9002\u7528\u573a\u666f"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"L1 (Lasso)"}),(0,i.jsx)(e.td,{children:"\u7a00\u758f\u89e3\uff0c\u7279\u5f81\u9009\u62e9"}),(0,i.jsx)(e.td,{children:"\u9ad8\u7ef4\u6570\u636e"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"L2 (Ridge)"}),(0,i.jsx)(e.td,{children:"\u9632\u6b62\u6743\u91cd\u8fc7\u5927"}),(0,i.jsx)(e.td,{children:"\u591a\u91cd\u5171\u7ebf\u6027"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Dropout"}),(0,i.jsx)(e.td,{children:"\u968f\u673a\u4e22\u5f03\u795e\u7ecf\u5143"}),(0,i.jsx)(e.td,{children:"\u6df1\u5ea6\u5b66\u4e60"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Early Stopping"}),(0,i.jsx)(e.td,{children:"\u9a8c\u8bc1\u96c6\u6027\u80fd\u4e0b\u964d\u65f6\u505c\u6b62"}),(0,i.jsx)(e.td,{children:"\u4efb\u4f55\u8fed\u4ee3\u6a21\u578b"})]})]})]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# L2 \u6b63\u5219\u5316\nmodel = LogisticRegression(C=0.1)  # C = 1/\u03bb\n\n# Dropout (PyTorch)\nnn.Dropout(0.5)\n\n# Early Stopping\nfrom sklearn.ensemble import GradientBoostingClassifier\nmodel = GradientBoostingClassifier(n_iter_no_change=10, validation_fraction=0.1)\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u7c7b\u522b\u4e0d\u5e73\u8861\u5904\u7406",children:"\u7c7b\u522b\u4e0d\u5e73\u8861\u5904\u7406"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# \u65b9\u6cd51: \u7c7b\u522b\u6743\u91cd\nmodel = LogisticRegression(class_weight='balanced')\n\n# \u65b9\u6cd52: \u8fc7\u91c7\u6837 (SMOTE)\nfrom imblearn.over_sampling import SMOTE\nsmote = SMOTE(random_state=42)\nX_res, y_res = smote.fit_resample(X_train, y_train)\n\n# \u65b9\u6cd53: \u6b20\u91c7\u6837\nfrom imblearn.under_sampling import RandomUnderSampler\nrus = RandomUnderSampler(random_state=42)\nX_res, y_res = rus.fit_resample(X_train, y_train)\n"})})]})}function m(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(c,{...n})}):c(n)}}}]);