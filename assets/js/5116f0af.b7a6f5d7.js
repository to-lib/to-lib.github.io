"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[27579],{42563:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>o,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"ml/automl","title":"\ud83e\udd16 AutoML","description":"AutoML \u81ea\u52a8\u5316\u673a\u5668\u5b66\u4e60\u6d41\u7a0b\uff0c\u51cf\u5c11\u624b\u52a8\u8c03\u53c2\u5de5\u4f5c\u3002","source":"@site/docs/ml/automl.md","sourceDirName":"ml","slug":"/ml/automl","permalink":"/docs/ml/automl","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/automl.md","tags":[],"version":"current","sidebarPosition":23,"frontMatter":{"sidebar_position":23,"title":"\ud83e\udd16 AutoML"},"sidebar":"ml","previous":{"title":"\ud83d\udd0d \u53ef\u89e3\u91ca\u6027","permalink":"/docs/ml/interpretability"},"next":{"title":"\ud83d\ude80 \u6a21\u578b\u90e8\u7f72","permalink":"/docs/ml/model-deployment"}}');var i=t(22714),l=t(48885);const s={sidebar_position:23,title:"\ud83e\udd16 AutoML"},a="AutoML",o={},d=[{value:"AutoML \u6d41\u7a0b",id:"automl-\u6d41\u7a0b",level:2},{value:"Auto-sklearn",id:"auto-sklearn",level:2},{value:"TPOT",id:"tpot",level:2},{value:"H2O AutoML",id:"h2o-automl",level:2},{value:"AutoGluon",id:"autogluon",level:2},{value:"\u795e\u7ecf\u67b6\u6784\u641c\u7d22 (NAS)",id:"\u795e\u7ecf\u67b6\u6784\u641c\u7d22-nas",level:2},{value:"\u5de5\u5177\u5bf9\u6bd4",id:"\u5de5\u5177\u5bf9\u6bd4",level:2},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2}];function c(n){const e={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,l.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"automl",children:"AutoML"})}),"\n",(0,i.jsx)(e.p,{children:"AutoML \u81ea\u52a8\u5316\u673a\u5668\u5b66\u4e60\u6d41\u7a0b\uff0c\u51cf\u5c11\u624b\u52a8\u8c03\u53c2\u5de5\u4f5c\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"automl-\u6d41\u7a0b",children:"AutoML \u6d41\u7a0b"}),"\n",(0,i.jsx)(e.mermaid,{value:"graph LR\n    A[\u6570\u636e] --\x3e B[\u7279\u5f81\u5de5\u7a0b]\n    B --\x3e C[\u6a21\u578b\u9009\u62e9]\n    C --\x3e D[\u8d85\u53c2\u6570\u4f18\u5316]\n    D --\x3e E[\u96c6\u6210]\n    E --\x3e F[\u6700\u4f18\u6a21\u578b]"}),"\n",(0,i.jsx)(e.h2,{id:"auto-sklearn",children:"Auto-sklearn"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"import autosklearn.classification\n\nautoml = autosklearn.classification.AutoSklearnClassifier(\n    time_left_for_this_task=3600,  # \u603b\u65f6\u95f4\uff08\u79d2\uff09\n    per_run_time_limit=300,         # \u5355\u6b21\u8fd0\u884c\u65f6\u95f4\n    n_jobs=-1\n)\n\nautoml.fit(X_train, y_train)\npredictions = automl.predict(X_test)\n\n# \u67e5\u770b\u6700\u4f73\u6a21\u578b\nprint(automl.leaderboard())\nprint(automl.show_models())\n"})}),"\n",(0,i.jsx)(e.h2,{id:"tpot",children:"TPOT"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from tpot import TPOTClassifier\n\ntpot = TPOTClassifier(\n    generations=10,\n    population_size=50,\n    cv=5,\n    random_state=42,\n    verbosity=2\n)\n\ntpot.fit(X_train, y_train)\nprint(tpot.score(X_test, y_test))\n\n# \u5bfc\u51fa\u6700\u4f73 Pipeline\ntpot.export('best_pipeline.py')\n"})}),"\n",(0,i.jsx)(e.h2,{id:"h2o-automl",children:"H2O AutoML"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"import h2o\nfrom h2o.automl import H2OAutoML\n\nh2o.init()\n\n# \u8f6c\u6362\u6570\u636e\ntrain = h2o.H2OFrame(df_train)\ntest = h2o.H2OFrame(df_test)\n\n# \u8fd0\u884c AutoML\naml = H2OAutoML(max_runtime_secs=3600, seed=42)\naml.train(x=features, y=target, training_frame=train)\n\n# \u67e5\u770b\u6392\u884c\u699c\nlb = aml.leaderboard\nprint(lb)\n\n# \u6700\u4f73\u6a21\u578b\nbest = aml.leader\npredictions = best.predict(test)\n"})}),"\n",(0,i.jsx)(e.h2,{id:"autogluon",children:"AutoGluon"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from autogluon.tabular import TabularPredictor\n\npredictor = TabularPredictor(label='target').fit(\n    train_data,\n    time_limit=3600,\n    presets='best_quality'\n)\n\npredictions = predictor.predict(test_data)\nleaderboard = predictor.leaderboard()\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u795e\u7ecf\u67b6\u6784\u641c\u7d22-nas",children:"\u795e\u7ecf\u67b6\u6784\u641c\u7d22 (NAS)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"# \u4f7f\u7528 Optuna \u7b80\u5355 NAS\nimport optuna\n\ndef objective(trial):\n    n_layers = trial.suggest_int('n_layers', 1, 5)\n    layers = []\n    in_features = input_dim\n\n    for i in range(n_layers):\n        out_features = trial.suggest_int(f'n_units_{i}', 32, 256)\n        layers.append(nn.Linear(in_features, out_features))\n        layers.append(nn.ReLU())\n        in_features = out_features\n\n    layers.append(nn.Linear(in_features, num_classes))\n    model = nn.Sequential(*layers)\n\n    # \u8bad\u7ec3\u5e76\u8fd4\u56de\u9a8c\u8bc1\u51c6\u786e\u7387\n    return train_and_evaluate(model)\n\nstudy = optuna.create_study(direction='maximize')\nstudy.optimize(objective, n_trials=100)\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5de5\u5177\u5bf9\u6bd4",children:"\u5de5\u5177\u5bf9\u6bd4"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u5de5\u5177"}),(0,i.jsx)(e.th,{children:"\u7279\u70b9"}),(0,i.jsx)(e.th,{children:"\u9002\u7528\u573a\u666f"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"Auto-sklearn"}),(0,i.jsx)(e.td,{children:"\u57fa\u4e8e sklearn"}),(0,i.jsx)(e.td,{children:"\u8868\u683c\u6570\u636e"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"TPOT"}),(0,i.jsx)(e.td,{children:"\u9057\u4f20\u7b97\u6cd5"}),(0,i.jsx)(e.td,{children:"Pipeline \u4f18\u5316"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"H2O"}),(0,i.jsx)(e.td,{children:"\u4f01\u4e1a\u7ea7"}),(0,i.jsx)(e.td,{children:"\u751f\u4ea7\u73af\u5883"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"AutoGluon"}),(0,i.jsx)(e.td,{children:"\u7b80\u5355\u6613\u7528"}),(0,i.jsx)(e.td,{children:"\u5feb\u901f\u539f\u578b"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"AutoKeras"}),(0,i.jsx)(e.td,{children:"\u795e\u7ecf\u7f51\u7edc"}),(0,i.jsx)(e.td,{children:"\u6df1\u5ea6\u5b66\u4e60"})]})]})]}),"\n",(0,i.jsx)(e.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,i.jsxs)(e.ol,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u8bbe\u7f6e\u5408\u7406\u65f6\u95f4\u9650\u5236"}),"\uff1a\u5e73\u8861\u641c\u7d22\u8d28\u91cf\u548c\u65f6\u95f4"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6570\u636e\u9884\u5904\u7406\u8981\u505a\u597d"}),"\uff1aAutoML \u4e0d\u80fd\u66ff\u4ee3\u6570\u636e\u6e05\u6d17"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u7406\u89e3\u6700\u7ec8\u6a21\u578b"}),"\uff1a\u4e0d\u8981\u76f2\u76ee\u4f7f\u7528\u9ed1\u76d2\u7ed3\u679c"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u9a8c\u8bc1\u96c6\u72ec\u7acb"}),"\uff1a\u907f\u514d\u8fc7\u62df\u5408\u9a8c\u8bc1\u96c6"]}),"\n"]})]})}function u(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(c,{...n})}):c(n)}},48885:(n,e,t)=>{t.d(e,{R:()=>s,x:()=>a});var r=t(99378);const i={},l=r.createContext(i);function s(n){const e=r.useContext(l);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:s(n.components),r.createElement(l.Provider,{value:e},n.children)}}}]);