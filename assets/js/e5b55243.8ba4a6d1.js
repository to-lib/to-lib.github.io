"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[28972],{48574:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>t,contentTitle:()=>c,default:()=>o,frontMatter:()=>i,metadata:()=>d,toc:()=>a});const d=JSON.parse('{"id":"docker/storage-drivers","title":"\u5b58\u50a8\u8fdb\u9636","description":"\u5b58\u50a8\u9a71\u52a8\u5bf9\u6bd4\u3001tmpfs \u6302\u8f7d\u4e0e\u5206\u5e03\u5f0f\u5b58\u50a8\u65b9\u6848","source":"@site/docs/docker/storage-drivers.md","sourceDirName":"docker","slug":"/docker/storage-drivers","permalink":"/docs/docker/storage-drivers","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/docker/storage-drivers.md","tags":[],"version":"current","sidebarPosition":21,"frontMatter":{"sidebar_position":21,"title":"\u5b58\u50a8\u8fdb\u9636","description":"\u5b58\u50a8\u9a71\u52a8\u5bf9\u6bd4\u3001tmpfs \u6302\u8f7d\u4e0e\u5206\u5e03\u5f0f\u5b58\u50a8\u65b9\u6848"},"sidebar":"docker","previous":{"title":"\u955c\u50cf\u539f\u7406","permalink":"/docs/docker/image-internals"},"next":{"title":"\u5bb9\u5668\u8fd0\u884c\u65f6","permalink":"/docs/docker/container-runtime"}}');var s=r(22714),l=r(48885);const i={sidebar_position:21,title:"\u5b58\u50a8\u8fdb\u9636",description:"\u5b58\u50a8\u9a71\u52a8\u5bf9\u6bd4\u3001tmpfs \u6302\u8f7d\u4e0e\u5206\u5e03\u5f0f\u5b58\u50a8\u65b9\u6848"},c="\u5b58\u50a8\u8fdb\u9636",t={},a=[{value:"\u5b58\u50a8\u9a71\u52a8\u5bf9\u6bd4",id:"\u5b58\u50a8\u9a71\u52a8\u5bf9\u6bd4",level:2},{value:"\u4e3b\u8981\u5b58\u50a8\u9a71\u52a8",id:"\u4e3b\u8981\u5b58\u50a8\u9a71\u52a8",level:3},{value:"\u67e5\u770b\u5f53\u524d\u5b58\u50a8\u9a71\u52a8",id:"\u67e5\u770b\u5f53\u524d\u5b58\u50a8\u9a71\u52a8",level:3},{value:"\u914d\u7f6e\u5b58\u50a8\u9a71\u52a8",id:"\u914d\u7f6e\u5b58\u50a8\u9a71\u52a8",level:3},{value:"overlay2 \u8be6\u89e3",id:"overlay2-\u8be6\u89e3",level:3},{value:"tmpfs \u6302\u8f7d",id:"tmpfs-\u6302\u8f7d",level:2},{value:"\u4f7f\u7528\u573a\u666f",id:"\u4f7f\u7528\u573a\u666f",level:3},{value:"\u57fa\u672c\u7528\u6cd5",id:"\u57fa\u672c\u7528\u6cd5",level:3},{value:"tmpfs \u9009\u9879",id:"tmpfs-\u9009\u9879",level:3},{value:"Docker Compose tmpfs",id:"docker-compose-tmpfs",level:3},{value:"\u7ed1\u5b9a\u6302\u8f7d vs \u5377",id:"\u7ed1\u5b9a\u6302\u8f7d-vs-\u5377",level:2},{value:"\u5bf9\u6bd4",id:"\u5bf9\u6bd4",level:3},{value:"\u7ed1\u5b9a\u6302\u8f7d",id:"\u7ed1\u5b9a\u6302\u8f7d",level:3},{value:"\u547d\u540d\u5377",id:"\u547d\u540d\u5377",level:3},{value:"NFS \u5b58\u50a8",id:"nfs-\u5b58\u50a8",level:2},{value:"\u521b\u5efa NFS \u5377",id:"\u521b\u5efa-nfs-\u5377",level:3},{value:"Docker Compose NFS",id:"docker-compose-nfs",level:3},{value:"\u5206\u5e03\u5f0f\u5b58\u50a8",id:"\u5206\u5e03\u5f0f\u5b58\u50a8",level:2},{value:"Ceph RBD",id:"ceph-rbd",level:3},{value:"GlusterFS",id:"glusterfs",level:3},{value:"\u4e91\u5b58\u50a8",id:"\u4e91\u5b58\u50a8",level:3},{value:"\u5b58\u50a8\u6027\u80fd\u4f18\u5316",id:"\u5b58\u50a8\u6027\u80fd\u4f18\u5316",level:2},{value:"\u9009\u62e9\u5408\u9002\u7684\u5b58\u50a8\u9a71\u52a8",id:"\u9009\u62e9\u5408\u9002\u7684\u5b58\u50a8\u9a71\u52a8",level:3},{value:"\u6570\u636e\u76ee\u5f55\u5206\u79bb",id:"\u6570\u636e\u76ee\u5f55\u5206\u79bb",level:3},{value:"\u65e5\u5fd7\u5b58\u50a8\u4f18\u5316",id:"\u65e5\u5fd7\u5b58\u50a8\u4f18\u5316",level:3},{value:"\u6570\u636e\u5907\u4efd\u4e0e\u6062\u590d",id:"\u6570\u636e\u5907\u4efd\u4e0e\u6062\u590d",level:2},{value:"\u5907\u4efd\u5377\u6570\u636e",id:"\u5907\u4efd\u5377\u6570\u636e",level:3},{value:"\u5907\u4efd\u5bb9\u5668",id:"\u5907\u4efd\u5bb9\u5668",level:3},{value:"\u8fc1\u79fb\u5377\u5230\u65b0\u4e3b\u673a",id:"\u8fc1\u79fb\u5377\u5230\u65b0\u4e3b\u673a",level:3}];function h(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"\u5b58\u50a8\u8fdb\u9636",children:"\u5b58\u50a8\u8fdb\u9636"})}),"\n",(0,s.jsx)(e.p,{children:"\u6df1\u5165\u7406\u89e3 Docker \u5b58\u50a8\u673a\u5236\u548c\u751f\u4ea7\u73af\u5883\u5b58\u50a8\u65b9\u6848\u3002"}),"\n",(0,s.jsx)(e.h2,{id:"\u5b58\u50a8\u9a71\u52a8\u5bf9\u6bd4",children:"\u5b58\u50a8\u9a71\u52a8\u5bf9\u6bd4"}),"\n",(0,s.jsx)(e.h3,{id:"\u4e3b\u8981\u5b58\u50a8\u9a71\u52a8",children:"\u4e3b\u8981\u5b58\u50a8\u9a71\u52a8"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u9a71\u52a8"}),(0,s.jsx)(e.th,{children:"\u540e\u7aef\u6587\u4ef6\u7cfb\u7edf"}),(0,s.jsx)(e.th,{children:"\u6027\u80fd"}),(0,s.jsx)(e.th,{children:"\u7a33\u5b9a\u6027"}),(0,s.jsx)(e.th,{children:"\u63a8\u8350\u573a\u666f"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"overlay2"})}),(0,s.jsx)(e.td,{children:"xfs, ext4"}),(0,s.jsx)(e.td,{children:"\u9ad8"}),(0,s.jsx)(e.td,{children:"\u9ad8"}),(0,s.jsx)(e.td,{children:"\u9ed8\u8ba4\u63a8\u8350"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"btrfs"})}),(0,s.jsx)(e.td,{children:"btrfs"}),(0,s.jsx)(e.td,{children:"\u9ad8"}),(0,s.jsx)(e.td,{children:"\u4e2d"}),(0,s.jsx)(e.td,{children:"\u4f7f\u7528 btrfs \u7684\u7cfb\u7edf"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"zfs"})}),(0,s.jsx)(e.td,{children:"zfs"}),(0,s.jsx)(e.td,{children:"\u9ad8"}),(0,s.jsx)(e.td,{children:"\u9ad8"}),(0,s.jsx)(e.td,{children:"\u4f7f\u7528 zfs \u7684\u7cfb\u7edf"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"devicemapper"})}),(0,s.jsx)(e.td,{children:"direct-lvm"}),(0,s.jsx)(e.td,{children:"\u4e2d"}),(0,s.jsx)(e.td,{children:"\u9ad8"}),(0,s.jsx)(e.td,{children:"RHEL/CentOS \u65e7\u7248\u672c"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.strong,{children:"vfs"})}),(0,s.jsx)(e.td,{children:"\u4efb\u610f"}),(0,s.jsx)(e.td,{children:"\u4f4e"}),(0,s.jsx)(e.td,{children:"\u9ad8"}),(0,s.jsx)(e.td,{children:"\u6d4b\u8bd5/\u8c03\u8bd5"})]})]})]}),"\n",(0,s.jsx)(e.h3,{id:"\u67e5\u770b\u5f53\u524d\u5b58\u50a8\u9a71\u52a8",children:"\u67e5\u770b\u5f53\u524d\u5b58\u50a8\u9a71\u52a8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:'docker info | grep "Storage Driver"\n# Storage Driver: overlay2\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u914d\u7f6e\u5b58\u50a8\u9a71\u52a8",children:"\u914d\u7f6e\u5b58\u50a8\u9a71\u52a8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",children:'// /etc/docker/daemon.json\n{\n  "storage-driver": "overlay2",\n  "storage-opts": [\n    "overlay2.override_kernel_check=true"\n  ]\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"overlay2-\u8be6\u89e3",children:"overlay2 \u8be6\u89e3"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b overlay2 \u5b58\u50a8\u4f4d\u7f6e\nls /var/lib/docker/overlay2/\n\n# \u67e5\u770b\u5bb9\u5668\u7684 overlay \u6302\u8f7d\u4fe1\u606f\ndocker inspect container --format '{{json .GraphDriver.Data}}' | jq\n\n# \u76ee\u5f55\u7ed3\u6784\n# /var/lib/docker/overlay2/\n# \u251c\u2500\u2500 <layer-id>/\n# \u2502   \u251c\u2500\u2500 diff/      # \u8be5\u5c42\u7684\u6587\u4ef6\u5185\u5bb9\n# \u2502   \u251c\u2500\u2500 link       # \u77ed ID \u94fe\u63a5\n# \u2502   \u251c\u2500\u2500 lower      # \u4e0b\u5c42\u5f15\u7528\n# \u2502   \u2514\u2500\u2500 work/      # overlay \u5de5\u4f5c\u76ee\u5f55\n# \u2514\u2500\u2500 l/             # \u77ed ID \u7b26\u53f7\u94fe\u63a5\u76ee\u5f55\n"})}),"\n",(0,s.jsx)(e.h2,{id:"tmpfs-\u6302\u8f7d",children:"tmpfs \u6302\u8f7d"}),"\n",(0,s.jsx)(e.p,{children:"tmpfs \u5c06\u6570\u636e\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff0c\u5bb9\u5668\u505c\u6b62\u540e\u6570\u636e\u6d88\u5931\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"\u4f7f\u7528\u573a\u666f",children:"\u4f7f\u7528\u573a\u666f"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u654f\u611f\u6570\u636e\uff08\u4e0d\u5199\u5165\u78c1\u76d8\uff09"}),"\n",(0,s.jsx)(e.li,{children:"\u9ad8\u6027\u80fd\u4e34\u65f6\u5b58\u50a8"}),"\n",(0,s.jsx)(e.li,{children:"\u7f13\u5b58\u6570\u636e"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"\u57fa\u672c\u7528\u6cd5",children:"\u57fa\u672c\u7528\u6cd5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u6302\u8f7d tmpfs\ndocker run -d \\\n  --tmpfs /tmp \\\n  --tmpfs /run:rw,noexec,nosuid,size=100m \\\n  nginx\n\n# \u4f7f\u7528 --mount \u8bed\u6cd5\ndocker run -d \\\n  --mount type=tmpfs,destination=/tmp,tmpfs-size=100m,tmpfs-mode=1777 \\\n  nginx\n"})}),"\n",(0,s.jsx)(e.h3,{id:"tmpfs-\u9009\u9879",children:"tmpfs \u9009\u9879"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u9009\u9879"}),(0,s.jsx)(e.th,{children:"\u8bf4\u660e"}),(0,s.jsx)(e.th,{children:"\u793a\u4f8b"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"size"})}),(0,s.jsx)(e.td,{children:"\u5927\u5c0f\u9650\u5236"}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"size=100m"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"mode"})}),(0,s.jsx)(e.td,{children:"\u6587\u4ef6\u6743\u9650"}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"mode=1777"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"uid"})}),(0,s.jsx)(e.td,{children:"\u6240\u6709\u8005 UID"}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"uid=1000"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"gid"})}),(0,s.jsx)(e.td,{children:"\u6240\u6709\u8005 GID"}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"gid=1000"})})]})]})]}),"\n",(0,s.jsx)(e.h3,{id:"docker-compose-tmpfs",children:"Docker Compose tmpfs"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:"services:\n  app:\n    image: myapp\n    tmpfs:\n      - /tmp\n      - /run:size=100m,mode=1777\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u7ed1\u5b9a\u6302\u8f7d-vs-\u5377",children:"\u7ed1\u5b9a\u6302\u8f7d vs \u5377"}),"\n",(0,s.jsx)(e.h3,{id:"\u5bf9\u6bd4",children:"\u5bf9\u6bd4"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"\u7279\u6027"}),(0,s.jsx)(e.th,{children:"\u7ed1\u5b9a\u6302\u8f7d (Bind Mount)"}),(0,s.jsx)(e.th,{children:"\u5377 (Volume)"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u4f4d\u7f6e"}),(0,s.jsx)(e.td,{children:"\u4e3b\u673a\u4efb\u610f\u8def\u5f84"}),(0,s.jsx)(e.td,{children:"/var/lib/docker/volumes"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u7ba1\u7406"}),(0,s.jsx)(e.td,{children:"\u624b\u52a8\u7ba1\u7406"}),(0,s.jsx)(e.td,{children:"Docker \u7ba1\u7406"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u5907\u4efd"}),(0,s.jsx)(e.td,{children:"\u76f4\u63a5\u5907\u4efd\u4e3b\u673a\u76ee\u5f55"}),(0,s.jsx)(e.td,{children:"\u9700\u8981\u901a\u8fc7\u5bb9\u5668\u6216 API"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u6027\u80fd"}),(0,s.jsx)(e.td,{children:"\u53d6\u51b3\u4e8e\u4e3b\u673a\u6587\u4ef6\u7cfb\u7edf"}),(0,s.jsx)(e.td,{children:"\u4f18\u5316\u8fc7\u7684\u6027\u80fd"})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:"\u53ef\u79fb\u690d\u6027"}),(0,s.jsx)(e.td,{children:"\u4f9d\u8d56\u4e3b\u673a\u8def\u5f84"}),(0,s.jsx)(e.td,{children:"\u66f4\u597d\u7684\u53ef\u79fb\u690d\u6027"})]})]})]}),"\n",(0,s.jsx)(e.h3,{id:"\u7ed1\u5b9a\u6302\u8f7d",children:"\u7ed1\u5b9a\u6302\u8f7d"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u57fa\u672c\u7ed1\u5b9a\u6302\u8f7d\ndocker run -v /host/path:/container/path nginx\n\n# \u53ea\u8bfb\u6302\u8f7d\ndocker run -v /host/path:/container/path:ro nginx\n\n# \u4f7f\u7528 --mount \u8bed\u6cd5\uff08\u63a8\u8350\uff09\ndocker run --mount type=bind,source=/host/path,target=/container/path nginx\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u547d\u540d\u5377",children:"\u547d\u540d\u5377"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u521b\u5efa\u5377\ndocker volume create mydata\n\n# \u4f7f\u7528\u5377\ndocker run -v mydata:/data nginx\n\n# \u67e5\u770b\u5377\u8be6\u60c5\ndocker volume inspect mydata\n"})}),"\n",(0,s.jsx)(e.h2,{id:"nfs-\u5b58\u50a8",children:"NFS \u5b58\u50a8"}),"\n",(0,s.jsx)(e.h3,{id:"\u521b\u5efa-nfs-\u5377",children:"\u521b\u5efa NFS \u5377"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u521b\u5efa NFS \u5377\ndocker volume create \\\n  --driver local \\\n  --opt type=nfs \\\n  --opt o=addr=192.168.1.100,rw,nfsvers=4 \\\n  --opt device=:/path/to/share \\\n  nfs-data\n\n# \u4f7f\u7528 NFS \u5377\ndocker run -v nfs-data:/data nginx\n"})}),"\n",(0,s.jsx)(e.h3,{id:"docker-compose-nfs",children:"Docker Compose NFS"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'services:\n  app:\n    image: myapp\n    volumes:\n      - nfs-data:/data\n\nvolumes:\n  nfs-data:\n    driver: local\n    driver_opts:\n      type: nfs\n      o: addr=192.168.1.100,rw,nfsvers=4\n      device: ":/path/to/share"\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u5206\u5e03\u5f0f\u5b58\u50a8",children:"\u5206\u5e03\u5f0f\u5b58\u50a8"}),"\n",(0,s.jsx)(e.h3,{id:"ceph-rbd",children:"Ceph RBD"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u5b89\u88c5 Ceph \u5377\u63d2\u4ef6\ndocker plugin install rexray/ceph\n\n# \u521b\u5efa Ceph \u5377\ndocker volume create -d rexray/ceph myvolume\n\n# \u4f7f\u7528\u5377\ndocker run -v myvolume:/data nginx\n"})}),"\n",(0,s.jsx)(e.h3,{id:"glusterfs",children:"GlusterFS"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-yaml",children:'# Docker Compose with GlusterFS\nvolumes:\n  gluster-data:\n    driver: local\n    driver_opts:\n      type: glusterfs\n      o: addr=gluster-server\n      device: ":/gv0"\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u4e91\u5b58\u50a8",children:"\u4e91\u5b58\u50a8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# AWS EBS (\u4f7f\u7528 REX-Ray)\ndocker plugin install rexray/ebs\n\n# Azure Disk\ndocker plugin install rexray/azureud\n\n# Google Cloud Persistent Disk\ndocker plugin install rexray/gcepd\n"})}),"\n",(0,s.jsx)(e.h2,{id:"\u5b58\u50a8\u6027\u80fd\u4f18\u5316",children:"\u5b58\u50a8\u6027\u80fd\u4f18\u5316"}),"\n",(0,s.jsx)(e.h3,{id:"\u9009\u62e9\u5408\u9002\u7684\u5b58\u50a8\u9a71\u52a8",children:"\u9009\u62e9\u5408\u9002\u7684\u5b58\u50a8\u9a71\u52a8"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5\u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b\ndf -T /var/lib/docker\n\n# overlay2 \u63a8\u8350\u4f7f\u7528 xfs \u6216 ext4\n# \u5982\u679c\u4f7f\u7528 xfs\uff0c\u786e\u4fdd\u542f\u7528 d_type\nxfs_info /var/lib/docker | grep ftype\n# ftype=1 \u8868\u793a\u652f\u6301\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u6570\u636e\u76ee\u5f55\u5206\u79bb",children:"\u6570\u636e\u76ee\u5f55\u5206\u79bb"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",children:'// /etc/docker/daemon.json\n{\n  "data-root": "/mnt/docker-data"\n}\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u65e5\u5fd7\u5b58\u50a8\u4f18\u5316",children:"\u65e5\u5fd7\u5b58\u50a8\u4f18\u5316"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-json",children:'{\n  "log-driver": "json-file",\n  "log-opts": {\n    "max-size": "10m",\n    "max-file": "3"\n  }\n}\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u6570\u636e\u5907\u4efd\u4e0e\u6062\u590d",children:"\u6570\u636e\u5907\u4efd\u4e0e\u6062\u590d"}),"\n",(0,s.jsx)(e.h3,{id:"\u5907\u4efd\u5377\u6570\u636e",children:"\u5907\u4efd\u5377\u6570\u636e"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u4f7f\u7528\u4e34\u65f6\u5bb9\u5668\u5907\u4efd\ndocker run --rm \\\n  -v mydata:/data \\\n  -v $(pwd):/backup \\\n  alpine tar czf /backup/mydata-backup.tar.gz -C /data .\n\n# \u6062\u590d\u6570\u636e\ndocker run --rm \\\n  -v mydata:/data \\\n  -v $(pwd):/backup \\\n  alpine tar xzf /backup/mydata-backup.tar.gz -C /data\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u5907\u4efd\u5bb9\u5668",children:"\u5907\u4efd\u5bb9\u5668"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u5bfc\u51fa\u5bb9\u5668\u6587\u4ef6\u7cfb\u7edf\ndocker export container > container-backup.tar\n\n# \u5bfc\u5165\u4e3a\u955c\u50cf\ndocker import container-backup.tar myimage:backup\n"})}),"\n",(0,s.jsx)(e.h3,{id:"\u8fc1\u79fb\u5377\u5230\u65b0\u4e3b\u673a",children:"\u8fc1\u79fb\u5377\u5230\u65b0\u4e3b\u673a"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-bash",children:"# \u6e90\u4e3b\u673a\uff1a\u5bfc\u51fa\u5377\ndocker run --rm -v mydata:/data -v /tmp:/backup alpine \\\n  tar czf /backup/mydata.tar.gz -C /data .\n\n# \u4f20\u8f93\u6587\u4ef6\nscp /tmp/mydata.tar.gz user@newhost:/tmp/\n\n# \u76ee\u6807\u4e3b\u673a\uff1a\u521b\u5efa\u5377\u5e76\u5bfc\u5165\ndocker volume create mydata\ndocker run --rm -v mydata:/data -v /tmp:/backup alpine \\\n  tar xzf /backup/mydata.tar.gz -C /data\n"})})]})}function o(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(h,{...n})}):h(n)}},48885:(n,e,r)=>{r.d(e,{R:()=>i,x:()=>c});var d=r(99378);const s={},l=d.createContext(s);function i(n){const e=d.useContext(l);return d.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:i(n.components),d.createElement(l.Provider,{value:e},n.children)}}}]);