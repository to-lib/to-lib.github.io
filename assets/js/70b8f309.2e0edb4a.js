"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[6472],{1266:(e,n,l)=>{l.d(n,{R:()=>r,x:()=>s});var t=l(9378);const d={},i=t.createContext(d);function r(e){const n=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:r(e.components),t.createElement(i.Provider,{value:n},e.children)}},8343:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>o,frontMatter:()=>r,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"netty/quick-reference","title":"\u5feb\u901f\u53c2\u8003","description":"\u6838\u5fc3 API \u901f\u67e5\u8868","source":"@site/docs/netty/quick-reference.md","sourceDirName":"netty","slug":"/netty/quick-reference","permalink":"/docs/netty/quick-reference","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/netty/quick-reference.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"docs","previous":{"title":"\u5e38\u89c1\u95ee\u9898\u4e0e\u6392\u67e5","permalink":"/docs/netty/troubleshooting"}}');var d=l(2714),i=l(1266);const r={sidebar_position:9},s="\u5feb\u901f\u53c2\u8003",c={},a=[{value:"\u6838\u5fc3 API \u901f\u67e5\u8868",id:"\u6838\u5fc3-api-\u901f\u67e5\u8868",level:2},{value:"\u670d\u52a1\u5668\u542f\u52a8\u6a21\u677f",id:"\u670d\u52a1\u5668\u542f\u52a8\u6a21\u677f",level:3},{value:"\u5ba2\u6237\u7aef\u8fde\u63a5\u6a21\u677f",id:"\u5ba2\u6237\u7aef\u8fde\u63a5\u6a21\u677f",level:3},{value:"Handler \u5e38\u7528\u65b9\u6cd5",id:"handler-\u5e38\u7528\u65b9\u6cd5",level:2},{value:"Inbound \u4e8b\u4ef6\uff08\u8bfb\u53d6\u6570\u636e\uff09",id:"inbound-\u4e8b\u4ef6\u8bfb\u53d6\u6570\u636e",level:3},{value:"Outbound \u4e8b\u4ef6\uff08\u5199\u5165\u6570\u636e\uff09",id:"outbound-\u4e8b\u4ef6\u5199\u5165\u6570\u636e",level:3},{value:"ByteBuf \u5e38\u7528\u64cd\u4f5c",id:"bytebuf-\u5e38\u7528\u64cd\u4f5c",level:2},{value:"\u521b\u5efa ByteBuf",id:"\u521b\u5efa-bytebuf",level:3},{value:"\u8bfb\u5199 ByteBuf",id:"\u8bfb\u5199-bytebuf",level:3},{value:"\u91ca\u653e ByteBuf",id:"\u91ca\u653e-bytebuf",level:3},{value:"\u5e38\u7528\u7f16\u89e3\u7801\u5668",id:"\u5e38\u7528\u7f16\u89e3\u7801\u5668",level:2},{value:"Channel \u5e38\u7528\u64cd\u4f5c",id:"channel-\u5e38\u7528\u64cd\u4f5c",level:2},{value:"Pipeline \u64cd\u4f5c",id:"pipeline-\u64cd\u4f5c",level:2},{value:"ChannelOption \u5e38\u7528\u914d\u7f6e",id:"channeloption-\u5e38\u7528\u914d\u7f6e",level:2},{value:"\u5f02\u6b65\u64cd\u4f5c",id:"\u5f02\u6b65\u64cd\u4f5c",level:2},{value:"\u4efb\u52a1\u8c03\u5ea6",id:"\u4efb\u52a1\u8c03\u5ea6",level:2},{value:"\u5f02\u5e38\u5904\u7406",id:"\u5f02\u5e38\u5904\u7406",level:2},{value:"\u5e38\u7528\u5de5\u5177\u7c7b",id:"\u5e38\u7528\u5de5\u5177\u7c7b",level:2},{value:"\u6027\u80fd\u76f8\u5173\u53c2\u6570",id:"\u6027\u80fd\u76f8\u5173\u53c2\u6570",level:2},{value:"JVM \u53c2\u6570",id:"jvm-\u53c2\u6570",level:3},{value:"\u7cfb\u7edf\u53c2\u6570\uff08Linux\uff09",id:"\u7cfb\u7edf\u53c2\u6570linux",level:3},{value:"\u5feb\u901f\u8bca\u65ad",id:"\u5feb\u901f\u8bca\u65ad",level:2},{value:"\u68c0\u67e5\u6e05\u5355",id:"\u68c0\u67e5\u6e05\u5355",level:3},{value:"\u5e38\u89c1\u9519\u8bef",id:"\u5e38\u89c1\u9519\u8bef",level:3},{value:"\u5b66\u4e60\u8d44\u6e90",id:"\u5b66\u4e60\u8d44\u6e90",level:2},{value:"\u5b98\u65b9\u8d44\u6e90",id:"\u5b98\u65b9\u8d44\u6e90",level:3},{value:"\u63a8\u8350\u4e66\u7c4d",id:"\u63a8\u8350\u4e66\u7c4d",level:3},{value:"\u5e38\u7528\u4f9d\u8d56\u7248\u672c",id:"\u5e38\u7528\u4f9d\u8d56\u7248\u672c",level:3},{value:"Maven POM \u914d\u7f6e\u793a\u4f8b",id:"maven-pom-\u914d\u7f6e\u793a\u4f8b",level:2},{value:"\u4e00\u884c\u4ee3\u7801\u53c2\u8003",id:"\u4e00\u884c\u4ee3\u7801\u53c2\u8003",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"\u5feb\u901f\u53c2\u8003",children:"\u5feb\u901f\u53c2\u8003"})}),"\n",(0,d.jsx)(n.h2,{id:"\u6838\u5fc3-api-\u901f\u67e5\u8868",children:"\u6838\u5fc3 API \u901f\u67e5\u8868"}),"\n",(0,d.jsx)(n.h3,{id:"\u670d\u52a1\u5668\u542f\u52a8\u6a21\u677f",children:"\u670d\u52a1\u5668\u542f\u52a8\u6a21\u677f"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:"EventLoopGroup bossGroup = new NioEventLoopGroup(1);\nEventLoopGroup workerGroup = new NioEventLoopGroup();\n\ntry {\n    ServerBootstrap bootstrap = new ServerBootstrap();\n    bootstrap.group(bossGroup, workerGroup)\n        .channel(NioServerSocketChannel.class)\n        .option(ChannelOption.SO_BACKLOG, 128)\n        .childOption(ChannelOption.SO_KEEPALIVE, true)\n        .childHandler(new ChannelInitializer<SocketChannel>() {\n            @Override\n            protected void initChannel(SocketChannel ch) {\n                ch.pipeline()\n                    .addLast(new StringDecoder(CharsetUtil.UTF_8))\n                    .addLast(new StringEncoder(CharsetUtil.UTF_8))\n                    .addLast(new MyHandler());\n            }\n        });\n\n    ChannelFuture future = bootstrap.bind(port).sync();\n    future.channel().closeFuture().sync();\n} finally {\n    bossGroup.shutdownGracefully();\n    workerGroup.shutdownGracefully();\n}\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u5ba2\u6237\u7aef\u8fde\u63a5\u6a21\u677f",children:"\u5ba2\u6237\u7aef\u8fde\u63a5\u6a21\u677f"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:"EventLoopGroup group = new NioEventLoopGroup();\n\ntry {\n    Bootstrap bootstrap = new Bootstrap();\n    bootstrap.group(group)\n        .channel(NioSocketChannel.class)\n        .option(ChannelOption.TCP_NODELAY, true)\n        .handler(new ChannelInitializer<SocketChannel>() {\n            @Override\n            protected void initChannel(SocketChannel ch) {\n                ch.pipeline()\n                    .addLast(new StringDecoder(CharsetUtil.UTF_8))\n                    .addLast(new StringEncoder(CharsetUtil.UTF_8))\n                    .addLast(new MyHandler());\n            }\n        });\n\n    ChannelFuture future = bootstrap.connect(host, port).sync();\n    future.channel().closeFuture().sync();\n} finally {\n    group.shutdownGracefully();\n}\n"})}),"\n",(0,d.jsx)(n.h2,{id:"handler-\u5e38\u7528\u65b9\u6cd5",children:"Handler \u5e38\u7528\u65b9\u6cd5"}),"\n",(0,d.jsx)(n.h3,{id:"inbound-\u4e8b\u4ef6\u8bfb\u53d6\u6570\u636e",children:"Inbound \u4e8b\u4ef6\uff08\u8bfb\u53d6\u6570\u636e\uff09"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u65b9\u6cd5"}),(0,d.jsx)(n.th,{children:"\u89e6\u53d1\u65f6\u673a"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"channelRegistered"})}),(0,d.jsx)(n.td,{children:"Channel \u6ce8\u518c\u5230 EventLoop"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"channelActive"})}),(0,d.jsx)(n.td,{children:"Channel \u8fde\u63a5\u5efa\u7acb"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"channelRead"})}),(0,d.jsx)(n.td,{children:"\u6536\u5230\u6570\u636e"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"channelReadComplete"})}),(0,d.jsx)(n.td,{children:"\u4e00\u6b21\u8bfb\u5b8c\u6210"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"userEventTriggered"})}),(0,d.jsx)(n.td,{children:"\u7528\u6237\u4e8b\u4ef6"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"channelInactive"})}),(0,d.jsx)(n.td,{children:"Channel \u8fde\u63a5\u5173\u95ed"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"exceptionCaught"})}),(0,d.jsx)(n.td,{children:"\u5f02\u5e38\u53d1\u751f"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"outbound-\u4e8b\u4ef6\u5199\u5165\u6570\u636e",children:"Outbound \u4e8b\u4ef6\uff08\u5199\u5165\u6570\u636e\uff09"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u65b9\u6cd5"}),(0,d.jsx)(n.th,{children:"\u4f5c\u7528"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"bind"})}),(0,d.jsx)(n.td,{children:"\u7ed1\u5b9a\u7aef\u53e3"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"connect"})}),(0,d.jsx)(n.td,{children:"\u8fde\u63a5\u670d\u52a1\u5668"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"write"})}),(0,d.jsx)(n.td,{children:"\u5199\u5165\u6570\u636e"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"flush"})}),(0,d.jsx)(n.td,{children:"\u5237\u65b0\u7f13\u51b2"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"close"})}),(0,d.jsx)(n.td,{children:"\u5173\u95ed\u8fde\u63a5"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"bytebuf-\u5e38\u7528\u64cd\u4f5c",children:"ByteBuf \u5e38\u7528\u64cd\u4f5c"}),"\n",(0,d.jsx)(n.h3,{id:"\u521b\u5efa-bytebuf",children:"\u521b\u5efa ByteBuf"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:'// \u5806\u5185\u5b58\nByteBuf buf = Unpooled.buffer(1024);\n\n// \u76f4\u63a5\u5185\u5b58\nByteBuf directBuf = Unpooled.directBuffer(1024);\n\n// \u4ece\u6570\u636e\u521b\u5efa\nByteBuf copy = Unpooled.copiedBuffer("Hello", CharsetUtil.UTF_8);\n'})}),"\n",(0,d.jsx)(n.h3,{id:"\u8bfb\u5199-bytebuf",children:"\u8bfb\u5199 ByteBuf"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:"// \u5199\u5165\nbuf.writeInt(123);\nbuf.writeByte(45);\nbuf.writeBytes(new byte[]{1, 2, 3});\n\n// \u8bfb\u53d6\nint value = buf.readInt();\nbyte b = buf.readByte();\n\n// \u83b7\u53d6\uff08\u4e0d\u79fb\u52a8\u6307\u9488\uff09\nint val = buf.getInt(0);\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u91ca\u653e-bytebuf",children:"\u91ca\u653e ByteBuf"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:"// \u65b9\u5f0f1\uff1a\u76f4\u63a5\u91ca\u653e\nbuf.release();\n\n// \u65b9\u5f0f2\uff1a\u5b89\u5168\u91ca\u653e\nReferenceCountUtil.release(msg);\n\n// \u65b9\u5f0f3\uff1aSimpleChannelInboundHandler \u81ea\u52a8\u91ca\u653e\npublic class MyHandler extends SimpleChannelInboundHandler<ByteBuf> {\n    protected void channelRead0(ChannelHandlerContext ctx, ByteBuf msg) {\n        // msg \u81ea\u52a8\u91ca\u653e\n    }\n}\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u5e38\u7528\u7f16\u89e3\u7801\u5668",children:"\u5e38\u7528\u7f16\u89e3\u7801\u5668"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:"// \u5b57\u7b26\u4e32\npipeline.addLast(new StringDecoder(CharsetUtil.UTF_8));\npipeline.addLast(new StringEncoder(CharsetUtil.UTF_8));\n\n// \u6309\u884c\u5206\u5272\npipeline.addLast(new LineBasedFrameDecoder(1024));\n\n// \u957f\u5ea6\u5b57\u6bb5\npipeline.addLast(\n    new LengthFieldBasedFrameDecoder(65535, 0, 4, 0, 4)\n);\n\n// \u7a7a\u95f2\u68c0\u6d4b\npipeline.addLast(new IdleStateHandler(60, 30, 0, TimeUnit.SECONDS));\n\n// \u65e5\u5fd7\npipeline.addLast(new LoggingHandler(LogLevel.DEBUG));\n"})}),"\n",(0,d.jsx)(n.h2,{id:"channel-\u5e38\u7528\u64cd\u4f5c",children:"Channel \u5e38\u7528\u64cd\u4f5c"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:'// \u5199\u5165\u6570\u636e\nChannelFuture future = ctx.writeAndFlush(msg);\n\n// \u83b7\u53d6\u8fde\u63a5\u4fe1\u606f\nInetSocketAddress remote = (InetSocketAddress) channel.remoteAddress();\nInetSocketAddress local = (InetSocketAddress) channel.localAddress();\n\n// \u68c0\u67e5\u72b6\u6001\nchannel.isActive();\nchannel.isOpen();\nchannel.isWritable();\n\n// \u5173\u95ed\u8fde\u63a5\nchannel.close();\n\n// \u5c5e\u6027\u5b58\u50a8\nchannel.attr(AttributeKey.valueOf("key")).set(value);\n'})}),"\n",(0,d.jsx)(n.h2,{id:"pipeline-\u64cd\u4f5c",children:"Pipeline \u64cd\u4f5c"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:'// \u6dfb\u52a0 Handler\npipeline.addLast("name", new MyHandler());\npipeline.addFirst(new MyHandler());\npipeline.addBefore("name", new MyHandler());\npipeline.addAfter("name", new MyHandler());\n\n// \u83b7\u53d6 Handler\nMyHandler handler = pipeline.get(MyHandler.class);\nChannelHandler handler2 = pipeline.get("name");\n\n// \u79fb\u9664 Handler\npipeline.remove("name");\npipeline.removeFirst();\npipeline.removeLast();\n\n// \u66ff\u6362 Handler\npipeline.replace("old", "new", new NewHandler());\n'})}),"\n",(0,d.jsx)(n.h2,{id:"channeloption-\u5e38\u7528\u914d\u7f6e",children:"ChannelOption \u5e38\u7528\u914d\u7f6e"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u9009\u9879"}),(0,d.jsx)(n.th,{children:"\u8bf4\u660e"}),(0,d.jsx)(n.th,{children:"\u63a8\u8350\u503c"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"SO_BACKLOG"})}),(0,d.jsx)(n.td,{children:"TCP backlog \u5927\u5c0f"}),(0,d.jsx)(n.td,{children:"128-2048"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"SO_KEEPALIVE"})}),(0,d.jsx)(n.td,{children:"\u4fdd\u6d3b\u63a2\u9488"}),(0,d.jsx)(n.td,{children:"true"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"TCP_NODELAY"})}),(0,d.jsx)(n.td,{children:"\u5173\u95ed Nagle \u7b97\u6cd5"}),(0,d.jsx)(n.td,{children:"true"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"SO_SNDBUF"})}),(0,d.jsx)(n.td,{children:"\u53d1\u9001\u7f13\u51b2\u5927\u5c0f"}),(0,d.jsx)(n.td,{children:"256KB"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"SO_RCVBUF"})}),(0,d.jsx)(n.td,{children:"\u63a5\u6536\u7f13\u51b2\u5927\u5c0f"}),(0,d.jsx)(n.td,{children:"256KB"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ALLOCATOR"})}),(0,d.jsx)(n.td,{children:"ByteBuf \u5206\u914d\u5668"}),(0,d.jsx)(n.td,{children:"PooledByteBufAllocator"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"WRITE_BUFFER_WATER_MARK"})}),(0,d.jsx)(n.td,{children:"\u5199\u7f13\u51b2\u6c34\u4f4d\u7ebf"}),(0,d.jsx)(n.td,{children:"32KB-1MB"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u5f02\u6b65\u64cd\u4f5c",children:"\u5f02\u6b65\u64cd\u4f5c"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:'// \u5199\u5165\u5e76\u76d1\u542c\u7ed3\u679c\nChannelFuture future = ctx.writeAndFlush(msg);\nfuture.addListener(f -> {\n    if (f.isSuccess()) {\n        System.out.println("\u5199\u5165\u6210\u529f");\n    } else {\n        System.out.println("\u5199\u5165\u5931\u8d25: " + f.cause());\n    }\n});\n\n// \u5f02\u6b65\u7b49\u5f85\uff08\u963b\u585e\uff09\ntry {\n    future.sync();\n} catch (InterruptedException e) {\n    e.printStackTrace();\n}\n\n// \u68c0\u67e5\u5b8c\u6210\u72b6\u6001\nif (future.isDone()) {\n    if (future.isSuccess()) {\n        // \u6210\u529f\n    }\n}\n'})}),"\n",(0,d.jsx)(n.h2,{id:"\u4efb\u52a1\u8c03\u5ea6",children:"\u4efb\u52a1\u8c03\u5ea6"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:'// \u4e00\u6b21\u6027\u5ef6\u8fdf\u4efb\u52a1\nctx.executor().schedule(() -> {\n    System.out.println("\u5ef6\u8fdf\u6267\u884c");\n}, 1, TimeUnit.SECONDS);\n\n// \u5468\u671f\u6027\u4efb\u52a1\nctx.executor().scheduleAtFixedRate(() -> {\n    System.out.println("\u5b9a\u65f6\u6267\u884c");\n}, 1, 1, TimeUnit.SECONDS);\n\n// \u5f02\u6b65\u6267\u884c\nctx.executor().execute(() -> {\n    System.out.println("\u5f02\u6b65\u6267\u884c");\n});\n'})}),"\n",(0,d.jsx)(n.h2,{id:"\u5f02\u5e38\u5904\u7406",children:"\u5f02\u5e38\u5904\u7406"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:'@Override\npublic void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {\n    // \u8bb0\u5f55\u5f02\u5e38\n    // logger.error("\u5f02\u5e38: ", cause);\n    cause.printStackTrace();\n    \n    // \u5173\u95ed\u8fde\u63a5\n    ctx.close();\n}\n'})}),"\n",(0,d.jsx)(n.h2,{id:"\u5e38\u7528\u5de5\u5177\u7c7b",children:"\u5e38\u7528\u5de5\u5177\u7c7b"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:"// ByteBuf \u5de5\u5177\nByteBufUtil.hexDump(buf);           // 16 \u8fdb\u5236\u8f93\u51fa\nByteBufUtil.appendPrettyHexDump(sb, buf); // \u683c\u5f0f\u5316\u8f93\u51fa\n\n// \u5f15\u7528\u8ba1\u6570\u5de5\u5177\nReferenceCountUtil.release(msg);    // \u5b89\u5168\u91ca\u653e\nReferenceCountUtil.retain(msg);     // \u589e\u52a0\u5f15\u7528\u8ba1\u6570\n\n// \u5b57\u7b26\u96c6\nCharsetUtil.UTF_8;\nCharsetUtil.US_ASCII;\nCharsetUtil.ISO_8859_1;\n\n// \u7f13\u51b2\u5206\u914d\u5668\nPooledByteBufAllocator.DEFAULT;\nUnpooledByteBufAllocator.DEFAULT;\n\n// Promise\nChannelPromise promise = ctx.newPromise();\npromise.setSuccess();\npromise.setFailure(cause);\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u6027\u80fd\u76f8\u5173\u53c2\u6570",children:"\u6027\u80fd\u76f8\u5173\u53c2\u6570"}),"\n",(0,d.jsx)(n.h3,{id:"jvm-\u53c2\u6570",children:"JVM \u53c2\u6570"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# \u76f4\u63a5\u5185\u5b58\u5927\u5c0f\n-XX:MaxDirectMemorySize=2G\n\n# \u5806\u5927\u5c0f\n-Xms2G -Xmx2G\n\n# GC \u4f18\u5316\n-XX:+UseG1GC -XX:MaxGCPauseMillis=50\n\n# \u7981\u7528\u504f\u5411\u9501\uff08\u9ad8\u5e76\u53d1\u4e0b\uff09\n-XX:-UseBiasedLocking\n"})}),"\n",(0,d.jsx)(n.h3,{id:"\u7cfb\u7edf\u53c2\u6570linux",children:"\u7cfb\u7edf\u53c2\u6570\uff08Linux\uff09"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# \u589e\u52a0\u7cfb\u7edf\u6700\u5927\u6587\u4ef6\u63cf\u8ff0\u7b26\nulimit -n 100000\n\n# TCP \u53c2\u6570\u8c03\u4f18\nsysctl -w net.core.somaxconn=65535\nsysctl -w net.ipv4.tcp_max_syn_backlog=65535\nsysctl -w net.ipv4.tcp_tw_reuse=1\nsysctl -w net.ipv4.tcp_fin_timeout=30\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u5feb\u901f\u8bca\u65ad",children:"\u5feb\u901f\u8bca\u65ad"}),"\n",(0,d.jsx)(n.h3,{id:"\u68c0\u67e5\u6e05\u5355",children:"\u68c0\u67e5\u6e05\u5355"}),"\n",(0,d.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u662f\u5426\u6b63\u786e\u91ca\u653e\u4e86 ByteBuf\uff1f"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u662f\u5426\u5728 EventLoop \u4e2d\u6267\u884c\u4e86\u963b\u585e\u64cd\u4f5c\uff1f"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u662f\u5426\u6b63\u786e\u4f20\u64ad\u4e86\u4e8b\u4ef6\uff1f"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u662f\u5426\u5904\u7406\u4e86\u5f02\u5e38\uff1f"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u662f\u5426\u914d\u7f6e\u4e86\u5408\u7406\u7684\u7ebf\u7a0b\u6c60\u5927\u5c0f\uff1f"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u662f\u5426\u8bbe\u7f6e\u4e86\u8fde\u63a5\u8d85\u65f6\uff1f"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u662f\u5426\u76d1\u63a7\u4e86\u5185\u5b58\u4f7f\u7528\uff1f"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","\u662f\u5426\u6709\u5185\u5b58\u6cc4\u6f0f\u68c0\u6d4b\uff1f"]}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u5e38\u89c1\u9519\u8bef",children:"\u5e38\u89c1\u9519\u8bef"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"\u9519\u8bef"}),(0,d.jsx)(n.th,{children:"\u539f\u56e0"}),(0,d.jsx)(n.th,{children:"\u89e3\u51b3\u65b9\u6848"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"LeakDetectedException"})}),(0,d.jsx)(n.td,{children:"\u5185\u5b58\u6cc4\u6f0f"}),(0,d.jsx)(n.td,{children:"\u68c0\u67e5 ByteBuf \u91ca\u653e"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"RejectedExecutionException"})}),(0,d.jsx)(n.td,{children:"\u7ebf\u7a0b\u6c60\u6ee1"}),(0,d.jsx)(n.td,{children:"\u589e\u52a0\u7ebf\u7a0b\u6c60\u5927\u5c0f"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"OutOfMemoryError"})}),(0,d.jsx)(n.td,{children:"\u5185\u5b58\u6ea2\u51fa"}),(0,d.jsx)(n.td,{children:"\u91ca\u653e\u8d44\u6e90\u3001\u589e\u52a0\u5806\u5927\u5c0f"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ClosedChannelException"})}),(0,d.jsx)(n.td,{children:"Channel \u5df2\u5173\u95ed"}),(0,d.jsx)(n.td,{children:"\u68c0\u67e5\u8fde\u63a5\u72b6\u6001"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.code,{children:"ConnectException"})}),(0,d.jsx)(n.td,{children:"\u8fde\u63a5\u5931\u8d25"}),(0,d.jsx)(n.td,{children:"\u68c0\u67e5\u670d\u52a1\u5668\u5730\u5740\u3001\u9632\u706b\u5899"})]})]})]}),"\n",(0,d.jsx)(n.h2,{id:"\u5b66\u4e60\u8d44\u6e90",children:"\u5b66\u4e60\u8d44\u6e90"}),"\n",(0,d.jsx)(n.h3,{id:"\u5b98\u65b9\u8d44\u6e90",children:"\u5b98\u65b9\u8d44\u6e90"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://netty.io/",children:"Netty \u5b98\u7f51"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://netty.io/4.1/api/",children:"API \u6587\u6863"})}),"\n",(0,d.jsx)(n.li,{children:(0,d.jsx)(n.a,{href:"https://github.com/netty/netty",children:"GitHub"})}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u63a8\u8350\u4e66\u7c4d",children:"\u63a8\u8350\u4e66\u7c4d"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"\u300aNetty in Action\u300b"}),"\n",(0,d.jsx)(n.li,{children:"\u300aNetty \u6743\u5a01\u6307\u5357\u300b"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"\u5e38\u7528\u4f9d\u8d56\u7248\u672c",children:"\u5e38\u7528\u4f9d\u8d56\u7248\u672c"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-xml",children:"\x3c!-- \u6700\u65b0\u7a33\u5b9a\u7248 --\x3e\n<dependency>\n    <groupId>io.netty</groupId>\n    <artifactId>netty-all</artifactId>\n    <version>4.1.100.Final</version>\n</dependency>\n\n\x3c!-- \u957f\u671f\u652f\u6301\u7248 --\x3e\n\x3c!-- 4.1.x \u7cfb\u5217\uff0c\u652f\u6301 JDK 8+ --\x3e\n\n\x3c!-- \u6700\u65b0\u5f00\u53d1\u7248 --\x3e\n\x3c!-- 5.0.x \u7cfb\u5217\uff08\u9884\u53d1\u5e03\uff09\uff0c\u9700\u8981 JDK 11+ --\x3e\n"})}),"\n",(0,d.jsx)(n.h2,{id:"maven-pom-\u914d\u7f6e\u793a\u4f8b",children:"Maven POM \u914d\u7f6e\u793a\u4f8b"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>io.netty</groupId>\n    <artifactId>netty-all</artifactId>\n    <version>4.1.100.Final</version>\n</dependency>\n\n\x3c!-- \u65e5\u5fd7 --\x3e\n<dependency>\n    <groupId>org.slf4j</groupId>\n    <artifactId>slf4j-api</artifactId>\n    <version>1.7.36</version>\n</dependency>\n\n\x3c!-- \u65e5\u5fd7\u5b9e\u73b0 --\x3e\n<dependency>\n    <groupId>ch.qos.logback</groupId>\n    <artifactId>logback-classic</artifactId>\n    <version>1.4.1</version>\n</dependency>\n"})}),"\n",(0,d.jsx)(n.h2,{id:"\u4e00\u884c\u4ee3\u7801\u53c2\u8003",children:"\u4e00\u884c\u4ee3\u7801\u53c2\u8003"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-java",children:'// \u542f\u7528\u5185\u5b58\u6cc4\u6f0f\u68c0\u6d4b\nSystem.setProperty("io.netty.leakDetection.level", "PARANOID");\n\n// \u5173\u95ed Nagle \u7b97\u6cd5\nbootstrap.childOption(ChannelOption.TCP_NODELAY, true);\n\n// \u4f7f\u7528\u6c60\u5316\u5206\u914d\u5668\nbootstrap.childOption(ChannelOption.ALLOCATOR, PooledByteBufAllocator.DEFAULT);\n\n// \u8bbe\u7f6e\u5fc3\u8df3\npipeline.addLast(new IdleStateHandler(60, 30, 0, TimeUnit.SECONDS));\n\n// \u9650\u5236\u6d88\u606f\u5927\u5c0f\npipeline.addLast(new LengthFieldBasedFrameDecoder(1024*1024, 0, 4, 0, 4));\n\n// \u8bb0\u5f55\u65e5\u5fd7\npipeline.addLast(new LoggingHandler(LogLevel.DEBUG));\n\n// \u5b89\u5168\u91ca\u653e\nReferenceCountUtil.release(msg);\n'})})]})}function o(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(h,{...e})}):h(e)}}}]);