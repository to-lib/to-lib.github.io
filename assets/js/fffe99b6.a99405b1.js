"use strict";(globalThis.webpackChunkto_lib_github_io=globalThis.webpackChunkto_lib_github_io||[]).push([[53702],{48885:(n,e,t)=>{t.d(e,{R:()=>l,x:()=>o});var r=t(99378);const i={},s=r.createContext(i);function l(n){const e=r.useContext(s);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),r.createElement(s.Provider,{value:e},n.children)}},85674:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"ml/uncertainty-quantification","title":"\ud83d\udcd0 \u4e0d\u786e\u5b9a\u6027\u91cf\u5316","description":"\u4e0d\u786e\u5b9a\u6027\u91cf\u5316\u4f30\u8ba1\u6a21\u578b\u9884\u6d4b\u7684\u7f6e\u4fe1\u5ea6\uff0c\u5bf9\u4e8e\u5b89\u5168\u5173\u952e\u5e94\u7528\u81f3\u5173\u91cd\u8981\u3002","source":"@site/docs/ml/uncertainty-quantification.md","sourceDirName":"ml","slug":"/ml/uncertainty-quantification","permalink":"/docs/ml/uncertainty-quantification","draft":false,"unlisted":false,"editUrl":"https://github.com/to-lib/to-lib.github.io/tree/main/docs/ml/uncertainty-quantification.md","tags":[],"version":"current","sidebarPosition":37,"frontMatter":{"sidebar_position":37,"title":"\ud83d\udcd0 \u4e0d\u786e\u5b9a\u6027\u91cf\u5316"},"sidebar":"ml","previous":{"title":"\ud83d\udee1\ufe0f \u5bf9\u6297\u9c81\u68d2\u6027","permalink":"/docs/ml/adversarial-robustness"},"next":{"title":"\ud83d\udd0d \u5f02\u5e38\u68c0\u6d4b\u8be6\u89e3","permalink":"/docs/ml/anomaly-detection"}}');var i=t(22714),s=t(48885);const l={sidebar_position:37,title:"\ud83d\udcd0 \u4e0d\u786e\u5b9a\u6027\u91cf\u5316"},o="\u4e0d\u786e\u5b9a\u6027\u91cf\u5316",d={},a=[{value:"\u4e0d\u786e\u5b9a\u6027\u7c7b\u578b",id:"\u4e0d\u786e\u5b9a\u6027\u7c7b\u578b",level:2},{value:"\u65b9\u6cd5\u6982\u89c8",id:"\u65b9\u6cd5\u6982\u89c8",level:2},{value:"MC Dropout",id:"mc-dropout",level:3},{value:"Deep Ensemble",id:"deep-ensemble",level:3},{value:"\u8d1d\u53f6\u65af\u795e\u7ecf\u7f51\u7edc",id:"\u8d1d\u53f6\u65af\u795e\u7ecf\u7f51\u7edc",level:3},{value:"\u6e29\u5ea6\u7f29\u653e (Calibration)",id:"\u6e29\u5ea6\u7f29\u653e-calibration",level:3},{value:"\u8bc4\u4f30\u6307\u6807",id:"\u8bc4\u4f30\u6307\u6807",level:2},{value:"\u5e94\u7528\u573a\u666f",id:"\u5e94\u7528\u573a\u666f",level:2}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"\u4e0d\u786e\u5b9a\u6027\u91cf\u5316",children:"\u4e0d\u786e\u5b9a\u6027\u91cf\u5316"})}),"\n",(0,i.jsx)(e.p,{children:"\u4e0d\u786e\u5b9a\u6027\u91cf\u5316\u4f30\u8ba1\u6a21\u578b\u9884\u6d4b\u7684\u7f6e\u4fe1\u5ea6\uff0c\u5bf9\u4e8e\u5b89\u5168\u5173\u952e\u5e94\u7528\u81f3\u5173\u91cd\u8981\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u4e0d\u786e\u5b9a\u6027\u7c7b\u578b",children:"\u4e0d\u786e\u5b9a\u6027\u7c7b\u578b"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,i.jsx)(e.th,{children:"\u63cf\u8ff0"}),(0,i.jsx)(e.th,{children:"\u6765\u6e90"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u8ba4\u77e5\u4e0d\u786e\u5b9a\u6027 (Epistemic)"}),(0,i.jsx)(e.td,{children:"\u6a21\u578b\u4e0d\u786e\u5b9a\u6027"}),(0,i.jsx)(e.td,{children:"\u6570\u636e\u4e0d\u8db3\u3001\u6a21\u578b\u5c40\u9650"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5076\u7136\u4e0d\u786e\u5b9a\u6027 (Aleatoric)"}),(0,i.jsx)(e.td,{children:"\u6570\u636e\u56fa\u6709\u566a\u58f0"}),(0,i.jsx)(e.td,{children:"\u65e0\u6cd5\u6d88\u9664"})]})]})]}),"\n",(0,i.jsx)(e.h2,{id:"\u65b9\u6cd5\u6982\u89c8",children:"\u65b9\u6cd5\u6982\u89c8"}),"\n",(0,i.jsx)(e.h3,{id:"mc-dropout",children:"MC Dropout"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"import torch\nimport torch.nn as nn\n\nclass MCDropoutModel(nn.Module):\n    def __init__(self, model, dropout_rate=0.1):\n        super().__init__()\n        self.model = model\n        self.dropout = nn.Dropout(dropout_rate)\n\n    def forward(self, x, n_samples=100):\n        self.train()  # \u4fdd\u6301 dropout \u5f00\u542f\n        predictions = []\n\n        for _ in range(n_samples):\n            pred = self.model(self.dropout(x))\n            predictions.append(pred)\n\n        predictions = torch.stack(predictions)\n        mean = predictions.mean(dim=0)\n        std = predictions.std(dim=0)  # \u4e0d\u786e\u5b9a\u6027\n\n        return mean, std\n"})}),"\n",(0,i.jsx)(e.h3,{id:"deep-ensemble",children:"Deep Ensemble"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"class DeepEnsemble:\n    def __init__(self, model_class, n_models=5):\n        self.models = [model_class() for _ in range(n_models)]\n\n    def fit(self, X, y):\n        for model in self.models:\n            # \u6bcf\u4e2a\u6a21\u578b\u7528\u4e0d\u540c\u968f\u673a\u79cd\u5b50\u8bad\u7ec3\n            model.fit(X, y)\n\n    def predict(self, X):\n        predictions = [model.predict(X) for model in self.models]\n        predictions = np.stack(predictions)\n\n        mean = predictions.mean(axis=0)\n        std = predictions.std(axis=0)\n\n        return mean, std\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u8d1d\u53f6\u65af\u795e\u7ecf\u7f51\u7edc",children:"\u8d1d\u53f6\u65af\u795e\u7ecf\u7f51\u7edc"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"import torch.nn as nn\nimport torch.nn.functional as F\n\nclass BayesianLinear(nn.Module):\n    def __init__(self, in_features, out_features):\n        super().__init__()\n        self.weight_mu = nn.Parameter(torch.randn(out_features, in_features) * 0.1)\n        self.weight_rho = nn.Parameter(torch.randn(out_features, in_features) - 3)\n        self.bias_mu = nn.Parameter(torch.zeros(out_features))\n        self.bias_rho = nn.Parameter(torch.ones(out_features) * -3)\n\n    def forward(self, x):\n        weight_sigma = F.softplus(self.weight_rho)\n        bias_sigma = F.softplus(self.bias_rho)\n\n        weight = self.weight_mu + weight_sigma * torch.randn_like(weight_sigma)\n        bias = self.bias_mu + bias_sigma * torch.randn_like(bias_sigma)\n\n        return F.linear(x, weight, bias)\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u6e29\u5ea6\u7f29\u653e-calibration",children:"\u6e29\u5ea6\u7f29\u653e (Calibration)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"class TemperatureScaling:\n    def __init__(self, model):\n        self.model = model\n        self.temperature = nn.Parameter(torch.ones(1))\n\n    def calibrate(self, val_loader):\n        optimizer = torch.optim.LBFGS([self.temperature], lr=0.01)\n\n        def eval():\n            loss = 0\n            for x, y in val_loader:\n                logits = self.model(x) / self.temperature\n                loss += nn.functional.cross_entropy(logits, y)\n            return loss\n\n        optimizer.step(eval)\n\n    def predict(self, x):\n        logits = self.model(x) / self.temperature\n        return torch.softmax(logits, dim=1)\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u8bc4\u4f30\u6307\u6807",children:"\u8bc4\u4f30\u6307\u6807"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"from sklearn.calibration import calibration_curve\n\n# \u53ef\u9760\u6027\u56fe\nprob_true, prob_pred = calibration_curve(y_true, y_prob, n_bins=10)\n\n# ECE (Expected Calibration Error)\ndef expected_calibration_error(y_true, y_prob, n_bins=10):\n    bin_boundaries = np.linspace(0, 1, n_bins + 1)\n    ece = 0\n    for i in range(n_bins):\n        mask = (y_prob >= bin_boundaries[i]) & (y_prob < bin_boundaries[i + 1])\n        if mask.sum() > 0:\n            acc = y_true[mask].mean()\n            conf = y_prob[mask].mean()\n            ece += mask.sum() * abs(acc - conf)\n    return ece / len(y_true)\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5e94\u7528\u573a\u666f",children:"\u5e94\u7528\u573a\u666f"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u9886\u57df"}),(0,i.jsx)(e.th,{children:"\u5e94\u7528"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u533b\u7597\u8bca\u65ad"}),(0,i.jsx)(e.td,{children:"\u8bc6\u522b\u9700\u8981\u4eba\u5de5\u590d\u6838\u7684\u75c5\u4f8b"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u81ea\u52a8\u9a7e\u9a76"}),(0,i.jsx)(e.td,{children:"\u4f4e\u7f6e\u4fe1\u5ea6\u65f6\u4ea4\u8fd8\u63a7\u5236\u6743"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u4e3b\u52a8\u5b66\u4e60"}),(0,i.jsx)(e.td,{children:"\u9009\u62e9\u6700\u4e0d\u786e\u5b9a\u7684\u6837\u672c\u6807\u6ce8"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5f02\u5e38\u68c0\u6d4b"}),(0,i.jsx)(e.td,{children:"\u9ad8\u4e0d\u786e\u5b9a\u6027\u53ef\u80fd\u662f\u5f02\u5e38"})]})]})]})]})}function h(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(c,{...n})}):c(n)}}}]);